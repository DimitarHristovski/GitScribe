var oN=Object.defineProperty;var lN=(t,e,n)=>e in t?oN(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var k=(t,e,n)=>lN(t,typeof e!="symbol"?e+"":e,n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}})();function yw(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var vw={exports:{}},Ku={},_w={exports:{}},Ie={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ul=Symbol.for("react.element"),cN=Symbol.for("react.portal"),uN=Symbol.for("react.fragment"),dN=Symbol.for("react.strict_mode"),hN=Symbol.for("react.profiler"),fN=Symbol.for("react.provider"),mN=Symbol.for("react.context"),pN=Symbol.for("react.forward_ref"),gN=Symbol.for("react.suspense"),yN=Symbol.for("react.memo"),vN=Symbol.for("react.lazy"),$y=Symbol.iterator;function _N(t){return t===null||typeof t!="object"?null:(t=$y&&t[$y]||t["@@iterator"],typeof t=="function"?t:null)}var ww={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},xw=Object.assign,bw={};function _i(t,e,n){this.props=t,this.context=e,this.refs=bw,this.updater=n||ww}_i.prototype.isReactComponent={};_i.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};_i.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Sw(){}Sw.prototype=_i.prototype;function ap(t,e,n){this.props=t,this.context=e,this.refs=bw,this.updater=n||ww}var ip=ap.prototype=new Sw;ip.constructor=ap;xw(ip,_i.prototype);ip.isPureReactComponent=!0;var Ly=Array.isArray,kw=Object.prototype.hasOwnProperty,op={current:null},Ew={key:!0,ref:!0,__self:!0,__source:!0};function Nw(t,e,n){var r,s={},a=null,i=null;if(e!=null)for(r in e.ref!==void 0&&(i=e.ref),e.key!==void 0&&(a=""+e.key),e)kw.call(e,r)&&!Ew.hasOwnProperty(r)&&(s[r]=e[r]);var o=arguments.length-2;if(o===1)s.children=n;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];s.children=l}if(t&&t.defaultProps)for(r in o=t.defaultProps,o)s[r]===void 0&&(s[r]=o[r]);return{$$typeof:ul,type:t,key:a,ref:i,props:s,_owner:op.current}}function wN(t,e){return{$$typeof:ul,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function lp(t){return typeof t=="object"&&t!==null&&t.$$typeof===ul}function xN(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Dy=/\/+/g;function th(t,e){return typeof t=="object"&&t!==null&&t.key!=null?xN(""+t.key):e.toString(36)}function xc(t,e,n,r,s){var a=typeof t;(a==="undefined"||a==="boolean")&&(t=null);var i=!1;if(t===null)i=!0;else switch(a){case"string":case"number":i=!0;break;case"object":switch(t.$$typeof){case ul:case cN:i=!0}}if(i)return i=t,s=s(i),t=r===""?"."+th(i,0):r,Ly(s)?(n="",t!=null&&(n=t.replace(Dy,"$&/")+"/"),xc(s,e,n,"",function(u){return u})):s!=null&&(lp(s)&&(s=wN(s,n+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(Dy,"$&/")+"/")+t)),e.push(s)),1;if(i=0,r=r===""?".":r+":",Ly(t))for(var o=0;o<t.length;o++){a=t[o];var l=r+th(a,o);i+=xc(a,e,n,l,s)}else if(l=_N(t),typeof l=="function")for(t=l.call(t),o=0;!(a=t.next()).done;)a=a.value,l=r+th(a,o++),i+=xc(a,e,n,l,s);else if(a==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return i}function Ol(t,e,n){if(t==null)return t;var r=[],s=0;return xc(t,r,"","",function(a){return e.call(n,a,s++)}),r}function bN(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Kt={current:null},bc={transition:null},SN={ReactCurrentDispatcher:Kt,ReactCurrentBatchConfig:bc,ReactCurrentOwner:op};function Tw(){throw Error("act(...) is not supported in production builds of React.")}Ie.Children={map:Ol,forEach:function(t,e,n){Ol(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Ol(t,function(){e++}),e},toArray:function(t){return Ol(t,function(e){return e})||[]},only:function(t){if(!lp(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ie.Component=_i;Ie.Fragment=uN;Ie.Profiler=hN;Ie.PureComponent=ap;Ie.StrictMode=dN;Ie.Suspense=gN;Ie.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=SN;Ie.act=Tw;Ie.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=xw({},t.props),s=t.key,a=t.ref,i=t._owner;if(e!=null){if(e.ref!==void 0&&(a=e.ref,i=op.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in e)kw.call(e,l)&&!Ew.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){o=Array(l);for(var u=0;u<l;u++)o[u]=arguments[u+2];r.children=o}return{$$typeof:ul,type:t.type,key:s,ref:a,props:r,_owner:i}};Ie.createContext=function(t){return t={$$typeof:mN,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:fN,_context:t},t.Consumer=t};Ie.createElement=Nw;Ie.createFactory=function(t){var e=Nw.bind(null,t);return e.type=t,e};Ie.createRef=function(){return{current:null}};Ie.forwardRef=function(t){return{$$typeof:pN,render:t}};Ie.isValidElement=lp;Ie.lazy=function(t){return{$$typeof:vN,_payload:{_status:-1,_result:t},_init:bN}};Ie.memo=function(t,e){return{$$typeof:yN,type:t,compare:e===void 0?null:e}};Ie.startTransition=function(t){var e=bc.transition;bc.transition={};try{t()}finally{bc.transition=e}};Ie.unstable_act=Tw;Ie.useCallback=function(t,e){return Kt.current.useCallback(t,e)};Ie.useContext=function(t){return Kt.current.useContext(t)};Ie.useDebugValue=function(){};Ie.useDeferredValue=function(t){return Kt.current.useDeferredValue(t)};Ie.useEffect=function(t,e){return Kt.current.useEffect(t,e)};Ie.useId=function(){return Kt.current.useId()};Ie.useImperativeHandle=function(t,e,n){return Kt.current.useImperativeHandle(t,e,n)};Ie.useInsertionEffect=function(t,e){return Kt.current.useInsertionEffect(t,e)};Ie.useLayoutEffect=function(t,e){return Kt.current.useLayoutEffect(t,e)};Ie.useMemo=function(t,e){return Kt.current.useMemo(t,e)};Ie.useReducer=function(t,e,n){return Kt.current.useReducer(t,e,n)};Ie.useRef=function(t){return Kt.current.useRef(t)};Ie.useState=function(t){return Kt.current.useState(t)};Ie.useSyncExternalStore=function(t,e,n){return Kt.current.useSyncExternalStore(t,e,n)};Ie.useTransition=function(){return Kt.current.useTransition()};Ie.version="18.3.1";_w.exports=Ie;var V=_w.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kN=V,EN=Symbol.for("react.element"),NN=Symbol.for("react.fragment"),TN=Object.prototype.hasOwnProperty,AN=kN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,CN={key:!0,ref:!0,__self:!0,__source:!0};function Aw(t,e,n){var r,s={},a=null,i=null;n!==void 0&&(a=""+n),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(i=e.ref);for(r in e)TN.call(e,r)&&!CN.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:EN,type:t,key:a,ref:i,props:s,_owner:AN.current}}Ku.Fragment=NN;Ku.jsx=Aw;Ku.jsxs=Aw;vw.exports=Ku;var c=vw.exports,Cw={exports:{}},En={},Iw={exports:{}},jw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e($,M){var U=$.length;$.push(M);e:for(;0<U;){var re=U-1>>>1,X=$[re];if(0<s(X,M))$[re]=M,$[U]=X,U=re;else break e}}function n($){return $.length===0?null:$[0]}function r($){if($.length===0)return null;var M=$[0],U=$.pop();if(U!==M){$[0]=U;e:for(var re=0,X=$.length,Te=X>>>1;re<Te;){var ze=2*(re+1)-1,Ee=$[ze],E=ze+1,b=$[E];if(0>s(Ee,U))E<X&&0>s(b,Ee)?($[re]=b,$[E]=U,re=E):($[re]=Ee,$[ze]=U,re=ze);else if(E<X&&0>s(b,U))$[re]=b,$[E]=U,re=E;else break e}}return M}function s($,M){var U=$.sortIndex-M.sortIndex;return U!==0?U:$.id-M.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var i=Date,o=i.now();t.unstable_now=function(){return i.now()-o}}var l=[],u=[],d=1,h=null,f=3,m=!1,v=!1,w=!1,_=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,p=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function g($){for(var M=n(u);M!==null;){if(M.callback===null)r(u);else if(M.startTime<=$)r(u),M.sortIndex=M.expirationTime,e(l,M);else break;M=n(u)}}function S($){if(w=!1,g($),!v)if(n(l)!==null)v=!0,W(N);else{var M=n(u);M!==null&&J(S,M.startTime-$)}}function N($,M){v=!1,w&&(w=!1,y(x),x=-1),m=!0;var U=f;try{for(g(M),h=n(l);h!==null&&(!(h.expirationTime>M)||$&&!D());){var re=h.callback;if(typeof re=="function"){h.callback=null,f=h.priorityLevel;var X=re(h.expirationTime<=M);M=t.unstable_now(),typeof X=="function"?h.callback=X:h===n(l)&&r(l),g(M)}else r(l);h=n(l)}if(h!==null)var Te=!0;else{var ze=n(u);ze!==null&&J(S,ze.startTime-M),Te=!1}return Te}finally{h=null,f=U,m=!1}}var T=!1,A=null,x=-1,j=5,R=-1;function D(){return!(t.unstable_now()-R<j)}function ye(){if(A!==null){var $=t.unstable_now();R=$;var M=!0;try{M=A(!0,$)}finally{M?Fe():(T=!1,A=null)}}else T=!1}var Fe;if(typeof p=="function")Fe=function(){p(ye)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,F=G.port2;G.port1.onmessage=ye,Fe=function(){F.postMessage(null)}}else Fe=function(){_(ye,0)};function W($){A=$,T||(T=!0,Fe())}function J($,M){x=_(function(){$(t.unstable_now())},M)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function($){$.callback=null},t.unstable_continueExecution=function(){v||m||(v=!0,W(N))},t.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<$?Math.floor(1e3/$):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function($){switch(f){case 1:case 2:case 3:var M=3;break;default:M=f}var U=f;f=M;try{return $()}finally{f=U}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function($,M){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var U=f;f=$;try{return M()}finally{f=U}},t.unstable_scheduleCallback=function($,M,U){var re=t.unstable_now();switch(typeof U=="object"&&U!==null?(U=U.delay,U=typeof U=="number"&&0<U?re+U:re):U=re,$){case 1:var X=-1;break;case 2:X=250;break;case 5:X=1073741823;break;case 4:X=1e4;break;default:X=5e3}return X=U+X,$={id:d++,callback:M,priorityLevel:$,startTime:U,expirationTime:X,sortIndex:-1},U>re?($.sortIndex=U,e(u,$),n(l)===null&&$===n(u)&&(w?(y(x),x=-1):w=!0,J(S,U-re))):($.sortIndex=X,e(l,$),v||m||(v=!0,W(N))),$},t.unstable_shouldYield=D,t.unstable_wrapCallback=function($){var M=f;return function(){var U=f;f=M;try{return $.apply(this,arguments)}finally{f=U}}}})(jw);Iw.exports=jw;var IN=Iw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jN=V,bn=IN;function B(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Rw=new Set,Po={};function _a(t,e){ni(t,e),ni(t+"Capture",e)}function ni(t,e){for(Po[t]=e,t=0;t<e.length;t++)Rw.add(e[t])}var Vr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),pf=Object.prototype.hasOwnProperty,RN=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,My={},Fy={};function ON(t){return pf.call(Fy,t)?!0:pf.call(My,t)?!1:RN.test(t)?Fy[t]=!0:(My[t]=!0,!1)}function PN(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function $N(t,e,n,r){if(e===null||typeof e>"u"||PN(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Jt(t,e,n,r,s,a,i){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=a,this.removeEmptyString=i}var Pt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Pt[t]=new Jt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Pt[e]=new Jt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Pt[t]=new Jt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Pt[t]=new Jt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Pt[t]=new Jt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Pt[t]=new Jt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Pt[t]=new Jt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Pt[t]=new Jt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Pt[t]=new Jt(t,5,!1,t.toLowerCase(),null,!1,!1)});var cp=/[\-:]([a-z])/g;function up(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(cp,up);Pt[e]=new Jt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(cp,up);Pt[e]=new Jt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(cp,up);Pt[e]=new Jt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Pt[t]=new Jt(t,1,!1,t.toLowerCase(),null,!1,!1)});Pt.xlinkHref=new Jt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Pt[t]=new Jt(t,1,!1,t.toLowerCase(),null,!0,!0)});function dp(t,e,n,r){var s=Pt.hasOwnProperty(e)?Pt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&($N(e,n,s,r)&&(n=null),r||s===null?ON(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var ns=jN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Pl=Symbol.for("react.element"),Pa=Symbol.for("react.portal"),$a=Symbol.for("react.fragment"),hp=Symbol.for("react.strict_mode"),gf=Symbol.for("react.profiler"),Ow=Symbol.for("react.provider"),Pw=Symbol.for("react.context"),fp=Symbol.for("react.forward_ref"),yf=Symbol.for("react.suspense"),vf=Symbol.for("react.suspense_list"),mp=Symbol.for("react.memo"),hs=Symbol.for("react.lazy"),$w=Symbol.for("react.offscreen"),zy=Symbol.iterator;function $i(t){return t===null||typeof t!="object"?null:(t=zy&&t[zy]||t["@@iterator"],typeof t=="function"?t:null)}var st=Object.assign,nh;function Vi(t){if(nh===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);nh=e&&e[1]||""}return`
`+nh+t}var rh=!1;function sh(t,e){if(!t||rh)return"";rh=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),a=r.stack.split(`
`),i=s.length-1,o=a.length-1;1<=i&&0<=o&&s[i]!==a[o];)o--;for(;1<=i&&0<=o;i--,o--)if(s[i]!==a[o]){if(i!==1||o!==1)do if(i--,o--,0>o||s[i]!==a[o]){var l=`
`+s[i].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=i&&0<=o);break}}}finally{rh=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Vi(t):""}function LN(t){switch(t.tag){case 5:return Vi(t.type);case 16:return Vi("Lazy");case 13:return Vi("Suspense");case 19:return Vi("SuspenseList");case 0:case 2:case 15:return t=sh(t.type,!1),t;case 11:return t=sh(t.type.render,!1),t;case 1:return t=sh(t.type,!0),t;default:return""}}function _f(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case $a:return"Fragment";case Pa:return"Portal";case gf:return"Profiler";case hp:return"StrictMode";case yf:return"Suspense";case vf:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Pw:return(t.displayName||"Context")+".Consumer";case Ow:return(t._context.displayName||"Context")+".Provider";case fp:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case mp:return e=t.displayName||null,e!==null?e:_f(t.type)||"Memo";case hs:e=t._payload,t=t._init;try{return _f(t(e))}catch{}}return null}function DN(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return _f(e);case 8:return e===hp?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ps(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Lw(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function MN(t){var e=Lw(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,a=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(i){r=""+i,a.call(this,i)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(i){r=""+i},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function $l(t){t._valueTracker||(t._valueTracker=MN(t))}function Dw(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Lw(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Vc(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function wf(t,e){var n=e.checked;return st({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Uy(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Ps(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Mw(t,e){e=e.checked,e!=null&&dp(t,"checked",e,!1)}function xf(t,e){Mw(t,e);var n=Ps(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?bf(t,e.type,n):e.hasOwnProperty("defaultValue")&&bf(t,e.type,Ps(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function By(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function bf(t,e,n){(e!=="number"||Vc(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var qi=Array.isArray;function Ja(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Ps(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Sf(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(B(91));return st({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Gy(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(B(92));if(qi(n)){if(1<n.length)throw Error(B(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Ps(n)}}function Fw(t,e){var n=Ps(e.value),r=Ps(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Hy(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function zw(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function kf(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?zw(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Ll,Uw=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Ll=Ll||document.createElement("div"),Ll.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Ll.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function $o(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var fo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},FN=["Webkit","ms","Moz","O"];Object.keys(fo).forEach(function(t){FN.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),fo[e]=fo[t]})});function Bw(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||fo.hasOwnProperty(t)&&fo[t]?(""+e).trim():e+"px"}function Gw(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=Bw(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var zN=st({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ef(t,e){if(e){if(zN[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(B(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(B(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(B(61))}if(e.style!=null&&typeof e.style!="object")throw Error(B(62))}}function Nf(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Tf=null;function pp(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Af=null,Ya=null,Qa=null;function Wy(t){if(t=fl(t)){if(typeof Af!="function")throw Error(B(280));var e=t.stateNode;e&&(e=ed(e),Af(t.stateNode,t.type,e))}}function Hw(t){Ya?Qa?Qa.push(t):Qa=[t]:Ya=t}function Ww(){if(Ya){var t=Ya,e=Qa;if(Qa=Ya=null,Wy(t),e)for(t=0;t<e.length;t++)Wy(e[t])}}function Vw(t,e){return t(e)}function qw(){}var ah=!1;function Zw(t,e,n){if(ah)return t(e,n);ah=!0;try{return Vw(t,e,n)}finally{ah=!1,(Ya!==null||Qa!==null)&&(qw(),Ww())}}function Lo(t,e){var n=t.stateNode;if(n===null)return null;var r=ed(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(B(231,e,typeof n));return n}var Cf=!1;if(Vr)try{var Li={};Object.defineProperty(Li,"passive",{get:function(){Cf=!0}}),window.addEventListener("test",Li,Li),window.removeEventListener("test",Li,Li)}catch{Cf=!1}function UN(t,e,n,r,s,a,i,o,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(d){this.onError(d)}}var mo=!1,qc=null,Zc=!1,If=null,BN={onError:function(t){mo=!0,qc=t}};function GN(t,e,n,r,s,a,i,o,l){mo=!1,qc=null,UN.apply(BN,arguments)}function HN(t,e,n,r,s,a,i,o,l){if(GN.apply(this,arguments),mo){if(mo){var u=qc;mo=!1,qc=null}else throw Error(B(198));Zc||(Zc=!0,If=u)}}function wa(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Kw(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Vy(t){if(wa(t)!==t)throw Error(B(188))}function WN(t){var e=t.alternate;if(!e){if(e=wa(t),e===null)throw Error(B(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var a=s.alternate;if(a===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===a.child){for(a=s.child;a;){if(a===n)return Vy(s),t;if(a===r)return Vy(s),e;a=a.sibling}throw Error(B(188))}if(n.return!==r.return)n=s,r=a;else{for(var i=!1,o=s.child;o;){if(o===n){i=!0,n=s,r=a;break}if(o===r){i=!0,r=s,n=a;break}o=o.sibling}if(!i){for(o=a.child;o;){if(o===n){i=!0,n=a,r=s;break}if(o===r){i=!0,r=a,n=s;break}o=o.sibling}if(!i)throw Error(B(189))}}if(n.alternate!==r)throw Error(B(190))}if(n.tag!==3)throw Error(B(188));return n.stateNode.current===n?t:e}function Jw(t){return t=WN(t),t!==null?Yw(t):null}function Yw(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Yw(t);if(e!==null)return e;t=t.sibling}return null}var Qw=bn.unstable_scheduleCallback,qy=bn.unstable_cancelCallback,VN=bn.unstable_shouldYield,qN=bn.unstable_requestPaint,ut=bn.unstable_now,ZN=bn.unstable_getCurrentPriorityLevel,gp=bn.unstable_ImmediatePriority,Xw=bn.unstable_UserBlockingPriority,Kc=bn.unstable_NormalPriority,KN=bn.unstable_LowPriority,ex=bn.unstable_IdlePriority,Ju=null,Sr=null;function JN(t){if(Sr&&typeof Sr.onCommitFiberRoot=="function")try{Sr.onCommitFiberRoot(Ju,t,void 0,(t.current.flags&128)===128)}catch{}}var er=Math.clz32?Math.clz32:XN,YN=Math.log,QN=Math.LN2;function XN(t){return t>>>=0,t===0?32:31-(YN(t)/QN|0)|0}var Dl=64,Ml=4194304;function Zi(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Jc(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,a=t.pingedLanes,i=n&268435455;if(i!==0){var o=i&~s;o!==0?r=Zi(o):(a&=i,a!==0&&(r=Zi(a)))}else i=n&~s,i!==0?r=Zi(i):a!==0&&(r=Zi(a));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,a=e&-e,s>=a||s===16&&(a&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-er(e),s=1<<n,r|=t[n],e&=~s;return r}function eT(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function tT(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,a=t.pendingLanes;0<a;){var i=31-er(a),o=1<<i,l=s[i];l===-1?(!(o&n)||o&r)&&(s[i]=eT(o,e)):l<=e&&(t.expiredLanes|=o),a&=~o}}function jf(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function tx(){var t=Dl;return Dl<<=1,!(Dl&4194240)&&(Dl=64),t}function ih(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function dl(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-er(e),t[e]=n}function nT(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-er(n),a=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~a}}function yp(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-er(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var Ge=0;function nx(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var rx,vp,sx,ax,ix,Rf=!1,Fl=[],ks=null,Es=null,Ns=null,Do=new Map,Mo=new Map,ps=[],rT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Zy(t,e){switch(t){case"focusin":case"focusout":ks=null;break;case"dragenter":case"dragleave":Es=null;break;case"mouseover":case"mouseout":Ns=null;break;case"pointerover":case"pointerout":Do.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Mo.delete(e.pointerId)}}function Di(t,e,n,r,s,a){return t===null||t.nativeEvent!==a?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[s]},e!==null&&(e=fl(e),e!==null&&vp(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function sT(t,e,n,r,s){switch(e){case"focusin":return ks=Di(ks,t,e,n,r,s),!0;case"dragenter":return Es=Di(Es,t,e,n,r,s),!0;case"mouseover":return Ns=Di(Ns,t,e,n,r,s),!0;case"pointerover":var a=s.pointerId;return Do.set(a,Di(Do.get(a)||null,t,e,n,r,s)),!0;case"gotpointercapture":return a=s.pointerId,Mo.set(a,Di(Mo.get(a)||null,t,e,n,r,s)),!0}return!1}function ox(t){var e=ea(t.target);if(e!==null){var n=wa(e);if(n!==null){if(e=n.tag,e===13){if(e=Kw(n),e!==null){t.blockedOn=e,ix(t.priority,function(){sx(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Sc(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Of(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Tf=r,n.target.dispatchEvent(r),Tf=null}else return e=fl(n),e!==null&&vp(e),t.blockedOn=n,!1;e.shift()}return!0}function Ky(t,e,n){Sc(t)&&n.delete(e)}function aT(){Rf=!1,ks!==null&&Sc(ks)&&(ks=null),Es!==null&&Sc(Es)&&(Es=null),Ns!==null&&Sc(Ns)&&(Ns=null),Do.forEach(Ky),Mo.forEach(Ky)}function Mi(t,e){t.blockedOn===e&&(t.blockedOn=null,Rf||(Rf=!0,bn.unstable_scheduleCallback(bn.unstable_NormalPriority,aT)))}function Fo(t){function e(s){return Mi(s,t)}if(0<Fl.length){Mi(Fl[0],t);for(var n=1;n<Fl.length;n++){var r=Fl[n];r.blockedOn===t&&(r.blockedOn=null)}}for(ks!==null&&Mi(ks,t),Es!==null&&Mi(Es,t),Ns!==null&&Mi(Ns,t),Do.forEach(e),Mo.forEach(e),n=0;n<ps.length;n++)r=ps[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<ps.length&&(n=ps[0],n.blockedOn===null);)ox(n),n.blockedOn===null&&ps.shift()}var Xa=ns.ReactCurrentBatchConfig,Yc=!0;function iT(t,e,n,r){var s=Ge,a=Xa.transition;Xa.transition=null;try{Ge=1,_p(t,e,n,r)}finally{Ge=s,Xa.transition=a}}function oT(t,e,n,r){var s=Ge,a=Xa.transition;Xa.transition=null;try{Ge=4,_p(t,e,n,r)}finally{Ge=s,Xa.transition=a}}function _p(t,e,n,r){if(Yc){var s=Of(t,e,n,r);if(s===null)gh(t,e,r,Qc,n),Zy(t,r);else if(sT(s,t,e,n,r))r.stopPropagation();else if(Zy(t,r),e&4&&-1<rT.indexOf(t)){for(;s!==null;){var a=fl(s);if(a!==null&&rx(a),a=Of(t,e,n,r),a===null&&gh(t,e,r,Qc,n),a===s)break;s=a}s!==null&&r.stopPropagation()}else gh(t,e,r,null,n)}}var Qc=null;function Of(t,e,n,r){if(Qc=null,t=pp(r),t=ea(t),t!==null)if(e=wa(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Kw(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Qc=t,null}function lx(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ZN()){case gp:return 1;case Xw:return 4;case Kc:case KN:return 16;case ex:return 536870912;default:return 16}default:return 16}}var vs=null,wp=null,kc=null;function cx(){if(kc)return kc;var t,e=wp,n=e.length,r,s="value"in vs?vs.value:vs.textContent,a=s.length;for(t=0;t<n&&e[t]===s[t];t++);var i=n-t;for(r=1;r<=i&&e[n-r]===s[a-r];r++);return kc=s.slice(t,1<r?1-r:void 0)}function Ec(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function zl(){return!0}function Jy(){return!1}function Nn(t){function e(n,r,s,a,i){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=a,this.target=i,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(n=t[o],this[o]=n?n(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?zl:Jy,this.isPropagationStopped=Jy,this}return st(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=zl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=zl)},persist:function(){},isPersistent:zl}),e}var wi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},xp=Nn(wi),hl=st({},wi,{view:0,detail:0}),lT=Nn(hl),oh,lh,Fi,Yu=st({},hl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:bp,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Fi&&(Fi&&t.type==="mousemove"?(oh=t.screenX-Fi.screenX,lh=t.screenY-Fi.screenY):lh=oh=0,Fi=t),oh)},movementY:function(t){return"movementY"in t?t.movementY:lh}}),Yy=Nn(Yu),cT=st({},Yu,{dataTransfer:0}),uT=Nn(cT),dT=st({},hl,{relatedTarget:0}),ch=Nn(dT),hT=st({},wi,{animationName:0,elapsedTime:0,pseudoElement:0}),fT=Nn(hT),mT=st({},wi,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),pT=Nn(mT),gT=st({},wi,{data:0}),Qy=Nn(gT),yT={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},vT={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_T={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function wT(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=_T[t])?!!e[t]:!1}function bp(){return wT}var xT=st({},hl,{key:function(t){if(t.key){var e=yT[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Ec(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?vT[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:bp,charCode:function(t){return t.type==="keypress"?Ec(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Ec(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),bT=Nn(xT),ST=st({},Yu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Xy=Nn(ST),kT=st({},hl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:bp}),ET=Nn(kT),NT=st({},wi,{propertyName:0,elapsedTime:0,pseudoElement:0}),TT=Nn(NT),AT=st({},Yu,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),CT=Nn(AT),IT=[9,13,27,32],Sp=Vr&&"CompositionEvent"in window,po=null;Vr&&"documentMode"in document&&(po=document.documentMode);var jT=Vr&&"TextEvent"in window&&!po,ux=Vr&&(!Sp||po&&8<po&&11>=po),e0=" ",t0=!1;function dx(t,e){switch(t){case"keyup":return IT.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function hx(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var La=!1;function RT(t,e){switch(t){case"compositionend":return hx(e);case"keypress":return e.which!==32?null:(t0=!0,e0);case"textInput":return t=e.data,t===e0&&t0?null:t;default:return null}}function OT(t,e){if(La)return t==="compositionend"||!Sp&&dx(t,e)?(t=cx(),kc=wp=vs=null,La=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return ux&&e.locale!=="ko"?null:e.data;default:return null}}var PT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function n0(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!PT[t.type]:e==="textarea"}function fx(t,e,n,r){Hw(r),e=Xc(e,"onChange"),0<e.length&&(n=new xp("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var go=null,zo=null;function $T(t){kx(t,0)}function Qu(t){var e=Fa(t);if(Dw(e))return t}function LT(t,e){if(t==="change")return e}var mx=!1;if(Vr){var uh;if(Vr){var dh="oninput"in document;if(!dh){var r0=document.createElement("div");r0.setAttribute("oninput","return;"),dh=typeof r0.oninput=="function"}uh=dh}else uh=!1;mx=uh&&(!document.documentMode||9<document.documentMode)}function s0(){go&&(go.detachEvent("onpropertychange",px),zo=go=null)}function px(t){if(t.propertyName==="value"&&Qu(zo)){var e=[];fx(e,zo,t,pp(t)),Zw($T,e)}}function DT(t,e,n){t==="focusin"?(s0(),go=e,zo=n,go.attachEvent("onpropertychange",px)):t==="focusout"&&s0()}function MT(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Qu(zo)}function FT(t,e){if(t==="click")return Qu(e)}function zT(t,e){if(t==="input"||t==="change")return Qu(e)}function UT(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var nr=typeof Object.is=="function"?Object.is:UT;function Uo(t,e){if(nr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!pf.call(e,s)||!nr(t[s],e[s]))return!1}return!0}function a0(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function i0(t,e){var n=a0(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=a0(n)}}function gx(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?gx(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function yx(){for(var t=window,e=Vc();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Vc(t.document)}return e}function kp(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function BT(t){var e=yx(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&gx(n.ownerDocument.documentElement,n)){if(r!==null&&kp(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,a=Math.min(r.start,s);r=r.end===void 0?a:Math.min(r.end,s),!t.extend&&a>r&&(s=r,r=a,a=s),s=i0(n,a);var i=i0(n,r);s&&i&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==i.node||t.focusOffset!==i.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),a>r?(t.addRange(e),t.extend(i.node,i.offset)):(e.setEnd(i.node,i.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var GT=Vr&&"documentMode"in document&&11>=document.documentMode,Da=null,Pf=null,yo=null,$f=!1;function o0(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;$f||Da==null||Da!==Vc(r)||(r=Da,"selectionStart"in r&&kp(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),yo&&Uo(yo,r)||(yo=r,r=Xc(Pf,"onSelect"),0<r.length&&(e=new xp("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Da)))}function Ul(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Ma={animationend:Ul("Animation","AnimationEnd"),animationiteration:Ul("Animation","AnimationIteration"),animationstart:Ul("Animation","AnimationStart"),transitionend:Ul("Transition","TransitionEnd")},hh={},vx={};Vr&&(vx=document.createElement("div").style,"AnimationEvent"in window||(delete Ma.animationend.animation,delete Ma.animationiteration.animation,delete Ma.animationstart.animation),"TransitionEvent"in window||delete Ma.transitionend.transition);function Xu(t){if(hh[t])return hh[t];if(!Ma[t])return t;var e=Ma[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in vx)return hh[t]=e[n];return t}var _x=Xu("animationend"),wx=Xu("animationiteration"),xx=Xu("animationstart"),bx=Xu("transitionend"),Sx=new Map,l0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function zs(t,e){Sx.set(t,e),_a(e,[t])}for(var fh=0;fh<l0.length;fh++){var mh=l0[fh],HT=mh.toLowerCase(),WT=mh[0].toUpperCase()+mh.slice(1);zs(HT,"on"+WT)}zs(_x,"onAnimationEnd");zs(wx,"onAnimationIteration");zs(xx,"onAnimationStart");zs("dblclick","onDoubleClick");zs("focusin","onFocus");zs("focusout","onBlur");zs(bx,"onTransitionEnd");ni("onMouseEnter",["mouseout","mouseover"]);ni("onMouseLeave",["mouseout","mouseover"]);ni("onPointerEnter",["pointerout","pointerover"]);ni("onPointerLeave",["pointerout","pointerover"]);_a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));_a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));_a("onBeforeInput",["compositionend","keypress","textInput","paste"]);_a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));_a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));_a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ki="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),VT=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ki));function c0(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,HN(r,e,void 0,t),t.currentTarget=null}function kx(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var a=void 0;if(e)for(var i=r.length-1;0<=i;i--){var o=r[i],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==a&&s.isPropagationStopped())break e;c0(s,o,u),a=l}else for(i=0;i<r.length;i++){if(o=r[i],l=o.instance,u=o.currentTarget,o=o.listener,l!==a&&s.isPropagationStopped())break e;c0(s,o,u),a=l}}}if(Zc)throw t=If,Zc=!1,If=null,t}function Ke(t,e){var n=e[zf];n===void 0&&(n=e[zf]=new Set);var r=t+"__bubble";n.has(r)||(Ex(e,t,2,!1),n.add(r))}function ph(t,e,n){var r=0;e&&(r|=4),Ex(n,t,r,e)}var Bl="_reactListening"+Math.random().toString(36).slice(2);function Bo(t){if(!t[Bl]){t[Bl]=!0,Rw.forEach(function(n){n!=="selectionchange"&&(VT.has(n)||ph(n,!1,t),ph(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Bl]||(e[Bl]=!0,ph("selectionchange",!1,e))}}function Ex(t,e,n,r){switch(lx(e)){case 1:var s=iT;break;case 4:s=oT;break;default:s=_p}n=s.bind(null,e,n,t),s=void 0,!Cf||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function gh(t,e,n,r,s){var a=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var i=r.tag;if(i===3||i===4){var o=r.stateNode.containerInfo;if(o===s||o.nodeType===8&&o.parentNode===s)break;if(i===4)for(i=r.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;i=i.return}for(;o!==null;){if(i=ea(o),i===null)return;if(l=i.tag,l===5||l===6){r=a=i;continue e}o=o.parentNode}}r=r.return}Zw(function(){var u=a,d=pp(n),h=[];e:{var f=Sx.get(t);if(f!==void 0){var m=xp,v=t;switch(t){case"keypress":if(Ec(n)===0)break e;case"keydown":case"keyup":m=bT;break;case"focusin":v="focus",m=ch;break;case"focusout":v="blur",m=ch;break;case"beforeblur":case"afterblur":m=ch;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=Yy;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=uT;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=ET;break;case _x:case wx:case xx:m=fT;break;case bx:m=TT;break;case"scroll":m=lT;break;case"wheel":m=CT;break;case"copy":case"cut":case"paste":m=pT;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=Xy}var w=(e&4)!==0,_=!w&&t==="scroll",y=w?f!==null?f+"Capture":null:f;w=[];for(var p=u,g;p!==null;){g=p;var S=g.stateNode;if(g.tag===5&&S!==null&&(g=S,y!==null&&(S=Lo(p,y),S!=null&&w.push(Go(p,S,g)))),_)break;p=p.return}0<w.length&&(f=new m(f,v,null,n,d),h.push({event:f,listeners:w}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",f&&n!==Tf&&(v=n.relatedTarget||n.fromElement)&&(ea(v)||v[qr]))break e;if((m||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,m?(v=n.relatedTarget||n.toElement,m=u,v=v?ea(v):null,v!==null&&(_=wa(v),v!==_||v.tag!==5&&v.tag!==6)&&(v=null)):(m=null,v=u),m!==v)){if(w=Yy,S="onMouseLeave",y="onMouseEnter",p="mouse",(t==="pointerout"||t==="pointerover")&&(w=Xy,S="onPointerLeave",y="onPointerEnter",p="pointer"),_=m==null?f:Fa(m),g=v==null?f:Fa(v),f=new w(S,p+"leave",m,n,d),f.target=_,f.relatedTarget=g,S=null,ea(d)===u&&(w=new w(y,p+"enter",v,n,d),w.target=g,w.relatedTarget=_,S=w),_=S,m&&v)t:{for(w=m,y=v,p=0,g=w;g;g=ka(g))p++;for(g=0,S=y;S;S=ka(S))g++;for(;0<p-g;)w=ka(w),p--;for(;0<g-p;)y=ka(y),g--;for(;p--;){if(w===y||y!==null&&w===y.alternate)break t;w=ka(w),y=ka(y)}w=null}else w=null;m!==null&&u0(h,f,m,w,!1),v!==null&&_!==null&&u0(h,_,v,w,!0)}}e:{if(f=u?Fa(u):window,m=f.nodeName&&f.nodeName.toLowerCase(),m==="select"||m==="input"&&f.type==="file")var N=LT;else if(n0(f))if(mx)N=zT;else{N=MT;var T=DT}else(m=f.nodeName)&&m.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(N=FT);if(N&&(N=N(t,u))){fx(h,N,n,d);break e}T&&T(t,f,u),t==="focusout"&&(T=f._wrapperState)&&T.controlled&&f.type==="number"&&bf(f,"number",f.value)}switch(T=u?Fa(u):window,t){case"focusin":(n0(T)||T.contentEditable==="true")&&(Da=T,Pf=u,yo=null);break;case"focusout":yo=Pf=Da=null;break;case"mousedown":$f=!0;break;case"contextmenu":case"mouseup":case"dragend":$f=!1,o0(h,n,d);break;case"selectionchange":if(GT)break;case"keydown":case"keyup":o0(h,n,d)}var A;if(Sp)e:{switch(t){case"compositionstart":var x="onCompositionStart";break e;case"compositionend":x="onCompositionEnd";break e;case"compositionupdate":x="onCompositionUpdate";break e}x=void 0}else La?dx(t,n)&&(x="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(x="onCompositionStart");x&&(ux&&n.locale!=="ko"&&(La||x!=="onCompositionStart"?x==="onCompositionEnd"&&La&&(A=cx()):(vs=d,wp="value"in vs?vs.value:vs.textContent,La=!0)),T=Xc(u,x),0<T.length&&(x=new Qy(x,t,null,n,d),h.push({event:x,listeners:T}),A?x.data=A:(A=hx(n),A!==null&&(x.data=A)))),(A=jT?RT(t,n):OT(t,n))&&(u=Xc(u,"onBeforeInput"),0<u.length&&(d=new Qy("onBeforeInput","beforeinput",null,n,d),h.push({event:d,listeners:u}),d.data=A))}kx(h,e)})}function Go(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Xc(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,a=s.stateNode;s.tag===5&&a!==null&&(s=a,a=Lo(t,n),a!=null&&r.unshift(Go(t,a,s)),a=Lo(t,e),a!=null&&r.push(Go(t,a,s))),t=t.return}return r}function ka(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function u0(t,e,n,r,s){for(var a=e._reactName,i=[];n!==null&&n!==r;){var o=n,l=o.alternate,u=o.stateNode;if(l!==null&&l===r)break;o.tag===5&&u!==null&&(o=u,s?(l=Lo(n,a),l!=null&&i.unshift(Go(n,l,o))):s||(l=Lo(n,a),l!=null&&i.push(Go(n,l,o)))),n=n.return}i.length!==0&&t.push({event:e,listeners:i})}var qT=/\r\n?/g,ZT=/\u0000|\uFFFD/g;function d0(t){return(typeof t=="string"?t:""+t).replace(qT,`
`).replace(ZT,"")}function Gl(t,e,n){if(e=d0(e),d0(t)!==e&&n)throw Error(B(425))}function eu(){}var Lf=null,Df=null;function Mf(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Ff=typeof setTimeout=="function"?setTimeout:void 0,KT=typeof clearTimeout=="function"?clearTimeout:void 0,h0=typeof Promise=="function"?Promise:void 0,JT=typeof queueMicrotask=="function"?queueMicrotask:typeof h0<"u"?function(t){return h0.resolve(null).then(t).catch(YT)}:Ff;function YT(t){setTimeout(function(){throw t})}function yh(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Fo(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Fo(e)}function Ts(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function f0(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var xi=Math.random().toString(36).slice(2),yr="__reactFiber$"+xi,Ho="__reactProps$"+xi,qr="__reactContainer$"+xi,zf="__reactEvents$"+xi,QT="__reactListeners$"+xi,XT="__reactHandles$"+xi;function ea(t){var e=t[yr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[qr]||n[yr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=f0(t);t!==null;){if(n=t[yr])return n;t=f0(t)}return e}t=n,n=t.parentNode}return null}function fl(t){return t=t[yr]||t[qr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Fa(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(B(33))}function ed(t){return t[Ho]||null}var Uf=[],za=-1;function Us(t){return{current:t}}function Ye(t){0>za||(t.current=Uf[za],Uf[za]=null,za--)}function qe(t,e){za++,Uf[za]=t.current,t.current=e}var $s={},zt=Us($s),ln=Us(!1),ha=$s;function ri(t,e){var n=t.type.contextTypes;if(!n)return $s;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},a;for(a in n)s[a]=e[a];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function cn(t){return t=t.childContextTypes,t!=null}function tu(){Ye(ln),Ye(zt)}function m0(t,e,n){if(zt.current!==$s)throw Error(B(168));qe(zt,e),qe(ln,n)}function Nx(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(B(108,DN(t)||"Unknown",s));return st({},n,r)}function nu(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||$s,ha=zt.current,qe(zt,t),qe(ln,ln.current),!0}function p0(t,e,n){var r=t.stateNode;if(!r)throw Error(B(169));n?(t=Nx(t,e,ha),r.__reactInternalMemoizedMergedChildContext=t,Ye(ln),Ye(zt),qe(zt,t)):Ye(ln),qe(ln,n)}var Mr=null,td=!1,vh=!1;function Tx(t){Mr===null?Mr=[t]:Mr.push(t)}function eA(t){td=!0,Tx(t)}function Bs(){if(!vh&&Mr!==null){vh=!0;var t=0,e=Ge;try{var n=Mr;for(Ge=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Mr=null,td=!1}catch(s){throw Mr!==null&&(Mr=Mr.slice(t+1)),Qw(gp,Bs),s}finally{Ge=e,vh=!1}}return null}var Ua=[],Ba=0,ru=null,su=0,Rn=[],On=0,fa=null,Ur=1,Br="";function Vs(t,e){Ua[Ba++]=su,Ua[Ba++]=ru,ru=t,su=e}function Ax(t,e,n){Rn[On++]=Ur,Rn[On++]=Br,Rn[On++]=fa,fa=t;var r=Ur;t=Br;var s=32-er(r)-1;r&=~(1<<s),n+=1;var a=32-er(e)+s;if(30<a){var i=s-s%5;a=(r&(1<<i)-1).toString(32),r>>=i,s-=i,Ur=1<<32-er(e)+s|n<<s|r,Br=a+t}else Ur=1<<a|n<<s|r,Br=t}function Ep(t){t.return!==null&&(Vs(t,1),Ax(t,1,0))}function Np(t){for(;t===ru;)ru=Ua[--Ba],Ua[Ba]=null,su=Ua[--Ba],Ua[Ba]=null;for(;t===fa;)fa=Rn[--On],Rn[On]=null,Br=Rn[--On],Rn[On]=null,Ur=Rn[--On],Rn[On]=null}var wn=null,vn=null,et=!1,Qn=null;function Cx(t,e){var n=Pn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function g0(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,wn=t,vn=Ts(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,wn=t,vn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=fa!==null?{id:Ur,overflow:Br}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Pn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,wn=t,vn=null,!0):!1;default:return!1}}function Bf(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Gf(t){if(et){var e=vn;if(e){var n=e;if(!g0(t,e)){if(Bf(t))throw Error(B(418));e=Ts(n.nextSibling);var r=wn;e&&g0(t,e)?Cx(r,n):(t.flags=t.flags&-4097|2,et=!1,wn=t)}}else{if(Bf(t))throw Error(B(418));t.flags=t.flags&-4097|2,et=!1,wn=t}}}function y0(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;wn=t}function Hl(t){if(t!==wn)return!1;if(!et)return y0(t),et=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Mf(t.type,t.memoizedProps)),e&&(e=vn)){if(Bf(t))throw Ix(),Error(B(418));for(;e;)Cx(t,e),e=Ts(e.nextSibling)}if(y0(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(B(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){vn=Ts(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}vn=null}}else vn=wn?Ts(t.stateNode.nextSibling):null;return!0}function Ix(){for(var t=vn;t;)t=Ts(t.nextSibling)}function si(){vn=wn=null,et=!1}function Tp(t){Qn===null?Qn=[t]:Qn.push(t)}var tA=ns.ReactCurrentBatchConfig;function zi(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(B(309));var r=n.stateNode}if(!r)throw Error(B(147,t));var s=r,a=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===a?e.ref:(e=function(i){var o=s.refs;i===null?delete o[a]:o[a]=i},e._stringRef=a,e)}if(typeof t!="string")throw Error(B(284));if(!n._owner)throw Error(B(290,t))}return t}function Wl(t,e){throw t=Object.prototype.toString.call(e),Error(B(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function v0(t){var e=t._init;return e(t._payload)}function jx(t){function e(y,p){if(t){var g=y.deletions;g===null?(y.deletions=[p],y.flags|=16):g.push(p)}}function n(y,p){if(!t)return null;for(;p!==null;)e(y,p),p=p.sibling;return null}function r(y,p){for(y=new Map;p!==null;)p.key!==null?y.set(p.key,p):y.set(p.index,p),p=p.sibling;return y}function s(y,p){return y=js(y,p),y.index=0,y.sibling=null,y}function a(y,p,g){return y.index=g,t?(g=y.alternate,g!==null?(g=g.index,g<p?(y.flags|=2,p):g):(y.flags|=2,p)):(y.flags|=1048576,p)}function i(y){return t&&y.alternate===null&&(y.flags|=2),y}function o(y,p,g,S){return p===null||p.tag!==6?(p=Eh(g,y.mode,S),p.return=y,p):(p=s(p,g),p.return=y,p)}function l(y,p,g,S){var N=g.type;return N===$a?d(y,p,g.props.children,S,g.key):p!==null&&(p.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===hs&&v0(N)===p.type)?(S=s(p,g.props),S.ref=zi(y,p,g),S.return=y,S):(S=Rc(g.type,g.key,g.props,null,y.mode,S),S.ref=zi(y,p,g),S.return=y,S)}function u(y,p,g,S){return p===null||p.tag!==4||p.stateNode.containerInfo!==g.containerInfo||p.stateNode.implementation!==g.implementation?(p=Nh(g,y.mode,S),p.return=y,p):(p=s(p,g.children||[]),p.return=y,p)}function d(y,p,g,S,N){return p===null||p.tag!==7?(p=oa(g,y.mode,S,N),p.return=y,p):(p=s(p,g),p.return=y,p)}function h(y,p,g){if(typeof p=="string"&&p!==""||typeof p=="number")return p=Eh(""+p,y.mode,g),p.return=y,p;if(typeof p=="object"&&p!==null){switch(p.$$typeof){case Pl:return g=Rc(p.type,p.key,p.props,null,y.mode,g),g.ref=zi(y,null,p),g.return=y,g;case Pa:return p=Nh(p,y.mode,g),p.return=y,p;case hs:var S=p._init;return h(y,S(p._payload),g)}if(qi(p)||$i(p))return p=oa(p,y.mode,g,null),p.return=y,p;Wl(y,p)}return null}function f(y,p,g,S){var N=p!==null?p.key:null;if(typeof g=="string"&&g!==""||typeof g=="number")return N!==null?null:o(y,p,""+g,S);if(typeof g=="object"&&g!==null){switch(g.$$typeof){case Pl:return g.key===N?l(y,p,g,S):null;case Pa:return g.key===N?u(y,p,g,S):null;case hs:return N=g._init,f(y,p,N(g._payload),S)}if(qi(g)||$i(g))return N!==null?null:d(y,p,g,S,null);Wl(y,g)}return null}function m(y,p,g,S,N){if(typeof S=="string"&&S!==""||typeof S=="number")return y=y.get(g)||null,o(p,y,""+S,N);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Pl:return y=y.get(S.key===null?g:S.key)||null,l(p,y,S,N);case Pa:return y=y.get(S.key===null?g:S.key)||null,u(p,y,S,N);case hs:var T=S._init;return m(y,p,g,T(S._payload),N)}if(qi(S)||$i(S))return y=y.get(g)||null,d(p,y,S,N,null);Wl(p,S)}return null}function v(y,p,g,S){for(var N=null,T=null,A=p,x=p=0,j=null;A!==null&&x<g.length;x++){A.index>x?(j=A,A=null):j=A.sibling;var R=f(y,A,g[x],S);if(R===null){A===null&&(A=j);break}t&&A&&R.alternate===null&&e(y,A),p=a(R,p,x),T===null?N=R:T.sibling=R,T=R,A=j}if(x===g.length)return n(y,A),et&&Vs(y,x),N;if(A===null){for(;x<g.length;x++)A=h(y,g[x],S),A!==null&&(p=a(A,p,x),T===null?N=A:T.sibling=A,T=A);return et&&Vs(y,x),N}for(A=r(y,A);x<g.length;x++)j=m(A,y,x,g[x],S),j!==null&&(t&&j.alternate!==null&&A.delete(j.key===null?x:j.key),p=a(j,p,x),T===null?N=j:T.sibling=j,T=j);return t&&A.forEach(function(D){return e(y,D)}),et&&Vs(y,x),N}function w(y,p,g,S){var N=$i(g);if(typeof N!="function")throw Error(B(150));if(g=N.call(g),g==null)throw Error(B(151));for(var T=N=null,A=p,x=p=0,j=null,R=g.next();A!==null&&!R.done;x++,R=g.next()){A.index>x?(j=A,A=null):j=A.sibling;var D=f(y,A,R.value,S);if(D===null){A===null&&(A=j);break}t&&A&&D.alternate===null&&e(y,A),p=a(D,p,x),T===null?N=D:T.sibling=D,T=D,A=j}if(R.done)return n(y,A),et&&Vs(y,x),N;if(A===null){for(;!R.done;x++,R=g.next())R=h(y,R.value,S),R!==null&&(p=a(R,p,x),T===null?N=R:T.sibling=R,T=R);return et&&Vs(y,x),N}for(A=r(y,A);!R.done;x++,R=g.next())R=m(A,y,x,R.value,S),R!==null&&(t&&R.alternate!==null&&A.delete(R.key===null?x:R.key),p=a(R,p,x),T===null?N=R:T.sibling=R,T=R);return t&&A.forEach(function(ye){return e(y,ye)}),et&&Vs(y,x),N}function _(y,p,g,S){if(typeof g=="object"&&g!==null&&g.type===$a&&g.key===null&&(g=g.props.children),typeof g=="object"&&g!==null){switch(g.$$typeof){case Pl:e:{for(var N=g.key,T=p;T!==null;){if(T.key===N){if(N=g.type,N===$a){if(T.tag===7){n(y,T.sibling),p=s(T,g.props.children),p.return=y,y=p;break e}}else if(T.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===hs&&v0(N)===T.type){n(y,T.sibling),p=s(T,g.props),p.ref=zi(y,T,g),p.return=y,y=p;break e}n(y,T);break}else e(y,T);T=T.sibling}g.type===$a?(p=oa(g.props.children,y.mode,S,g.key),p.return=y,y=p):(S=Rc(g.type,g.key,g.props,null,y.mode,S),S.ref=zi(y,p,g),S.return=y,y=S)}return i(y);case Pa:e:{for(T=g.key;p!==null;){if(p.key===T)if(p.tag===4&&p.stateNode.containerInfo===g.containerInfo&&p.stateNode.implementation===g.implementation){n(y,p.sibling),p=s(p,g.children||[]),p.return=y,y=p;break e}else{n(y,p);break}else e(y,p);p=p.sibling}p=Nh(g,y.mode,S),p.return=y,y=p}return i(y);case hs:return T=g._init,_(y,p,T(g._payload),S)}if(qi(g))return v(y,p,g,S);if($i(g))return w(y,p,g,S);Wl(y,g)}return typeof g=="string"&&g!==""||typeof g=="number"?(g=""+g,p!==null&&p.tag===6?(n(y,p.sibling),p=s(p,g),p.return=y,y=p):(n(y,p),p=Eh(g,y.mode,S),p.return=y,y=p),i(y)):n(y,p)}return _}var ai=jx(!0),Rx=jx(!1),au=Us(null),iu=null,Ga=null,Ap=null;function Cp(){Ap=Ga=iu=null}function Ip(t){var e=au.current;Ye(au),t._currentValue=e}function Hf(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function ei(t,e){iu=t,Ap=Ga=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(an=!0),t.firstContext=null)}function Dn(t){var e=t._currentValue;if(Ap!==t)if(t={context:t,memoizedValue:e,next:null},Ga===null){if(iu===null)throw Error(B(308));Ga=t,iu.dependencies={lanes:0,firstContext:t}}else Ga=Ga.next=t;return e}var ta=null;function jp(t){ta===null?ta=[t]:ta.push(t)}function Ox(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,jp(e)):(n.next=s.next,s.next=n),e.interleaved=n,Zr(t,r)}function Zr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var fs=!1;function Rp(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Px(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Gr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function As(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Re&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Zr(t,n)}return s=r.interleaved,s===null?(e.next=e,jp(r)):(e.next=s.next,s.next=e),r.interleaved=e,Zr(t,n)}function Nc(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,yp(t,n)}}function _0(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,a=null;if(n=n.firstBaseUpdate,n!==null){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};a===null?s=a=i:a=a.next=i,n=n.next}while(n!==null);a===null?s=a=e:a=a.next=e}else s=a=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:a,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function ou(t,e,n,r){var s=t.updateQueue;fs=!1;var a=s.firstBaseUpdate,i=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var l=o,u=l.next;l.next=null,i===null?a=u:i.next=u,i=l;var d=t.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==i&&(o===null?d.firstBaseUpdate=u:o.next=u,d.lastBaseUpdate=l))}if(a!==null){var h=s.baseState;i=0,d=u=l=null,o=a;do{var f=o.lane,m=o.eventTime;if((r&f)===f){d!==null&&(d=d.next={eventTime:m,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var v=t,w=o;switch(f=e,m=n,w.tag){case 1:if(v=w.payload,typeof v=="function"){h=v.call(m,h,f);break e}h=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=w.payload,f=typeof v=="function"?v.call(m,h,f):v,f==null)break e;h=st({},h,f);break e;case 2:fs=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,f=s.effects,f===null?s.effects=[o]:f.push(o))}else m={eventTime:m,lane:f,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(u=d=m,l=h):d=d.next=m,i|=f;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;f=o,o=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(!0);if(d===null&&(l=h),s.baseState=l,s.firstBaseUpdate=u,s.lastBaseUpdate=d,e=s.shared.interleaved,e!==null){s=e;do i|=s.lane,s=s.next;while(s!==e)}else a===null&&(s.shared.lanes=0);pa|=i,t.lanes=i,t.memoizedState=h}}function w0(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(B(191,s));s.call(r)}}}var ml={},kr=Us(ml),Wo=Us(ml),Vo=Us(ml);function na(t){if(t===ml)throw Error(B(174));return t}function Op(t,e){switch(qe(Vo,e),qe(Wo,t),qe(kr,ml),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:kf(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=kf(e,t)}Ye(kr),qe(kr,e)}function ii(){Ye(kr),Ye(Wo),Ye(Vo)}function $x(t){na(Vo.current);var e=na(kr.current),n=kf(e,t.type);e!==n&&(qe(Wo,t),qe(kr,n))}function Pp(t){Wo.current===t&&(Ye(kr),Ye(Wo))}var nt=Us(0);function lu(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var _h=[];function $p(){for(var t=0;t<_h.length;t++)_h[t]._workInProgressVersionPrimary=null;_h.length=0}var Tc=ns.ReactCurrentDispatcher,wh=ns.ReactCurrentBatchConfig,ma=0,rt=null,_t=null,Et=null,cu=!1,vo=!1,qo=0,nA=0;function Lt(){throw Error(B(321))}function Lp(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!nr(t[n],e[n]))return!1;return!0}function Dp(t,e,n,r,s,a){if(ma=a,rt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Tc.current=t===null||t.memoizedState===null?iA:oA,t=n(r,s),vo){a=0;do{if(vo=!1,qo=0,25<=a)throw Error(B(301));a+=1,Et=_t=null,e.updateQueue=null,Tc.current=lA,t=n(r,s)}while(vo)}if(Tc.current=uu,e=_t!==null&&_t.next!==null,ma=0,Et=_t=rt=null,cu=!1,e)throw Error(B(300));return t}function Mp(){var t=qo!==0;return qo=0,t}function pr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Et===null?rt.memoizedState=Et=t:Et=Et.next=t,Et}function Mn(){if(_t===null){var t=rt.alternate;t=t!==null?t.memoizedState:null}else t=_t.next;var e=Et===null?rt.memoizedState:Et.next;if(e!==null)Et=e,_t=t;else{if(t===null)throw Error(B(310));_t=t,t={memoizedState:_t.memoizedState,baseState:_t.baseState,baseQueue:_t.baseQueue,queue:_t.queue,next:null},Et===null?rt.memoizedState=Et=t:Et=Et.next=t}return Et}function Zo(t,e){return typeof e=="function"?e(t):e}function xh(t){var e=Mn(),n=e.queue;if(n===null)throw Error(B(311));n.lastRenderedReducer=t;var r=_t,s=r.baseQueue,a=n.pending;if(a!==null){if(s!==null){var i=s.next;s.next=a.next,a.next=i}r.baseQueue=s=a,n.pending=null}if(s!==null){a=s.next,r=r.baseState;var o=i=null,l=null,u=a;do{var d=u.lane;if((ma&d)===d)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(o=l=h,i=r):l=l.next=h,rt.lanes|=d,pa|=d}u=u.next}while(u!==null&&u!==a);l===null?i=r:l.next=o,nr(r,e.memoizedState)||(an=!0),e.memoizedState=r,e.baseState=i,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do a=s.lane,rt.lanes|=a,pa|=a,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function bh(t){var e=Mn(),n=e.queue;if(n===null)throw Error(B(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,a=e.memoizedState;if(s!==null){n.pending=null;var i=s=s.next;do a=t(a,i.action),i=i.next;while(i!==s);nr(a,e.memoizedState)||(an=!0),e.memoizedState=a,e.baseQueue===null&&(e.baseState=a),n.lastRenderedState=a}return[a,r]}function Lx(){}function Dx(t,e){var n=rt,r=Mn(),s=e(),a=!nr(r.memoizedState,s);if(a&&(r.memoizedState=s,an=!0),r=r.queue,Fp(zx.bind(null,n,r,t),[t]),r.getSnapshot!==e||a||Et!==null&&Et.memoizedState.tag&1){if(n.flags|=2048,Ko(9,Fx.bind(null,n,r,s,e),void 0,null),Tt===null)throw Error(B(349));ma&30||Mx(n,e,s)}return s}function Mx(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=rt.updateQueue,e===null?(e={lastEffect:null,stores:null},rt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Fx(t,e,n,r){e.value=n,e.getSnapshot=r,Ux(e)&&Bx(t)}function zx(t,e,n){return n(function(){Ux(e)&&Bx(t)})}function Ux(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!nr(t,n)}catch{return!0}}function Bx(t){var e=Zr(t,1);e!==null&&tr(e,t,1,-1)}function x0(t){var e=pr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Zo,lastRenderedState:t},e.queue=t,t=t.dispatch=aA.bind(null,rt,t),[e.memoizedState,t]}function Ko(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=rt.updateQueue,e===null?(e={lastEffect:null,stores:null},rt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Gx(){return Mn().memoizedState}function Ac(t,e,n,r){var s=pr();rt.flags|=t,s.memoizedState=Ko(1|e,n,void 0,r===void 0?null:r)}function nd(t,e,n,r){var s=Mn();r=r===void 0?null:r;var a=void 0;if(_t!==null){var i=_t.memoizedState;if(a=i.destroy,r!==null&&Lp(r,i.deps)){s.memoizedState=Ko(e,n,a,r);return}}rt.flags|=t,s.memoizedState=Ko(1|e,n,a,r)}function b0(t,e){return Ac(8390656,8,t,e)}function Fp(t,e){return nd(2048,8,t,e)}function Hx(t,e){return nd(4,2,t,e)}function Wx(t,e){return nd(4,4,t,e)}function Vx(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function qx(t,e,n){return n=n!=null?n.concat([t]):null,nd(4,4,Vx.bind(null,e,t),n)}function zp(){}function Zx(t,e){var n=Mn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Lp(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Kx(t,e){var n=Mn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Lp(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Jx(t,e,n){return ma&21?(nr(n,e)||(n=tx(),rt.lanes|=n,pa|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,an=!0),t.memoizedState=n)}function rA(t,e){var n=Ge;Ge=n!==0&&4>n?n:4,t(!0);var r=wh.transition;wh.transition={};try{t(!1),e()}finally{Ge=n,wh.transition=r}}function Yx(){return Mn().memoizedState}function sA(t,e,n){var r=Is(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Qx(t))Xx(e,n);else if(n=Ox(t,e,n,r),n!==null){var s=Zt();tr(n,t,r,s),eb(n,e,r)}}function aA(t,e,n){var r=Is(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Qx(t))Xx(e,s);else{var a=t.alternate;if(t.lanes===0&&(a===null||a.lanes===0)&&(a=e.lastRenderedReducer,a!==null))try{var i=e.lastRenderedState,o=a(i,n);if(s.hasEagerState=!0,s.eagerState=o,nr(o,i)){var l=e.interleaved;l===null?(s.next=s,jp(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}n=Ox(t,e,s,r),n!==null&&(s=Zt(),tr(n,t,r,s),eb(n,e,r))}}function Qx(t){var e=t.alternate;return t===rt||e!==null&&e===rt}function Xx(t,e){vo=cu=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function eb(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,yp(t,n)}}var uu={readContext:Dn,useCallback:Lt,useContext:Lt,useEffect:Lt,useImperativeHandle:Lt,useInsertionEffect:Lt,useLayoutEffect:Lt,useMemo:Lt,useReducer:Lt,useRef:Lt,useState:Lt,useDebugValue:Lt,useDeferredValue:Lt,useTransition:Lt,useMutableSource:Lt,useSyncExternalStore:Lt,useId:Lt,unstable_isNewReconciler:!1},iA={readContext:Dn,useCallback:function(t,e){return pr().memoizedState=[t,e===void 0?null:e],t},useContext:Dn,useEffect:b0,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Ac(4194308,4,Vx.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Ac(4194308,4,t,e)},useInsertionEffect:function(t,e){return Ac(4,2,t,e)},useMemo:function(t,e){var n=pr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=pr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=sA.bind(null,rt,t),[r.memoizedState,t]},useRef:function(t){var e=pr();return t={current:t},e.memoizedState=t},useState:x0,useDebugValue:zp,useDeferredValue:function(t){return pr().memoizedState=t},useTransition:function(){var t=x0(!1),e=t[0];return t=rA.bind(null,t[1]),pr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=rt,s=pr();if(et){if(n===void 0)throw Error(B(407));n=n()}else{if(n=e(),Tt===null)throw Error(B(349));ma&30||Mx(r,e,n)}s.memoizedState=n;var a={value:n,getSnapshot:e};return s.queue=a,b0(zx.bind(null,r,a,t),[t]),r.flags|=2048,Ko(9,Fx.bind(null,r,a,n,e),void 0,null),n},useId:function(){var t=pr(),e=Tt.identifierPrefix;if(et){var n=Br,r=Ur;n=(r&~(1<<32-er(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=qo++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=nA++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},oA={readContext:Dn,useCallback:Zx,useContext:Dn,useEffect:Fp,useImperativeHandle:qx,useInsertionEffect:Hx,useLayoutEffect:Wx,useMemo:Kx,useReducer:xh,useRef:Gx,useState:function(){return xh(Zo)},useDebugValue:zp,useDeferredValue:function(t){var e=Mn();return Jx(e,_t.memoizedState,t)},useTransition:function(){var t=xh(Zo)[0],e=Mn().memoizedState;return[t,e]},useMutableSource:Lx,useSyncExternalStore:Dx,useId:Yx,unstable_isNewReconciler:!1},lA={readContext:Dn,useCallback:Zx,useContext:Dn,useEffect:Fp,useImperativeHandle:qx,useInsertionEffect:Hx,useLayoutEffect:Wx,useMemo:Kx,useReducer:bh,useRef:Gx,useState:function(){return bh(Zo)},useDebugValue:zp,useDeferredValue:function(t){var e=Mn();return _t===null?e.memoizedState=t:Jx(e,_t.memoizedState,t)},useTransition:function(){var t=bh(Zo)[0],e=Mn().memoizedState;return[t,e]},useMutableSource:Lx,useSyncExternalStore:Dx,useId:Yx,unstable_isNewReconciler:!1};function Zn(t,e){if(t&&t.defaultProps){e=st({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Wf(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:st({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var rd={isMounted:function(t){return(t=t._reactInternals)?wa(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Zt(),s=Is(t),a=Gr(r,s);a.payload=e,n!=null&&(a.callback=n),e=As(t,a,s),e!==null&&(tr(e,t,s,r),Nc(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Zt(),s=Is(t),a=Gr(r,s);a.tag=1,a.payload=e,n!=null&&(a.callback=n),e=As(t,a,s),e!==null&&(tr(e,t,s,r),Nc(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Zt(),r=Is(t),s=Gr(n,r);s.tag=2,e!=null&&(s.callback=e),e=As(t,s,r),e!==null&&(tr(e,t,r,n),Nc(e,t,r))}};function S0(t,e,n,r,s,a,i){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,a,i):e.prototype&&e.prototype.isPureReactComponent?!Uo(n,r)||!Uo(s,a):!0}function tb(t,e,n){var r=!1,s=$s,a=e.contextType;return typeof a=="object"&&a!==null?a=Dn(a):(s=cn(e)?ha:zt.current,r=e.contextTypes,a=(r=r!=null)?ri(t,s):$s),e=new e(n,a),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=rd,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=a),e}function k0(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&rd.enqueueReplaceState(e,e.state,null)}function Vf(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},Rp(t);var a=e.contextType;typeof a=="object"&&a!==null?s.context=Dn(a):(a=cn(e)?ha:zt.current,s.context=ri(t,a)),s.state=t.memoizedState,a=e.getDerivedStateFromProps,typeof a=="function"&&(Wf(t,e,a,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&rd.enqueueReplaceState(s,s.state,null),ou(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function oi(t,e){try{var n="",r=e;do n+=LN(r),r=r.return;while(r);var s=n}catch(a){s=`
Error generating stack: `+a.message+`
`+a.stack}return{value:t,source:e,stack:s,digest:null}}function Sh(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function qf(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var cA=typeof WeakMap=="function"?WeakMap:Map;function nb(t,e,n){n=Gr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){hu||(hu=!0,rm=r),qf(t,e)},n}function rb(t,e,n){n=Gr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){qf(t,e)}}var a=t.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(n.callback=function(){qf(t,e),typeof r!="function"&&(Cs===null?Cs=new Set([this]):Cs.add(this));var i=e.stack;this.componentDidCatch(e.value,{componentStack:i!==null?i:""})}),n}function E0(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new cA;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=SA.bind(null,t,e,n),e.then(t,t))}function N0(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function T0(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Gr(-1,1),e.tag=2,As(n,e,1))),n.lanes|=1),t)}var uA=ns.ReactCurrentOwner,an=!1;function qt(t,e,n,r){e.child=t===null?Rx(e,null,n,r):ai(e,t.child,n,r)}function A0(t,e,n,r,s){n=n.render;var a=e.ref;return ei(e,s),r=Dp(t,e,n,r,a,s),n=Mp(),t!==null&&!an?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Kr(t,e,s)):(et&&n&&Ep(e),e.flags|=1,qt(t,e,r,s),e.child)}function C0(t,e,n,r,s){if(t===null){var a=n.type;return typeof a=="function"&&!Zp(a)&&a.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=a,sb(t,e,a,r,s)):(t=Rc(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(a=t.child,!(t.lanes&s)){var i=a.memoizedProps;if(n=n.compare,n=n!==null?n:Uo,n(i,r)&&t.ref===e.ref)return Kr(t,e,s)}return e.flags|=1,t=js(a,r),t.ref=e.ref,t.return=e,e.child=t}function sb(t,e,n,r,s){if(t!==null){var a=t.memoizedProps;if(Uo(a,r)&&t.ref===e.ref)if(an=!1,e.pendingProps=r=a,(t.lanes&s)!==0)t.flags&131072&&(an=!0);else return e.lanes=t.lanes,Kr(t,e,s)}return Zf(t,e,n,r,s)}function ab(t,e,n){var r=e.pendingProps,s=r.children,a=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},qe(Wa,yn),yn|=n;else{if(!(n&1073741824))return t=a!==null?a.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,qe(Wa,yn),yn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=a!==null?a.baseLanes:n,qe(Wa,yn),yn|=r}else a!==null?(r=a.baseLanes|n,e.memoizedState=null):r=n,qe(Wa,yn),yn|=r;return qt(t,e,s,n),e.child}function ib(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Zf(t,e,n,r,s){var a=cn(n)?ha:zt.current;return a=ri(e,a),ei(e,s),n=Dp(t,e,n,r,a,s),r=Mp(),t!==null&&!an?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Kr(t,e,s)):(et&&r&&Ep(e),e.flags|=1,qt(t,e,n,s),e.child)}function I0(t,e,n,r,s){if(cn(n)){var a=!0;nu(e)}else a=!1;if(ei(e,s),e.stateNode===null)Cc(t,e),tb(e,n,r),Vf(e,n,r,s),r=!0;else if(t===null){var i=e.stateNode,o=e.memoizedProps;i.props=o;var l=i.context,u=n.contextType;typeof u=="object"&&u!==null?u=Dn(u):(u=cn(n)?ha:zt.current,u=ri(e,u));var d=n.getDerivedStateFromProps,h=typeof d=="function"||typeof i.getSnapshotBeforeUpdate=="function";h||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==r||l!==u)&&k0(e,i,r,u),fs=!1;var f=e.memoizedState;i.state=f,ou(e,r,i,s),l=e.memoizedState,o!==r||f!==l||ln.current||fs?(typeof d=="function"&&(Wf(e,n,d,r),l=e.memoizedState),(o=fs||S0(e,n,o,r,f,l,u))?(h||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(e.flags|=4194308)):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),i.props=r,i.state=l,i.context=u,r=o):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{i=e.stateNode,Px(t,e),o=e.memoizedProps,u=e.type===e.elementType?o:Zn(e.type,o),i.props=u,h=e.pendingProps,f=i.context,l=n.contextType,typeof l=="object"&&l!==null?l=Dn(l):(l=cn(n)?ha:zt.current,l=ri(e,l));var m=n.getDerivedStateFromProps;(d=typeof m=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==h||f!==l)&&k0(e,i,r,l),fs=!1,f=e.memoizedState,i.state=f,ou(e,r,i,s);var v=e.memoizedState;o!==h||f!==v||ln.current||fs?(typeof m=="function"&&(Wf(e,n,m,r),v=e.memoizedState),(u=fs||S0(e,n,u,r,f,v,l)||!1)?(d||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(r,v,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(r,v,l)),typeof i.componentDidUpdate=="function"&&(e.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=v),i.props=r,i.state=v,i.context=l,r=u):(typeof i.componentDidUpdate!="function"||o===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return Kf(t,e,n,r,a,s)}function Kf(t,e,n,r,s,a){ib(t,e);var i=(e.flags&128)!==0;if(!r&&!i)return s&&p0(e,n,!1),Kr(t,e,a);r=e.stateNode,uA.current=e;var o=i&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&i?(e.child=ai(e,t.child,null,a),e.child=ai(e,null,o,a)):qt(t,e,o,a),e.memoizedState=r.state,s&&p0(e,n,!0),e.child}function ob(t){var e=t.stateNode;e.pendingContext?m0(t,e.pendingContext,e.pendingContext!==e.context):e.context&&m0(t,e.context,!1),Op(t,e.containerInfo)}function j0(t,e,n,r,s){return si(),Tp(s),e.flags|=256,qt(t,e,n,r),e.child}var Jf={dehydrated:null,treeContext:null,retryLane:0};function Yf(t){return{baseLanes:t,cachePool:null,transitions:null}}function lb(t,e,n){var r=e.pendingProps,s=nt.current,a=!1,i=(e.flags&128)!==0,o;if((o=i)||(o=t!==null&&t.memoizedState===null?!1:(s&2)!==0),o?(a=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),qe(nt,s&1),t===null)return Gf(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(i=r.children,t=r.fallback,a?(r=e.mode,a=e.child,i={mode:"hidden",children:i},!(r&1)&&a!==null?(a.childLanes=0,a.pendingProps=i):a=id(i,r,0,null),t=oa(t,r,n,null),a.return=e,t.return=e,a.sibling=t,e.child=a,e.child.memoizedState=Yf(n),e.memoizedState=Jf,t):Up(e,i));if(s=t.memoizedState,s!==null&&(o=s.dehydrated,o!==null))return dA(t,e,i,r,o,s,n);if(a){a=r.fallback,i=e.mode,s=t.child,o=s.sibling;var l={mode:"hidden",children:r.children};return!(i&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=js(s,l),r.subtreeFlags=s.subtreeFlags&14680064),o!==null?a=js(o,a):(a=oa(a,i,n,null),a.flags|=2),a.return=e,r.return=e,r.sibling=a,e.child=r,r=a,a=e.child,i=t.child.memoizedState,i=i===null?Yf(n):{baseLanes:i.baseLanes|n,cachePool:null,transitions:i.transitions},a.memoizedState=i,a.childLanes=t.childLanes&~n,e.memoizedState=Jf,r}return a=t.child,t=a.sibling,r=js(a,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Up(t,e){return e=id({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Vl(t,e,n,r){return r!==null&&Tp(r),ai(e,t.child,null,n),t=Up(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function dA(t,e,n,r,s,a,i){if(n)return e.flags&256?(e.flags&=-257,r=Sh(Error(B(422))),Vl(t,e,i,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(a=r.fallback,s=e.mode,r=id({mode:"visible",children:r.children},s,0,null),a=oa(a,s,i,null),a.flags|=2,r.return=e,a.return=e,r.sibling=a,e.child=r,e.mode&1&&ai(e,t.child,null,i),e.child.memoizedState=Yf(i),e.memoizedState=Jf,a);if(!(e.mode&1))return Vl(t,e,i,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var o=r.dgst;return r=o,a=Error(B(419)),r=Sh(a,r,void 0),Vl(t,e,i,r)}if(o=(i&t.childLanes)!==0,an||o){if(r=Tt,r!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|i)?0:s,s!==0&&s!==a.retryLane&&(a.retryLane=s,Zr(t,s),tr(r,t,s,-1))}return qp(),r=Sh(Error(B(421))),Vl(t,e,i,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=kA.bind(null,t),s._reactRetry=e,null):(t=a.treeContext,vn=Ts(s.nextSibling),wn=e,et=!0,Qn=null,t!==null&&(Rn[On++]=Ur,Rn[On++]=Br,Rn[On++]=fa,Ur=t.id,Br=t.overflow,fa=e),e=Up(e,r.children),e.flags|=4096,e)}function R0(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Hf(t.return,e,n)}function kh(t,e,n,r,s){var a=t.memoizedState;a===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=s)}function cb(t,e,n){var r=e.pendingProps,s=r.revealOrder,a=r.tail;if(qt(t,e,r.children,n),r=nt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&R0(t,n,e);else if(t.tag===19)R0(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(qe(nt,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&lu(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),kh(e,!1,s,n,a);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&lu(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}kh(e,!0,n,null,a);break;case"together":kh(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Cc(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Kr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),pa|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(B(153));if(e.child!==null){for(t=e.child,n=js(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=js(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function hA(t,e,n){switch(e.tag){case 3:ob(e),si();break;case 5:$x(e);break;case 1:cn(e.type)&&nu(e);break;case 4:Op(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;qe(au,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(qe(nt,nt.current&1),e.flags|=128,null):n&e.child.childLanes?lb(t,e,n):(qe(nt,nt.current&1),t=Kr(t,e,n),t!==null?t.sibling:null);qe(nt,nt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return cb(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),qe(nt,nt.current),r)break;return null;case 22:case 23:return e.lanes=0,ab(t,e,n)}return Kr(t,e,n)}var ub,Qf,db,hb;ub=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Qf=function(){};db=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,na(kr.current);var a=null;switch(n){case"input":s=wf(t,s),r=wf(t,r),a=[];break;case"select":s=st({},s,{value:void 0}),r=st({},r,{value:void 0}),a=[];break;case"textarea":s=Sf(t,s),r=Sf(t,r),a=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=eu)}Ef(n,r);var i;n=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var o=s[u];for(i in o)o.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Po.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in r){var l=r[u];if(o=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&l!==o&&(l!=null||o!=null))if(u==="style")if(o){for(i in o)!o.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in l)l.hasOwnProperty(i)&&o[i]!==l[i]&&(n||(n={}),n[i]=l[i])}else n||(a||(a=[]),a.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(a=a||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(a=a||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Po.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Ke("scroll",t),a||o===l||(a=[])):(a=a||[]).push(u,l))}n&&(a=a||[]).push("style",n);var u=a;(e.updateQueue=u)&&(e.flags|=4)}};hb=function(t,e,n,r){n!==r&&(e.flags|=4)};function Ui(t,e){if(!et)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Dt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function fA(t,e,n){var r=e.pendingProps;switch(Np(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Dt(e),null;case 1:return cn(e.type)&&tu(),Dt(e),null;case 3:return r=e.stateNode,ii(),Ye(ln),Ye(zt),$p(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Hl(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Qn!==null&&(im(Qn),Qn=null))),Qf(t,e),Dt(e),null;case 5:Pp(e);var s=na(Vo.current);if(n=e.type,t!==null&&e.stateNode!=null)db(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(B(166));return Dt(e),null}if(t=na(kr.current),Hl(e)){r=e.stateNode,n=e.type;var a=e.memoizedProps;switch(r[yr]=e,r[Ho]=a,t=(e.mode&1)!==0,n){case"dialog":Ke("cancel",r),Ke("close",r);break;case"iframe":case"object":case"embed":Ke("load",r);break;case"video":case"audio":for(s=0;s<Ki.length;s++)Ke(Ki[s],r);break;case"source":Ke("error",r);break;case"img":case"image":case"link":Ke("error",r),Ke("load",r);break;case"details":Ke("toggle",r);break;case"input":Uy(r,a),Ke("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},Ke("invalid",r);break;case"textarea":Gy(r,a),Ke("invalid",r)}Ef(n,a),s=null;for(var i in a)if(a.hasOwnProperty(i)){var o=a[i];i==="children"?typeof o=="string"?r.textContent!==o&&(a.suppressHydrationWarning!==!0&&Gl(r.textContent,o,t),s=["children",o]):typeof o=="number"&&r.textContent!==""+o&&(a.suppressHydrationWarning!==!0&&Gl(r.textContent,o,t),s=["children",""+o]):Po.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&Ke("scroll",r)}switch(n){case"input":$l(r),By(r,a,!0);break;case"textarea":$l(r),Hy(r);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(r.onclick=eu)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=zw(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=i.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=i.createElement(n,{is:r.is}):(t=i.createElement(n),n==="select"&&(i=t,r.multiple?i.multiple=!0:r.size&&(i.size=r.size))):t=i.createElementNS(t,n),t[yr]=e,t[Ho]=r,ub(t,e,!1,!1),e.stateNode=t;e:{switch(i=Nf(n,r),n){case"dialog":Ke("cancel",t),Ke("close",t),s=r;break;case"iframe":case"object":case"embed":Ke("load",t),s=r;break;case"video":case"audio":for(s=0;s<Ki.length;s++)Ke(Ki[s],t);s=r;break;case"source":Ke("error",t),s=r;break;case"img":case"image":case"link":Ke("error",t),Ke("load",t),s=r;break;case"details":Ke("toggle",t),s=r;break;case"input":Uy(t,r),s=wf(t,r),Ke("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=st({},r,{value:void 0}),Ke("invalid",t);break;case"textarea":Gy(t,r),s=Sf(t,r),Ke("invalid",t);break;default:s=r}Ef(n,s),o=s;for(a in o)if(o.hasOwnProperty(a)){var l=o[a];a==="style"?Gw(t,l):a==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Uw(t,l)):a==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&$o(t,l):typeof l=="number"&&$o(t,""+l):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Po.hasOwnProperty(a)?l!=null&&a==="onScroll"&&Ke("scroll",t):l!=null&&dp(t,a,l,i))}switch(n){case"input":$l(t),By(t,r,!1);break;case"textarea":$l(t),Hy(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Ps(r.value));break;case"select":t.multiple=!!r.multiple,a=r.value,a!=null?Ja(t,!!r.multiple,a,!1):r.defaultValue!=null&&Ja(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=eu)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Dt(e),null;case 6:if(t&&e.stateNode!=null)hb(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(B(166));if(n=na(Vo.current),na(kr.current),Hl(e)){if(r=e.stateNode,n=e.memoizedProps,r[yr]=e,(a=r.nodeValue!==n)&&(t=wn,t!==null))switch(t.tag){case 3:Gl(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Gl(r.nodeValue,n,(t.mode&1)!==0)}a&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[yr]=e,e.stateNode=r}return Dt(e),null;case 13:if(Ye(nt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(et&&vn!==null&&e.mode&1&&!(e.flags&128))Ix(),si(),e.flags|=98560,a=!1;else if(a=Hl(e),r!==null&&r.dehydrated!==null){if(t===null){if(!a)throw Error(B(318));if(a=e.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(B(317));a[yr]=e}else si(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Dt(e),a=!1}else Qn!==null&&(im(Qn),Qn=null),a=!0;if(!a)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||nt.current&1?bt===0&&(bt=3):qp())),e.updateQueue!==null&&(e.flags|=4),Dt(e),null);case 4:return ii(),Qf(t,e),t===null&&Bo(e.stateNode.containerInfo),Dt(e),null;case 10:return Ip(e.type._context),Dt(e),null;case 17:return cn(e.type)&&tu(),Dt(e),null;case 19:if(Ye(nt),a=e.memoizedState,a===null)return Dt(e),null;if(r=(e.flags&128)!==0,i=a.rendering,i===null)if(r)Ui(a,!1);else{if(bt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(i=lu(t),i!==null){for(e.flags|=128,Ui(a,!1),r=i.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)a=n,t=r,a.flags&=14680066,i=a.alternate,i===null?(a.childLanes=0,a.lanes=t,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=i.childLanes,a.lanes=i.lanes,a.child=i.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=i.memoizedProps,a.memoizedState=i.memoizedState,a.updateQueue=i.updateQueue,a.type=i.type,t=i.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return qe(nt,nt.current&1|2),e.child}t=t.sibling}a.tail!==null&&ut()>li&&(e.flags|=128,r=!0,Ui(a,!1),e.lanes=4194304)}else{if(!r)if(t=lu(i),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Ui(a,!0),a.tail===null&&a.tailMode==="hidden"&&!i.alternate&&!et)return Dt(e),null}else 2*ut()-a.renderingStartTime>li&&n!==1073741824&&(e.flags|=128,r=!0,Ui(a,!1),e.lanes=4194304);a.isBackwards?(i.sibling=e.child,e.child=i):(n=a.last,n!==null?n.sibling=i:e.child=i,a.last=i)}return a.tail!==null?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=ut(),e.sibling=null,n=nt.current,qe(nt,r?n&1|2:n&1),e):(Dt(e),null);case 22:case 23:return Vp(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?yn&1073741824&&(Dt(e),e.subtreeFlags&6&&(e.flags|=8192)):Dt(e),null;case 24:return null;case 25:return null}throw Error(B(156,e.tag))}function mA(t,e){switch(Np(e),e.tag){case 1:return cn(e.type)&&tu(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return ii(),Ye(ln),Ye(zt),$p(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Pp(e),null;case 13:if(Ye(nt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(B(340));si()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ye(nt),null;case 4:return ii(),null;case 10:return Ip(e.type._context),null;case 22:case 23:return Vp(),null;case 24:return null;default:return null}}var ql=!1,Mt=!1,pA=typeof WeakSet=="function"?WeakSet:Set,ee=null;function Ha(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){lt(t,e,r)}else n.current=null}function Xf(t,e,n){try{n()}catch(r){lt(t,e,r)}}var O0=!1;function gA(t,e){if(Lf=Yc,t=yx(),kp(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch{n=null;break e}var i=0,o=-1,l=-1,u=0,d=0,h=t,f=null;t:for(;;){for(var m;h!==n||s!==0&&h.nodeType!==3||(o=i+s),h!==a||r!==0&&h.nodeType!==3||(l=i+r),h.nodeType===3&&(i+=h.nodeValue.length),(m=h.firstChild)!==null;)f=h,h=m;for(;;){if(h===t)break t;if(f===n&&++u===s&&(o=i),f===a&&++d===r&&(l=i),(m=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=m}n=o===-1||l===-1?null:{start:o,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Df={focusedElem:t,selectionRange:n},Yc=!1,ee=e;ee!==null;)if(e=ee,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ee=t;else for(;ee!==null;){e=ee;try{var v=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var w=v.memoizedProps,_=v.memoizedState,y=e.stateNode,p=y.getSnapshotBeforeUpdate(e.elementType===e.type?w:Zn(e.type,w),_);y.__reactInternalSnapshotBeforeUpdate=p}break;case 3:var g=e.stateNode.containerInfo;g.nodeType===1?g.textContent="":g.nodeType===9&&g.documentElement&&g.removeChild(g.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(B(163))}}catch(S){lt(e,e.return,S)}if(t=e.sibling,t!==null){t.return=e.return,ee=t;break}ee=e.return}return v=O0,O0=!1,v}function _o(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var a=s.destroy;s.destroy=void 0,a!==void 0&&Xf(e,n,a)}s=s.next}while(s!==r)}}function sd(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function em(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function fb(t){var e=t.alternate;e!==null&&(t.alternate=null,fb(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[yr],delete e[Ho],delete e[zf],delete e[QT],delete e[XT])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function mb(t){return t.tag===5||t.tag===3||t.tag===4}function P0(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||mb(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function tm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=eu));else if(r!==4&&(t=t.child,t!==null))for(tm(t,e,n),t=t.sibling;t!==null;)tm(t,e,n),t=t.sibling}function nm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(nm(t,e,n),t=t.sibling;t!==null;)nm(t,e,n),t=t.sibling}var It=null,Yn=!1;function os(t,e,n){for(n=n.child;n!==null;)pb(t,e,n),n=n.sibling}function pb(t,e,n){if(Sr&&typeof Sr.onCommitFiberUnmount=="function")try{Sr.onCommitFiberUnmount(Ju,n)}catch{}switch(n.tag){case 5:Mt||Ha(n,e);case 6:var r=It,s=Yn;It=null,os(t,e,n),It=r,Yn=s,It!==null&&(Yn?(t=It,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):It.removeChild(n.stateNode));break;case 18:It!==null&&(Yn?(t=It,n=n.stateNode,t.nodeType===8?yh(t.parentNode,n):t.nodeType===1&&yh(t,n),Fo(t)):yh(It,n.stateNode));break;case 4:r=It,s=Yn,It=n.stateNode.containerInfo,Yn=!0,os(t,e,n),It=r,Yn=s;break;case 0:case 11:case 14:case 15:if(!Mt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var a=s,i=a.destroy;a=a.tag,i!==void 0&&(a&2||a&4)&&Xf(n,e,i),s=s.next}while(s!==r)}os(t,e,n);break;case 1:if(!Mt&&(Ha(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(o){lt(n,e,o)}os(t,e,n);break;case 21:os(t,e,n);break;case 22:n.mode&1?(Mt=(r=Mt)||n.memoizedState!==null,os(t,e,n),Mt=r):os(t,e,n);break;default:os(t,e,n)}}function $0(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new pA),e.forEach(function(r){var s=EA.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function zn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var a=t,i=e,o=i;e:for(;o!==null;){switch(o.tag){case 5:It=o.stateNode,Yn=!1;break e;case 3:It=o.stateNode.containerInfo,Yn=!0;break e;case 4:It=o.stateNode.containerInfo,Yn=!0;break e}o=o.return}if(It===null)throw Error(B(160));pb(a,i,s),It=null,Yn=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(u){lt(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)gb(e,t),e=e.sibling}function gb(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(zn(e,t),ur(t),r&4){try{_o(3,t,t.return),sd(3,t)}catch(w){lt(t,t.return,w)}try{_o(5,t,t.return)}catch(w){lt(t,t.return,w)}}break;case 1:zn(e,t),ur(t),r&512&&n!==null&&Ha(n,n.return);break;case 5:if(zn(e,t),ur(t),r&512&&n!==null&&Ha(n,n.return),t.flags&32){var s=t.stateNode;try{$o(s,"")}catch(w){lt(t,t.return,w)}}if(r&4&&(s=t.stateNode,s!=null)){var a=t.memoizedProps,i=n!==null?n.memoizedProps:a,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&a.type==="radio"&&a.name!=null&&Mw(s,a),Nf(o,i);var u=Nf(o,a);for(i=0;i<l.length;i+=2){var d=l[i],h=l[i+1];d==="style"?Gw(s,h):d==="dangerouslySetInnerHTML"?Uw(s,h):d==="children"?$o(s,h):dp(s,d,h,u)}switch(o){case"input":xf(s,a);break;case"textarea":Fw(s,a);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!a.multiple;var m=a.value;m!=null?Ja(s,!!a.multiple,m,!1):f!==!!a.multiple&&(a.defaultValue!=null?Ja(s,!!a.multiple,a.defaultValue,!0):Ja(s,!!a.multiple,a.multiple?[]:"",!1))}s[Ho]=a}catch(w){lt(t,t.return,w)}}break;case 6:if(zn(e,t),ur(t),r&4){if(t.stateNode===null)throw Error(B(162));s=t.stateNode,a=t.memoizedProps;try{s.nodeValue=a}catch(w){lt(t,t.return,w)}}break;case 3:if(zn(e,t),ur(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Fo(e.containerInfo)}catch(w){lt(t,t.return,w)}break;case 4:zn(e,t),ur(t);break;case 13:zn(e,t),ur(t),s=t.child,s.flags&8192&&(a=s.memoizedState!==null,s.stateNode.isHidden=a,!a||s.alternate!==null&&s.alternate.memoizedState!==null||(Hp=ut())),r&4&&$0(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(Mt=(u=Mt)||d,zn(e,t),Mt=u):zn(e,t),ur(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(ee=t,d=t.child;d!==null;){for(h=ee=d;ee!==null;){switch(f=ee,m=f.child,f.tag){case 0:case 11:case 14:case 15:_o(4,f,f.return);break;case 1:Ha(f,f.return);var v=f.stateNode;if(typeof v.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,v.props=e.memoizedProps,v.state=e.memoizedState,v.componentWillUnmount()}catch(w){lt(r,n,w)}}break;case 5:Ha(f,f.return);break;case 22:if(f.memoizedState!==null){D0(h);continue}}m!==null?(m.return=f,ee=m):D0(h)}d=d.sibling}e:for(d=null,h=t;;){if(h.tag===5){if(d===null){d=h;try{s=h.stateNode,u?(a=s.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(o=h.stateNode,l=h.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=Bw("display",i))}catch(w){lt(t,t.return,w)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(w){lt(t,t.return,w)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:zn(e,t),ur(t),r&4&&$0(t);break;case 21:break;default:zn(e,t),ur(t)}}function ur(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(mb(n)){var r=n;break e}n=n.return}throw Error(B(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&($o(s,""),r.flags&=-33);var a=P0(t);nm(t,a,s);break;case 3:case 4:var i=r.stateNode.containerInfo,o=P0(t);tm(t,o,i);break;default:throw Error(B(161))}}catch(l){lt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function yA(t,e,n){ee=t,yb(t)}function yb(t,e,n){for(var r=(t.mode&1)!==0;ee!==null;){var s=ee,a=s.child;if(s.tag===22&&r){var i=s.memoizedState!==null||ql;if(!i){var o=s.alternate,l=o!==null&&o.memoizedState!==null||Mt;o=ql;var u=Mt;if(ql=i,(Mt=l)&&!u)for(ee=s;ee!==null;)i=ee,l=i.child,i.tag===22&&i.memoizedState!==null?M0(s):l!==null?(l.return=i,ee=l):M0(s);for(;a!==null;)ee=a,yb(a),a=a.sibling;ee=s,ql=o,Mt=u}L0(t)}else s.subtreeFlags&8772&&a!==null?(a.return=s,ee=a):L0(t)}}function L0(t){for(;ee!==null;){var e=ee;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Mt||sd(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Mt)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Zn(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;a!==null&&w0(e,a,r);break;case 3:var i=e.updateQueue;if(i!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}w0(e,i,n)}break;case 5:var o=e.stateNode;if(n===null&&e.flags&4){n=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&Fo(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(B(163))}Mt||e.flags&512&&em(e)}catch(f){lt(e,e.return,f)}}if(e===t){ee=null;break}if(n=e.sibling,n!==null){n.return=e.return,ee=n;break}ee=e.return}}function D0(t){for(;ee!==null;){var e=ee;if(e===t){ee=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ee=n;break}ee=e.return}}function M0(t){for(;ee!==null;){var e=ee;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{sd(4,e)}catch(l){lt(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(l){lt(e,s,l)}}var a=e.return;try{em(e)}catch(l){lt(e,a,l)}break;case 5:var i=e.return;try{em(e)}catch(l){lt(e,i,l)}}}catch(l){lt(e,e.return,l)}if(e===t){ee=null;break}var o=e.sibling;if(o!==null){o.return=e.return,ee=o;break}ee=e.return}}var vA=Math.ceil,du=ns.ReactCurrentDispatcher,Bp=ns.ReactCurrentOwner,Ln=ns.ReactCurrentBatchConfig,Re=0,Tt=null,ft=null,Ot=0,yn=0,Wa=Us(0),bt=0,Jo=null,pa=0,ad=0,Gp=0,wo=null,nn=null,Hp=0,li=1/0,Dr=null,hu=!1,rm=null,Cs=null,Zl=!1,_s=null,fu=0,xo=0,sm=null,Ic=-1,jc=0;function Zt(){return Re&6?ut():Ic!==-1?Ic:Ic=ut()}function Is(t){return t.mode&1?Re&2&&Ot!==0?Ot&-Ot:tA.transition!==null?(jc===0&&(jc=tx()),jc):(t=Ge,t!==0||(t=window.event,t=t===void 0?16:lx(t.type)),t):1}function tr(t,e,n,r){if(50<xo)throw xo=0,sm=null,Error(B(185));dl(t,n,r),(!(Re&2)||t!==Tt)&&(t===Tt&&(!(Re&2)&&(ad|=n),bt===4&&gs(t,Ot)),un(t,r),n===1&&Re===0&&!(e.mode&1)&&(li=ut()+500,td&&Bs()))}function un(t,e){var n=t.callbackNode;tT(t,e);var r=Jc(t,t===Tt?Ot:0);if(r===0)n!==null&&qy(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&qy(n),e===1)t.tag===0?eA(F0.bind(null,t)):Tx(F0.bind(null,t)),JT(function(){!(Re&6)&&Bs()}),n=null;else{switch(nx(r)){case 1:n=gp;break;case 4:n=Xw;break;case 16:n=Kc;break;case 536870912:n=ex;break;default:n=Kc}n=Eb(n,vb.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function vb(t,e){if(Ic=-1,jc=0,Re&6)throw Error(B(327));var n=t.callbackNode;if(ti()&&t.callbackNode!==n)return null;var r=Jc(t,t===Tt?Ot:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=mu(t,r);else{e=r;var s=Re;Re|=2;var a=wb();(Tt!==t||Ot!==e)&&(Dr=null,li=ut()+500,ia(t,e));do try{xA();break}catch(o){_b(t,o)}while(!0);Cp(),du.current=a,Re=s,ft!==null?e=0:(Tt=null,Ot=0,e=bt)}if(e!==0){if(e===2&&(s=jf(t),s!==0&&(r=s,e=am(t,s))),e===1)throw n=Jo,ia(t,0),gs(t,r),un(t,ut()),n;if(e===6)gs(t,r);else{if(s=t.current.alternate,!(r&30)&&!_A(s)&&(e=mu(t,r),e===2&&(a=jf(t),a!==0&&(r=a,e=am(t,a))),e===1))throw n=Jo,ia(t,0),gs(t,r),un(t,ut()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(B(345));case 2:qs(t,nn,Dr);break;case 3:if(gs(t,r),(r&130023424)===r&&(e=Hp+500-ut(),10<e)){if(Jc(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Zt(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Ff(qs.bind(null,t,nn,Dr),e);break}qs(t,nn,Dr);break;case 4:if(gs(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var i=31-er(r);a=1<<i,i=e[i],i>s&&(s=i),r&=~a}if(r=s,r=ut()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*vA(r/1960))-r,10<r){t.timeoutHandle=Ff(qs.bind(null,t,nn,Dr),r);break}qs(t,nn,Dr);break;case 5:qs(t,nn,Dr);break;default:throw Error(B(329))}}}return un(t,ut()),t.callbackNode===n?vb.bind(null,t):null}function am(t,e){var n=wo;return t.current.memoizedState.isDehydrated&&(ia(t,e).flags|=256),t=mu(t,e),t!==2&&(e=nn,nn=n,e!==null&&im(e)),t}function im(t){nn===null?nn=t:nn.push.apply(nn,t)}function _A(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],a=s.getSnapshot;s=s.value;try{if(!nr(a(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function gs(t,e){for(e&=~Gp,e&=~ad,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-er(e),r=1<<n;t[n]=-1,e&=~r}}function F0(t){if(Re&6)throw Error(B(327));ti();var e=Jc(t,0);if(!(e&1))return un(t,ut()),null;var n=mu(t,e);if(t.tag!==0&&n===2){var r=jf(t);r!==0&&(e=r,n=am(t,r))}if(n===1)throw n=Jo,ia(t,0),gs(t,e),un(t,ut()),n;if(n===6)throw Error(B(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,qs(t,nn,Dr),un(t,ut()),null}function Wp(t,e){var n=Re;Re|=1;try{return t(e)}finally{Re=n,Re===0&&(li=ut()+500,td&&Bs())}}function ga(t){_s!==null&&_s.tag===0&&!(Re&6)&&ti();var e=Re;Re|=1;var n=Ln.transition,r=Ge;try{if(Ln.transition=null,Ge=1,t)return t()}finally{Ge=r,Ln.transition=n,Re=e,!(Re&6)&&Bs()}}function Vp(){yn=Wa.current,Ye(Wa)}function ia(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,KT(n)),ft!==null)for(n=ft.return;n!==null;){var r=n;switch(Np(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&tu();break;case 3:ii(),Ye(ln),Ye(zt),$p();break;case 5:Pp(r);break;case 4:ii();break;case 13:Ye(nt);break;case 19:Ye(nt);break;case 10:Ip(r.type._context);break;case 22:case 23:Vp()}n=n.return}if(Tt=t,ft=t=js(t.current,null),Ot=yn=e,bt=0,Jo=null,Gp=ad=pa=0,nn=wo=null,ta!==null){for(e=0;e<ta.length;e++)if(n=ta[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,a=n.pending;if(a!==null){var i=a.next;a.next=s,r.next=i}n.pending=r}ta=null}return t}function _b(t,e){do{var n=ft;try{if(Cp(),Tc.current=uu,cu){for(var r=rt.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}cu=!1}if(ma=0,Et=_t=rt=null,vo=!1,qo=0,Bp.current=null,n===null||n.return===null){bt=1,Jo=e,ft=null;break}e:{var a=t,i=n.return,o=n,l=e;if(e=Ot,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,d=o,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var m=N0(i);if(m!==null){m.flags&=-257,T0(m,i,o,a,e),m.mode&1&&E0(a,u,e),e=m,l=u;var v=e.updateQueue;if(v===null){var w=new Set;w.add(l),e.updateQueue=w}else v.add(l);break e}else{if(!(e&1)){E0(a,u,e),qp();break e}l=Error(B(426))}}else if(et&&o.mode&1){var _=N0(i);if(_!==null){!(_.flags&65536)&&(_.flags|=256),T0(_,i,o,a,e),Tp(oi(l,o));break e}}a=l=oi(l,o),bt!==4&&(bt=2),wo===null?wo=[a]:wo.push(a),a=i;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e;var y=nb(a,l,e);_0(a,y);break e;case 1:o=l;var p=a.type,g=a.stateNode;if(!(a.flags&128)&&(typeof p.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(Cs===null||!Cs.has(g)))){a.flags|=65536,e&=-e,a.lanes|=e;var S=rb(a,o,e);_0(a,S);break e}}a=a.return}while(a!==null)}bb(n)}catch(N){e=N,ft===n&&n!==null&&(ft=n=n.return);continue}break}while(!0)}function wb(){var t=du.current;return du.current=uu,t===null?uu:t}function qp(){(bt===0||bt===3||bt===2)&&(bt=4),Tt===null||!(pa&268435455)&&!(ad&268435455)||gs(Tt,Ot)}function mu(t,e){var n=Re;Re|=2;var r=wb();(Tt!==t||Ot!==e)&&(Dr=null,ia(t,e));do try{wA();break}catch(s){_b(t,s)}while(!0);if(Cp(),Re=n,du.current=r,ft!==null)throw Error(B(261));return Tt=null,Ot=0,bt}function wA(){for(;ft!==null;)xb(ft)}function xA(){for(;ft!==null&&!VN();)xb(ft)}function xb(t){var e=kb(t.alternate,t,yn);t.memoizedProps=t.pendingProps,e===null?bb(t):ft=e,Bp.current=null}function bb(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=mA(n,e),n!==null){n.flags&=32767,ft=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{bt=6,ft=null;return}}else if(n=fA(n,e,yn),n!==null){ft=n;return}if(e=e.sibling,e!==null){ft=e;return}ft=e=t}while(e!==null);bt===0&&(bt=5)}function qs(t,e,n){var r=Ge,s=Ln.transition;try{Ln.transition=null,Ge=1,bA(t,e,n,r)}finally{Ln.transition=s,Ge=r}return null}function bA(t,e,n,r){do ti();while(_s!==null);if(Re&6)throw Error(B(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(B(177));t.callbackNode=null,t.callbackPriority=0;var a=n.lanes|n.childLanes;if(nT(t,a),t===Tt&&(ft=Tt=null,Ot=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Zl||(Zl=!0,Eb(Kc,function(){return ti(),null})),a=(n.flags&15990)!==0,n.subtreeFlags&15990||a){a=Ln.transition,Ln.transition=null;var i=Ge;Ge=1;var o=Re;Re|=4,Bp.current=null,gA(t,n),gb(n,t),BT(Df),Yc=!!Lf,Df=Lf=null,t.current=n,yA(n),qN(),Re=o,Ge=i,Ln.transition=a}else t.current=n;if(Zl&&(Zl=!1,_s=t,fu=s),a=t.pendingLanes,a===0&&(Cs=null),JN(n.stateNode),un(t,ut()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(hu)throw hu=!1,t=rm,rm=null,t;return fu&1&&t.tag!==0&&ti(),a=t.pendingLanes,a&1?t===sm?xo++:(xo=0,sm=t):xo=0,Bs(),null}function ti(){if(_s!==null){var t=nx(fu),e=Ln.transition,n=Ge;try{if(Ln.transition=null,Ge=16>t?16:t,_s===null)var r=!1;else{if(t=_s,_s=null,fu=0,Re&6)throw Error(B(331));var s=Re;for(Re|=4,ee=t.current;ee!==null;){var a=ee,i=a.child;if(ee.flags&16){var o=a.deletions;if(o!==null){for(var l=0;l<o.length;l++){var u=o[l];for(ee=u;ee!==null;){var d=ee;switch(d.tag){case 0:case 11:case 15:_o(8,d,a)}var h=d.child;if(h!==null)h.return=d,ee=h;else for(;ee!==null;){d=ee;var f=d.sibling,m=d.return;if(fb(d),d===u){ee=null;break}if(f!==null){f.return=m,ee=f;break}ee=m}}}var v=a.alternate;if(v!==null){var w=v.child;if(w!==null){v.child=null;do{var _=w.sibling;w.sibling=null,w=_}while(w!==null)}}ee=a}}if(a.subtreeFlags&2064&&i!==null)i.return=a,ee=i;else e:for(;ee!==null;){if(a=ee,a.flags&2048)switch(a.tag){case 0:case 11:case 15:_o(9,a,a.return)}var y=a.sibling;if(y!==null){y.return=a.return,ee=y;break e}ee=a.return}}var p=t.current;for(ee=p;ee!==null;){i=ee;var g=i.child;if(i.subtreeFlags&2064&&g!==null)g.return=i,ee=g;else e:for(i=p;ee!==null;){if(o=ee,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:sd(9,o)}}catch(N){lt(o,o.return,N)}if(o===i){ee=null;break e}var S=o.sibling;if(S!==null){S.return=o.return,ee=S;break e}ee=o.return}}if(Re=s,Bs(),Sr&&typeof Sr.onPostCommitFiberRoot=="function")try{Sr.onPostCommitFiberRoot(Ju,t)}catch{}r=!0}return r}finally{Ge=n,Ln.transition=e}}return!1}function z0(t,e,n){e=oi(n,e),e=nb(t,e,1),t=As(t,e,1),e=Zt(),t!==null&&(dl(t,1,e),un(t,e))}function lt(t,e,n){if(t.tag===3)z0(t,t,n);else for(;e!==null;){if(e.tag===3){z0(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Cs===null||!Cs.has(r))){t=oi(n,t),t=rb(e,t,1),e=As(e,t,1),t=Zt(),e!==null&&(dl(e,1,t),un(e,t));break}}e=e.return}}function SA(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Zt(),t.pingedLanes|=t.suspendedLanes&n,Tt===t&&(Ot&n)===n&&(bt===4||bt===3&&(Ot&130023424)===Ot&&500>ut()-Hp?ia(t,0):Gp|=n),un(t,e)}function Sb(t,e){e===0&&(t.mode&1?(e=Ml,Ml<<=1,!(Ml&130023424)&&(Ml=4194304)):e=1);var n=Zt();t=Zr(t,e),t!==null&&(dl(t,e,n),un(t,n))}function kA(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),Sb(t,n)}function EA(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(B(314))}r!==null&&r.delete(e),Sb(t,n)}var kb;kb=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||ln.current)an=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return an=!1,hA(t,e,n);an=!!(t.flags&131072)}else an=!1,et&&e.flags&1048576&&Ax(e,su,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Cc(t,e),t=e.pendingProps;var s=ri(e,zt.current);ei(e,n),s=Dp(null,e,r,t,s,n);var a=Mp();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,cn(r)?(a=!0,nu(e)):a=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Rp(e),s.updater=rd,e.stateNode=s,s._reactInternals=e,Vf(e,r,t,n),e=Kf(null,e,r,!0,a,n)):(e.tag=0,et&&a&&Ep(e),qt(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Cc(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=TA(r),t=Zn(r,t),s){case 0:e=Zf(null,e,r,t,n);break e;case 1:e=I0(null,e,r,t,n);break e;case 11:e=A0(null,e,r,t,n);break e;case 14:e=C0(null,e,r,Zn(r.type,t),n);break e}throw Error(B(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Zn(r,s),Zf(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Zn(r,s),I0(t,e,r,s,n);case 3:e:{if(ob(e),t===null)throw Error(B(387));r=e.pendingProps,a=e.memoizedState,s=a.element,Px(t,e),ou(e,r,null,n);var i=e.memoizedState;if(r=i.element,a.isDehydrated)if(a={element:r,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},e.updateQueue.baseState=a,e.memoizedState=a,e.flags&256){s=oi(Error(B(423)),e),e=j0(t,e,r,n,s);break e}else if(r!==s){s=oi(Error(B(424)),e),e=j0(t,e,r,n,s);break e}else for(vn=Ts(e.stateNode.containerInfo.firstChild),wn=e,et=!0,Qn=null,n=Rx(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(si(),r===s){e=Kr(t,e,n);break e}qt(t,e,r,n)}e=e.child}return e;case 5:return $x(e),t===null&&Gf(e),r=e.type,s=e.pendingProps,a=t!==null?t.memoizedProps:null,i=s.children,Mf(r,s)?i=null:a!==null&&Mf(r,a)&&(e.flags|=32),ib(t,e),qt(t,e,i,n),e.child;case 6:return t===null&&Gf(e),null;case 13:return lb(t,e,n);case 4:return Op(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=ai(e,null,r,n):qt(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Zn(r,s),A0(t,e,r,s,n);case 7:return qt(t,e,e.pendingProps,n),e.child;case 8:return qt(t,e,e.pendingProps.children,n),e.child;case 12:return qt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,a=e.memoizedProps,i=s.value,qe(au,r._currentValue),r._currentValue=i,a!==null)if(nr(a.value,i)){if(a.children===s.children&&!ln.current){e=Kr(t,e,n);break e}}else for(a=e.child,a!==null&&(a.return=e);a!==null;){var o=a.dependencies;if(o!==null){i=a.child;for(var l=o.firstContext;l!==null;){if(l.context===r){if(a.tag===1){l=Gr(-1,n&-n),l.tag=2;var u=a.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?l.next=l:(l.next=d.next,d.next=l),u.pending=l}}a.lanes|=n,l=a.alternate,l!==null&&(l.lanes|=n),Hf(a.return,n,e),o.lanes|=n;break}l=l.next}}else if(a.tag===10)i=a.type===e.type?null:a.child;else if(a.tag===18){if(i=a.return,i===null)throw Error(B(341));i.lanes|=n,o=i.alternate,o!==null&&(o.lanes|=n),Hf(i,n,e),i=a.sibling}else i=a.child;if(i!==null)i.return=a;else for(i=a;i!==null;){if(i===e){i=null;break}if(a=i.sibling,a!==null){a.return=i.return,i=a;break}i=i.return}a=i}qt(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,ei(e,n),s=Dn(s),r=r(s),e.flags|=1,qt(t,e,r,n),e.child;case 14:return r=e.type,s=Zn(r,e.pendingProps),s=Zn(r.type,s),C0(t,e,r,s,n);case 15:return sb(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Zn(r,s),Cc(t,e),e.tag=1,cn(r)?(t=!0,nu(e)):t=!1,ei(e,n),tb(e,r,s),Vf(e,r,s,n),Kf(null,e,r,!0,t,n);case 19:return cb(t,e,n);case 22:return ab(t,e,n)}throw Error(B(156,e.tag))};function Eb(t,e){return Qw(t,e)}function NA(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pn(t,e,n,r){return new NA(t,e,n,r)}function Zp(t){return t=t.prototype,!(!t||!t.isReactComponent)}function TA(t){if(typeof t=="function")return Zp(t)?1:0;if(t!=null){if(t=t.$$typeof,t===fp)return 11;if(t===mp)return 14}return 2}function js(t,e){var n=t.alternate;return n===null?(n=Pn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Rc(t,e,n,r,s,a){var i=2;if(r=t,typeof t=="function")Zp(t)&&(i=1);else if(typeof t=="string")i=5;else e:switch(t){case $a:return oa(n.children,s,a,e);case hp:i=8,s|=8;break;case gf:return t=Pn(12,n,e,s|2),t.elementType=gf,t.lanes=a,t;case yf:return t=Pn(13,n,e,s),t.elementType=yf,t.lanes=a,t;case vf:return t=Pn(19,n,e,s),t.elementType=vf,t.lanes=a,t;case $w:return id(n,s,a,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Ow:i=10;break e;case Pw:i=9;break e;case fp:i=11;break e;case mp:i=14;break e;case hs:i=16,r=null;break e}throw Error(B(130,t==null?t:typeof t,""))}return e=Pn(i,n,e,s),e.elementType=t,e.type=r,e.lanes=a,e}function oa(t,e,n,r){return t=Pn(7,t,r,e),t.lanes=n,t}function id(t,e,n,r){return t=Pn(22,t,r,e),t.elementType=$w,t.lanes=n,t.stateNode={isHidden:!1},t}function Eh(t,e,n){return t=Pn(6,t,null,e),t.lanes=n,t}function Nh(t,e,n){return e=Pn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function AA(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ih(0),this.expirationTimes=ih(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ih(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Kp(t,e,n,r,s,a,i,o,l){return t=new AA(t,e,n,o,l),e===1?(e=1,a===!0&&(e|=8)):e=0,a=Pn(3,null,null,e),t.current=a,a.stateNode=t,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Rp(a),t}function CA(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Pa,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function Nb(t){if(!t)return $s;t=t._reactInternals;e:{if(wa(t)!==t||t.tag!==1)throw Error(B(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(cn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(B(171))}if(t.tag===1){var n=t.type;if(cn(n))return Nx(t,n,e)}return e}function Tb(t,e,n,r,s,a,i,o,l){return t=Kp(n,r,!0,t,s,a,i,o,l),t.context=Nb(null),n=t.current,r=Zt(),s=Is(n),a=Gr(r,s),a.callback=e??null,As(n,a,s),t.current.lanes=s,dl(t,s,r),un(t,r),t}function od(t,e,n,r){var s=e.current,a=Zt(),i=Is(s);return n=Nb(n),e.context===null?e.context=n:e.pendingContext=n,e=Gr(a,i),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=As(s,e,i),t!==null&&(tr(t,s,i,a),Nc(t,s,i)),i}function pu(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function U0(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Jp(t,e){U0(t,e),(t=t.alternate)&&U0(t,e)}function IA(){return null}var Ab=typeof reportError=="function"?reportError:function(t){console.error(t)};function Yp(t){this._internalRoot=t}ld.prototype.render=Yp.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(B(409));od(t,e,null,null)};ld.prototype.unmount=Yp.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;ga(function(){od(null,t,null,null)}),e[qr]=null}};function ld(t){this._internalRoot=t}ld.prototype.unstable_scheduleHydration=function(t){if(t){var e=ax();t={blockedOn:null,target:t,priority:e};for(var n=0;n<ps.length&&e!==0&&e<ps[n].priority;n++);ps.splice(n,0,t),n===0&&ox(t)}};function Qp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function cd(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function B0(){}function jA(t,e,n,r,s){if(s){if(typeof r=="function"){var a=r;r=function(){var u=pu(i);a.call(u)}}var i=Tb(e,r,t,0,null,!1,!1,"",B0);return t._reactRootContainer=i,t[qr]=i.current,Bo(t.nodeType===8?t.parentNode:t),ga(),i}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var o=r;r=function(){var u=pu(l);o.call(u)}}var l=Kp(t,0,!1,null,null,!1,!1,"",B0);return t._reactRootContainer=l,t[qr]=l.current,Bo(t.nodeType===8?t.parentNode:t),ga(function(){od(e,l,n,r)}),l}function ud(t,e,n,r,s){var a=n._reactRootContainer;if(a){var i=a;if(typeof s=="function"){var o=s;s=function(){var l=pu(i);o.call(l)}}od(e,i,t,s)}else i=jA(n,e,t,s,r);return pu(i)}rx=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Zi(e.pendingLanes);n!==0&&(yp(e,n|1),un(e,ut()),!(Re&6)&&(li=ut()+500,Bs()))}break;case 13:ga(function(){var r=Zr(t,1);if(r!==null){var s=Zt();tr(r,t,1,s)}}),Jp(t,1)}};vp=function(t){if(t.tag===13){var e=Zr(t,134217728);if(e!==null){var n=Zt();tr(e,t,134217728,n)}Jp(t,134217728)}};sx=function(t){if(t.tag===13){var e=Is(t),n=Zr(t,e);if(n!==null){var r=Zt();tr(n,t,e,r)}Jp(t,e)}};ax=function(){return Ge};ix=function(t,e){var n=Ge;try{return Ge=t,e()}finally{Ge=n}};Af=function(t,e,n){switch(e){case"input":if(xf(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=ed(r);if(!s)throw Error(B(90));Dw(r),xf(r,s)}}}break;case"textarea":Fw(t,n);break;case"select":e=n.value,e!=null&&Ja(t,!!n.multiple,e,!1)}};Vw=Wp;qw=ga;var RA={usingClientEntryPoint:!1,Events:[fl,Fa,ed,Hw,Ww,Wp]},Bi={findFiberByHostInstance:ea,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},OA={bundleType:Bi.bundleType,version:Bi.version,rendererPackageName:Bi.rendererPackageName,rendererConfig:Bi.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ns.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Jw(t),t===null?null:t.stateNode},findFiberByHostInstance:Bi.findFiberByHostInstance||IA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Kl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Kl.isDisabled&&Kl.supportsFiber)try{Ju=Kl.inject(OA),Sr=Kl}catch{}}En.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=RA;En.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Qp(e))throw Error(B(200));return CA(t,e,null,n)};En.createRoot=function(t,e){if(!Qp(t))throw Error(B(299));var n=!1,r="",s=Ab;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Kp(t,1,!1,null,null,n,!1,r,s),t[qr]=e.current,Bo(t.nodeType===8?t.parentNode:t),new Yp(e)};En.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(B(188)):(t=Object.keys(t).join(","),Error(B(268,t)));return t=Jw(e),t=t===null?null:t.stateNode,t};En.flushSync=function(t){return ga(t)};En.hydrate=function(t,e,n){if(!cd(e))throw Error(B(200));return ud(null,t,e,!0,n)};En.hydrateRoot=function(t,e,n){if(!Qp(t))throw Error(B(405));var r=n!=null&&n.hydratedSources||null,s=!1,a="",i=Ab;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(a=n.identifierPrefix),n.onRecoverableError!==void 0&&(i=n.onRecoverableError)),e=Tb(e,null,t,1,n??null,s,!1,a,i),t[qr]=e.current,Bo(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new ld(e)};En.render=function(t,e,n){if(!cd(e))throw Error(B(200));return ud(null,t,e,!1,n)};En.unmountComponentAtNode=function(t){if(!cd(t))throw Error(B(40));return t._reactRootContainer?(ga(function(){ud(null,null,t,!1,function(){t._reactRootContainer=null,t[qr]=null})}),!0):!1};En.unstable_batchedUpdates=Wp;En.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!cd(n))throw Error(B(200));if(t==null||t._reactInternals===void 0)throw Error(B(38));return ud(t,e,n,!1,r)};En.version="18.3.1-next-f1338f8080-20240426";function Cb(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Cb)}catch(t){console.error(t)}}Cb(),Cw.exports=En;var PA=Cw.exports,Ib,G0=PA;Ib=G0.createRoot,G0.hydrateRoot;/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var $A={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LA=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),ge=(t,e)=>{const n=V.forwardRef(({color:r="currentColor",size:s=24,strokeWidth:a=2,absoluteStrokeWidth:i,className:o="",children:l,...u},d)=>V.createElement("svg",{ref:d,...$A,width:s,height:s,stroke:r,strokeWidth:i?Number(a)*24/Number(s):a,className:["lucide",`lucide-${LA(t)}`,o].join(" "),...u},[...e.map(([h,f])=>V.createElement(h,f)),...Array.isArray(l)?l:[l]]));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H0=ge("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DA=ge("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jb=ge("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MA=ge("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FA=ge("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W0=ge("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gu=ge("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zA=ge("BellOff",[["path",{d:"M8.7 3A6 6 0 0 1 18 8a21.3 21.3 0 0 0 .6 5",key:"o7mx20"}],["path",{d:"M17 17H3s3-2 3-9a4.67 4.67 0 0 1 .3-1.7",key:"16f1lm"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V0=ge("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rb=ge("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ys=ge("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UA=ge("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BA=ge("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GA=ge("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HA=ge("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qs=ge("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WA=ge("Cookie",[["path",{d:"M12 2a10 10 0 1 0 10 10 4 4 0 0 1-5-5 4 4 0 0 1-5-5",key:"laymnq"}],["path",{d:"M8.5 8.5v.01",key:"ue8clq"}],["path",{d:"M16 15.5v.01",key:"14dtrp"}],["path",{d:"M12 12v.01",key:"u5ubse"}],["path",{d:"M11 17v.01",key:"1hyl5a"}],["path",{d:"M7 14v.01",key:"uct60s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VA=ge("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qA=ge("Cpu",[["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"9",y:"9",width:"6",height:"6",key:"o3kz5p"}],["path",{d:"M15 2v2",key:"13l42r"}],["path",{d:"M15 20v2",key:"15mkzm"}],["path",{d:"M2 15h2",key:"1gxd5l"}],["path",{d:"M2 9h2",key:"1bbxkp"}],["path",{d:"M20 15h2",key:"19e6y8"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M9 2v2",key:"165o2o"}],["path",{d:"M9 20v2",key:"i2bqo8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZA=ge("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bo=ge("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zr=ge("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oc=ge("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ws=ge("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q0=ge("FolderTree",[["path",{d:"M20 10a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1h-2.5a1 1 0 0 1-.8-.4l-.9-1.2A1 1 0 0 0 15 3h-2a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"hod4my"}],["path",{d:"M20 21a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1h-2.9a1 1 0 0 1-.88-.55l-.42-.85a1 1 0 0 0-.92-.6H13a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"w4yl2u"}],["path",{d:"M3 5a2 2 0 0 0 2 2h3",key:"f2jnh7"}],["path",{d:"M3 3v13a2 2 0 0 0 2 2h3",key:"k8epm1"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KA=ge("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yo=ge("GitCommitHorizontal",[["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}],["line",{x1:"3",x2:"9",y1:"12",y2:"12",key:"1dyftd"}],["line",{x1:"15",x2:"21",y1:"12",y2:"12",key:"oup4p8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _r=ge("Github",[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",key:"tonef"}],["path",{d:"M9 18c-4.51 2-5-2-7-2",key:"9comsn"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z0=ge("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const om=ge("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JA=ge("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Th=ge("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YA=ge("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QA=ge("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pc=ge("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ob=ge("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K0=ge("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XA=ge("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eC=ge("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tC=ge("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nC=ge("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rC=ge("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sC=ge("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aC=ge("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nt=ge("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iC=ge("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J0=ge("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const So=ge("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lm=ge("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),Y0={en:{documentationWriter:"Documentation Writer",aiPoweredGeneration:"AI-powered documentation generation",sourceSelection:"Source Selection",clickToCollapse:"Click to collapse",clickToExpand:"Click to expand",formats:"Formats",sections:"Sections",selectAtLeastOne:"Select at least one format and section",token:"Token",add:"Add",change:"Change",hide:"Hide",openaiKey:"OpenAI Key",saveChanges:"Save Changes",runWorkflow:"Run Workflow",startWritingDocumentation:"Start Writing Documentation",generating:"Generating...",documentation:"Documentation",noDocumentation:"No documentation generated yet",export:"Export",commit:"Commit",settings:"Settings",statistics:"Statistics",qualityScores:"Quality Scores",refactorProposals:"Refactor Proposals",badges:"Badges",pdfExport:"PDF Export",clear:"Clear",formatsLocked:"Formats and sections are locked after generation.",runNewWorkflow:"Run a new workflow to change them.",agentWorkflow:"Agent Workflow",useAiAgents:"Use AI agents for automated pipeline",singleRepo:"Single Repository",multiRepo:"Multi-Repository",githubUrl:"GitHub URL",selectRepos:"Select Repositories",selectAtLeastOneRepo:"Please select at least one repository",selectAtLeastOneFormat:"Please select at least one output format",selectAtLeastOneSection:"Please select at least one documentation section type",pleaseProvideUrl:"Please provide a GitHub URL",reviewAndCommit:'Review the documentation below, then click "Commit to Repos" if you want to commit it.',commitToRepos:"Commit to Repos",committing:"Committing...",clearDocumentation:"Clear documentation to change formats/sections",toChangeFormats:"to change formats/sections",gitScribe:"GitScribe",aiPowered:"AI-POWERED",aiPoweredDocumentationTitle:"AI-Powered Documentation for GitHub Repositories",aiPoweredDocumentationDescription:"Automatically generate comprehensive documentation from single or multiple GitHub repositories. Powered by AI agents that analyze, plan, and write documentation for your codebase.",githubIntegration:"GitHub Integration",githubIntegrationDescription:"Generate documentation from any GitHub repository",multiRepoSupport:"Multi-Repo Support",multiRepoSupportDescription:"Generate documentation for multiple repositories simultaneously",autoCommitExport:"Auto-Commit & Export",autoCommitExportDescription:"Automatically commit documentation to repos or download as Markdown",readyToStart:"Ready to start?",generateDocumentationFromRepos:"Generate documentation from GitHub repositories",noAccountNeeded:"No account needed - Start immediately!",startImmediately:"Start immediately!",whyChooseOurTool:"Why Choose Our Documentation Tool",whyChooseOurToolDescription:"Streamline your documentation workflow with AI-powered generation",aiAgentWorkflows:"AI Agent Workflows",aiAgentWorkflowsDescription:"Automated agent system that discovers, analyzes, plans, and writes documentation for your repositories.",autoUpdateFollow:"Auto-Update & Follow",autoUpdateFollowDescription:"Automatically detect changes and regenerate documentation when repositories are updated.",githubIntegrationFeature:"GitHub Integration",githubIntegrationFeatureDescription:"Seamless commit integration and direct repository access for your documentation workflow.",readyToGetStarted:"Ready to get started?",joinDevelopers:"Join developers and teams automating their documentation workflow",startGeneratingDocumentation:"Start Generating Documentation",footerDescription:"AI-powered documentation generation for GitHub repositories with multi-repo support, agent workflows, and auto-update features.",madeWith:"Made with",forDevelopers:"for developers",features:"Features",resources:"Resources",connect:"Connect",contactUs:"Contact Us",allRightsReserved:"All rights reserved",privacyPolicy:"Privacy Policy",termsOfService:"Terms of Service",cookiePolicy:"Cookie Policy",overview:"Overview",gettingStarted:"Getting Started",supportedFormats:"Supported Formats",repositoryAccess:"Repository Access",fileAnalysis:"File Analysis",codeUnderstanding:"Code Understanding",createGitHubToken:"Create a GitHub Personal Access Token",addTokenToGitScribe:"Add Token to GitScribe",startGenerating:"Start Generating",requiredScopes:"Required scopes",forPrivateRepos:"for private repos and commits",forPublicRepos:"For public repos, a token is optional but recommended to avoid rate limits",enterRepositoryUrl:"Enter your repository URL",chooseOutputFormats:"Choose output formats and section types",clickRunWorkflow:'Click "Run Workflow"',selectMultipleRepositories:"Select Multiple Repositories",aiPoweredAnalysis:"AI-powered analysis",automaticallyAnalyze:"Automatically analyze",connectToAnyRepository:"Connect to any GitHub repository",usingPersonalAccessToken:"using your Personal Access Token",goToGitHubSettings:"Go to GitHub Settings",developerSettings:"Developer settings",personalAccessTokens:"Personal access tokens",tokensClassic:"Tokens (classic)",enterYourToken:"Enter your token",githubTokenField:"in the GitHub Token field",documentationEditorSettings:"in the documentation editor settings",clickSaveChanges:'Click "Save Changes"',persistIt:"to persist it",egOwnerRepo:"e.g., owner/repo",thenClickRunWorkflow:'then click "Run Workflow"',startAiAgentWorkflow:"to start the AI agent workflow",youCanUseAnyOfTheseFormats:"You can use any of these formats to specify a repository",toSpecifyRepository:"to specify a repository",seamlesslyConnectWithGitHub:"Seamlessly connect with GitHub to generate documentation from your repositories",generateDocumentationFromRepositories:"generate documentation from your repositories",gitScribeIntegratesDirectly:"GitScribe integrates directly with GitHub's API",accessYourRepositories:"to access your repositories",generateComprehensiveDocumentation:"and generate comprehensive documentation",whetherPublicOrPrivate:"Whether you're working with public or private repositories",ourIntegrationMakesItEasy:"our integration makes it easy",documentYourCodebase:"to document your codebase",connectToAnyGitHubRepository:"Connect to any GitHub repository",automaticallyAnalyzeRepository:"Automatically analyze repository",repositoryStructure:"repository structure",codeFiles:"code files",configuration:"and configuration",aiPoweredAnalysisOfCodebase:"AI-powered analysis of your codebase",generateAccurateDocumentation:"to generate accurate documentation",tokenOptionalButRecommended:"For public repos, a token is optional but recommended",avoidRateLimits:"to avoid rate limits",multiRepoSupportTitle:"Multi-Repository Support",generateDocumentationForMultiple:"Generate documentation for multiple",simultaneously:"simultaneously",selectMultipleRepositoriesTitle:"Select Multiple Repositories",batchProcessing:"Batch Processing",unifiedDocumentation:"Unified Documentation",individualDocumentation:"Individual Documentation",aiPoweredGenerationTitle:"AI-Powered Generation",aiPoweredGenerationDescription:"Leverage advanced AI to create comprehensive, accurate documentation",exportCommitTitle:"Export & Commit",exportCommitDescription:"Export documentation or commit directly to your repositories",documentationTitle:"Documentation",apiReferenceTitle:"API Reference",examplesTitle:"Examples",supportTitle:"Support",privacyPolicyTitle:"Privacy Policy",termsOfServiceTitle:"Terms of Service",cookiePolicyTitle:"Cookie Policy",assistantGreeting:"Hi! I'm your AI assistant. I can help you edit and improve your documentation! ",assistantCapabilities:"I can:",assistantRewriteSections:"Rewrite sections",assistantImproveClarity:"Improve clarity and readability",assistantFixGrammar:"Fix grammar and spelling",assistantAddRemoveContent:"Add or remove content",assistantRestructure:"Restructure the documentation",assistantFormatText:"Format text better",assistantTellMeWhatToChange:"Just tell me what you'd like to change!",assistantErrorNoDocumentation:"Documentation editing mode requires documentation to be loaded. Please generate documentation first.",assistantErrorUnknown:"Sorry, I encountered an error",assistantErrorApiKey:"Configuration error: OpenAI API key is missing. Please check your environment variables.",assistantErrorParse:`I had trouble understanding that request. Could you try rephrasing it? For example:
 "Add a pricing section"
 "Change the primary color to blue"
 "Update the hero title"`,assistantErrorNetwork:"Network error: Please check your internet connection and try again.",assistantPlaceholderLoading:"AI is generating your request...",assistantPlaceholderReady:"Ask me anything about your documentation...",assistantTitleSend:"Send message",assistantTitleType:"Type a message to send",assistantClearConversation:"Clear conversation",selectRepositories:"Select Repositories",selected:"selected",close:"Close",searchRepositories:"Search repositories...",visibility:"Visibility:",all:"All",public:"Public",private:"Private",refresh:"Refresh",loadingRepositories:"Loading repositories...",noRepositoriesMatch:"No repositories match your search.",noRepositoriesFound:"No repositories found.",lastPushed:"Last pushed:",repositoriesSelected:"repositories selected",repositorySelected:"repository selected",noRepositoriesSelected:"No repositories selected",clearAll:"Clear All",done:"Done",repositoryDiscovery:"Repository Discovery",repositoryAnalysis:"Repository Analysis",qualityAnalysis:"Quality Analysis",refactorProposal:"Refactor Proposal",documentationPlanning:"Documentation Planning",documentationWriting:"Documentation Writing",gitOperations:"Git Operations",complete:"Complete",running:"Running...",processing:"Processing:",completed:" Completed",error:"Error:",automatedPipeline:"Automated documentation generation pipeline",outputFormats:"Output Formats",sectionTypes:"Section Types",pleaseSelectAtLeastOneRepository:"Please select at least one repository",noWorkflowState:"No workflow state available",noDocumentationToCommit:"No documentation to commit",commitFailed:"Commit failed",generatedFeatures:"Generated Features",workflowComplete:"Workflow Complete!",generatedDocumentationFor:"Generated documentation for",repository:"repository",repositories:"repositories",committedTo:"Committed to",backTo:"Back to",cancel:"Cancel",branch:"Branch",commitMessage:"Commit Message",scrollToTop:"Scroll to top",hideAiAssistant:"Hide AI Assistant",showAiAssistant:"Show AI Assistant",enableAutoUpdate:"Enable auto-update on push/merge",disableAutoUpdate:"Disable auto-update",format:"Format:",section:"Section:",addDocumentation:"Add documentation",ownerRepoOrGithub:"owner/repo or github.com/owner/repo",ownerRepoPlaceholder:"owner/repo",keyFeatures:"Key Features",selectAndProcessMultiple:"Select and process multiple repositories in a single operation",eachRepositoryGetsOwn:"Each repository gets its own dedicated documentation file",batchCommit:"Batch Commit",commitToAllSelected:"Commit documentation to all selected repositories with one click",howToUse:"How to Use",selectMultipleReposStep:"1. Select Multiple Repositories",clickSelectReposButton:'Click "Select repositories" button to browse and select from your GitHub repositories. You can search and filter by visibility.',browseAndSelectFromGitHub:"browse and select from your GitHub repositories",searchAndFilterByVisibility:"You can search and filter by visibility",chooseOutputFormatsSections:"2. Choose Output Formats & Sections",selectOneOrMoreFormats:"Select one or more output formats",markdownMdxOpenapiHtml:"(Markdown, MDX, OpenAPI, HTML)",documentationSectionTypes:"and documentation section types",readmeArchitectureApi:"(README, Architecture, API, etc.)",runWorkflowStep:"3. Run Workflow",clickRunWorkflowToStart:'Click "Run Workflow" to start the AI agent workflow',systemWillProcessEachRepo:"The system will process each repository",throughDiscoveryAnalysisPlanning:"through discovery, analysis, planning, and writing stages",reviewCommitStep:"4. Review & Commit",reviewDocumentationInTabs:"Review documentation in separate tabs for each repository",switchBetweenFormatsSections:"Switch between formats and sections",whenReadyClickCommitToRepos:'When ready, click "Commit to Repos"',commitAllAtOnce:"to commit all at once",benefits:"Benefits",saveTimeProcessingMultiple:"Save time by processing multiple repositories simultaneously",maintainConsistentFormat:"Maintain consistent documentation format across projects",easyManagementWithTabs:"Easy management with tabbed interface for each repository",batchCommitFunctionality:"Batch commit functionality for efficient workflow",aiModels:"AI Models",gitScribeSupportsMultipleModels:"GitScribe supports multiple OpenAI models",chooseBasedOnNeeds:"Choose based on your needs",speedCostQuality:"for speed, cost, and quality",gpt4oMiniRecommended:"GPT-4o Mini (Recommended)",fastAndCostEffective:"Fast and cost-effective for most documentation tasks",bestBalanceSpeedQuality:"Best balance of speed and quality",gpt4o:"GPT-4o",mostAdvancedModel:"Most advanced model",complexCodebases:"for complex codebases",highestQualityHigherCost:"Highest quality, higher cost",gpt4Turbo:"GPT-4 Turbo",balancedPerformanceAccuracy:"Balanced performance and accuracy",goodForLargeRepos:"Good for large repositories",gpt35Turbo:"GPT-3.5 Turbo",fastAndEconomical:"Fast and economical",simpleProjects:"for simple projects",lowestCostOption:"Lowest cost option",youCanChangeModel:"You can change the model",settingsPanel:"in the Settings panel",realtimeCostEstimation:"Real-time cost estimation",statisticsSidebar:"is displayed in the Statistics sidebar",aiAssistant:"AI Assistant",aiAssistantFeature:"The AI Assistant feature allows you",interactivelyEditImprove:"to interactively edit and improve your documentation",rewriteSectionsForClarity:"Rewrite sections for better clarity",fixGrammarSpellingErrors:"Fix grammar and spelling errors",addRemoveContentBasedOnNeeds:"Add or remove content based on your needs",restructureDocumentation:"Restructure documentation for better flow",formatTextImproveReadability:"Format text and improve readability",costEstimation:"Cost Estimation",gitScribeProvidesRealtime:"GitScribe provides real-time cost estimation",basedOn:"based on",selectedAiModelPricing:"Selected AI model pricing",estimatedTokenUsage:"Estimated token usage",documentationLengthComplexity:"Documentation length and complexity",costsDisplayedInStatistics:"Costs are displayed",duringGeneration:"during generation"},fr:{documentationWriter:"Gnrateur de Documentation",aiPoweredGeneration:"Gnration de documentation alimente par IA",sourceSelection:"Slection de Source",clickToCollapse:"Cliquez pour rduire",clickToExpand:"Cliquez pour dvelopper",formats:"Formats",sections:"Sections",selectAtLeastOne:"Slectionnez au moins un format et une section",token:"Jeton",add:"Ajouter",change:"Changer",hide:"Masquer",openaiKey:"Cl OpenAI",saveChanges:"Enregistrer les Modifications",runWorkflow:"Excuter le Workflow",startWritingDocumentation:"Commencer  crire la Documentation",generating:"Gnration...",documentation:"Documentation",noDocumentation:"Aucune documentation gnre pour le moment",export:"Exporter",commit:"Valider",settings:"Paramtres",statistics:"Statistiques",qualityScores:"Scores de Qualit",refactorProposals:"Propositions de Refactorisation",badges:"Badges",pdfExport:"Export PDF",clear:"Effacer",formatsLocked:"Les formats et sections sont verrouills aprs gnration.",runNewWorkflow:"Excutez un nouveau workflow pour les modifier.",agentWorkflow:"Workflow d'Agent",useAiAgents:"Utiliser des agents IA pour le pipeline automatis",singleRepo:"Dpt Unique",multiRepo:"Multi-Dpts",githubUrl:"URL GitHub",selectRepos:"Slectionner les Dpts",selectAtLeastOneRepo:"Veuillez slectionner au moins un dpt",selectAtLeastOneFormat:"Veuillez slectionner au moins un format de sortie",selectAtLeastOneSection:"Veuillez slectionner au moins un type de section de documentation",pleaseProvideUrl:"Veuillez fournir une URL GitHub",reviewAndCommit:'Examinez la documentation ci-dessous, puis cliquez sur "Valider dans les Dpts" si vous souhaitez la valider.',commitToRepos:"Valider dans les Dpts",committing:"Validation...",clearDocumentation:"Effacer la documentation pour modifier les formats/sections",toChangeFormats:"pour modifier les formats/sections",gitScribe:"GitScribe",aiPowered:"ALIMENT PAR IA",aiPoweredDocumentationTitle:"Documentation Alimente par IA pour les Dpts GitHub",aiPoweredDocumentationDescription:"Gnrez automatiquement une documentation complte  partir d'un ou plusieurs dpts GitHub. Aliment par des agents IA qui analysent, planifient et rdigent la documentation pour votre base de code.",githubIntegration:"Intgration GitHub",githubIntegrationDescription:"Gnrer de la documentation  partir de n'importe quel dpt GitHub",multiRepoSupport:"Support Multi-Dpts",multiRepoSupportDescription:"Gnrer de la documentation pour plusieurs dpts simultanment",autoCommitExport:"Validation & Export Automatiques",autoCommitExportDescription:"Valider automatiquement la documentation dans les dpts ou la tlcharger en Markdown",readyToStart:"Prt  commencer?",generateDocumentationFromRepos:"Gnrer de la documentation  partir de dpts GitHub",noAccountNeeded:"Aucun compte requis - Commencez immdiatement!",startImmediately:"Commencez immdiatement!",whyChooseOurTool:"Pourquoi Choisir Notre Outil de Documentation",whyChooseOurToolDescription:"Rationalisez votre flux de travail de documentation avec une gnration alimente par IA",aiAgentWorkflows:"Workflows d'Agents IA",aiAgentWorkflowsDescription:"Systme d'agents automatis qui dcouvre, analyse, planifie et rdige la documentation pour vos dpts.",autoUpdateFollow:"Mise  Jour & Suivi Automatiques",autoUpdateFollowDescription:"Dtecter automatiquement les changements et rgnrer la documentation lorsque les dpts sont mis  jour.",githubIntegrationFeature:"Intgration GitHub",githubIntegrationFeatureDescription:"Intgration de validation transparente et accs direct aux dpts pour votre flux de travail de documentation.",readyToGetStarted:"Prt  commencer?",joinDevelopers:"Rejoignez les dveloppeurs et les quipes qui automatisent leur flux de travail de documentation",startGeneratingDocumentation:"Commencer  Gnrer la Documentation",footerDescription:"Gnration de documentation alimente par IA pour les dpts GitHub avec support multi-dpts, workflows d'agents et fonctionnalits de mise  jour automatique.",madeWith:"Fait avec",forDevelopers:"pour les dveloppeurs",features:"Fonctionnalits",resources:"Ressources",connect:"Se Connecter",contactUs:"Nous Contacter",allRightsReserved:"Tous droits rservs",privacyPolicy:"Politique de Confidentialit",termsOfService:"Conditions d'Utilisation",cookiePolicy:"Politique des Cookies",overview:"Aperu",gettingStarted:"Pour Commencer",supportedFormats:"Formats Pris en Charge",repositoryAccess:"Accs au Dpt",fileAnalysis:"Analyse de Fichiers",codeUnderstanding:"Comprhension du Code",createGitHubToken:"Crer un Jeton d'Accs Personnel GitHub",addTokenToGitScribe:"Ajouter le Jeton  GitScribe",startGenerating:"Commencer la Gnration",requiredScopes:"Portes requises",forPrivateRepos:"pour les dpts privs et les commits",forPublicRepos:"Pour les dpts publics, un jeton est facultatif mais recommand pour viter les limites de dbit",enterRepositoryUrl:"Entrez l'URL de votre dpt",chooseOutputFormats:"Choisissez les formats de sortie et les types de sections",clickRunWorkflow:'Cliquez sur "Excuter le Workflow"',selectMultipleRepositories:"Slectionner Plusieurs Dpts",aiPoweredAnalysis:"Analyse alimente par IA",automaticallyAnalyze:"Analyser automatiquement",connectToAnyRepository:"Se connecter  n'importe quel dpt GitHub",usingPersonalAccessToken:"en utilisant votre Jeton d'Accs Personnel",goToGitHubSettings:"Allez dans les Paramtres GitHub",developerSettings:"Paramtres du dveloppeur",personalAccessTokens:"Jetons d'accs personnels",tokensClassic:"Jetons (classique)",enterYourToken:"Entrez votre jeton",githubTokenField:"dans le champ Jeton GitHub",documentationEditorSettings:"dans les paramtres de l'diteur de documentation",clickSaveChanges:'Cliquez sur "Enregistrer les Modifications"',persistIt:"pour le conserver",egOwnerRepo:"par ex., propritaire/dpt",thenClickRunWorkflow:'puis cliquez sur "Excuter le Workflow"',startAiAgentWorkflow:"pour dmarrer le workflow de l'agent IA",youCanUseAnyOfTheseFormats:"Vous pouvez utiliser l'un de ces formats pour spcifier un dpt",toSpecifyRepository:"pour spcifier un dpt",seamlesslyConnectWithGitHub:"Connectez-vous facilement  GitHub pour gnrer de la documentation  partir de vos dpts",generateDocumentationFromRepositories:"gnrer de la documentation  partir de vos dpts",gitScribeIntegratesDirectly:"GitScribe s'intgre directement avec l'API GitHub",accessYourRepositories:"pour accder  vos dpts",generateComprehensiveDocumentation:"et gnrer une documentation complte",whetherPublicOrPrivate:"Que vous travailliez avec des dpts publics ou privs",ourIntegrationMakesItEasy:"notre intgration facilite",documentYourCodebase:"la documentation de votre base de code",connectToAnyGitHubRepository:"Se connecter  n'importe quel dpt GitHub",automaticallyAnalyzeRepository:"Analyser automatiquement le dpt",repositoryStructure:"structure du dpt",codeFiles:"fichiers de code",configuration:"et configuration",aiPoweredAnalysisOfCodebase:"Analyse alimente par IA de votre base de code",generateAccurateDocumentation:"pour gnrer une documentation prcise",tokenOptionalButRecommended:"Pour les dpts publics, un jeton est facultatif mais recommand",avoidRateLimits:"pour viter les limites de dbit",multiRepoSupportTitle:"Support Multi-Dpts",generateDocumentationForMultiple:"Gnrer de la documentation pour plusieurs",simultaneously:"simultanment",selectMultipleRepositoriesTitle:"Slectionner Plusieurs Dpts",batchProcessing:"Traitement par Lots",unifiedDocumentation:"Documentation Unifie",individualDocumentation:"Documentation Individuelle",aiPoweredGenerationTitle:"Gnration Alimente par IA",aiPoweredGenerationDescription:"Exploitez l'IA avance pour crer une documentation complte et prcise",exportCommitTitle:"Export & Commit",exportCommitDescription:"Exporter la documentation ou la committer directement dans vos dpts",documentationTitle:"Documentation",apiReferenceTitle:"Rfrence API",examplesTitle:"Exemples",supportTitle:"Support",privacyPolicyTitle:"Politique de Confidentialit",termsOfServiceTitle:"Conditions d'Utilisation",cookiePolicyTitle:"Politique des Cookies",assistantGreeting:"Salut! Je suis votre assistant IA. Je peux vous aider  modifier et amliorer votre documentation! ",assistantCapabilities:"Je peux:",assistantRewriteSections:"Rcrire des sections",assistantImproveClarity:"Amliorer la clart et la lisibilit",assistantFixGrammar:"Corriger la grammaire et l'orthographe",assistantAddRemoveContent:"Ajouter ou supprimer du contenu",assistantRestructure:"Restructurer la documentation",assistantFormatText:"Mieux formater le texte",assistantTellMeWhatToChange:"Dites-moi simplement ce que vous aimeriez changer!",assistantErrorNoDocumentation:"Le mode d'dition de documentation ncessite que la documentation soit charge. Veuillez d'abord gnrer la documentation.",assistantErrorUnknown:"Dsol, j'ai rencontr une erreur",assistantErrorApiKey:"Erreur de configuration: La cl API OpenAI est manquante. Veuillez vrifier vos variables d'environnement.",assistantErrorParse:`J'ai eu du mal  comprendre cette demande. Pourriez-vous essayer de la reformuler? Par exemple:
 "Ajouter une section de tarification"
 "Changer la couleur principale en bleu"
 "Mettre  jour le titre principal"`,assistantErrorNetwork:"Erreur rseau: Veuillez vrifier votre connexion Internet et ressayer.",assistantPlaceholderLoading:"L'IA gnre votre demande...",assistantPlaceholderReady:"Demandez-moi n'importe quoi sur votre documentation...",assistantTitleSend:"Envoyer le message",assistantTitleType:"Tapez un message  envoyer",assistantClearConversation:"Effacer la conversation",selectRepositories:"Slectionner les Dpts",selected:"slectionn",close:"Fermer",searchRepositories:"Rechercher des dpts...",visibility:"Visibilit:",all:"Tous",public:"Public",private:"Priv",refresh:"Actualiser",loadingRepositories:"Chargement des dpts...",noRepositoriesMatch:"Aucun dpt ne correspond  votre recherche.",noRepositoriesFound:"Aucun dpt trouv.",lastPushed:"Dernire mise  jour:",repositoriesSelected:"dpts slectionns",repositorySelected:"dpt slectionn",noRepositoriesSelected:"Aucun dpt slectionn",clearAll:"Tout Effacer",done:"Termin",repositoryDiscovery:"Dcouverte de Dpt",repositoryAnalysis:"Analyse de Dpt",qualityAnalysis:"Analyse de Qualit",refactorProposal:"Proposition de Refactorisation",documentationPlanning:"Planification de Documentation",documentationWriting:"Rdaction de Documentation",gitOperations:"Oprations Git",complete:"Termin",running:"En cours...",processing:"Traitement:",completed:" Termin",error:"Erreur:",automatedPipeline:"Pipeline automatis de gnration de documentation",outputFormats:"Formats de Sortie",sectionTypes:"Types de Sections",pleaseSelectAtLeastOneRepository:"Veuillez slectionner au moins un dpt",noWorkflowState:"Aucun tat de workflow disponible",noDocumentationToCommit:"Aucune documentation  committer",commitFailed:"chec du commit",generatedFeatures:"Fonctionnalits Gnres",workflowComplete:"Workflow Termin!",generatedDocumentationFor:"Documentation gnre pour",repository:"dpt",repositories:"dpts",committedTo:"Committ dans",backTo:"Retour ",cancel:"Annuler",branch:"Branche",commitMessage:"Message de Commit",scrollToTop:"Faire dfiler vers le haut",hideAiAssistant:"Masquer l'Assistant IA",showAiAssistant:"Afficher l'Assistant IA",enableAutoUpdate:"Activer la mise  jour automatique lors du push/merge",disableAutoUpdate:"Dsactiver la mise  jour automatique",format:"Format:",section:"Section:",addDocumentation:"Ajouter de la documentation",ownerRepoOrGithub:"propritaire/dpt ou github.com/propritaire/dpt",ownerRepoPlaceholder:"propritaire/dpt"},de:{documentationWriter:"Dokumentations-Generator",aiPoweredGeneration:"KI-gesttzte Dokumentationsgenerierung",sourceSelection:"Quellenauswahl",clickToCollapse:"Zum Reduzieren klicken",clickToExpand:"Zum Erweitern klicken",formats:"Formate",sections:"Abschnitte",selectAtLeastOne:"Whlen Sie mindestens ein Format und einen Abschnitt",token:"Token",add:"Hinzufgen",change:"ndern",hide:"Ausblenden",openaiKey:"OpenAI-Schlssel",saveChanges:"nderungen Speichern",runWorkflow:"Workflow Ausfhren",startWritingDocumentation:"Dokumentation Schreiben Beginnen",generating:"Wird generiert...",documentation:"Dokumentation",noDocumentation:"Noch keine Dokumentation generiert",export:"Exportieren",commit:"bernehmen",settings:"Einstellungen",statistics:"Statistiken",qualityScores:"Qualittsbewertungen",refactorProposals:"Refaktorisierungsvorschlge",badges:"Abzeichen",pdfExport:"PDF-Export",clear:"Lschen",formatsLocked:"Formate und Abschnitte sind nach der Generierung gesperrt.",runNewWorkflow:"Fhren Sie einen neuen Workflow aus, um sie zu ndern.",agentWorkflow:"Agent-Workflow",useAiAgents:"KI-Agenten fr automatisierte Pipeline verwenden",singleRepo:"Einzelnes Repository",multiRepo:"Multi-Repository",githubUrl:"GitHub-URL",selectRepos:"Repositories Auswhlen",selectAtLeastOneRepo:"Bitte whlen Sie mindestens ein Repository aus",selectAtLeastOneFormat:"Bitte whlen Sie mindestens ein Ausgabeformat aus",selectAtLeastOneSection:"Bitte whlen Sie mindestens einen Dokumentationsabschnittstyp aus",pleaseProvideUrl:"Bitte geben Sie eine GitHub-URL an",reviewAndCommit:'berprfen Sie die Dokumentation unten und klicken Sie dann auf "In Repositories bernehmen", wenn Sie sie bernehmen mchten.',commitToRepos:"In Repositories bernehmen",committing:"Wird bernommen...",clearDocumentation:"Dokumentation lschen, um Formate/Abschnitte zu ndern",toChangeFormats:"um Formate/Abschnitte zu ndern",gitScribe:"GitScribe",aiPowered:"KI-GESTTZT",aiPoweredDocumentationTitle:"KI-gesttzte Dokumentation fr GitHub-Repositories",aiPoweredDocumentationDescription:"Generieren Sie automatisch umfassende Dokumentation aus einzelnen oder mehreren GitHub-Repositories. Angetrieben von KI-Agenten, die Dokumentation fr Ihre Codebasis analysieren, planen und schreiben.",githubIntegration:"GitHub-Integration",githubIntegrationDescription:"Generieren Sie Dokumentation aus jedem GitHub-Repository",multiRepoSupport:"Multi-Repository-Untersttzung",multiRepoSupportDescription:"Generieren Sie Dokumentation fr mehrere Repositories gleichzeitig",autoCommitExport:"Automatische bernahme & Export",autoCommitExportDescription:"Automatisch Dokumentation in Repositories bernehmen oder als Markdown herunterladen",readyToStart:"Bereit zu starten?",generateDocumentationFromRepos:"Generieren Sie Dokumentation aus GitHub-Repositories",noAccountNeeded:"Kein Konto erforderlich - Sofort starten!",startImmediately:"Sofort starten!",whyChooseOurTool:"Warum Unser Dokumentationstool Whlen",whyChooseOurToolDescription:"Optimieren Sie Ihren Dokumentations-Workflow mit KI-gesttzter Generierung",aiAgentWorkflows:"KI-Agent-Workflows",aiAgentWorkflowsDescription:"Automatisiertes Agentensystem, das Dokumentation fr Ihre Repositories entdeckt, analysiert, plant und schreibt.",autoUpdateFollow:"Automatische Aktualisierung & Verfolgung",autoUpdateFollowDescription:"Automatisch nderungen erkennen und Dokumentation neu generieren, wenn Repositories aktualisiert werden.",githubIntegrationFeature:"GitHub-Integration",githubIntegrationFeatureDescription:"Nahtlose Commit-Integration und direkter Repository-Zugriff fr Ihren Dokumentations-Workflow.",readyToGetStarted:"Bereit zu starten?",joinDevelopers:"Treten Sie Entwicklern und Teams bei, die ihren Dokumentations-Workflow automatisieren",startGeneratingDocumentation:"Dokumentation Generieren Starten",footerDescription:"KI-gesttzte Dokumentationsgenerierung fr GitHub-Repositories mit Multi-Repository-Untersttzung, Agent-Workflows und Auto-Update-Funktionen.",madeWith:"Gemacht mit",forDevelopers:"fr Entwickler",features:"Funktionen",resources:"Ressourcen",connect:"Verbinden",contactUs:"Kontaktieren Sie uns",allRightsReserved:"Alle Rechte vorbehalten",privacyPolicy:"Datenschutzrichtlinie",termsOfService:"Nutzungsbedingungen",cookiePolicy:"Cookie-Richtlinie",overview:"bersicht",gettingStarted:"Erste Schritte",supportedFormats:"Untersttzte Formate",repositoryAccess:"Repository-Zugriff",fileAnalysis:"Dateianalyse",codeUnderstanding:"Code-Verstndnis",createGitHubToken:"GitHub Personal Access Token erstellen",addTokenToGitScribe:"Token zu GitScribe hinzufgen",startGenerating:"Generierung starten",requiredScopes:"Erforderliche Berechtigungen",forPrivateRepos:"fr private Repositories und Commits",forPublicRepos:"Fr ffentliche Repositories ist ein Token optional, aber empfohlen, um Rate-Limits zu vermeiden",enterRepositoryUrl:"Geben Sie Ihre Repository-URL ein",chooseOutputFormats:"Whlen Sie Ausgabeformate und Abschnittstypen",clickRunWorkflow:'Klicken Sie auf "Workflow Ausfhren"',selectMultipleRepositories:"Mehrere Repositories Auswhlen",aiPoweredAnalysis:"KI-gesttzte Analyse",automaticallyAnalyze:"Automatisch analysieren",connectToAnyRepository:"Verbinden Sie sich mit jedem GitHub-Repository",usingPersonalAccessToken:"mit Ihrem Personal Access Token",goToGitHubSettings:"Gehen Sie zu GitHub-Einstellungen",developerSettings:"Entwicklereinstellungen",personalAccessTokens:"Personal Access Tokens",tokensClassic:"Tokens (klassisch)",enterYourToken:"Geben Sie Ihren Token ein",githubTokenField:"im GitHub-Token-Feld",documentationEditorSettings:"in den Dokumentations-Editor-Einstellungen",clickSaveChanges:'Klicken Sie auf "nderungen Speichern"',persistIt:"um es zu speichern",egOwnerRepo:"z.B. Eigentmer/Repository",thenClickRunWorkflow:'dann klicken Sie auf "Workflow Ausfhren"',startAiAgentWorkflow:"um den KI-Agent-Workflow zu starten",youCanUseAnyOfTheseFormats:"Sie knnen eines dieser Formate verwenden, um ein Repository anzugeben",toSpecifyRepository:"um ein Repository anzugeben",seamlesslyConnectWithGitHub:"Verbinden Sie sich nahtlos mit GitHub, um Dokumentation aus Ihren Repositories zu generieren",generateDocumentationFromRepositories:"Dokumentation aus Ihren Repositories generieren",gitScribeIntegratesDirectly:"GitScribe integriert sich direkt mit der GitHub-API",accessYourRepositories:"um auf Ihre Repositories zuzugreifen",generateComprehensiveDocumentation:"und umfassende Dokumentation zu generieren",whetherPublicOrPrivate:"Ob Sie mit ffentlichen oder privaten Repositories arbeiten",ourIntegrationMakesItEasy:"unsere Integration macht es einfach",documentYourCodebase:"Ihre Codebasis zu dokumentieren",connectToAnyGitHubRepository:"Verbinden Sie sich mit jedem GitHub-Repository",automaticallyAnalyzeRepository:"Repository automatisch analysieren",repositoryStructure:"Repository-Struktur",codeFiles:"Codedateien",configuration:"und Konfiguration",aiPoweredAnalysisOfCodebase:"KI-gesttzte Analyse Ihrer Codebasis",generateAccurateDocumentation:"um genaue Dokumentation zu generieren",tokenOptionalButRecommended:"Fr ffentliche Repositories ist ein Token optional, aber empfohlen",avoidRateLimits:"um Rate-Limits zu vermeiden",multiRepoSupportTitle:"Multi-Repository-Untersttzung",generateDocumentationForMultiple:"Generieren Sie Dokumentation fr mehrere",simultaneously:"gleichzeitig",selectMultipleRepositoriesTitle:"Mehrere Repositories Auswhlen",batchProcessing:"Stapelverarbeitung",unifiedDocumentation:"Einheitliche Dokumentation",individualDocumentation:"Individuelle Dokumentation",aiPoweredGenerationTitle:"KI-gesttzte Generierung",aiPoweredGenerationDescription:"Nutzen Sie fortschrittliche KI, um umfassende, genaue Dokumentation zu erstellen",exportCommitTitle:"Export & Commit",exportCommitDescription:"Exportieren Sie Dokumentation oder committen Sie direkt in Ihre Repositories",documentationTitle:"Dokumentation",apiReferenceTitle:"API-Referenz",examplesTitle:"Beispiele",supportTitle:"Support",privacyPolicyTitle:"Datenschutzrichtlinie",termsOfServiceTitle:"Nutzungsbedingungen",cookiePolicyTitle:"Cookie-Richtlinie",assistantGreeting:"Hallo! Ich bin Ihr KI-Assistent. Ich kann Ihnen beim Bearbeiten und Verbessern Ihrer Dokumentation helfen! ",assistantCapabilities:"Ich kann:",assistantRewriteSections:"Abschnitte umschreiben",assistantImproveClarity:"Klarheit und Lesbarkeit verbessern",assistantFixGrammar:"Grammatik und Rechtschreibung korrigieren",assistantAddRemoveContent:"Inhalte hinzufgen oder entfernen",assistantRestructure:"Dokumentation umstrukturieren",assistantFormatText:"Text besser formatieren",assistantTellMeWhatToChange:"Sagen Sie mir einfach, was Sie ndern mchten!",assistantErrorNoDocumentation:"Der Dokumentationsbearbeitungsmodus erfordert, dass die Dokumentation geladen ist. Bitte generieren Sie zuerst die Dokumentation.",assistantErrorUnknown:"Entschuldigung, es ist ein Fehler aufgetreten",assistantErrorApiKey:"Konfigurationsfehler: OpenAI API-Schlssel fehlt. Bitte berprfen Sie Ihre Umgebungsvariablen.",assistantErrorParse:`Ich hatte Schwierigkeiten, diese Anfrage zu verstehen. Knnten Sie versuchen, sie umzuformulieren? Zum Beispiel:
 "Fgen Sie einen Preisabschnitt hinzu"
 "ndern Sie die Hauptfarbe zu blau"
 "Aktualisieren Sie den Haupttitel"`,assistantErrorNetwork:"Netzwerkfehler: Bitte berprfen Sie Ihre Internetverbindung und versuchen Sie es erneut.",assistantPlaceholderLoading:"KI generiert Ihre Anfrage...",assistantPlaceholderReady:"Fragen Sie mich alles ber Ihre Dokumentation...",assistantTitleSend:"Nachricht senden",assistantTitleType:"Geben Sie eine Nachricht ein, um sie zu senden",assistantClearConversation:"Konversation lschen",selectRepositories:"Repositories Auswhlen",selected:"ausgewhlt",close:"Schlieen",searchRepositories:"Repositories suchen...",visibility:"Sichtbarkeit:",all:"Alle",public:"ffentlich",private:"Privat",refresh:"Aktualisieren",loadingRepositories:"Repositories werden geladen...",noRepositoriesMatch:"Keine Repositories entsprechen Ihrer Suche.",noRepositoriesFound:"Keine Repositories gefunden.",lastPushed:"Zuletzt aktualisiert:",repositoriesSelected:"Repositories ausgewhlt",repositorySelected:"Repository ausgewhlt",noRepositoriesSelected:"Keine Repositories ausgewhlt",clearAll:"Alle Lschen",done:"Fertig",repositoryDiscovery:"Repository-Entdeckung",repositoryAnalysis:"Repository-Analyse",qualityAnalysis:"Qualittsanalyse",refactorProposal:"Refaktorisierungsvorschlag",documentationPlanning:"Dokumentationsplanung",documentationWriting:"Dokumentationserstellung",gitOperations:"Git-Operationen",complete:"Abgeschlossen",running:"Luft...",processing:"Verarbeitung:",completed:" Abgeschlossen",error:"Fehler:",automatedPipeline:"Automatisierte Dokumentationsgenerierungs-Pipeline",outputFormats:"Ausgabeformate",sectionTypes:"Abschnittstypen",pleaseSelectAtLeastOneRepository:"Bitte whlen Sie mindestens ein Repository aus",noWorkflowState:"Kein Workflow-Zustand verfgbar",noDocumentationToCommit:"Keine Dokumentation zum Committen",commitFailed:"Commit fehlgeschlagen",generatedFeatures:"Generierte Funktionen",workflowComplete:"Workflow Abgeschlossen!",generatedDocumentationFor:"Dokumentation generiert fr",repository:"Repository",repositories:"Repositories",committedTo:"Committet in",backTo:"Zurck zu",cancel:"Abbrechen",branch:"Branch",commitMessage:"Commit-Nachricht",scrollToTop:"Nach oben scrollen",hideAiAssistant:"KI-Assistenten ausblenden",showAiAssistant:"KI-Assistenten anzeigen",enableAutoUpdate:"Automatische Aktualisierung bei Push/Merge aktivieren",disableAutoUpdate:"Automatische Aktualisierung deaktivieren",format:"Format:",section:"Abschnitt:",addDocumentation:"Dokumentation hinzufgen",ownerRepoOrGithub:"Eigentmer/Repository oder github.com/Eigentmer/Repository",ownerRepoPlaceholder:"Eigentmer/Repository"},it:{documentationWriter:"Generatore di Documentazione",aiPoweredGeneration:"Generazione di documentazione alimentata da IA",sourceSelection:"Selezione Sorgente",clickToCollapse:"Clicca per comprimere",clickToExpand:"Clicca per espandere",formats:"Formati",sections:"Sezioni",selectAtLeastOne:"Seleziona almeno un formato e una sezione",token:"Token",add:"Aggiungi",change:"Cambia",hide:"Nascondi",openaiKey:"Chiave OpenAI",saveChanges:"Salva Modifiche",runWorkflow:"Esegui Workflow",startWritingDocumentation:"Inizia a Scrivere la Documentazione",generating:"Generazione...",documentation:"Documentazione",noDocumentation:"Nessuna documentazione generata ancora",export:"Esporta",commit:"Commit",settings:"Impostazioni",statistics:"Statistiche",qualityScores:"Punteggi di Qualit",refactorProposals:"Proposte di Refactoring",badges:"Badge",pdfExport:"Esporta PDF",clear:"Cancella",formatsLocked:"I formati e le sezioni sono bloccati dopo la generazione.",runNewWorkflow:"Esegui un nuovo workflow per modificarli.",agentWorkflow:"Workflow Agente",useAiAgents:"Usa agenti IA per pipeline automatizzata",singleRepo:"Repository Singolo",multiRepo:"Multi-Repository",githubUrl:"URL GitHub",selectRepos:"Seleziona Repository",selectAtLeastOneRepo:"Seleziona almeno un repository",selectAtLeastOneFormat:"Seleziona almeno un formato di output",selectAtLeastOneSection:"Seleziona almeno un tipo di sezione di documentazione",pleaseProvideUrl:"Fornisci un URL GitHub",reviewAndCommit:'Rivedi la documentazione qui sotto, poi clicca "Commit nei Repository" se vuoi committarla.',commitToRepos:"Commit nei Repository",committing:"Commit in corso...",clearDocumentation:"Cancella la documentazione per modificare formati/sezioni",toChangeFormats:"per modificare formati/sezioni",gitScribe:"GitScribe",aiPowered:"ALIMENTATO DA IA",aiPoweredDocumentationTitle:"Documentazione Alimentata da IA per Repository GitHub",aiPoweredDocumentationDescription:"Genera automaticamente documentazione completa da uno o pi repository GitHub. Alimentato da agenti IA che analizzano, pianificano e scrivono documentazione per la tua codebase.",githubIntegration:"Integrazione GitHub",githubIntegrationDescription:"Genera documentazione da qualsiasi repository GitHub",multiRepoSupport:"Supporto Multi-Repository",multiRepoSupportDescription:"Genera documentazione per pi repository contemporaneamente",autoCommitExport:"Commit & Export Automatici",autoCommitExportDescription:"Esegui automaticamente commit della documentazione nei repository o scaricala come Markdown",readyToStart:"Pronto per iniziare?",generateDocumentationFromRepos:"Genera documentazione da repository GitHub",noAccountNeeded:"Nessun account necessario - Inizia subito!",startImmediately:"Inizia subito!",whyChooseOurTool:"Perch Scegliere Il Nostro Strumento di Documentazione",whyChooseOurToolDescription:"Semplifica il tuo flusso di lavoro di documentazione con generazione alimentata da IA",aiAgentWorkflows:"Workflow di Agenti IA",aiAgentWorkflowsDescription:"Sistema di agenti automatizzato che scopre, analizza, pianifica e scrive documentazione per i tuoi repository.",autoUpdateFollow:"Aggiornamento & Monitoraggio Automatici",autoUpdateFollowDescription:"Rileva automaticamente le modifiche e rigenera la documentazione quando i repository vengono aggiornati.",githubIntegrationFeature:"Integrazione GitHub",githubIntegrationFeatureDescription:"Integrazione commit senza soluzione di continuit e accesso diretto ai repository per il tuo flusso di lavoro di documentazione.",readyToGetStarted:"Pronto per iniziare?",joinDevelopers:"Unisciti a sviluppatori e team che automatizzano il loro flusso di lavoro di documentazione",startGeneratingDocumentation:"Inizia a Generare Documentazione",footerDescription:"Generazione di documentazione alimentata da IA per repository GitHub con supporto multi-repository, workflow di agenti e funzionalit di aggiornamento automatico.",madeWith:"Fatto con",forDevelopers:"per sviluppatori",features:"Funzionalit",resources:"Risorse",connect:"Connetti",contactUs:"Contattaci",allRightsReserved:"Tutti i diritti riservati",privacyPolicy:"Informativa sulla Privacy",termsOfService:"Termini di Servizio",cookiePolicy:"Informativa sui Cookie",overview:"Panoramica",gettingStarted:"Per Iniziare",supportedFormats:"Formati Supportati",repositoryAccess:"Accesso al Repository",fileAnalysis:"Analisi dei File",codeUnderstanding:"Comprensione del Codice",createGitHubToken:"Crea un Token di Accesso Personale GitHub",addTokenToGitScribe:"Aggiungi Token a GitScribe",startGenerating:"Inizia la Generazione",requiredScopes:"Ambiti richiesti",forPrivateRepos:"per repository privati e commit",forPublicRepos:"Per repository pubblici, un token  opzionale ma raccomandato per evitare limiti di velocit",enterRepositoryUrl:"Inserisci l'URL del tuo repository",chooseOutputFormats:"Scegli i formati di output e i tipi di sezione",clickRunWorkflow:'Clicca su "Esegui Workflow"',selectMultipleRepositories:"Seleziona Pi Repository",aiPoweredAnalysis:"Analisi alimentata da IA",automaticallyAnalyze:"Analizza automaticamente",connectToAnyRepository:"Connetti a qualsiasi repository GitHub",usingPersonalAccessToken:"usando il tuo Token di Accesso Personale",goToGitHubSettings:"Vai alle Impostazioni GitHub",developerSettings:"Impostazioni sviluppatore",personalAccessTokens:"Token di accesso personali",tokensClassic:"Token (classico)",enterYourToken:"Inserisci il tuo token",githubTokenField:"nel campo Token GitHub",documentationEditorSettings:"nelle impostazioni dell'editor di documentazione",clickSaveChanges:'Clicca su "Salva Modifiche"',persistIt:"per salvarlo",egOwnerRepo:"es. proprietario/repository",thenClickRunWorkflow:'poi clicca su "Esegui Workflow"',startAiAgentWorkflow:"per avviare il workflow dell'agente IA",youCanUseAnyOfTheseFormats:"Puoi usare uno di questi formati per specificare un repository",toSpecifyRepository:"per specificare un repository",seamlesslyConnectWithGitHub:"Connettiti facilmente con GitHub per generare documentazione dai tuoi repository",generateDocumentationFromRepositories:"generare documentazione dai tuoi repository",gitScribeIntegratesDirectly:"GitScribe si integra direttamente con l'API GitHub",accessYourRepositories:"per accedere ai tuoi repository",generateComprehensiveDocumentation:"e generare documentazione completa",whetherPublicOrPrivate:"Che tu stia lavorando con repository pubblici o privati",ourIntegrationMakesItEasy:"la nostra integrazione facilita",documentYourCodebase:"la documentazione della tua codebase",connectToAnyGitHubRepository:"Connetti a qualsiasi repository GitHub",automaticallyAnalyzeRepository:"Analizza automaticamente il repository",repositoryStructure:"struttura del repository",codeFiles:"file di codice",configuration:"e configurazione",aiPoweredAnalysisOfCodebase:"Analisi alimentata da IA della tua codebase",generateAccurateDocumentation:"per generare documentazione accurata",tokenOptionalButRecommended:"Per repository pubblici, un token  opzionale ma raccomandato",avoidRateLimits:"per evitare limiti di velocit",multiRepoSupportTitle:"Supporto Multi-Repository",generateDocumentationForMultiple:"Genera documentazione per pi",simultaneously:"contemporaneamente",selectMultipleRepositoriesTitle:"Seleziona Pi Repository",batchProcessing:"Elaborazione in Batch",unifiedDocumentation:"Documentazione Unificata",individualDocumentation:"Documentazione Individuale",aiPoweredGenerationTitle:"Generazione Alimentata da IA",aiPoweredGenerationDescription:"Sfrutta l'IA avanzata per creare documentazione completa e accurata",exportCommitTitle:"Export & Commit",exportCommitDescription:"Esporta documentazione o committa direttamente nei tuoi repository",documentationTitle:"Documentazione",apiReferenceTitle:"Riferimento API",examplesTitle:"Esempi",supportTitle:"Supporto",privacyPolicyTitle:"Informativa sulla Privacy",termsOfServiceTitle:"Termini di Servizio",cookiePolicyTitle:"Informativa sui Cookie",assistantGreeting:"Ciao! Sono il tuo assistente IA. Posso aiutarti a modificare e migliorare la tua documentazione! ",assistantCapabilities:"Posso:",assistantRewriteSections:"Riscrivere sezioni",assistantImproveClarity:"Migliorare chiarezza e leggibilit",assistantFixGrammar:"Correggere grammatica e ortografia",assistantAddRemoveContent:"Aggiungere o rimuovere contenuti",assistantRestructure:"Ristrutturare la documentazione",assistantFormatText:"Formattare meglio il testo",assistantTellMeWhatToChange:"Dimmi semplicemente cosa vorresti cambiare!",assistantErrorNoDocumentation:"La modalit di modifica della documentazione richiede che la documentazione sia caricata. Genera prima la documentazione.",assistantErrorUnknown:"Scusa, ho riscontrato un errore",assistantErrorApiKey:"Errore di configurazione: La chiave API OpenAI  mancante. Controlla le tue variabili d'ambiente.",assistantErrorParse:`Ho avuto difficolt a capire quella richiesta. Potresti provare a riformularla? Ad esempio:
 "Aggiungi una sezione prezzi"
 "Cambia il colore primario in blu"
 "Aggiorna il titolo principale"`,assistantErrorNetwork:"Errore di rete: Controlla la tua connessione Internet e riprova.",assistantPlaceholderLoading:"L'IA sta generando la tua richiesta...",assistantPlaceholderReady:"Chiedimi qualsiasi cosa sulla tua documentazione...",assistantTitleSend:"Invia messaggio",assistantTitleType:"Digita un messaggio da inviare",assistantClearConversation:"Cancella conversazione",selectRepositories:"Seleziona Repository",selected:"selezionato",close:"Chiudi",searchRepositories:"Cerca repository...",visibility:"Visibilit:",all:"Tutti",public:"Pubblico",private:"Privato",refresh:"Aggiorna",loadingRepositories:"Caricamento repository...",noRepositoriesMatch:"Nessun repository corrisponde alla tua ricerca.",noRepositoriesFound:"Nessun repository trovato.",lastPushed:"Ultimo aggiornamento:",repositoriesSelected:"repository selezionati",repositorySelected:"repository selezionato",noRepositoriesSelected:"Nessun repository selezionato",clearAll:"Cancella Tutto",done:"Fatto",repositoryDiscovery:"Scoperta Repository",repositoryAnalysis:"Analisi Repository",qualityAnalysis:"Analisi Qualit",refactorProposal:"Proposta di Refactoring",documentationPlanning:"Pianificazione Documentazione",documentationWriting:"Scrittura Documentazione",gitOperations:"Operazioni Git",complete:"Completato",running:"In esecuzione...",processing:"Elaborazione:",completed:" Completato",error:"Errore:",automatedPipeline:"Pipeline automatizzata di generazione documentazione",outputFormats:"Formati di Output",sectionTypes:"Tipi di Sezione",pleaseSelectAtLeastOneRepository:"Seleziona almeno un repository",noWorkflowState:"Nessuno stato del workflow disponibile",noDocumentationToCommit:"Nessuna documentazione da committare",commitFailed:"Commit fallito",generatedFeatures:"Funzionalit Generate",workflowComplete:"Workflow Completato!",generatedDocumentationFor:"Documentazione generata per",repository:"repository",repositories:"repository",committedTo:"Committato in",backTo:"Torna a",cancel:"Annulla",branch:"Branch",commitMessage:"Messaggio di Commit",scrollToTop:"Scorri in alto",hideAiAssistant:"Nascondi Assistente IA",showAiAssistant:"Mostra Assistente IA",enableAutoUpdate:"Abilita aggiornamento automatico su push/merge",disableAutoUpdate:"Disabilita aggiornamento automatico",format:"Formato:",section:"Sezione:",addDocumentation:"Aggiungi documentazione",ownerRepoOrGithub:"proprietario/repository o github.com/proprietario/repository",ownerRepoPlaceholder:"proprietario/repository"},es:{documentationWriter:"Generador de Documentacin",aiPoweredGeneration:"Generacin de documentacin impulsada por IA",sourceSelection:"Seleccin de Fuente",clickToCollapse:"Haz clic para contraer",clickToExpand:"Haz clic para expandir",formats:"Formatos",sections:"Secciones",selectAtLeastOne:"Selecciona al menos un formato y una seccin",token:"Token",add:"Agregar",change:"Cambiar",hide:"Ocultar",openaiKey:"Clave OpenAI",saveChanges:"Guardar Cambios",runWorkflow:"Ejecutar Workflow",startWritingDocumentation:"Comenzar a Escribir Documentacin",generating:"Generando...",documentation:"Documentacin",noDocumentation:"An no se ha generado documentacin",export:"Exportar",commit:"Confirmar",settings:"Configuracin",statistics:"Estadsticas",qualityScores:"Puntuaciones de Calidad",refactorProposals:"Propuestas de Refactorizacin",badges:"Insignias",pdfExport:"Exportar PDF",clear:"Limpiar",formatsLocked:"Los formatos y secciones estn bloqueados despus de la generacin.",runNewWorkflow:"Ejecuta un nuevo workflow para cambiarlos.",agentWorkflow:"Workflow de Agente",useAiAgents:"Usar agentes IA para pipeline automatizado",singleRepo:"Repositorio nico",multiRepo:"Multi-Repositorio",githubUrl:"URL de GitHub",selectRepos:"Seleccionar Repositorios",selectAtLeastOneRepo:"Por favor selecciona al menos un repositorio",selectAtLeastOneFormat:"Por favor selecciona al menos un formato de salida",selectAtLeastOneSection:"Por favor selecciona al menos un tipo de seccin de documentacin",pleaseProvideUrl:"Por favor proporciona una URL de GitHub",reviewAndCommit:'Revisa la documentacin a continuacin, luego haz clic en "Confirmar en Repositorios" si deseas confirmarla.',commitToRepos:"Confirmar en Repositorios",committing:"Confirmando...",clearDocumentation:"Limpiar documentacin para cambiar formatos/secciones",toChangeFormats:"para cambiar formatos/secciones",gitScribe:"GitScribe",aiPowered:"IMPULSADO POR IA",aiPoweredDocumentationTitle:"Documentacin Impulsada por IA para Repositorios GitHub",aiPoweredDocumentationDescription:"Genera automticamente documentacin completa desde uno o varios repositorios GitHub. Impulsado por agentes IA que analizan, planifican y escriben documentacin para tu base de cdigo.",githubIntegration:"Integracin GitHub",githubIntegrationDescription:"Genera documentacin desde cualquier repositorio GitHub",multiRepoSupport:"Soporte Multi-Repositorio",multiRepoSupportDescription:"Genera documentacin para mltiples repositorios simultneamente",autoCommitExport:"Commit & Export Automticos",autoCommitExportDescription:"Confirma automticamente la documentacin en repositorios o descrgala como Markdown",readyToStart:"Listo para comenzar?",generateDocumentationFromRepos:"Genera documentacin desde repositorios GitHub",noAccountNeeded:"No se necesita cuenta - Comienza inmediatamente!",startImmediately:"Comienza inmediatamente!",whyChooseOurTool:"Por Qu Elegir Nuestra Herramienta de Documentacin",whyChooseOurToolDescription:"Optimiza tu flujo de trabajo de documentacin con generacin impulsada por IA",aiAgentWorkflows:"Workflows de Agentes IA",aiAgentWorkflowsDescription:"Sistema de agentes automatizado que descubre, analiza, planifica y escribe documentacin para tus repositorios.",autoUpdateFollow:"Actualizacin & Seguimiento Automticos",autoUpdateFollowDescription:"Detecta automticamente cambios y regenera documentacin cuando los repositorios se actualizan.",githubIntegrationFeature:"Integracin GitHub",githubIntegrationFeatureDescription:"Integracin de commit sin problemas y acceso directo a repositorios para tu flujo de trabajo de documentacin.",readyToGetStarted:"Listo para comenzar?",joinDevelopers:"nete a desarrolladores y equipos que automatizan su flujo de trabajo de documentacin",startGeneratingDocumentation:"Comenzar a Generar Documentacin",footerDescription:"Generacin de documentacin impulsada por IA para repositorios GitHub con soporte multi-repositorio, workflows de agentes y funciones de actualizacin automtica.",madeWith:"Hecho con",forDevelopers:"para desarrolladores",features:"Caractersticas",resources:"Recursos",connect:"Conectar",contactUs:"Contctanos",allRightsReserved:"Todos los derechos reservados",privacyPolicy:"Poltica de Privacidad",termsOfService:"Trminos de Servicio",cookiePolicy:"Poltica de Cookies",overview:"Resumen",gettingStarted:"Para Empezar",supportedFormats:"Formatos Soportados",repositoryAccess:"Acceso al Repositorio",fileAnalysis:"Anlisis de Archivos",codeUnderstanding:"Comprensin del Cdigo",createGitHubToken:"Crear un Token de Acceso Personal de GitHub",addTokenToGitScribe:"Agregar Token a GitScribe",startGenerating:"Comenzar la Generacin",requiredScopes:"Alcances requeridos",forPrivateRepos:"para repositorios privados y commits",forPublicRepos:"Para repositorios pblicos, un token es opcional pero recomendado para evitar lmites de velocidad",enterRepositoryUrl:"Ingresa la URL de tu repositorio",chooseOutputFormats:"Elige formatos de salida y tipos de seccin",clickRunWorkflow:'Haz clic en "Ejecutar Workflow"',selectMultipleRepositories:"Seleccionar Mltiples Repositorios",aiPoweredAnalysis:"Anlisis impulsado por IA",automaticallyAnalyze:"Analizar automticamente",connectToAnyRepository:"Conecta a cualquier repositorio GitHub",usingPersonalAccessToken:"usando tu Token de Acceso Personal",goToGitHubSettings:"Ve a Configuracin de GitHub",developerSettings:"Configuracin de desarrollador",personalAccessTokens:"Tokens de acceso personal",tokensClassic:"Tokens (clsico)",enterYourToken:"Ingresa tu token",githubTokenField:"en el campo Token de GitHub",documentationEditorSettings:"en la configuracin del editor de documentacin",clickSaveChanges:'Haz clic en "Guardar Cambios"',persistIt:"para guardarlo",egOwnerRepo:"ej. propietario/repositorio",thenClickRunWorkflow:'luego haz clic en "Ejecutar Workflow"',startAiAgentWorkflow:"para iniciar el workflow del agente IA",youCanUseAnyOfTheseFormats:"Puedes usar cualquiera de estos formatos para especificar un repositorio",toSpecifyRepository:"para especificar un repositorio",seamlesslyConnectWithGitHub:"Conctate fcilmente con GitHub para generar documentacin desde tus repositorios",generateDocumentationFromRepositories:"generar documentacin desde tus repositorios",gitScribeIntegratesDirectly:"GitScribe se integra directamente con la API de GitHub",accessYourRepositories:"para acceder a tus repositorios",generateComprehensiveDocumentation:"y generar documentacin completa",whetherPublicOrPrivate:"Ya sea que trabajes con repositorios pblicos o privados",ourIntegrationMakesItEasy:"nuestra integracin facilita",documentYourCodebase:"documentar tu base de cdigo",connectToAnyGitHubRepository:"Conecta a cualquier repositorio GitHub",automaticallyAnalyzeRepository:"Analizar automticamente el repositorio",repositoryStructure:"estructura del repositorio",codeFiles:"archivos de cdigo",configuration:"y configuracin",aiPoweredAnalysisOfCodebase:"Anlisis impulsado por IA de tu base de cdigo",generateAccurateDocumentation:"para generar documentacin precisa",tokenOptionalButRecommended:"Para repositorios pblicos, un token es opcional pero recomendado",avoidRateLimits:"para evitar lmites de velocidad",multiRepoSupportTitle:"Soporte Multi-Repositorio",generateDocumentationForMultiple:"Genera documentacin para mltiples",simultaneously:"simultneamente",selectMultipleRepositoriesTitle:"Seleccionar Mltiples Repositorios",batchProcessing:"Procesamiento por Lotes",unifiedDocumentation:"Documentacin Unificada",individualDocumentation:"Documentacin Individual",aiPoweredGenerationTitle:"Generacin Impulsada por IA",aiPoweredGenerationDescription:"Aprovecha la IA avanzada para crear documentacin completa y precisa",exportCommitTitle:"Export & Commit",exportCommitDescription:"Exporta documentacin o commitea directamente a tus repositorios",documentationTitle:"Documentacin",apiReferenceTitle:"Referencia API",examplesTitle:"Ejemplos",supportTitle:"Soporte",privacyPolicyTitle:"Poltica de Privacidad",termsOfServiceTitle:"Trminos de Servicio",cookiePolicyTitle:"Poltica de Cookies",assistantGreeting:"Hola! Soy tu asistente IA. Puedo ayudarte a editar y mejorar tu documentacin! ",assistantCapabilities:"Puedo:",assistantRewriteSections:"Reescribir secciones",assistantImproveClarity:"Mejorar claridad y legibilidad",assistantFixGrammar:"Corregir gramtica y ortografa",assistantAddRemoveContent:"Agregar o eliminar contenido",assistantRestructure:"Reestructurar la documentacin",assistantFormatText:"Formatear mejor el texto",assistantTellMeWhatToChange:"Solo dime qu te gustara cambiar!",assistantErrorNoDocumentation:"El modo de edicin de documentacin requiere que la documentacin est cargada. Por favor, genera la documentacin primero.",assistantErrorUnknown:"Lo siento, encontr un error",assistantErrorApiKey:"Error de configuracin: Falta la clave API de OpenAI. Por favor, verifica tus variables de entorno.",assistantErrorParse:`Tuve problemas para entender esa solicitud. Podras intentar reformularla? Por ejemplo:
 "Agrega una seccin de precios"
 "Cambia el color primario a azul"
 "Actualiza el ttulo principal"`,assistantErrorNetwork:"Error de red: Por favor, verifica tu conexin a Internet e intenta de nuevo.",assistantPlaceholderLoading:"La IA est generando tu solicitud...",assistantPlaceholderReady:"Pregntame cualquier cosa sobre tu documentacin...",assistantTitleSend:"Enviar mensaje",assistantTitleType:"Escribe un mensaje para enviar",assistantClearConversation:"Limpiar conversacin",selectRepositories:"Seleccionar Repositorios",selected:"seleccionado",close:"Cerrar",searchRepositories:"Buscar repositorios...",visibility:"Visibilidad:",all:"Todos",public:"Pblico",private:"Privado",refresh:"Actualizar",loadingRepositories:"Cargando repositorios...",noRepositoriesMatch:"Ningn repositorio coincide con tu bsqueda.",noRepositoriesFound:"No se encontraron repositorios.",lastPushed:"ltima actualizacin:",repositoriesSelected:"repositorios seleccionados",repositorySelected:"repositorio seleccionado",noRepositoriesSelected:"No se seleccionaron repositorios",clearAll:"Limpiar Todo",done:"Hecho",repositoryDiscovery:"Descubrimiento de Repositorio",repositoryAnalysis:"Anlisis de Repositorio",qualityAnalysis:"Anlisis de Calidad",refactorProposal:"Propuesta de Refactorizacin",documentationPlanning:"Planificacin de Documentacin",documentationWriting:"Escritura de Documentacin",gitOperations:"Operaciones Git",complete:"Completado",running:"Ejecutando...",processing:"Procesando:",completed:" Completado",error:"Error:",automatedPipeline:"Pipeline automatizado de generacin de documentacin",outputFormats:"Formatos de Salida",sectionTypes:"Tipos de Seccin",pleaseSelectAtLeastOneRepository:"Por favor selecciona al menos un repositorio",noWorkflowState:"No hay estado de workflow disponible",noDocumentationToCommit:"No hay documentacin para confirmar",commitFailed:"Confirmacin fallida",generatedFeatures:"Caractersticas Generadas",workflowComplete:"Workflow Completado!",generatedDocumentationFor:"Documentacin generada para",repository:"repositorio",repositories:"repositorios",committedTo:"Confirmado en",backTo:"Volver a",cancel:"Cancelar",branch:"Rama",commitMessage:"Mensaje de Confirmacin",scrollToTop:"Desplazar hacia arriba",hideAiAssistant:"Ocultar Asistente IA",showAiAssistant:"Mostrar Asistente IA",enableAutoUpdate:"Habilitar actualizacin automtica en push/merge",disableAutoUpdate:"Deshabilitar actualizacin automtica",format:"Formato:",section:"Seccin:",addDocumentation:"Agregar documentacin",ownerRepoOrGithub:"propietario/repositorio o github.com/propietario/repositorio",ownerRepoPlaceholder:"propietario/repositorio"}};function oC(t,e="en"){var n;return((n=Y0[e])==null?void 0:n[t])||Y0.en[t]||t}function xa(t){return e=>oC(e,t)}function Xp({onNavigate:t}){const e=new Date().getFullYear(),[n,r]=V.useState(()=>localStorage.getItem("selectedLanguage")||"en");V.useEffect(()=>{const i=()=>{const l=localStorage.getItem("selectedLanguage");l&&r(l)};window.addEventListener("storage",i);const o=setInterval(i,100);return()=>{window.removeEventListener("storage",i),clearInterval(o)}},[]);const s=xa(n),a=(i,o)=>{i.preventDefault(),t?t(o):window.dispatchEvent(new CustomEvent("navigate",{detail:o}))};return c.jsx("footer",{className:"bg-white border-t border-gray-100",children:c.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-12",children:[c.jsxs("div",{className:"grid md:grid-cols-4 gap-8 mb-8",children:[c.jsxs("div",{className:"md:col-span-1",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[c.jsx("div",{className:"p-2 bg-gradient-to-r from-orange-500 to-red-500 rounded-full",children:c.jsx(Oc,{className:"w-5 h-5 text-white"})}),c.jsx("span",{className:"text-lg font-bold text-gray-900",children:s("gitScribe")})]}),c.jsx("p",{className:"text-sm text-gray-600 mb-4",children:s("footerDescription")}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[c.jsx("span",{children:s("madeWith")}),c.jsx(om,{className:"w-4 h-4 text-red-500 fill-red-500"}),c.jsx("span",{children:s("forDevelopers")})]})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-gray-900 mb-4 text-sm uppercase tracking-wide",children:s("features")}),c.jsxs("ul",{className:"space-y-2 text-sm",children:[c.jsx("li",{children:c.jsx("a",{href:"#",onClick:i=>a(i,"github-integration"),className:"text-gray-600 hover:text-orange-600 transition-colors",children:s("githubIntegration")})}),c.jsx("li",{children:c.jsx("a",{href:"#",onClick:i=>a(i,"multi-repo-support"),className:"text-gray-600 hover:text-orange-600 transition-colors",children:s("multiRepoSupport")})}),c.jsx("li",{children:c.jsx("a",{href:"#",onClick:i=>a(i,"ai-powered-generation"),className:"text-gray-600 hover:text-orange-600 transition-colors",children:s("aiPoweredGeneration")})}),c.jsx("li",{children:c.jsxs("a",{href:"#",onClick:i=>a(i,"export-commit"),className:"text-gray-600 hover:text-orange-600 transition-colors",children:[s("export")," & ",s("commit")]})})]})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-gray-900 mb-4 text-sm uppercase tracking-wide",children:s("resources")}),c.jsxs("ul",{className:"space-y-2 text-sm",children:[c.jsx("li",{children:c.jsx("a",{href:"#",onClick:i=>a(i,"documentation-page"),className:"text-gray-600 hover:text-orange-600 transition-colors",children:s("documentation")})}),c.jsx("li",{children:c.jsx("a",{href:"#",onClick:i=>a(i,"api-reference"),className:"text-gray-600 hover:text-orange-600 transition-colors",children:s("apiReferenceTitle")})}),c.jsx("li",{children:c.jsx("a",{href:"#",onClick:i=>a(i,"examples"),className:"text-gray-600 hover:text-orange-600 transition-colors",children:s("examplesTitle")})}),c.jsx("li",{children:c.jsx("a",{href:"#",onClick:i=>a(i,"support"),className:"text-gray-600 hover:text-orange-600 transition-colors",children:s("supportTitle")})})]})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-gray-900 mb-4 text-sm uppercase tracking-wide",children:s("connect")}),c.jsxs("ul",{className:"space-y-2 text-sm",children:[c.jsx("li",{children:c.jsxs("a",{href:"https://github.com",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-gray-600 hover:text-orange-600 transition-colors",children:[c.jsx(_r,{className:"w-4 h-4"}),c.jsx("span",{children:"GitHub"})]})}),c.jsx("li",{children:c.jsxs("a",{href:"mailto:support@GitScribe.com",className:"flex items-center gap-2 text-gray-600 hover:text-orange-600 transition-colors",children:[c.jsx(Ob,{className:"w-4 h-4"}),c.jsx("span",{children:s("contactUs")})]})})]})]})]}),c.jsxs("div",{className:"pt-8 border-t border-gray-200 flex flex-col md:flex-row justify-between items-center gap-4",children:[c.jsxs("p",{className:"text-sm text-gray-600",children:[" ",e," ",s("gitScribe"),". ",s("allRightsReserved"),"."]}),c.jsxs("div",{className:"flex items-center gap-6 text-sm text-gray-600",children:[c.jsx("a",{href:"#",onClick:i=>a(i,"privacy-policy"),className:"hover:text-orange-600 transition-colors",children:s("privacyPolicy")}),c.jsx("a",{href:"#",onClick:i=>a(i,"terms-of-service"),className:"hover:text-orange-600 transition-colors",children:s("termsOfService")}),c.jsx("a",{href:"#",onClick:i=>a(i,"cookie-policy"),className:"hover:text-orange-600 transition-colors",children:s("cookiePolicy")})]})]})]})})}function lC({onGenerate:t}){const[e,n]=V.useState(()=>localStorage.getItem("selectedLanguage")||"en");V.useEffect(()=>{localStorage.setItem("selectedLanguage",e)},[e]);const r=xa(e);return c.jsxs("div",{className:"min-h-screen bg-white",children:[c.jsx("header",{className:"bg-white border-b border-gray-100 sticky top-0 z-50",children:c.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-4 flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"p-2 bg-gradient-to-r from-orange-500 to-red-500 rounded-full",children:c.jsx(Oc,{className:"w-6 h-6 text-white"})}),c.jsx("span",{className:"text-xl font-bold text-gray-900",children:r("gitScribe")})]}),c.jsx("div",{className:"flex items-center gap-2",children:c.jsxs("select",{value:e,onChange:s=>n(s.target.value),className:"px-3 py-2 text-sm font-semibold rounded-xl bg-white/80 backdrop-blur-sm text-slate-700 hover:bg-white border border-slate-200 hover:border-orange-300 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all duration-300 shadow-sm hover:shadow-md cursor-pointer",title:"Translate page",children:[c.jsx("option",{value:"en",children:" EN"}),c.jsx("option",{value:"fr",children:" FR"}),c.jsx("option",{value:"de",children:" DE"}),c.jsx("option",{value:"it",children:" IT"}),c.jsx("option",{value:"es",children:" ES"})]})})]})}),c.jsxs("main",{className:"max-w-7xl mx-auto px-4",children:[c.jsx("section",{className:"py-20",children:c.jsxs("div",{className:"grid lg:grid-cols-2 gap-12 items-center",children:[c.jsxs("div",{children:[c.jsxs("div",{className:"mb-6 flex items-center gap-2",children:[c.jsx("div",{className:"h-1 w-12 bg-gradient-to-r from-orange-500 to-red-500 rounded-full"}),c.jsx("span",{className:"text-orange-600 font-semibold text-sm",children:r("aiPowered")})]}),c.jsx("h1",{className:"text-6xl font-black text-gray-900 mb-6 leading-tight",children:r("aiPoweredDocumentationTitle")}),c.jsx("p",{className:"text-xl text-gray-600 mb-8 leading-relaxed",children:r("aiPoweredDocumentationDescription")}),c.jsxs("div",{className:"space-y-4 mb-8",children:[c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:c.jsx(Oc,{className:"w-5 h-5 text-orange-600"})}),c.jsxs("div",{children:[c.jsx("p",{className:"font-semibold text-gray-900",children:r("githubIntegration")}),c.jsx("p",{className:"text-gray-600",children:r("githubIntegrationDescription")})]})]}),c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:c.jsx(om,{className:"w-5 h-5 text-orange-600"})}),c.jsxs("div",{children:[c.jsx("p",{className:"font-semibold text-gray-900",children:r("multiRepoSupport")}),c.jsx("p",{className:"text-gray-600",children:r("multiRepoSupportDescription")})]})]}),c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:c.jsx(K0,{className:"w-5 h-5 text-orange-600"})}),c.jsxs("div",{children:[c.jsx("p",{className:"font-semibold text-gray-900",children:r("autoCommitExport")}),c.jsx("p",{className:"text-gray-600",children:r("autoCommitExportDescription")})]})]})]})]}),c.jsxs("div",{className:"relative",children:[c.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-orange-100 to-red-100 rounded-3xl blur-2xl opacity-50"}),c.jsxs("div",{className:"relative bg-white rounded-3xl shadow-2xl p-8 border border-orange-100",children:[c.jsxs("div",{className:"text-center mb-8",children:[c.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-orange-500 to-red-500 rounded-full mx-auto mb-4 flex items-center justify-center",children:c.jsx(Nt,{className:"w-8 h-8 text-white"})}),c.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:r("readyToStart")}),c.jsx("p",{className:"text-gray-600 mt-1",children:r("generateDocumentationFromRepos")}),c.jsxs("div",{className:"mt-3 inline-flex items-center gap-2 px-3 py-1 bg-orange-50 border border-orange-200 rounded-full text-xs text-orange-700",children:[c.jsx("span",{children:""}),c.jsx("span",{children:r("noAccountNeeded")})]})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("button",{onClick:t,className:"w-full bg-gradient-to-r from-orange-500 to-red-500 text-white py-4 rounded-xl font-bold text-lg hover:shadow-lg transition-all duration-200 transform hover:scale-105 flex items-center justify-center gap-2",children:[c.jsx(Nt,{className:"w-5 h-5"}),r("startWritingDocumentation")]}),c.jsx("p",{className:"text-xs text-gray-500 text-center mt-4",children:" AI-powered documentation generation for GitHub repositories"})]})]})]})]})}),c.jsxs("section",{className:"py-20 border-t border-gray-100",children:[c.jsxs("div",{className:"text-center mb-16",children:[c.jsx("h2",{className:"text-4xl font-black text-gray-900 mb-4",children:r("whyChooseOurTool")}),c.jsx("p",{className:"text-xl text-gray-600 max-w-2xl mx-auto",children:r("whyChooseOurToolDescription")})]}),c.jsxs("div",{className:"grid md:grid-cols-3 gap-8",children:[c.jsxs("div",{className:"group",children:[c.jsx("div",{className:"relative mb-6 h-40 bg-gradient-to-br from-orange-50 to-red-50 rounded-2xl overflow-hidden flex items-center justify-center",children:c.jsx(lm,{className:"w-16 h-16 text-orange-400 group-hover:scale-110 transition-transform"})}),c.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:r("aiAgentWorkflows")}),c.jsx("p",{className:"text-gray-600",children:r("aiAgentWorkflowsDescription")})]}),c.jsxs("div",{className:"group",children:[c.jsx("div",{className:"relative mb-6 h-40 bg-gradient-to-br from-orange-50 to-red-50 rounded-2xl overflow-hidden flex items-center justify-center",children:c.jsx(KA,{className:"w-16 h-16 text-red-400 group-hover:scale-110 transition-transform"})}),c.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:r("autoUpdateFollow")}),c.jsx("p",{className:"text-gray-600",children:r("autoUpdateFollowDescription")})]}),c.jsxs("div",{className:"group",children:[c.jsx("div",{className:"relative mb-6 h-40 bg-gradient-to-br from-orange-50 to-red-50 rounded-2xl overflow-hidden flex items-center justify-center",children:c.jsx(K0,{className:"w-16 h-16 text-orange-400 group-hover:scale-110 transition-transform"})}),c.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:r("githubIntegrationFeature")}),c.jsx("p",{className:"text-gray-600",children:r("githubIntegrationFeatureDescription")})]})]})]}),c.jsx("section",{className:"py-20",children:c.jsxs("div",{className:"bg-gradient-to-r from-orange-500 to-red-500 rounded-3xl p-12 text-center text-white relative overflow-hidden",children:[c.jsxs("div",{className:"absolute inset-0 opacity-10",children:[c.jsx(Oc,{className:"w-32 h-32 absolute top-0 right-0"}),c.jsx(om,{className:"w-24 h-24 absolute bottom-0 left-0"})]}),c.jsxs("div",{className:"relative z-10",children:[c.jsx("h2",{className:"text-4xl font-black mb-4",children:r("readyToGetStarted")}),c.jsx("p",{className:"text-orange-100 text-lg mb-8 max-w-2xl mx-auto",children:r("joinDevelopers")}),c.jsxs("button",{onClick:t,className:"bg-white text-orange-600 px-8 py-4 rounded-xl font-bold text-lg hover:shadow-lg transition-all duration-200 transform hover:scale-105 inline-block flex items-center gap-2 mx-auto",children:[c.jsx(Nt,{className:"w-5 h-5"}),r("startGeneratingDocumentation")]})]})]})}),c.jsx(Xp,{onNavigate:s=>{window.dispatchEvent(new CustomEvent("navigate",{detail:s}))}})]})]})}const cC="modulepreload",uC=function(t){return"/"+t},Q0={},Pb=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),o=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));s=Promise.allSettled(n.map(l=>{if(l=uC(l),l in Q0)return;Q0[l]=!0;const u=l.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${d}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":cC,u||(h.as="script"),h.crossOrigin="",h.href=l,o&&h.setAttribute("nonce",o),document.head.appendChild(h),u)return new Promise((f,m)=>{h.addEventListener("load",f),h.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${l}`)))})}))}function a(i){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i}return s.then(i=>{for(const o of i||[])o.status==="rejected"&&a(o.reason);return e().catch(a)})};function dC({project:t,selectedPage:e,onUpdateProject:n,onAddSection:r,onUpdateSection:s,onUpdateSectionProps:a,onDeleteSection:i,onAddPage:o,onDeletePage:l,onSelectPage:u,model:d="gpt-4o-mini",documentation:h,onUpdateDocumentation:f}){const[m,v]=V.useState([]),w=V.useCallback(()=>{h&&f&&v([{role:"assistant",content:`${T("assistantGreeting")}

${T("assistantCapabilities")}
- ${T("assistantRewriteSections")}
- ${T("assistantImproveClarity")}
- ${T("assistantFixGrammar")}
- ${T("assistantAddRemoveContent")}
- ${T("assistantRestructure")}
- ${T("assistantFormatText")}

${T("assistantTellMeWhatToChange")}`,timestamp:Date.now()}])},[h,f]);V.useEffect(()=>{m.length===0&&h&&f&&w()},[m.length,h,f,w]);const[_,y]=V.useState(""),[p,g]=V.useState(!1),S=V.useRef(null),[N]=V.useState(()=>localStorage.getItem("selectedLanguage")||"en"),T=xa(N);V.useEffect(()=>{var x;(x=S.current)==null||x.scrollIntoView({behavior:"smooth"})},[m]);const A=async()=>{if(!_.trim()||p)return;const x=_.trim();y(""),v(j=>[...j,{role:"user",content:x,timestamp:Date.now()}]),g(!0);try{if(h&&f){const j=await hC(x,h,d);j.updatedDocumentation&&f(j.updatedDocumentation),v(R=>[...R,{role:"assistant",content:j.message,timestamp:Date.now()}]),g(!1);return}v(j=>[...j,{role:"assistant",content:T("assistantErrorNoDocumentation"),timestamp:Date.now()}]),g(!1)}catch(j){console.error("Assistant error:",j);const R=j.message||"Unknown error occurred";let D=`${T("assistantErrorUnknown")}: ${R}`;R.includes("API key")?D=T("assistantErrorApiKey"):R.includes("parse")||R.includes("JSON")?D=T("assistantErrorParse"):(R.includes("timeout")||R.includes("network"))&&(D=T("assistantErrorNetwork")),v(ye=>[...ye,{role:"assistant",content:D,timestamp:Date.now()}])}finally{g(!1)}};return c.jsxs("div",{className:"h-full flex flex-col bg-gradient-to-br from-slate-50 via-white to-blue-50/30 overflow-hidden",children:[c.jsxs("div",{className:"bg-white/80 backdrop-blur-xl border-b border-white/50 p-4 flex items-center justify-between flex-shrink-0 shadow-sm",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsxs("div",{className:"relative",children:[c.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-orange-500 to-red-600 rounded-xl blur opacity-30"}),c.jsx("div",{className:"relative bg-gradient-to-r from-orange-500 to-red-600 p-2 rounded-xl",children:c.jsx(Nt,{className:"w-5 h-5 text-white"})})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-bold text-slate-800 text-base",children:"AI Assistant"}),c.jsx("p",{className:"text-xs text-slate-500",children:"Documentation helper"})]})]}),m.length>1&&c.jsx("button",{onClick:()=>{confirm("Clear conversation history?")&&w()},className:"p-2 hover:bg-slate-100 rounded-lg transition-colors text-slate-500 hover:text-slate-700",title:T("assistantClearConversation"),children:c.jsx(So,{className:"w-4 h-4"})})]}),c.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 min-h-0 overscroll-contain scrollbar-thin scrollbar-thumb-slate-300 scrollbar-track-transparent",children:[m.length===0&&c.jsx("div",{className:"flex items-center justify-center h-full",children:c.jsxs("div",{className:"text-center max-w-sm",children:[c.jsxs("div",{className:"relative mx-auto w-20 h-20 mb-4",children:[c.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-orange-400 to-red-500 rounded-full blur-xl opacity-30"}),c.jsx("div",{className:"relative bg-gradient-to-r from-orange-500 to-red-600 p-4 rounded-full",children:c.jsx(Nt,{className:"w-10 h-10 text-white"})})]}),c.jsx("h4",{className:"text-lg font-semibold text-slate-700 mb-2",children:"Ready to help!"}),c.jsx("p",{className:"text-sm text-slate-500 mb-4",children:"I can help you edit and improve your documentation"}),c.jsxs("div",{className:"flex flex-wrap gap-2 justify-center",children:[c.jsx("span",{className:"px-3 py-1.5 bg-orange-50 text-orange-700 rounded-lg text-xs font-medium",children:" Edit sections"}),c.jsx("span",{className:"px-3 py-1.5 bg-red-50 text-red-700 rounded-lg text-xs font-medium",children:" Improve clarity"}),c.jsx("span",{className:"px-3 py-1.5 bg-orange-50 text-orange-700 rounded-lg text-xs font-medium",children:" Fix grammar"})]})]})}),m.map((x,j)=>c.jsx("div",{className:`flex ${x.role==="user"?"justify-end":"justify-start"} animate-in fade-in slide-in-from-bottom-2 duration-300`,children:c.jsxs("div",{className:`max-w-[85%] rounded-2xl px-4 py-3 shadow-lg ${x.role==="user"?"bg-gradient-to-br from-orange-600 to-red-600 text-white":"bg-white/90 backdrop-blur-sm border border-slate-200/50 text-slate-800"}`,children:[x.role==="assistant"&&c.jsxs("div",{className:"flex items-center gap-2 mb-2 pb-2 border-b border-slate-200/50",children:[c.jsx("div",{className:"w-6 h-6 bg-gradient-to-r from-orange-500 to-red-600 rounded-full flex items-center justify-center",children:c.jsx(Nt,{className:"w-3.5 h-3.5 text-white"})}),c.jsx("span",{className:"text-xs font-semibold text-slate-600",children:"AI Assistant"})]}),c.jsx("div",{className:"text-sm whitespace-pre-wrap leading-relaxed",children:x.content.split(`
`).map((R,D)=>{var ye;if(R.match(/^#{1,3}\s+/)){const Fe=((ye=R.match(/^#+/))==null?void 0:ye[0].length)||1,G=R.replace(/^#+\s+/,""),F=Fe===1?"text-base font-bold mt-3 mb-2 text-slate-800":Fe===2?"text-sm font-semibold mt-2 mb-1 text-slate-700":"text-sm font-medium mt-1 text-slate-600";return c.jsx("div",{className:F,children:G},D)}if(R.includes(" **Changes Made:**"))return c.jsx("div",{className:"mt-3 pt-3 border-t border-slate-300/50",children:c.jsxs("strong",{className:"font-semibold text-slate-800 flex items-center gap-2",children:[c.jsx("span",{children:""}),c.jsx("span",{children:R.replace(/\*\*/g,"")})]})},D);if(R.trim().match(/^(||||||)/))return c.jsxs("div",{className:"mt-2 font-medium text-slate-700 flex items-start gap-2",children:[c.jsx("span",{className:"text-lg",children:R.trim().charAt(0)}),c.jsx("span",{children:R.trim().substring(1).trim()})]},D);if(R.includes("**")){const Fe=R.split(/(\*\*[^*]+\*\*)/g);return c.jsx("div",{className:"my-1",children:Fe.map((G,F)=>G.startsWith("**")&&G.endsWith("**")?c.jsx("strong",{className:"font-semibold text-slate-900",children:G.slice(2,-2)},F):c.jsx("span",{children:G},F))},D)}return R.trim().startsWith("")||R.trim().startsWith("-")?c.jsxs("div",{className:"ml-4 text-slate-700 my-1 flex items-start gap-2",children:[c.jsx("span",{className:"text-orange-500 mt-1 font-bold",children:""}),c.jsx("span",{children:R.trim().substring(1).trim()})]},D):c.jsx("div",{className:"my-1 text-slate-700",children:R||""},D)})})]})},j)),p&&c.jsx("div",{className:"flex justify-start animate-in fade-in",children:c.jsx("div",{className:"bg-white/90 backdrop-blur-sm border border-slate-200/50 rounded-2xl px-4 py-3 shadow-lg",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsxs("div",{className:"flex gap-1",children:[c.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full animate-bounce"}),c.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),c.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Nt,{className:"w-4 h-4 text-orange-600 animate-pulse"}),c.jsx("span",{className:"text-sm font-medium text-slate-700",children:"AI is thinking..."})]})]})})}),c.jsx("div",{ref:S})]}),c.jsxs("div",{className:"p-4 bg-white/80 backdrop-blur-xl border-t border-white/50 flex-shrink-0 shadow-lg",children:[c.jsxs("div",{className:"flex gap-2",children:[c.jsx("div",{className:"flex-1 relative",children:c.jsx("input",{type:"text",value:_,onChange:x=>y(x.target.value),onKeyPress:x=>{x.key==="Enter"&&!x.shiftKey&&!p&&_.trim()&&(x.preventDefault(),A())},placeholder:T(p?"assistantPlaceholderLoading":"assistantPlaceholderReady"),className:"w-full px-4 py-3 bg-white border-2 border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500 disabled:bg-slate-50 disabled:cursor-not-allowed transition-all text-sm",disabled:p})}),c.jsx("button",{onClick:A,disabled:p||!_.trim(),className:"px-5 py-3 bg-gradient-to-r from-orange-600 to-red-600 text-white rounded-xl hover:shadow-xl hover:scale-105 active:scale-95 transition-all disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100 flex items-center gap-2 font-medium shadow-lg",title:_.trim()?T("assistantTitleSend"):T("assistantTitleType"),children:p?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-white border-t-transparent rounded-full"}),c.jsx("span",{className:"text-sm hidden sm:inline",children:"Generating..."})]}):c.jsxs(c.Fragment,{children:[c.jsx(rC,{className:"w-4 h-4"}),c.jsx("span",{className:"hidden sm:inline text-sm",children:"Send"})]})})]}),c.jsxs("div",{className:"mt-2 text-xs text-slate-500 flex items-center gap-4 flex-wrap",children:[c.jsxs("span",{className:"flex items-center gap-1",children:[c.jsx("span",{children:""}),c.jsx("span",{children:"Be specific for better results"})]}),c.jsxs("span",{className:"hidden sm:inline flex items-center gap-1",children:[c.jsx("span",{children:""}),c.jsx("span",{children:"Press Enter to send"})]})]})]})]})}async function hC(t,e,n="gpt-4o-mini"){const{callLangChain:r}=await Pb(async()=>{const{callLangChain:i}=await Promise.resolve().then(()=>RM);return{callLangChain:i}},void 0),s=`You are a helpful AI assistant specialized in editing and improving documentation. Your role is to help users edit, improve, and refine their documentation text.

YOUR CAPABILITIES:
- Rewrite sections for better clarity
- Improve grammar, spelling, and style
- Add missing information
- Remove unnecessary content
- Restructure documentation for better flow
- Format text properly
- Make content more professional and readable

YOUR APPROACH:
- Preserve the original structure and meaning
- Make improvements while keeping the user's intent
- Be clear about what changes you made
- Maintain markdown formatting
- Keep technical accuracy`,a=`The user wants to edit their documentation. Here's their request:

"${t}"

Current documentation:
\`\`\`
${e}
\`\`\`

Please:
1. Understand what the user wants to change
2. Edit the documentation accordingly
3. Return the complete updated documentation
4. Explain briefly what you changed

Return your response in this format:
<explanation>
Brief explanation of what you changed
</explanation>

<documentation>
[Complete updated documentation here]
</documentation>`;try{const i=await r(a,s,n,.7),o=i.match(/<explanation>([\s\S]*?)<\/explanation>/),l=i.match(/<documentation>([\s\S]*?)<\/documentation>/),u=o?o[1].trim():"I've updated your documentation.",d=l?l[1].trim():e;return{message:u,updatedDocumentation:d}}catch(i){return{message:`Error editing documentation: ${i.message}`,updatedDocumentation:e}}}function dd(t){const e=[/^https?:\/\/github\.com\/([^\/]+)\/([^\/]+)(?:\/tree\/([^\/]+))?/,/^github\.com\/([^\/]+)\/([^\/]+)(?:\/tree\/([^\/]+))?/,/^([^\/]+)\/([^\/]+)$/];for(const n of e){const r=t.trim().match(n);if(r)return{owner:r[1],repo:r[2],branch:r[3]||"main"}}return null}function fC(t){try{localStorage.setItem("github_token",t),console.log("GitHub token stored successfully")}catch(e){throw console.error("Failed to store GitHub token:",e),new Error("Could not store GitHub token in localStorage")}}function xt(){try{const t=localStorage.getItem("github_token");if(t)return t}catch{console.warn("Could not access localStorage for GitHub token")}return null}async function Ft(t,e,n="",r="main",s){try{const a=s||xt(),i={Accept:"application/vnd.github.v3+json"};a&&(i.Authorization=`token ${a}`);const o=n?`contents/${n}`:"contents",l=`https://api.github.com/repos/${t}/${e}/${o}?ref=${r}`,u=await fetch(l,{headers:i});if(!u.ok){if(u.status===404)return[];throw new Error(`Failed to list contents: ${u.status} ${u.statusText}`)}const d=await u.json();return Array.isArray(d)?d.map(h=>({name:h.name,type:h.type==="file"?"file":"dir",path:h.path,size:h.size})):d.type==="file"?[{name:d.name,type:"file",path:d.path,size:d.size}]:[]}catch(a){throw console.error("Error listing GitHub contents:",a),new Error(`Failed to list repository contents: ${a.message}`)}}async function ra(t,e,n,r="main",s){try{const a=s||xt(),i=`https://raw.githubusercontent.com/${t}/${e}/${r}/${n}`;console.log("Fetching GitHub file:",i);const o={Accept:"application/json, text/plain, */*"};a&&(o.Authorization=`token ${a}`);const l=await fetch(i,{method:"GET",headers:o});if(console.log("GitHub file response status:",l.status,l.statusText),!l.ok){if(l.status===404)return r==="master"?(console.log("Trying main branch instead of master"),ra(t,e,n,"main",s)):(console.log(`File not found: ${n} (404)`),null);throw l.status===403?new Error("Rate limited or repository is private. Try using a GitHub personal access token."):new Error(`Failed to fetch file: ${l.status} ${l.statusText}`)}const u=await l.text();return console.log(`Successfully fetched ${n}, length: ${u.length}`),u}catch(a){throw console.error("Error fetching GitHub file:",a),a.message?a:new Error(`Network error: ${a.message||"Failed to fetch from GitHub"}`)}}async function $b(t){const e=xt();if(!e)throw new Error("GitHub token is required.");const{visibility:n="all",affiliation:r,perPage:s=100,page:a=1}=t||{},i={Accept:"application/vnd.github.v3+json",Authorization:`token ${e}`},o=new URLSearchParams({per_page:s.toString(),page:a.toString()});n!=="all"&&o.append("visibility",n),r&&o.append("affiliation",r);try{const l=`https://api.github.com/user/repos?${o.toString()}`,u=await fetch(l,{headers:i});if(!u.ok)throw u.status===401?new Error("Invalid or expired GitHub token. Please check your token."):u.status===403?new Error("Rate limited or insufficient permissions. Please check your token permissions."):new Error(`Failed to fetch repositories: ${u.status} ${u.statusText}`);return(await u.json()).map(h=>({id:h.id,name:h.name,fullName:h.full_name,owner:h.owner.login,private:h.private,htmlUrl:h.html_url,description:h.description||void 0,defaultBranch:h.default_branch||"main",lastPushedAt:h.pushed_at||void 0,language:h.language||void 0}))}catch(l){throw console.error("Error fetching user repositories:",l),l.message?l:new Error(`Failed to fetch repositories: ${l.message||"Unknown error"}`)}}async function mC(t,e,n,r="main",s){const a=s||xt();if(!a)throw new Error("GitHub token is required for file operations.");const i={Accept:"application/vnd.github.v3+json",Authorization:`token ${a}`};try{const o=`https://api.github.com/repos/${t}/${e}/contents/${n}?ref=${r}`,l=await fetch(o,{headers:i});if(l.status===404)return null;if(!l.ok)throw new Error(`Failed to get file SHA: ${l.status} ${l.statusText}`);return(await l.json()).sha||null}catch(o){throw console.error("Error getting file SHA:",o),o.message&&o.message.includes("Failed to get file SHA")?o:new Error(`Failed to get file SHA: ${o.message||"Unknown error"}`)}}async function cm(t,e,n,r,s,a="main",i,o){const l=i||xt();if(!l)throw new Error("GitHub token is required for file operations.");const u=await mC(t,e,n,a,l),d=btoa(unescape(encodeURIComponent(r))),h={Accept:"application/vnd.github.v3+json",Authorization:`token ${l}`,"Content-Type":"application/json"},f={message:s,content:d,branch:a};u&&(f.sha=u);try{const m=`https://api.github.com/repos/${t}/${e}/contents/${n}`,v=await fetch(m,{method:"PUT",headers:h,body:JSON.stringify(f)});if(!v.ok){const _=await v.json().catch(()=>({}));throw v.status===409?new Error("File was modified by another commit. Please try again."):v.status===403?new Error("Insufficient permissions. Token needs repo scope."):new Error(`Failed to create/update file: ${v.status} ${v.statusText}. ${_.message||""}`)}const w=await v.json();return{commit:{sha:w.commit.sha,html_url:w.commit.html_url}}}catch(m){throw console.error("Error creating/updating file:",m),m.message&&m.message.includes("Failed to create/update file")?m:new Error(`Failed to create/update file: ${m.message||"Unknown error"}`)}}async function X0(t,e,n="main",r){var i;const s=r||xt();if(!s)throw new Error("GitHub token is required to check commits.");const a={Accept:"application/vnd.github.v3+json",Authorization:`token ${s}`};try{const o=`https://api.github.com/repos/${t}/${e}/git/ref/heads/${n}`,l=await fetch(o,{headers:a});if(!l.ok)throw new Error(`Failed to get branch ref: ${l.status} ${l.statusText}`);return((i=(await l.json()).object)==null?void 0:i.sha)||null}catch(o){throw console.error("Error getting latest commit SHA:",o),new Error(`Failed to get latest commit SHA: ${o.message||"Unknown error"}`)}}async function pC(t,e,n,r){var i,o,l;const s=r||xt();if(!s)throw new Error("GitHub token is required to check commits.");const a={Accept:"application/vnd.github.v3+json",Authorization:`token ${s}`};try{const u=`https://api.github.com/repos/${t}/${e}/git/commits/${n}`,d=await fetch(u,{headers:a});if(!d.ok)throw new Error(`Failed to get commit info: ${d.status} ${d.statusText}`);const h=await d.json(),f=((i=h.parents)==null?void 0:i.length)>1||!1;return{message:h.message||"",isMerge:f,author:((o=h.author)==null?void 0:o.name)||"Unknown",date:((l=h.author)==null?void 0:l.date)||new Date().toISOString()}}catch(u){throw console.error("Error getting commit info:",u),new Error(`Failed to get commit info: ${u.message||"Unknown error"}`)}}function gC({selectedRepos:t,onSelectionChange:e,onClose:n}){const[r,s]=V.useState([]),[a,i]=V.useState(!1),[o,l]=V.useState(""),[u,d]=V.useState(""),[h,f]=V.useState("all"),[m]=V.useState(()=>localStorage.getItem("selectedLanguage")||"en"),v=xa(m);V.useEffect(()=>{w()},[h]);const w=async()=>{i(!0),l("");try{const g=await $b({visibility:h,perPage:100});s(g)}catch(g){l(g.message||"Failed to load repositories"),console.error("Error loading repos:",g)}finally{i(!1)}},_=g=>{const S=t.some(N=>N.id===g.id);e(S?t.filter(N=>N.id!==g.id):[...t,g])},y=g=>t.some(S=>S.id===g.id),p=r.filter(g=>g.name.toLowerCase().includes(u.toLowerCase())||g.fullName.toLowerCase().includes(u.toLowerCase())||g.description&&g.description.toLowerCase().includes(u.toLowerCase()));return c.jsxs("div",{className:"bg-white rounded-lg shadow-lg border border-gray-200 p-6 max-w-4xl w-full max-h-[80vh] flex flex-col",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(_r,{className:"w-5 h-5 text-gray-700"}),c.jsx("h2",{className:"text-xl font-bold text-gray-900",children:v("selectRepositories")}),t.length>0&&c.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 rounded-full text-sm font-medium",children:[t.length," ",v("selected")]})]}),n&&c.jsx("button",{onClick:n,className:"text-gray-400 hover:text-gray-600 transition-colors",title:v("close"),children:c.jsx(So,{className:"w-5 h-5"})})]}),c.jsxs("div",{className:"mb-4 space-y-3",children:[c.jsxs("div",{className:"relative",children:[c.jsx(nC,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),c.jsx("input",{type:"text",placeholder:v("searchRepositories"),value:u,onChange:g=>d(g.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-sm text-gray-600",children:v("visibility")}),c.jsx("div",{className:"flex gap-2",children:["all","public","private"].map(g=>c.jsx("button",{onClick:()=>f(g),className:`px-3 py-1 text-sm rounded-lg transition-colors ${h===g?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:v(g==="all"?"all":g==="public"?"public":"private")},g))}),c.jsx("button",{onClick:w,disabled:a,className:"ml-auto px-3 py-1 text-sm bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors disabled:opacity-50",children:v("refresh")})]})]}),o&&c.jsxs("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg flex items-center gap-2 text-red-700",children:[c.jsx(DA,{className:"w-4 h-4"}),c.jsx("span",{className:"text-sm",children:o})]}),a&&c.jsxs("div",{className:"flex items-center justify-center py-12",children:[c.jsx(Pc,{className:"w-6 h-6 text-blue-500 animate-spin"}),c.jsx("span",{className:"ml-2 text-gray-600",children:v("loadingRepositories")})]}),!a&&!o&&c.jsx("div",{className:"flex-1 overflow-y-auto border border-gray-200 rounded-lg",children:p.length===0?c.jsx("div",{className:"p-8 text-center text-gray-500",children:v(u?"noRepositoriesMatch":"noRepositoriesFound")}):c.jsx("div",{className:"divide-y divide-gray-200",children:p.map(g=>{const S=y(g);return c.jsx("div",{onClick:()=>_(g),className:`p-4 cursor-pointer transition-colors hover:bg-gray-50 ${S?"bg-blue-50 border-l-4 border-l-blue-500":""}`,children:c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsx("div",{className:`mt-1 w-5 h-5 rounded border-2 flex items-center justify-center flex-shrink-0 ${S?"bg-blue-500 border-blue-500":"border-gray-300"}`,children:S&&c.jsx(UA,{className:"w-3 h-3 text-white"})}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("h3",{className:"font-semibold text-gray-900",children:g.name}),g.private&&c.jsx("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-600 text-xs rounded",children:v("private")}),g.language&&c.jsx("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-600 text-xs rounded",children:g.language})]}),c.jsx("p",{className:"text-sm text-gray-600 mt-1",children:g.fullName}),g.description&&c.jsx("p",{className:"text-sm text-gray-500 mt-1 line-clamp-2",children:g.description}),g.lastPushedAt&&c.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[v("lastPushed")," ",new Date(g.lastPushedAt).toLocaleDateString()]})]})]})},g.id)})})}),c.jsxs("div",{className:"mt-4 flex items-center justify-between pt-4 border-t border-gray-200",children:[c.jsx("div",{className:"text-sm text-gray-600",children:t.length>0?`${t.length} ${t.length!==1?v("repositories"):v("repository")} ${v("selected")}`:v("noRepositoriesSelected")}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{onClick:()=>e([]),disabled:t.length===0,className:"px-4 py-2 text-sm text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:v("clearAll")}),n&&c.jsx("button",{onClick:n,className:"px-4 py-2 text-sm bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:v("done")})]})]})]})}var Z=(t=>(t.DISCOVERY="discovery",t.ANALYSIS="analysis",t.QUALITY="quality",t.REFACTOR="refactor",t.PLANNING="planning",t.WRITING="writing",t.GITOPS="gitops",t.COMPLETE="complete",t))(Z||{});async function yC(t){console.log("[RepoDiscovery] Starting repository discovery...");const e={currentStep:Z.DISCOVERY,progress:{current:0,total:1,currentAgent:"RepoDiscovery"}};try{if(t.selectedRepos&&t.selectedRepos.length>0){console.log("[RepoDiscovery] Validating",t.selectedRepos.length,"selected repositories");const n=[];for(const r of t.selectedRepos)try{r.fullName&&r.owner&&r.name&&n.push(r)}catch(s){console.warn(`[RepoDiscovery] Invalid repo: ${r.fullName}`,s)}n.length>0?(e.discoveredRepos=n,e.completedSteps=new Set([Z.DISCOVERY]),e.progress={current:1,total:1,currentAgent:"RepoDiscovery"},console.log("[RepoDiscovery] Validated",n.length,"repositories")):(e.errors=new Map([["discovery","No valid repositories found"]]),console.warn("[RepoDiscovery] No valid repositories after validation"))}else try{const n=await $b({perPage:100});n&&n.length>0?(e.discoveredRepos=n,e.completedSteps=new Set([Z.DISCOVERY]),e.progress={current:1,total:1,currentAgent:"RepoDiscovery"},console.log("[RepoDiscovery] Discovered",n.length,"user repositories")):(e.errors=new Map([["discovery","No repositories found"]]),console.warn("[RepoDiscovery] No repositories found"))}catch(n){console.error("[RepoDiscovery] Failed to fetch user repos:",n),e.errors=new Map([["discovery",n.message||"Failed to discover repositories"]])}}catch(n){console.error("[RepoDiscovery] Error:",n),e.errors=new Map([["discovery",n.message||"Discovery failed"]])}return e}function Jl(t,e){return t.lc_error_code=e,t.message=`${t.message}

Troubleshooting URL: https://docs.langchain.com/oss/javascript/langchain/errors/${e}/
`,t}function _e(t,e,n,r,s){if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,n),n}function I(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)}let Lb=function(){const{crypto:t}=globalThis;if(t!=null&&t.randomUUID)return Lb=t.randomUUID.bind(t),t.randomUUID();const e=new Uint8Array(1),n=t?()=>t.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,r=>(+r^n()&15>>+r/4).toString(16))};function um(t){return typeof t=="object"&&t!==null&&("name"in t&&t.name==="AbortError"||"message"in t&&String(t.message).includes("FetchRequestCanceledException"))}const dm=t=>{if(t instanceof Error)return t;if(typeof t=="object"&&t!==null){try{if(Object.prototype.toString.call(t)==="[object Error]"){const e=new Error(t.message,t.cause?{cause:t.cause}:{});return t.stack&&(e.stack=t.stack),t.cause&&!e.cause&&(e.cause=t.cause),t.name&&(e.name=t.name),e}}catch{}try{return new Error(JSON.stringify(t))}catch{}}return new Error(t)};class ue extends Error{}class $t extends ue{constructor(e,n,r,s){super(`${$t.makeMessage(e,n,r)}`),this.status=e,this.headers=s,this.requestID=s==null?void 0:s.get("x-request-id"),this.error=n;const a=n;this.code=a==null?void 0:a.code,this.param=a==null?void 0:a.param,this.type=a==null?void 0:a.type}static makeMessage(e,n,r){const s=n!=null&&n.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):r;return e&&s?`${e} ${s}`:e?`${e} status code (no body)`:s||"(no status code or body)"}static generate(e,n,r,s){if(!e||!s)return new hd({message:r,cause:dm(n)});const a=n==null?void 0:n.error;return e===400?new Db(e,a,r,s):e===401?new Mb(e,a,r,s):e===403?new Fb(e,a,r,s):e===404?new zb(e,a,r,s):e===409?new Ub(e,a,r,s):e===422?new Bb(e,a,r,s):e===429?new Gb(e,a,r,s):e>=500?new Hb(e,a,r,s):new $t(e,a,r,s)}}class _n extends $t{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class hd extends $t{constructor({message:e,cause:n}){super(void 0,void 0,e||"Connection error.",void 0),n&&(this.cause=n)}}class fd extends hd{constructor({message:e}={}){super({message:e??"Request timed out."})}}class Db extends $t{}class Mb extends $t{}class Fb extends $t{}class zb extends $t{}class Ub extends $t{}class Bb extends $t{}class Gb extends $t{}class Hb extends $t{}class Wb extends ue{constructor(){super("Could not parse response content as the length limit was reached")}}class Vb extends ue{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}class Ji extends Error{constructor(e){super(e)}}const vC=/^[a-z][a-z0-9+.-]*:/i,_C=t=>vC.test(t);let tn=t=>(tn=Array.isArray,tn(t)),ev=tn;function qb(t){return typeof t!="object"?{}:t??{}}function wC(t){if(!t)return!0;for(const e in t)return!1;return!0}function xC(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Ah(t){return t!=null&&typeof t=="object"&&!Array.isArray(t)}const bC=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new ue(`${t} must be an integer`);if(e<0)throw new ue(`${t} must be a positive integer`);return e},SC=t=>{try{return JSON.parse(t)}catch{return}},pl=t=>new Promise(e=>setTimeout(e,t)),Ca="6.9.1",kC=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u";function EC(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const NC=()=>{var n;const t=EC();if(t==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ca,"X-Stainless-OS":nv(Deno.build.os),"X-Stainless-Arch":tv(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((n=Deno.version)==null?void 0:n.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ca,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(t==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ca,"X-Stainless-OS":nv(globalThis.process.platform??"unknown"),"X-Stainless-Arch":tv(globalThis.process.arch??"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":globalThis.process.version??"unknown"};const e=TC();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ca,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ca,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function TC(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:n}of t){const r=n.exec(navigator.userAgent);if(r){const s=r[1]||0,a=r[2]||0,i=r[3]||0;return{browser:e,version:`${s}.${a}.${i}`}}}return null}const tv=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",nv=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let rv;const AC=()=>rv??(rv=NC());function CC(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new OpenAI({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function Zb(...t){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...t)}function Kb(t){let e=Symbol.asyncIterator in t?t[Symbol.asyncIterator]():t[Symbol.iterator]();return Zb({start(){},async pull(n){const{done:r,value:s}=await e.next();r?n.close():n.enqueue(s)},async cancel(){var n;await((n=e.return)==null?void 0:n.call(e))}})}function Jb(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const n=await e.read();return n!=null&&n.done&&e.releaseLock(),n}catch(n){throw e.releaseLock(),n}},async return(){const n=e.cancel();return e.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function IC(t){var r,s;if(t===null||typeof t!="object")return;if(t[Symbol.asyncIterator]){await((s=(r=t[Symbol.asyncIterator]()).return)==null?void 0:s.call(r));return}const e=t.getReader(),n=e.cancel();e.releaseLock(),await n}const jC=({headers:t,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)}),Yb="RFC3986",Qb=t=>String(t),sv={RFC1738:t=>String(t).replace(/%20/g,"+"),RFC3986:Qb},RC="RFC1738";let hm=(t,e)=>(hm=Object.hasOwn??Function.prototype.call.bind(Object.prototype.hasOwnProperty),hm(t,e));const dr=(()=>{const t=[];for(let e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t})(),Ch=1024,OC=(t,e,n,r,s)=>{if(t.length===0)return t;let a=t;if(typeof t=="symbol"?a=Symbol.prototype.toString.call(t):typeof t!="string"&&(a=String(t)),n==="iso-8859-1")return escape(a).replace(/%u[0-9a-f]{4}/gi,function(o){return"%26%23"+parseInt(o.slice(2),16)+"%3B"});let i="";for(let o=0;o<a.length;o+=Ch){const l=a.length>=Ch?a.slice(o,o+Ch):a,u=[];for(let d=0;d<l.length;++d){let h=l.charCodeAt(d);if(h===45||h===46||h===95||h===126||h>=48&&h<=57||h>=65&&h<=90||h>=97&&h<=122||s===RC&&(h===40||h===41)){u[u.length]=l.charAt(d);continue}if(h<128){u[u.length]=dr[h];continue}if(h<2048){u[u.length]=dr[192|h>>6]+dr[128|h&63];continue}if(h<55296||h>=57344){u[u.length]=dr[224|h>>12]+dr[128|h>>6&63]+dr[128|h&63];continue}d+=1,h=65536+((h&1023)<<10|l.charCodeAt(d)&1023),u[u.length]=dr[240|h>>18]+dr[128|h>>12&63]+dr[128|h>>6&63]+dr[128|h&63]}i+=u.join("")}return i};function PC(t){return!t||typeof t!="object"?!1:!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))}function av(t,e){if(tn(t)){const n=[];for(let r=0;r<t.length;r+=1)n.push(e(t[r]));return n}return e(t)}const Xb={brackets(t){return String(t)+"[]"},comma:"comma",indices(t,e){return String(t)+"["+e+"]"},repeat(t){return String(t)}},e1=function(t,e){Array.prototype.push.apply(t,tn(e)?e:[e])};let iv;const vt={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:OC,encodeValuesOnly:!1,format:Yb,formatter:Qb,indices:!1,serializeDate(t){return(iv??(iv=Function.prototype.call.bind(Date.prototype.toISOString)))(t)},skipNulls:!1,strictNullHandling:!1};function $C(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t=="symbol"||typeof t=="bigint"}const Ih={};function t1(t,e,n,r,s,a,i,o,l,u,d,h,f,m,v,w,_,y){let p=t,g=y,S=0,N=!1;for(;(g=g.get(Ih))!==void 0&&!N;){const R=g.get(t);if(S+=1,typeof R<"u"){if(R===S)throw new RangeError("Cyclic object value");N=!0}typeof g.get(Ih)>"u"&&(S=0)}if(typeof u=="function"?p=u(e,p):p instanceof Date?p=f==null?void 0:f(p):n==="comma"&&tn(p)&&(p=av(p,function(R){return R instanceof Date?f==null?void 0:f(R):R})),p===null){if(a)return l&&!w?l(e,vt.encoder,_,"key",m):e;p=""}if($C(p)||PC(p)){if(l){const R=w?e:l(e,vt.encoder,_,"key",m);return[(v==null?void 0:v(R))+"="+(v==null?void 0:v(l(p,vt.encoder,_,"value",m)))]}return[(v==null?void 0:v(e))+"="+(v==null?void 0:v(String(p)))]}const T=[];if(typeof p>"u")return T;let A;if(n==="comma"&&tn(p))w&&l&&(p=av(p,l)),A=[{value:p.length>0?p.join(",")||null:void 0}];else if(tn(u))A=u;else{const R=Object.keys(p);A=d?R.sort(d):R}const x=o?String(e).replace(/\./g,"%2E"):String(e),j=r&&tn(p)&&p.length===1?x+"[]":x;if(s&&tn(p)&&p.length===0)return j+"[]";for(let R=0;R<A.length;++R){const D=A[R],ye=typeof D=="object"&&typeof D.value<"u"?D.value:p[D];if(i&&ye===null)continue;const Fe=h&&o?D.replace(/\./g,"%2E"):D,G=tn(p)?typeof n=="function"?n(j,Fe):j:j+(h?"."+Fe:"["+Fe+"]");y.set(t,S);const F=new WeakMap;F.set(Ih,y),e1(T,t1(ye,G,n,r,s,a,i,o,n==="comma"&&w&&tn(p)?null:l,u,d,h,f,m,v,w,_,F))}return T}function LC(t=vt){if(typeof t.allowEmptyArrays<"u"&&typeof t.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof t.encodeDotInKeys<"u"&&typeof t.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(t.encoder!==null&&typeof t.encoder<"u"&&typeof t.encoder!="function")throw new TypeError("Encoder has to be a function.");const e=t.charset||vt.charset;if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let n=Yb;if(typeof t.format<"u"){if(!hm(sv,t.format))throw new TypeError("Unknown format option provided.");n=t.format}const r=sv[n];let s=vt.filter;(typeof t.filter=="function"||tn(t.filter))&&(s=t.filter);let a;if(t.arrayFormat&&t.arrayFormat in Xb?a=t.arrayFormat:"indices"in t?a=t.indices?"indices":"repeat":a=vt.arrayFormat,"commaRoundTrip"in t&&typeof t.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const i=typeof t.allowDots>"u"?t.encodeDotInKeys?!0:vt.allowDots:!!t.allowDots;return{addQueryPrefix:typeof t.addQueryPrefix=="boolean"?t.addQueryPrefix:vt.addQueryPrefix,allowDots:i,allowEmptyArrays:typeof t.allowEmptyArrays=="boolean"?!!t.allowEmptyArrays:vt.allowEmptyArrays,arrayFormat:a,charset:e,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:vt.charsetSentinel,commaRoundTrip:!!t.commaRoundTrip,delimiter:typeof t.delimiter>"u"?vt.delimiter:t.delimiter,encode:typeof t.encode=="boolean"?t.encode:vt.encode,encodeDotInKeys:typeof t.encodeDotInKeys=="boolean"?t.encodeDotInKeys:vt.encodeDotInKeys,encoder:typeof t.encoder=="function"?t.encoder:vt.encoder,encodeValuesOnly:typeof t.encodeValuesOnly=="boolean"?t.encodeValuesOnly:vt.encodeValuesOnly,filter:s,format:n,formatter:r,serializeDate:typeof t.serializeDate=="function"?t.serializeDate:vt.serializeDate,skipNulls:typeof t.skipNulls=="boolean"?t.skipNulls:vt.skipNulls,sort:typeof t.sort=="function"?t.sort:null,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:vt.strictNullHandling}}function DC(t,e={}){let n=t;const r=LC(e);let s,a;typeof r.filter=="function"?(a=r.filter,n=a("",n)):tn(r.filter)&&(a=r.filter,s=a);const i=[];if(typeof n!="object"||n===null)return"";const o=Xb[r.arrayFormat],l=o==="comma"&&r.commaRoundTrip;s||(s=Object.keys(n)),r.sort&&s.sort(r.sort);const u=new WeakMap;for(let f=0;f<s.length;++f){const m=s[f];r.skipNulls&&n[m]===null||e1(i,t1(n[m],m,o,l,r.allowEmptyArrays,r.strictNullHandling,r.skipNulls,r.encodeDotInKeys,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,u))}const d=i.join(r.delimiter);let h=r.addQueryPrefix===!0?"?":"";return r.charsetSentinel&&(r.charset==="iso-8859-1"?h+="utf8=%26%2310003%3B&":h+="utf8=%E2%9C%93&"),d.length>0?h+d:""}function MC(t){let e=0;for(const s of t)e+=s.length;const n=new Uint8Array(e);let r=0;for(const s of t)n.set(s,r),r+=s.length;return n}let ov;function eg(t){let e;return(ov??(e=new globalThis.TextEncoder,ov=e.encode.bind(e)))(t)}let lv;function cv(t){let e;return(lv??(e=new globalThis.TextDecoder,lv=e.decode.bind(e)))(t)}var fn,mn;class md{constructor(){fn.set(this,void 0),mn.set(this,void 0),_e(this,fn,new Uint8Array),_e(this,mn,null)}decode(e){if(e==null)return[];const n=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?eg(e):e;_e(this,fn,MC([I(this,fn,"f"),n]));const r=[];let s;for(;(s=FC(I(this,fn,"f"),I(this,mn,"f")))!=null;){if(s.carriage&&I(this,mn,"f")==null){_e(this,mn,s.index);continue}if(I(this,mn,"f")!=null&&(s.index!==I(this,mn,"f")+1||s.carriage)){r.push(cv(I(this,fn,"f").subarray(0,I(this,mn,"f")-1))),_e(this,fn,I(this,fn,"f").subarray(I(this,mn,"f"))),_e(this,mn,null);continue}const a=I(this,mn,"f")!==null?s.preceding-1:s.preceding,i=cv(I(this,fn,"f").subarray(0,a));r.push(i),_e(this,fn,I(this,fn,"f").subarray(s.index)),_e(this,mn,null)}return r}flush(){return I(this,fn,"f").length?this.decode(`
`):[]}}fn=new WeakMap,mn=new WeakMap;md.NEWLINE_CHARS=new Set([`
`,"\r"]);md.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function FC(t,e){for(let s=e??0;s<t.length;s++){if(t[s]===10)return{preceding:s,index:s+1,carriage:!1};if(t[s]===13)return{preceding:s,index:s+1,carriage:!0}}return null}function zC(t){for(let r=0;r<t.length-1;r++){if(t[r]===10&&t[r+1]===10||t[r]===13&&t[r+1]===13)return r+2;if(t[r]===13&&t[r+1]===10&&r+3<t.length&&t[r+2]===13&&t[r+3]===10)return r+4}return-1}const yu={off:0,error:200,warn:300,info:400,debug:500},uv=(t,e,n)=>{if(t){if(xC(yu,t))return t;jt(n).warn(`${e} was set to ${JSON.stringify(t)}, expected one of ${JSON.stringify(Object.keys(yu))}`)}};function Yi(){}function Yl(t,e,n){return!e||yu[t]>yu[n]?Yi:e[t].bind(e)}const UC={error:Yi,warn:Yi,info:Yi,debug:Yi};let dv=new WeakMap;function jt(t){const e=t.logger,n=t.logLevel??"off";if(!e)return UC;const r=dv.get(e);if(r&&r[0]===n)return r[1];const s={error:Yl("error",e,n),warn:Yl("warn",e,n),info:Yl("info",e,n),debug:Yl("debug",e,n)};return dv.set(e,[n,s]),s}const Zs=t=>(t.options&&(t.options={...t.options},delete t.options.headers),t.headers&&(t.headers=Object.fromEntries((t.headers instanceof Headers?[...t.headers]:Object.entries(t.headers)).map(([e,n])=>[e,e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":n]))),"retryOfRequestLogID"in t&&(t.retryOfRequestLogID&&(t.retryOf=t.retryOfRequestLogID),delete t.retryOfRequestLogID),t);var Gi;class wr{constructor(e,n,r){this.iterator=e,Gi.set(this,void 0),this.controller=n,_e(this,Gi,r)}static fromSSEResponse(e,n,r){let s=!1;const a=r?jt(r):console;async function*i(){if(s)throw new ue("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let o=!1;try{for await(const l of BC(e,n))if(!o){if(l.data.startsWith("[DONE]")){o=!0;continue}if(l.event===null||!l.event.startsWith("thread.")){let u;try{u=JSON.parse(l.data)}catch(d){throw a.error("Could not parse message into JSON:",l.data),a.error("From chunk:",l.raw),d}if(u&&u.error)throw new $t(void 0,u.error,void 0,e.headers);yield u}else{let u;try{u=JSON.parse(l.data)}catch(d){throw console.error("Could not parse message into JSON:",l.data),console.error("From chunk:",l.raw),d}if(l.event=="error")throw new $t(void 0,u.error,u.message,void 0);yield{event:l.event,data:u}}}o=!0}catch(l){if(um(l))return;throw l}finally{o||n.abort()}}return new wr(i,n,r)}static fromReadableStream(e,n,r){let s=!1;async function*a(){const o=new md,l=Jb(e);for await(const u of l)for(const d of o.decode(u))yield d;for(const u of o.flush())yield u}async function*i(){if(s)throw new ue("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let o=!1;try{for await(const l of a())o||l&&(yield JSON.parse(l));o=!0}catch(l){if(um(l))return;throw l}finally{o||n.abort()}}return new wr(i,n,r)}[(Gi=new WeakMap,Symbol.asyncIterator)](){return this.iterator()}tee(){const e=[],n=[],r=this.iterator(),s=a=>({next:()=>{if(a.length===0){const i=r.next();e.push(i),n.push(i)}return a.shift()}});return[new wr(()=>s(e),this.controller,I(this,Gi,"f")),new wr(()=>s(n),this.controller,I(this,Gi,"f"))]}toReadableStream(){const e=this;let n;return Zb({async start(){n=e[Symbol.asyncIterator]()},async pull(r){try{const{value:s,done:a}=await n.next();if(a)return r.close();const i=eg(JSON.stringify(s)+`
`);r.enqueue(i)}catch(s){r.error(s)}},async cancel(){var r;await((r=n.return)==null?void 0:r.call(n))}})}}async function*BC(t,e){if(!t.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new ue("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new ue("Attempted to iterate over a response with no body");const n=new HC,r=new md,s=Jb(t.body);for await(const a of GC(s))for(const i of r.decode(a)){const o=n.decode(i);o&&(yield o)}for(const a of r.flush()){const i=n.decode(a);i&&(yield i)}}async function*GC(t){let e=new Uint8Array;for await(const n of t){if(n==null)continue;const r=n instanceof ArrayBuffer?new Uint8Array(n):typeof n=="string"?eg(n):n;let s=new Uint8Array(e.length+r.length);s.set(e),s.set(r,e.length),e=s;let a;for(;(a=zC(e))!==-1;)yield e.slice(0,a),e=e.slice(a)}e.length>0&&(yield e)}class HC{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const a={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],a}if(this.chunks.push(e),e.startsWith(":"))return null;let[n,r,s]=WC(e,":");return s.startsWith(" ")&&(s=s.substring(1)),n==="event"?this.event=s:n==="data"&&this.data.push(s),null}}function WC(t,e){const n=t.indexOf(e);return n!==-1?[t.substring(0,n),e,t.substring(n+e.length)]:[t,"",""]}async function n1(t,e){const{response:n,requestLogID:r,retryOfRequestLogID:s,startTime:a}=e,i=await(async()=>{var h;if(e.options.stream)return jt(t).debug("response",n.status,n.url,n.headers,n.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(n,e.controller,t):wr.fromSSEResponse(n,e.controller,t);if(n.status===204)return null;if(e.options.__binaryResponse)return n;const o=n.headers.get("content-type"),l=(h=o==null?void 0:o.split(";")[0])==null?void 0:h.trim();if((l==null?void 0:l.includes("application/json"))||(l==null?void 0:l.endsWith("+json"))){const f=await n.json();return r1(f,n)}return await n.text()})();return jt(t).debug(`[${r}] response parsed`,Zs({retryOfRequestLogID:s,url:n.url,status:n.status,body:i,durationMs:Date.now()-a})),i}function r1(t,e){return!t||typeof t!="object"||Array.isArray(t)?t:Object.defineProperty(t,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}var Qi;class pd extends Promise{constructor(e,n,r=n1){super(s=>{s(null)}),this.responsePromise=n,this.parseResponse=r,Qi.set(this,void 0),_e(this,Qi,e)}_thenUnwrap(e){return new pd(I(this,Qi,"f"),this.responsePromise,async(n,r)=>r1(e(await this.parseResponse(n,r),r),r.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:n,request_id:n.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(I(this,Qi,"f"),e))),this.parsedPromise}then(e,n){return this.parse().then(e,n)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}Qi=new WeakMap;var Ql;class tg{constructor(e,n,r,s){Ql.set(this,void 0),_e(this,Ql,e),this.options=s,this.response=n,this.body=r}hasNextPage(){return this.getPaginatedItems().length?this.nextPageRequestOptions()!=null:!1}async getNextPage(){const e=this.nextPageRequestOptions();if(!e)throw new ue("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");return await I(this,Ql,"f").requestAPIList(this.constructor,e)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(Ql=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const n of e.getPaginatedItems())yield n}}class VC extends pd{constructor(e,n,r){super(e,n,async(s,a)=>new r(s,a.response,await n1(s,a),a.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const n of e)yield n}}class gd extends tg{constructor(e,n,r,s){super(e,n,r,s),this.data=r.data||[],this.object=r.object}getPaginatedItems(){return this.data??[]}nextPageRequestOptions(){return null}}class mt extends tg{constructor(e,n,r,s){super(e,n,r,s),this.data=r.data||[],this.has_more=r.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){var r;const e=this.getPaginatedItems(),n=(r=e[e.length-1])==null?void 0:r.id;return n?{...this.options,query:{...qb(this.options.query),after:n}}:null}}class vu extends tg{constructor(e,n,r,s){super(e,n,r,s),this.data=r.data||[],this.has_more=r.has_more||!1,this.last_id=r.last_id||""}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){const e=this.last_id;return e?{...this.options,query:{...qb(this.options.query),after:e}}:null}}const s1=()=>{var t;if(typeof File>"u"){const{process:e}=globalThis,n=typeof((t=e==null?void 0:e.versions)==null?void 0:t.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(n?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function ko(t,e,n){return s1(),new File(t,e??"unknown_file",n)}function $c(t){return(typeof t=="object"&&t!==null&&("name"in t&&t.name&&String(t.name)||"url"in t&&t.url&&String(t.url)||"filename"in t&&t.filename&&String(t.filename)||"path"in t&&t.path&&String(t.path))||"").split(/[\\/]/).pop()||void 0}const ng=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function",hv=async(t,e)=>fm(t.body)?{...t,body:await a1(t.body,e)}:t,ya=async(t,e)=>({...t,body:await a1(t.body,e)}),fv=new WeakMap;function qC(t){const e=typeof t=="function"?t:t.fetch,n=fv.get(e);if(n)return n;const r=(async()=>{try{const s="Response"in e?e.Response:(await e("data:,")).constructor,a=new FormData;return a.toString()!==await new s(a).text()}catch{return!0}})();return fv.set(e,r),r}const a1=async(t,e)=>{if(!await qC(e))throw new TypeError("The provided fetch function does not support file uploads with the current global FormData class.");const n=new FormData;return await Promise.all(Object.entries(t||{}).map(([r,s])=>mm(n,r,s))),n},i1=t=>t instanceof Blob&&"name"in t,ZC=t=>typeof t=="object"&&t!==null&&(t instanceof Response||ng(t)||i1(t)),fm=t=>{if(ZC(t))return!0;if(Array.isArray(t))return t.some(fm);if(t&&typeof t=="object"){for(const e in t)if(fm(t[e]))return!0}return!1},mm=async(t,e,n)=>{if(n!==void 0){if(n==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")t.append(e,String(n));else if(n instanceof Response)t.append(e,ko([await n.blob()],$c(n)));else if(ng(n))t.append(e,ko([await new Response(Kb(n)).blob()],$c(n)));else if(i1(n))t.append(e,n,$c(n));else if(Array.isArray(n))await Promise.all(n.map(r=>mm(t,e+"[]",r)));else if(typeof n=="object")await Promise.all(Object.entries(n).map(([r,s])=>mm(t,`${e}[${r}]`,s)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`)}},o1=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",KC=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&o1(t),JC=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function";async function YC(t,e,n){if(s1(),t=await t,KC(t))return t instanceof File?t:ko([await t.arrayBuffer()],t.name);if(JC(t)){const s=await t.blob();return e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()),ko(await pm(s),e,n)}const r=await pm(t);if(e||(e=$c(t)),!(n!=null&&n.type)){const s=r.find(a=>typeof a=="object"&&"type"in a&&a.type);typeof s=="string"&&(n={...n,type:s})}return ko(r,e,n)}async function pm(t){var n;let e=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)e.push(t);else if(o1(t))e.push(t instanceof Blob?t:await t.arrayBuffer());else if(ng(t))for await(const r of t)e.push(...await pm(r));else{const r=(n=t==null?void 0:t.constructor)==null?void 0:n.name;throw new Error(`Unexpected data type: ${typeof t}${r?`; constructor: ${r}`:""}${QC(t)}`)}return e}function QC(t){return typeof t!="object"||t===null?"":`; props: [${Object.getOwnPropertyNames(t).map(n=>`"${n}"`).join(", ")}]`}class le{constructor(e){this._client=e}}function l1(t){return t.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const mv=Object.freeze(Object.create(null)),XC=(t=l1)=>function(n,...r){if(n.length===1)return n[0];let s=!1;const a=[],i=n.reduce((d,h,f)=>{var w;/[?#]/.test(h)&&(s=!0);const m=r[f];let v=(s?encodeURIComponent:t)(""+m);return f!==r.length&&(m==null||typeof m=="object"&&m.toString===((w=Object.getPrototypeOf(Object.getPrototypeOf(m.hasOwnProperty??mv)??mv))==null?void 0:w.toString))&&(v=m+"",a.push({start:d.length+h.length,length:v.length,error:`Value of type ${Object.prototype.toString.call(m).slice(8,-1)} is not a valid path parameter`})),d+h+(f===r.length?"":v)},""),o=i.split(/[?#]/,1)[0],l=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let u;for(;(u=l.exec(o))!==null;)a.push({start:u.index,length:u[0].length,error:`Value "${u[0]}" can't be safely passed as a path parameter`});if(a.sort((d,h)=>d.start-h.start),a.length>0){let d=0;const h=a.reduce((f,m)=>{const v=" ".repeat(m.start-d),w="^".repeat(m.length);return d=m.start+m.length,f+v+w},"");throw new ue(`Path parameters result in path with invalid segments:
${a.map(f=>f.error).join(`
`)}
${i}
${h}`)}return i},z=XC(l1);let c1=class extends le{list(e,n={},r){return this._client.getAPIList(z`/chat/completions/${e}/messages`,mt,{query:n,...r})}};function _u(t){return t!==void 0&&"function"in t&&t.function!==void 0}function eI(t,e){const n={...t};return Object.defineProperties(n,{$brand:{value:"auto-parseable-response-format",enumerable:!1},$parseRaw:{value:e,enumerable:!1}}),n}function rg(t){return(t==null?void 0:t.$brand)==="auto-parseable-response-format"}function gl(t){return(t==null?void 0:t.$brand)==="auto-parseable-tool"}function tI(t,e){return!e||!u1(e)?{...t,choices:t.choices.map(n=>(d1(n.message.tool_calls),{...n,message:{...n.message,parsed:null,...n.message.tool_calls?{tool_calls:n.message.tool_calls}:void 0}}))}:sg(t,e)}function sg(t,e){const n=t.choices.map(r=>{var s;if(r.finish_reason==="length")throw new Wb;if(r.finish_reason==="content_filter")throw new Vb;return d1(r.message.tool_calls),{...r,message:{...r.message,...r.message.tool_calls?{tool_calls:((s=r.message.tool_calls)==null?void 0:s.map(a=>rI(e,a)))??void 0}:void 0,parsed:r.message.content&&!r.message.refusal?nI(e,r.message.content):null}}});return{...t,choices:n}}function nI(t,e){var n,r;return((n=t.response_format)==null?void 0:n.type)!=="json_schema"?null:((r=t.response_format)==null?void 0:r.type)==="json_schema"?"$parseRaw"in t.response_format?t.response_format.$parseRaw(e):JSON.parse(e):null}function rI(t,e){var r;const n=(r=t.tools)==null?void 0:r.find(s=>{var a;return _u(s)&&((a=s.function)==null?void 0:a.name)===e.function.name});return{...e,function:{...e.function,parsed_arguments:gl(n)?n.$parseRaw(e.function.arguments):n!=null&&n.function.strict?JSON.parse(e.function.arguments):null}}}function sI(t,e){var r;if(!t||!("tools"in t)||!t.tools)return!1;const n=(r=t.tools)==null?void 0:r.find(s=>{var a;return _u(s)&&((a=s.function)==null?void 0:a.name)===e.function.name});return _u(n)&&(gl(n)||(n==null?void 0:n.function.strict)||!1)}function u1(t){var e;return rg(t.response_format)?!0:((e=t.tools)==null?void 0:e.some(n=>gl(n)||n.type==="function"&&n.function.strict===!0))??!1}function d1(t){for(const e of t||[])if(e.type!=="function")throw new ue(`Currently only \`function\` tool calls are supported; Received \`${e.type}\``)}function aI(t){for(const e of t??[]){if(e.type!=="function")throw new ue(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new ue(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}const wu=t=>(t==null?void 0:t.role)==="assistant",h1=t=>(t==null?void 0:t.role)==="tool";var gm,Lc,Dc,Xi,eo,Mc,to,$r,no,xu,bu,Ia,f1;class ag{constructor(){gm.add(this),this.controller=new AbortController,Lc.set(this,void 0),Dc.set(this,()=>{}),Xi.set(this,()=>{}),eo.set(this,void 0),Mc.set(this,()=>{}),to.set(this,()=>{}),$r.set(this,{}),no.set(this,!1),xu.set(this,!1),bu.set(this,!1),Ia.set(this,!1),_e(this,Lc,new Promise((e,n)=>{_e(this,Dc,e,"f"),_e(this,Xi,n,"f")})),_e(this,eo,new Promise((e,n)=>{_e(this,Mc,e,"f"),_e(this,to,n,"f")})),I(this,Lc,"f").catch(()=>{}),I(this,eo,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},I(this,gm,"m",f1).bind(this))},0)}_connected(){this.ended||(I(this,Dc,"f").call(this),this._emit("connect"))}get ended(){return I(this,no,"f")}get errored(){return I(this,xu,"f")}get aborted(){return I(this,bu,"f")}abort(){this.controller.abort()}on(e,n){return(I(this,$r,"f")[e]||(I(this,$r,"f")[e]=[])).push({listener:n}),this}off(e,n){const r=I(this,$r,"f")[e];if(!r)return this;const s=r.findIndex(a=>a.listener===n);return s>=0&&r.splice(s,1),this}once(e,n){return(I(this,$r,"f")[e]||(I(this,$r,"f")[e]=[])).push({listener:n,once:!0}),this}emitted(e){return new Promise((n,r)=>{_e(this,Ia,!0),e!=="error"&&this.once("error",r),this.once(e,n)})}async done(){_e(this,Ia,!0),await I(this,eo,"f")}_emit(e,...n){if(I(this,no,"f"))return;e==="end"&&(_e(this,no,!0),I(this,Mc,"f").call(this));const r=I(this,$r,"f")[e];if(r&&(I(this,$r,"f")[e]=r.filter(s=>!s.once),r.forEach(({listener:s})=>s(...n))),e==="abort"){const s=n[0];!I(this,Ia,"f")&&!(r!=null&&r.length)&&Promise.reject(s),I(this,Xi,"f").call(this,s),I(this,to,"f").call(this,s),this._emit("end");return}if(e==="error"){const s=n[0];!I(this,Ia,"f")&&!(r!=null&&r.length)&&Promise.reject(s),I(this,Xi,"f").call(this,s),I(this,to,"f").call(this,s),this._emit("end")}}_emitFinal(){}}Lc=new WeakMap,Dc=new WeakMap,Xi=new WeakMap,eo=new WeakMap,Mc=new WeakMap,to=new WeakMap,$r=new WeakMap,no=new WeakMap,xu=new WeakMap,bu=new WeakMap,Ia=new WeakMap,gm=new WeakSet,f1=function(e){if(_e(this,xu,!0),e instanceof Error&&e.name==="AbortError"&&(e=new _n),e instanceof _n)return _e(this,bu,!0),this._emit("abort",e);if(e instanceof ue)return this._emit("error",e);if(e instanceof Error){const n=new ue(e.message);return n.cause=e,this._emit("error",n)}return this._emit("error",new ue(String(e)))};function iI(t){return typeof t.parse=="function"}var Vt,ym,Su,vm,_m,wm,m1,p1;const oI=10;class g1 extends ag{constructor(){super(...arguments),Vt.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){var r;this._chatCompletions.push(e),this._emit("chatCompletion",e);const n=(r=e.choices[0])==null?void 0:r.message;return n&&this._addMessage(n),e}_addMessage(e,n=!0){if("content"in e||(e.content=null),this.messages.push(e),n){if(this._emit("message",e),h1(e)&&e.content)this._emit("functionToolCallResult",e.content);else if(wu(e)&&e.tool_calls)for(const r of e.tool_calls)r.type==="function"&&this._emit("functionToolCall",r.function)}}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new ue("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),I(this,Vt,"m",ym).call(this)}async finalMessage(){return await this.done(),I(this,Vt,"m",Su).call(this)}async finalFunctionToolCall(){return await this.done(),I(this,Vt,"m",vm).call(this)}async finalFunctionToolCallResult(){return await this.done(),I(this,Vt,"m",_m).call(this)}async totalUsage(){return await this.done(),I(this,Vt,"m",wm).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const n=I(this,Vt,"m",Su).call(this);n&&this._emit("finalMessage",n);const r=I(this,Vt,"m",ym).call(this);r&&this._emit("finalContent",r);const s=I(this,Vt,"m",vm).call(this);s&&this._emit("finalFunctionToolCall",s);const a=I(this,Vt,"m",_m).call(this);a!=null&&this._emit("finalFunctionToolCallResult",a),this._chatCompletions.some(i=>i.usage)&&this._emit("totalUsage",I(this,Vt,"m",wm).call(this))}async _createChatCompletion(e,n,r){const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),I(this,Vt,"m",m1).call(this,n);const a=await e.chat.completions.create({...n,stream:!1},{...r,signal:this.controller.signal});return this._connected(),this._addChatCompletion(sg(a,n))}async _runChatCompletion(e,n,r){for(const s of n.messages)this._addMessage(s,!1);return await this._createChatCompletion(e,n,r)}async _runTools(e,n,r){var m,v,w;const s="tool",{tool_choice:a="auto",stream:i,...o}=n,l=typeof a!="string"&&a.type==="function"&&((m=a==null?void 0:a.function)==null?void 0:m.name),{maxChatCompletions:u=oI}=r||{},d=n.tools.map(_=>{if(gl(_)){if(!_.$callback)throw new ue("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:_.$callback,name:_.function.name,description:_.function.description||"",parameters:_.function.parameters,parse:_.$parseRaw,strict:!0}}}return _}),h={};for(const _ of d)_.type==="function"&&(h[_.function.name||_.function.function.name]=_.function);const f="tools"in n?d.map(_=>_.type==="function"?{type:"function",function:{name:_.function.name||_.function.function.name,parameters:_.function.parameters,description:_.function.description,strict:_.function.strict}}:_):void 0;for(const _ of n.messages)this._addMessage(_,!1);for(let _=0;_<u;++_){const p=(v=(await this._createChatCompletion(e,{...o,tool_choice:a,tools:f,messages:[...this.messages]},r)).choices[0])==null?void 0:v.message;if(!p)throw new ue("missing message in ChatCompletion response");if(!((w=p.tool_calls)!=null&&w.length))return;for(const g of p.tool_calls){if(g.type!=="function")continue;const S=g.id,{name:N,arguments:T}=g.function,A=h[N];if(A){if(l&&l!==N){const D=`Invalid tool_call: ${JSON.stringify(N)}. ${JSON.stringify(l)} requested. Please try again`;this._addMessage({role:s,tool_call_id:S,content:D});continue}}else{const D=`Invalid tool_call: ${JSON.stringify(N)}. Available options are: ${Object.keys(h).map(ye=>JSON.stringify(ye)).join(", ")}. Please try again`;this._addMessage({role:s,tool_call_id:S,content:D});continue}let x;try{x=iI(A)?await A.parse(T):T}catch(D){const ye=D instanceof Error?D.message:String(D);this._addMessage({role:s,tool_call_id:S,content:ye});continue}const j=await A.function(x,this),R=I(this,Vt,"m",p1).call(this,j);if(this._addMessage({role:s,tool_call_id:S,content:R}),l)return}}}}Vt=new WeakSet,ym=function(){return I(this,Vt,"m",Su).call(this).content??null},Su=function(){let e=this.messages.length;for(;e-- >0;){const n=this.messages[e];if(wu(n))return{...n,content:n.content??null,refusal:n.refusal??null}}throw new ue("stream ended without producing a ChatCompletionMessage with role=assistant")},vm=function(){var e,n;for(let r=this.messages.length-1;r>=0;r--){const s=this.messages[r];if(wu(s)&&((e=s==null?void 0:s.tool_calls)!=null&&e.length))return(n=s.tool_calls.filter(a=>a.type==="function").at(-1))==null?void 0:n.function}},_m=function(){for(let e=this.messages.length-1;e>=0;e--){const n=this.messages[e];if(h1(n)&&n.content!=null&&typeof n.content=="string"&&this.messages.some(r=>{var s;return r.role==="assistant"&&((s=r.tool_calls)==null?void 0:s.some(a=>a.type==="function"&&a.id===n.tool_call_id))}))return n.content}},wm=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:n}of this._chatCompletions)n&&(e.completion_tokens+=n.completion_tokens,e.prompt_tokens+=n.prompt_tokens,e.total_tokens+=n.total_tokens);return e},m1=function(e){if(e.n!=null&&e.n>1)throw new ue("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},p1=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class ig extends g1{static runTools(e,n,r){const s=new ig,a={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,n,a)),s}_addMessage(e,n=!0){super._addMessage(e,n),wu(e)&&e.content&&this._emit("content",e.content)}}const y1=1,v1=2,_1=4,w1=8,x1=16,b1=32,S1=64,k1=128,E1=256,N1=k1|E1,T1=x1|b1|N1|S1,A1=y1|v1|T1,C1=_1|w1,lI=A1|C1,kt={STR:y1,NUM:v1,ARR:_1,OBJ:w1,NULL:x1,BOOL:b1,NAN:S1,INFINITY:k1,MINUS_INFINITY:E1,INF:N1,SPECIAL:T1,ATOM:A1,COLLECTION:C1,ALL:lI};class cI extends Error{}class uI extends Error{}function dI(t,e=kt.ALL){if(typeof t!="string")throw new TypeError(`expecting str, got ${typeof t}`);if(!t.trim())throw new Error(`${t} is empty`);return hI(t.trim(),e)}const hI=(t,e)=>{const n=t.length;let r=0;const s=f=>{throw new cI(`${f} at position ${r}`)},a=f=>{throw new uI(`${f} at position ${r}`)},i=()=>(h(),r>=n&&s("Unexpected end of input"),t[r]==='"'?o():t[r]==="{"?l():t[r]==="["?u():t.substring(r,r+4)==="null"||kt.NULL&e&&n-r<4&&"null".startsWith(t.substring(r))?(r+=4,null):t.substring(r,r+4)==="true"||kt.BOOL&e&&n-r<4&&"true".startsWith(t.substring(r))?(r+=4,!0):t.substring(r,r+5)==="false"||kt.BOOL&e&&n-r<5&&"false".startsWith(t.substring(r))?(r+=5,!1):t.substring(r,r+8)==="Infinity"||kt.INFINITY&e&&n-r<8&&"Infinity".startsWith(t.substring(r))?(r+=8,1/0):t.substring(r,r+9)==="-Infinity"||kt.MINUS_INFINITY&e&&1<n-r&&n-r<9&&"-Infinity".startsWith(t.substring(r))?(r+=9,-1/0):t.substring(r,r+3)==="NaN"||kt.NAN&e&&n-r<3&&"NaN".startsWith(t.substring(r))?(r+=3,NaN):d()),o=()=>{const f=r;let m=!1;for(r++;r<n&&(t[r]!=='"'||m&&t[r-1]==="\\");)m=t[r]==="\\"?!m:!1,r++;if(t.charAt(r)=='"')try{return JSON.parse(t.substring(f,++r-Number(m)))}catch(v){a(String(v))}else if(kt.STR&e)try{return JSON.parse(t.substring(f,r-Number(m))+'"')}catch{return JSON.parse(t.substring(f,t.lastIndexOf("\\"))+'"')}s("Unterminated string literal")},l=()=>{r++,h();const f={};try{for(;t[r]!=="}";){if(h(),r>=n&&kt.OBJ&e)return f;const m=o();h(),r++;try{const v=i();Object.defineProperty(f,m,{value:v,writable:!0,enumerable:!0,configurable:!0})}catch(v){if(kt.OBJ&e)return f;throw v}h(),t[r]===","&&r++}}catch{if(kt.OBJ&e)return f;s("Expected '}' at end of object")}return r++,f},u=()=>{r++;const f=[];try{for(;t[r]!=="]";)f.push(i()),h(),t[r]===","&&r++}catch{if(kt.ARR&e)return f;s("Expected ']' at end of array")}return r++,f},d=()=>{if(r===0){t==="-"&&kt.NUM&e&&s("Not sure what '-' is");try{return JSON.parse(t)}catch(m){if(kt.NUM&e)try{return t[t.length-1]==="."?JSON.parse(t.substring(0,t.lastIndexOf("."))):JSON.parse(t.substring(0,t.lastIndexOf("e")))}catch{}a(String(m))}}const f=r;for(t[r]==="-"&&r++;t[r]&&!",]}".includes(t[r]);)r++;r==n&&!(kt.NUM&e)&&s("Unterminated number literal");try{return JSON.parse(t.substring(f,r))}catch{t.substring(f,r)==="-"&&kt.NUM&e&&s("Not sure what '-' is");try{return JSON.parse(t.substring(f,t.lastIndexOf("e")))}catch(v){a(String(v))}}},h=()=>{for(;r<n&&` 
\r	`.includes(t[r]);)r++};return i()},pv=t=>dI(t,kt.ALL^kt.NUM);var yt,Pr,Ea,ls,jh,Xl,Rh,Oh,Ph,ec,$h,gv;class Qo extends g1{constructor(e){super(),yt.add(this),Pr.set(this,void 0),Ea.set(this,void 0),ls.set(this,void 0),_e(this,Pr,e),_e(this,Ea,[])}get currentChatCompletionSnapshot(){return I(this,ls,"f")}static fromReadableStream(e){const n=new Qo(null);return n._run(()=>n._fromReadableStream(e)),n}static createChatCompletion(e,n,r){const s=new Qo(n);return s._run(()=>s._runChatCompletion(e,{...n,stream:!0},{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createChatCompletion(e,n,r){var i;super._createChatCompletion;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),I(this,yt,"m",jh).call(this);const a=await e.chat.completions.create({...n,stream:!0},{...r,signal:this.controller.signal});this._connected();for await(const o of a)I(this,yt,"m",Rh).call(this,o);if((i=a.controller.signal)!=null&&i.aborted)throw new _n;return this._addChatCompletion(I(this,yt,"m",ec).call(this))}async _fromReadableStream(e,n){var i;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),I(this,yt,"m",jh).call(this),this._connected();const s=wr.fromReadableStream(e,this.controller);let a;for await(const o of s)a&&a!==o.id&&this._addChatCompletion(I(this,yt,"m",ec).call(this)),I(this,yt,"m",Rh).call(this,o),a=o.id;if((i=s.controller.signal)!=null&&i.aborted)throw new _n;return this._addChatCompletion(I(this,yt,"m",ec).call(this))}[(Pr=new WeakMap,Ea=new WeakMap,ls=new WeakMap,yt=new WeakSet,jh=function(){this.ended||_e(this,ls,void 0)},Xl=function(n){let r=I(this,Ea,"f")[n.index];return r||(r={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},I(this,Ea,"f")[n.index]=r,r)},Rh=function(n){var s,a,i,o,l,u,d,h,f,m,v,w,_,y,p;if(this.ended)return;const r=I(this,yt,"m",gv).call(this,n);this._emit("chunk",n,r);for(const g of n.choices){const S=r.choices[g.index];g.delta.content!=null&&((s=S.message)==null?void 0:s.role)==="assistant"&&((a=S.message)!=null&&a.content)&&(this._emit("content",g.delta.content,S.message.content),this._emit("content.delta",{delta:g.delta.content,snapshot:S.message.content,parsed:S.message.parsed})),g.delta.refusal!=null&&((i=S.message)==null?void 0:i.role)==="assistant"&&((o=S.message)!=null&&o.refusal)&&this._emit("refusal.delta",{delta:g.delta.refusal,snapshot:S.message.refusal}),((l=g.logprobs)==null?void 0:l.content)!=null&&((u=S.message)==null?void 0:u.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(d=g.logprobs)==null?void 0:d.content,snapshot:((h=S.logprobs)==null?void 0:h.content)??[]}),((f=g.logprobs)==null?void 0:f.refusal)!=null&&((m=S.message)==null?void 0:m.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(v=g.logprobs)==null?void 0:v.refusal,snapshot:((w=S.logprobs)==null?void 0:w.refusal)??[]});const N=I(this,yt,"m",Xl).call(this,S);S.finish_reason&&(I(this,yt,"m",Ph).call(this,S),N.current_tool_call_index!=null&&I(this,yt,"m",Oh).call(this,S,N.current_tool_call_index));for(const T of g.delta.tool_calls??[])N.current_tool_call_index!==T.index&&(I(this,yt,"m",Ph).call(this,S),N.current_tool_call_index!=null&&I(this,yt,"m",Oh).call(this,S,N.current_tool_call_index)),N.current_tool_call_index=T.index;for(const T of g.delta.tool_calls??[]){const A=(_=S.message.tool_calls)==null?void 0:_[T.index];A!=null&&A.type&&((A==null?void 0:A.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(y=A.function)==null?void 0:y.name,index:T.index,arguments:A.function.arguments,parsed_arguments:A.function.parsed_arguments,arguments_delta:((p=T.function)==null?void 0:p.arguments)??""}):(A==null||A.type,void 0))}}},Oh=function(n,r){var i,o,l;if(I(this,yt,"m",Xl).call(this,n).done_tool_calls.has(r))return;const a=(i=n.message.tool_calls)==null?void 0:i[r];if(!a)throw new Error("no tool call snapshot");if(!a.type)throw new Error("tool call snapshot missing `type`");if(a.type==="function"){const u=(l=(o=I(this,Pr,"f"))==null?void 0:o.tools)==null?void 0:l.find(d=>_u(d)&&d.function.name===a.function.name);this._emit("tool_calls.function.arguments.done",{name:a.function.name,index:r,arguments:a.function.arguments,parsed_arguments:gl(u)?u.$parseRaw(a.function.arguments):u!=null&&u.function.strict?JSON.parse(a.function.arguments):null})}else a.type},Ph=function(n){var s,a;const r=I(this,yt,"m",Xl).call(this,n);if(n.message.content&&!r.content_done){r.content_done=!0;const i=I(this,yt,"m",$h).call(this);this._emit("content.done",{content:n.message.content,parsed:i?i.$parseRaw(n.message.content):null})}n.message.refusal&&!r.refusal_done&&(r.refusal_done=!0,this._emit("refusal.done",{refusal:n.message.refusal})),(s=n.logprobs)!=null&&s.content&&!r.logprobs_content_done&&(r.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:n.logprobs.content})),(a=n.logprobs)!=null&&a.refusal&&!r.logprobs_refusal_done&&(r.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:n.logprobs.refusal}))},ec=function(){if(this.ended)throw new ue("stream has ended, this shouldn't happen");const n=I(this,ls,"f");if(!n)throw new ue("request ended without sending any chunks");return _e(this,ls,void 0),_e(this,Ea,[]),fI(n,I(this,Pr,"f"))},$h=function(){var r;const n=(r=I(this,Pr,"f"))==null?void 0:r.response_format;return rg(n)?n:null},gv=function(n){var r,s,a,i;let o=I(this,ls,"f");const{choices:l,...u}=n;o?Object.assign(o,u):o=_e(this,ls,{...u,choices:[]});for(const{delta:d,finish_reason:h,index:f,logprobs:m=null,...v}of n.choices){let w=o.choices[f];if(w||(w=o.choices[f]={finish_reason:h,index:f,message:{},logprobs:m,...v}),m)if(!w.logprobs)w.logprobs=Object.assign({},m);else{const{content:T,refusal:A,...x}=m;Object.assign(w.logprobs,x),T&&((r=w.logprobs).content??(r.content=[]),w.logprobs.content.push(...T)),A&&((s=w.logprobs).refusal??(s.refusal=[]),w.logprobs.refusal.push(...A))}if(h&&(w.finish_reason=h,I(this,Pr,"f")&&u1(I(this,Pr,"f")))){if(h==="length")throw new Wb;if(h==="content_filter")throw new Vb}if(Object.assign(w,v),!d)continue;const{content:_,refusal:y,function_call:p,role:g,tool_calls:S,...N}=d;if(Object.assign(w.message,N),y&&(w.message.refusal=(w.message.refusal||"")+y),g&&(w.message.role=g),p&&(w.message.function_call?(p.name&&(w.message.function_call.name=p.name),p.arguments&&((a=w.message.function_call).arguments??(a.arguments=""),w.message.function_call.arguments+=p.arguments)):w.message.function_call=p),_&&(w.message.content=(w.message.content||"")+_,!w.message.refusal&&I(this,yt,"m",$h).call(this)&&(w.message.parsed=pv(w.message.content))),S){w.message.tool_calls||(w.message.tool_calls=[]);for(const{index:T,id:A,type:x,function:j,...R}of S){const D=(i=w.message.tool_calls)[T]??(i[T]={});Object.assign(D,R),A&&(D.id=A),x&&(D.type=x),j&&(D.function??(D.function={name:j.name??"",arguments:""})),j!=null&&j.name&&(D.function.name=j.name),j!=null&&j.arguments&&(D.function.arguments+=j.arguments,sI(I(this,Pr,"f"),D)&&(D.function.parsed_arguments=pv(D.function.arguments)))}}}return o},Symbol.asyncIterator)](){const e=[],n=[];let r=!1;return this.on("chunk",s=>{const a=n.shift();a?a.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of n)s.resolve(void 0);n.length=0}),this.on("abort",s=>{r=!0;for(const a of n)a.reject(s);n.length=0}),this.on("error",s=>{r=!0;for(const a of n)a.reject(s);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((a,i)=>n.push({resolve:a,reject:i})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new wr(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function fI(t,e){const{id:n,choices:r,created:s,model:a,system_fingerprint:i,...o}=t,l={...o,id:n,choices:r.map(({message:u,finish_reason:d,index:h,logprobs:f,...m})=>{if(!d)throw new ue(`missing finish_reason for choice ${h}`);const{content:v=null,function_call:w,tool_calls:_,...y}=u,p=u.role;if(!p)throw new ue(`missing role for choice ${h}`);if(w){const{arguments:g,name:S}=w;if(g==null)throw new ue(`missing function_call.arguments for choice ${h}`);if(!S)throw new ue(`missing function_call.name for choice ${h}`);return{...m,message:{content:v,function_call:{arguments:g,name:S},role:p,refusal:u.refusal??null},finish_reason:d,index:h,logprobs:f}}return _?{...m,index:h,finish_reason:d,logprobs:f,message:{...y,role:p,content:v,refusal:u.refusal??null,tool_calls:_.map((g,S)=>{const{function:N,type:T,id:A,...x}=g,{arguments:j,name:R,...D}=N||{};if(A==null)throw new ue(`missing choices[${h}].tool_calls[${S}].id
${tc(t)}`);if(T==null)throw new ue(`missing choices[${h}].tool_calls[${S}].type
${tc(t)}`);if(R==null)throw new ue(`missing choices[${h}].tool_calls[${S}].function.name
${tc(t)}`);if(j==null)throw new ue(`missing choices[${h}].tool_calls[${S}].function.arguments
${tc(t)}`);return{...x,id:A,type:T,function:{...D,name:R,arguments:j}}})}}:{...m,message:{...y,content:v,role:p,refusal:u.refusal??null},finish_reason:d,index:h,logprobs:f}}),created:s,model:a,object:"chat.completion",...i?{system_fingerprint:i}:{}};return tI(l,e)}function tc(t){return JSON.stringify(t)}class ku extends Qo{static fromReadableStream(e){const n=new ku(null);return n._run(()=>n._fromReadableStream(e)),n}static runTools(e,n,r){const s=new ku(n),a={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,n,a)),s}}let og=class extends le{constructor(){super(...arguments),this.messages=new c1(this._client)}create(e,n){return this._client.post("/chat/completions",{body:e,...n,stream:e.stream??!1})}retrieve(e,n){return this._client.get(z`/chat/completions/${e}`,n)}update(e,n,r){return this._client.post(z`/chat/completions/${e}`,{body:n,...r})}list(e={},n){return this._client.getAPIList("/chat/completions",mt,{query:e,...n})}delete(e,n){return this._client.delete(z`/chat/completions/${e}`,n)}parse(e,n){return aI(e.tools),this._client.chat.completions.create(e,{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"chat.completions.parse"}})._thenUnwrap(r=>sg(r,e))}runTools(e,n){return e.stream?ku.runTools(this._client,e,n):ig.runTools(this._client,e,n)}stream(e,n){return Qo.createChatCompletion(this._client,e,n)}};og.Messages=c1;class lg extends le{constructor(){super(...arguments),this.completions=new og(this._client)}}lg.Completions=og;const I1=Symbol("brand.privateNullableHeaders");function*mI(t){if(!t)return;if(I1 in t){const{values:r,nulls:s}=t;yield*r.entries();for(const a of s)yield[a,null];return}let e=!1,n;t instanceof Headers?n=t.entries():ev(t)?n=t:(e=!0,n=Object.entries(t??{}));for(let r of n){const s=r[0];if(typeof s!="string")throw new TypeError("expected header name to be a string");const a=ev(r[1])?r[1]:[r[1]];let i=!1;for(const o of a)o!==void 0&&(e&&!i&&(i=!0,yield[s,null]),yield[s,o])}}const ne=t=>{const e=new Headers,n=new Set;for(const r of t){const s=new Set;for(const[a,i]of mI(r)){const o=a.toLowerCase();s.has(o)||(e.delete(a),s.add(o)),i===null?(e.delete(a),n.add(o)):(e.append(a,i),n.delete(o))}}return{[I1]:!0,values:e,nulls:n}};class j1 extends le{create(e,n){return this._client.post("/audio/speech",{body:e,...n,headers:ne([{Accept:"application/octet-stream"},n==null?void 0:n.headers]),__binaryResponse:!0})}}class R1 extends le{create(e,n){return this._client.post("/audio/transcriptions",ya({body:e,...n,stream:e.stream??!1,__metadata:{model:e.model}},this._client))}}class O1 extends le{create(e,n){return this._client.post("/audio/translations",ya({body:e,...n,__metadata:{model:e.model}},this._client))}}class yl extends le{constructor(){super(...arguments),this.transcriptions=new R1(this._client),this.translations=new O1(this._client),this.speech=new j1(this._client)}}yl.Transcriptions=R1;yl.Translations=O1;yl.Speech=j1;class P1 extends le{create(e,n){return this._client.post("/batches",{body:e,...n})}retrieve(e,n){return this._client.get(z`/batches/${e}`,n)}list(e={},n){return this._client.getAPIList("/batches",mt,{query:e,...n})}cancel(e,n){return this._client.post(z`/batches/${e}/cancel`,n)}}class $1 extends le{create(e,n){return this._client.post("/assistants",{body:e,...n,headers:ne([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}retrieve(e,n){return this._client.get(z`/assistants/${e}`,{...n,headers:ne([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}update(e,n,r){return this._client.post(z`/assistants/${e}`,{body:n,...r,headers:ne([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}list(e={},n){return this._client.getAPIList("/assistants",mt,{query:e,...n,headers:ne([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}delete(e,n){return this._client.delete(z`/assistants/${e}`,{...n,headers:ne([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}}let L1=class extends le{create(e,n){return this._client.post("/realtime/sessions",{body:e,...n,headers:ne([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}};class D1 extends le{create(e,n){return this._client.post("/realtime/transcription_sessions",{body:e,...n,headers:ne([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}}let yd=class extends le{constructor(){super(...arguments),this.sessions=new L1(this._client),this.transcriptionSessions=new D1(this._client)}};yd.Sessions=L1;yd.TranscriptionSessions=D1;class M1 extends le{create(e,n){return this._client.post("/chatkit/sessions",{body:e,...n,headers:ne([{"OpenAI-Beta":"chatkit_beta=v1"},n==null?void 0:n.headers])})}cancel(e,n){return this._client.post(z`/chatkit/sessions/${e}/cancel`,{...n,headers:ne([{"OpenAI-Beta":"chatkit_beta=v1"},n==null?void 0:n.headers])})}}let F1=class extends le{retrieve(e,n){return this._client.get(z`/chatkit/threads/${e}`,{...n,headers:ne([{"OpenAI-Beta":"chatkit_beta=v1"},n==null?void 0:n.headers])})}list(e={},n){return this._client.getAPIList("/chatkit/threads",vu,{query:e,...n,headers:ne([{"OpenAI-Beta":"chatkit_beta=v1"},n==null?void 0:n.headers])})}delete(e,n){return this._client.delete(z`/chatkit/threads/${e}`,{...n,headers:ne([{"OpenAI-Beta":"chatkit_beta=v1"},n==null?void 0:n.headers])})}listItems(e,n={},r){return this._client.getAPIList(z`/chatkit/threads/${e}/items`,vu,{query:n,...r,headers:ne([{"OpenAI-Beta":"chatkit_beta=v1"},r==null?void 0:r.headers])})}};class vd extends le{constructor(){super(...arguments),this.sessions=new M1(this._client),this.threads=new F1(this._client)}}vd.Sessions=M1;vd.Threads=F1;class z1 extends le{create(e,n,r){return this._client.post(z`/threads/${e}/messages`,{body:n,...r,headers:ne([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}retrieve(e,n,r){const{thread_id:s}=n;return this._client.get(z`/threads/${s}/messages/${e}`,{...r,headers:ne([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}update(e,n,r){const{thread_id:s,...a}=n;return this._client.post(z`/threads/${s}/messages/${e}`,{body:a,...r,headers:ne([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}list(e,n={},r){return this._client.getAPIList(z`/threads/${e}/messages`,mt,{query:n,...r,headers:ne([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}delete(e,n,r){const{thread_id:s}=n;return this._client.delete(z`/threads/${s}/messages/${e}`,{...r,headers:ne([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}}class U1 extends le{retrieve(e,n,r){const{thread_id:s,run_id:a,...i}=n;return this._client.get(z`/threads/${s}/runs/${a}/steps/${e}`,{query:i,...r,headers:ne([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}list(e,n,r){const{thread_id:s,...a}=n;return this._client.getAPIList(z`/threads/${s}/runs/${e}/steps`,mt,{query:a,...r,headers:ne([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}}const pI=t=>{if(typeof Buffer<"u"){const e=Buffer.from(t,"base64");return Array.from(new Float32Array(e.buffer,e.byteOffset,e.length/Float32Array.BYTES_PER_ELEMENT))}else{const e=atob(t),n=e.length,r=new Uint8Array(n);for(let s=0;s<n;s++)r[s]=e.charCodeAt(s);return Array.from(new Float32Array(r.buffer))}};var Lh={};const Na=t=>{var e,n,r,s;if(typeof globalThis.process<"u")return((e=Lh==null?void 0:Lh[t])==null?void 0:e.trim())??void 0;if(typeof globalThis.Deno<"u")return(s=(r=(n=globalThis.Deno.env)==null?void 0:n.get)==null?void 0:r.call(n,t))==null?void 0:s.trim()};var Rt,sa,xm,gr,Fc,Kn,aa,Va,Xs,Eu,gn,zc,Uc,Eo,ro,so,yv,vv,_v,wv,xv,bv,Sv;class No extends ag{constructor(){super(...arguments),Rt.add(this),xm.set(this,[]),gr.set(this,{}),Fc.set(this,{}),Kn.set(this,void 0),aa.set(this,void 0),Va.set(this,void 0),Xs.set(this,void 0),Eu.set(this,void 0),gn.set(this,void 0),zc.set(this,void 0),Uc.set(this,void 0),Eo.set(this,void 0)}[(xm=new WeakMap,gr=new WeakMap,Fc=new WeakMap,Kn=new WeakMap,aa=new WeakMap,Va=new WeakMap,Xs=new WeakMap,Eu=new WeakMap,gn=new WeakMap,zc=new WeakMap,Uc=new WeakMap,Eo=new WeakMap,Rt=new WeakSet,Symbol.asyncIterator)](){const e=[],n=[];let r=!1;return this.on("event",s=>{const a=n.shift();a?a.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of n)s.resolve(void 0);n.length=0}),this.on("abort",s=>{r=!0;for(const a of n)a.reject(s);n.length=0}),this.on("error",s=>{r=!0;for(const a of n)a.reject(s);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((a,i)=>n.push({resolve:a,reject:i})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const n=new sa;return n._run(()=>n._fromReadableStream(e)),n}async _fromReadableStream(e,n){var a;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),this._connected();const s=wr.fromReadableStream(e,this.controller);for await(const i of s)I(this,Rt,"m",ro).call(this,i);if((a=s.controller.signal)!=null&&a.aborted)throw new _n;return this._addRun(I(this,Rt,"m",so).call(this))}toReadableStream(){return new wr(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,n,r,s){const a=new sa;return a._run(()=>a._runToolAssistantStream(e,n,r,{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createToolAssistantStream(e,n,r,s){var l;const a=s==null?void 0:s.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const i={...r,stream:!0},o=await e.submitToolOutputs(n,i,{...s,signal:this.controller.signal});this._connected();for await(const u of o)I(this,Rt,"m",ro).call(this,u);if((l=o.controller.signal)!=null&&l.aborted)throw new _n;return this._addRun(I(this,Rt,"m",so).call(this))}static createThreadAssistantStream(e,n,r){const s=new sa;return s._run(()=>s._threadAssistantStream(e,n,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}static createAssistantStream(e,n,r,s){const a=new sa;return a._run(()=>a._runAssistantStream(e,n,r,{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}})),a}currentEvent(){return I(this,zc,"f")}currentRun(){return I(this,Uc,"f")}currentMessageSnapshot(){return I(this,Kn,"f")}currentRunStepSnapshot(){return I(this,Eo,"f")}async finalRunSteps(){return await this.done(),Object.values(I(this,gr,"f"))}async finalMessages(){return await this.done(),Object.values(I(this,Fc,"f"))}async finalRun(){if(await this.done(),!I(this,aa,"f"))throw Error("Final run was not received.");return I(this,aa,"f")}async _createThreadAssistantStream(e,n,r){var o;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));const a={...n,stream:!0},i=await e.createAndRun(a,{...r,signal:this.controller.signal});this._connected();for await(const l of i)I(this,Rt,"m",ro).call(this,l);if((o=i.controller.signal)!=null&&o.aborted)throw new _n;return this._addRun(I(this,Rt,"m",so).call(this))}async _createAssistantStream(e,n,r,s){var l;const a=s==null?void 0:s.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const i={...r,stream:!0},o=await e.create(n,i,{...s,signal:this.controller.signal});this._connected();for await(const u of o)I(this,Rt,"m",ro).call(this,u);if((l=o.controller.signal)!=null&&l.aborted)throw new _n;return this._addRun(I(this,Rt,"m",so).call(this))}static accumulateDelta(e,n){for(const[r,s]of Object.entries(n)){if(!e.hasOwnProperty(r)){e[r]=s;continue}let a=e[r];if(a==null){e[r]=s;continue}if(r==="index"||r==="type"){e[r]=s;continue}if(typeof a=="string"&&typeof s=="string")a+=s;else if(typeof a=="number"&&typeof s=="number")a+=s;else if(Ah(a)&&Ah(s))a=this.accumulateDelta(a,s);else if(Array.isArray(a)&&Array.isArray(s)){if(a.every(i=>typeof i=="string"||typeof i=="number")){a.push(...s);continue}for(const i of s){if(!Ah(i))throw new Error(`Expected array delta entry to be an object but got: ${i}`);const o=i.index;if(o==null)throw console.error(i),new Error("Expected array delta entry to have an `index` property");if(typeof o!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${o}`);const l=a[o];l==null?a.push(i):a[o]=this.accumulateDelta(l,i)}continue}else throw Error(`Unhandled record type: ${r}, deltaValue: ${s}, accValue: ${a}`);e[r]=a}return e}_addRun(e){return e}async _threadAssistantStream(e,n,r){return await this._createThreadAssistantStream(n,e,r)}async _runAssistantStream(e,n,r,s){return await this._createAssistantStream(n,e,r,s)}async _runToolAssistantStream(e,n,r,s){return await this._createToolAssistantStream(n,e,r,s)}}sa=No,ro=function(e){if(!this.ended)switch(_e(this,zc,e),I(this,Rt,"m",_v).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":I(this,Rt,"m",Sv).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":I(this,Rt,"m",vv).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":I(this,Rt,"m",yv).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},so=function(){if(this.ended)throw new ue("stream has ended, this shouldn't happen");if(!I(this,aa,"f"))throw Error("Final run has not been received");return I(this,aa,"f")},yv=function(e){const[n,r]=I(this,Rt,"m",xv).call(this,e,I(this,Kn,"f"));_e(this,Kn,n),I(this,Fc,"f")[n.id]=n;for(const s of r){const a=n.content[s.index];(a==null?void 0:a.type)=="text"&&this._emit("textCreated",a.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,n),e.data.delta.content)for(const s of e.data.delta.content){if(s.type=="text"&&s.text){let a=s.text,i=n.content[s.index];if(i&&i.type=="text")this._emit("textDelta",a,i.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(s.index!=I(this,Va,"f")){if(I(this,Xs,"f"))switch(I(this,Xs,"f").type){case"text":this._emit("textDone",I(this,Xs,"f").text,I(this,Kn,"f"));break;case"image_file":this._emit("imageFileDone",I(this,Xs,"f").image_file,I(this,Kn,"f"));break}_e(this,Va,s.index)}_e(this,Xs,n.content[s.index])}break;case"thread.message.completed":case"thread.message.incomplete":if(I(this,Va,"f")!==void 0){const s=e.data.content[I(this,Va,"f")];if(s)switch(s.type){case"image_file":this._emit("imageFileDone",s.image_file,I(this,Kn,"f"));break;case"text":this._emit("textDone",s.text,I(this,Kn,"f"));break}}I(this,Kn,"f")&&this._emit("messageDone",e.data),_e(this,Kn,void 0)}},vv=function(e){const n=I(this,Rt,"m",wv).call(this,e);switch(_e(this,Eo,n),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const r=e.data.delta;if(r.step_details&&r.step_details.type=="tool_calls"&&r.step_details.tool_calls&&n.step_details.type=="tool_calls")for(const a of r.step_details.tool_calls)a.index==I(this,Eu,"f")?this._emit("toolCallDelta",a,n.step_details.tool_calls[a.index]):(I(this,gn,"f")&&this._emit("toolCallDone",I(this,gn,"f")),_e(this,Eu,a.index),_e(this,gn,n.step_details.tool_calls[a.index]),I(this,gn,"f")&&this._emit("toolCallCreated",I(this,gn,"f")));this._emit("runStepDelta",e.data.delta,n);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":_e(this,Eo,void 0),e.data.step_details.type=="tool_calls"&&I(this,gn,"f")&&(this._emit("toolCallDone",I(this,gn,"f")),_e(this,gn,void 0)),this._emit("runStepDone",e.data,n);break}},_v=function(e){I(this,xm,"f").push(e),this._emit("event",e)},wv=function(e){switch(e.event){case"thread.run.step.created":return I(this,gr,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let n=I(this,gr,"f")[e.data.id];if(!n)throw Error("Received a RunStepDelta before creation of a snapshot");let r=e.data;if(r.delta){const s=sa.accumulateDelta(n,r.delta);I(this,gr,"f")[e.data.id]=s}return I(this,gr,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":I(this,gr,"f")[e.data.id]=e.data;break}if(I(this,gr,"f")[e.data.id])return I(this,gr,"f")[e.data.id];throw new Error("No snapshot available")},xv=function(e,n){let r=[];switch(e.event){case"thread.message.created":return[e.data,r];case"thread.message.delta":if(!n)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let s=e.data;if(s.delta.content)for(const a of s.delta.content)if(a.index in n.content){let i=n.content[a.index];n.content[a.index]=I(this,Rt,"m",bv).call(this,a,i)}else n.content[a.index]=a,r.push(a);return[n,r];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(n)return[n,r];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},bv=function(e,n){return sa.accumulateDelta(n,e)},Sv=function(e){switch(_e(this,Uc,e.data),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":case"thread.run.incomplete":_e(this,aa,e.data),I(this,gn,"f")&&(this._emit("toolCallDone",I(this,gn,"f")),_e(this,gn,void 0));break}};let cg=class extends le{constructor(){super(...arguments),this.steps=new U1(this._client)}create(e,n,r){const{include:s,...a}=n;return this._client.post(z`/threads/${e}/runs`,{query:{include:s},body:a,...r,headers:ne([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers]),stream:n.stream??!1})}retrieve(e,n,r){const{thread_id:s}=n;return this._client.get(z`/threads/${s}/runs/${e}`,{...r,headers:ne([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}update(e,n,r){const{thread_id:s,...a}=n;return this._client.post(z`/threads/${s}/runs/${e}`,{body:a,...r,headers:ne([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}list(e,n={},r){return this._client.getAPIList(z`/threads/${e}/runs`,mt,{query:n,...r,headers:ne([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}cancel(e,n,r){const{thread_id:s}=n;return this._client.post(z`/threads/${s}/runs/${e}/cancel`,{...r,headers:ne([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}async createAndPoll(e,n,r){const s=await this.create(e,n,r);return await this.poll(s.id,{thread_id:e},r)}createAndStream(e,n,r){return No.createAssistantStream(e,this._client.beta.threads.runs,n,r)}async poll(e,n,r){var a;const s=ne([r==null?void 0:r.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":((a=r==null?void 0:r.pollIntervalMs)==null?void 0:a.toString())??void 0}]);for(;;){const{data:i,response:o}=await this.retrieve(e,n,{...r,headers:{...r==null?void 0:r.headers,...s}}).withResponse();switch(i.status){case"queued":case"in_progress":case"cancelling":let l=5e3;if(r!=null&&r.pollIntervalMs)l=r.pollIntervalMs;else{const u=o.headers.get("openai-poll-after-ms");if(u){const d=parseInt(u);isNaN(d)||(l=d)}}await pl(l);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return i}}}stream(e,n,r){return No.createAssistantStream(e,this._client.beta.threads.runs,n,r)}submitToolOutputs(e,n,r){const{thread_id:s,...a}=n;return this._client.post(z`/threads/${s}/runs/${e}/submit_tool_outputs`,{body:a,...r,headers:ne([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers]),stream:n.stream??!1})}async submitToolOutputsAndPoll(e,n,r){const s=await this.submitToolOutputs(e,n,r);return await this.poll(s.id,n,r)}submitToolOutputsStream(e,n,r){return No.createToolAssistantStream(e,this._client.beta.threads.runs,n,r)}};cg.Steps=U1;class _d extends le{constructor(){super(...arguments),this.runs=new cg(this._client),this.messages=new z1(this._client)}create(e={},n){return this._client.post("/threads",{body:e,...n,headers:ne([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}retrieve(e,n){return this._client.get(z`/threads/${e}`,{...n,headers:ne([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}update(e,n,r){return this._client.post(z`/threads/${e}`,{body:n,...r,headers:ne([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}delete(e,n){return this._client.delete(z`/threads/${e}`,{...n,headers:ne([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}createAndRun(e,n){return this._client.post("/threads/runs",{body:e,...n,headers:ne([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers]),stream:e.stream??!1})}async createAndRunPoll(e,n){const r=await this.createAndRun(e,n);return await this.runs.poll(r.id,{thread_id:r.thread_id},n)}createAndRunStream(e,n){return No.createThreadAssistantStream(e,this._client.beta.threads,n)}}_d.Runs=cg;_d.Messages=z1;class bi extends le{constructor(){super(...arguments),this.realtime=new yd(this._client),this.chatkit=new vd(this._client),this.assistants=new $1(this._client),this.threads=new _d(this._client)}}bi.Realtime=yd;bi.ChatKit=vd;bi.Assistants=$1;bi.Threads=_d;class B1 extends le{create(e,n){return this._client.post("/completions",{body:e,...n,stream:e.stream??!1})}}class G1 extends le{retrieve(e,n,r){const{container_id:s}=n;return this._client.get(z`/containers/${s}/files/${e}/content`,{...r,headers:ne([{Accept:"application/binary"},r==null?void 0:r.headers]),__binaryResponse:!0})}}let ug=class extends le{constructor(){super(...arguments),this.content=new G1(this._client)}create(e,n,r){return this._client.post(z`/containers/${e}/files`,ya({body:n,...r},this._client))}retrieve(e,n,r){const{container_id:s}=n;return this._client.get(z`/containers/${s}/files/${e}`,r)}list(e,n={},r){return this._client.getAPIList(z`/containers/${e}/files`,mt,{query:n,...r})}delete(e,n,r){const{container_id:s}=n;return this._client.delete(z`/containers/${s}/files/${e}`,{...r,headers:ne([{Accept:"*/*"},r==null?void 0:r.headers])})}};ug.Content=G1;class dg extends le{constructor(){super(...arguments),this.files=new ug(this._client)}create(e,n){return this._client.post("/containers",{body:e,...n})}retrieve(e,n){return this._client.get(z`/containers/${e}`,n)}list(e={},n){return this._client.getAPIList("/containers",mt,{query:e,...n})}delete(e,n){return this._client.delete(z`/containers/${e}`,{...n,headers:ne([{Accept:"*/*"},n==null?void 0:n.headers])})}}dg.Files=ug;class H1 extends le{create(e,n,r){const{include:s,...a}=n;return this._client.post(z`/conversations/${e}/items`,{query:{include:s},body:a,...r})}retrieve(e,n,r){const{conversation_id:s,...a}=n;return this._client.get(z`/conversations/${s}/items/${e}`,{query:a,...r})}list(e,n={},r){return this._client.getAPIList(z`/conversations/${e}/items`,vu,{query:n,...r})}delete(e,n,r){const{conversation_id:s}=n;return this._client.delete(z`/conversations/${s}/items/${e}`,r)}}class hg extends le{constructor(){super(...arguments),this.items=new H1(this._client)}create(e={},n){return this._client.post("/conversations",{body:e,...n})}retrieve(e,n){return this._client.get(z`/conversations/${e}`,n)}update(e,n,r){return this._client.post(z`/conversations/${e}`,{body:n,...r})}delete(e,n){return this._client.delete(z`/conversations/${e}`,n)}}hg.Items=H1;let W1=class extends le{create(e,n){const r=!!e.encoding_format;let s=r?e.encoding_format:"base64";r&&jt(this._client).debug("embeddings/user defined encoding_format:",e.encoding_format);const a=this._client.post("/embeddings",{body:{...e,encoding_format:s},...n});return r?a:(jt(this._client).debug("embeddings/decoding base64 embeddings from base64"),a._thenUnwrap(i=>(i&&i.data&&i.data.forEach(o=>{const l=o.embedding;o.embedding=pI(l)}),i)))}};class V1 extends le{retrieve(e,n,r){const{eval_id:s,run_id:a}=n;return this._client.get(z`/evals/${s}/runs/${a}/output_items/${e}`,r)}list(e,n,r){const{eval_id:s,...a}=n;return this._client.getAPIList(z`/evals/${s}/runs/${e}/output_items`,mt,{query:a,...r})}}class fg extends le{constructor(){super(...arguments),this.outputItems=new V1(this._client)}create(e,n,r){return this._client.post(z`/evals/${e}/runs`,{body:n,...r})}retrieve(e,n,r){const{eval_id:s}=n;return this._client.get(z`/evals/${s}/runs/${e}`,r)}list(e,n={},r){return this._client.getAPIList(z`/evals/${e}/runs`,mt,{query:n,...r})}delete(e,n,r){const{eval_id:s}=n;return this._client.delete(z`/evals/${s}/runs/${e}`,r)}cancel(e,n,r){const{eval_id:s}=n;return this._client.post(z`/evals/${s}/runs/${e}`,r)}}fg.OutputItems=V1;class mg extends le{constructor(){super(...arguments),this.runs=new fg(this._client)}create(e,n){return this._client.post("/evals",{body:e,...n})}retrieve(e,n){return this._client.get(z`/evals/${e}`,n)}update(e,n,r){return this._client.post(z`/evals/${e}`,{body:n,...r})}list(e={},n){return this._client.getAPIList("/evals",mt,{query:e,...n})}delete(e,n){return this._client.delete(z`/evals/${e}`,n)}}mg.Runs=fg;let q1=class extends le{create(e,n){return this._client.post("/files",ya({body:e,...n},this._client))}retrieve(e,n){return this._client.get(z`/files/${e}`,n)}list(e={},n){return this._client.getAPIList("/files",mt,{query:e,...n})}delete(e,n){return this._client.delete(z`/files/${e}`,n)}content(e,n){return this._client.get(z`/files/${e}/content`,{...n,headers:ne([{Accept:"application/binary"},n==null?void 0:n.headers]),__binaryResponse:!0})}async waitForProcessing(e,{pollInterval:n=5e3,maxWait:r=30*60*1e3}={}){const s=new Set(["processed","error","deleted"]),a=Date.now();let i=await this.retrieve(e);for(;!i.status||!s.has(i.status);)if(await pl(n),i=await this.retrieve(e),Date.now()-a>r)throw new fd({message:`Giving up on waiting for file ${e} to finish processing after ${r} milliseconds.`});return i}};class Z1 extends le{}let K1=class extends le{run(e,n){return this._client.post("/fine_tuning/alpha/graders/run",{body:e,...n})}validate(e,n){return this._client.post("/fine_tuning/alpha/graders/validate",{body:e,...n})}};class pg extends le{constructor(){super(...arguments),this.graders=new K1(this._client)}}pg.Graders=K1;class J1 extends le{create(e,n,r){return this._client.getAPIList(z`/fine_tuning/checkpoints/${e}/permissions`,gd,{body:n,method:"post",...r})}retrieve(e,n={},r){return this._client.get(z`/fine_tuning/checkpoints/${e}/permissions`,{query:n,...r})}delete(e,n,r){const{fine_tuned_model_checkpoint:s}=n;return this._client.delete(z`/fine_tuning/checkpoints/${s}/permissions/${e}`,r)}}let gg=class extends le{constructor(){super(...arguments),this.permissions=new J1(this._client)}};gg.Permissions=J1;class Y1 extends le{list(e,n={},r){return this._client.getAPIList(z`/fine_tuning/jobs/${e}/checkpoints`,mt,{query:n,...r})}}class yg extends le{constructor(){super(...arguments),this.checkpoints=new Y1(this._client)}create(e,n){return this._client.post("/fine_tuning/jobs",{body:e,...n})}retrieve(e,n){return this._client.get(z`/fine_tuning/jobs/${e}`,n)}list(e={},n){return this._client.getAPIList("/fine_tuning/jobs",mt,{query:e,...n})}cancel(e,n){return this._client.post(z`/fine_tuning/jobs/${e}/cancel`,n)}listEvents(e,n={},r){return this._client.getAPIList(z`/fine_tuning/jobs/${e}/events`,mt,{query:n,...r})}pause(e,n){return this._client.post(z`/fine_tuning/jobs/${e}/pause`,n)}resume(e,n){return this._client.post(z`/fine_tuning/jobs/${e}/resume`,n)}}yg.Checkpoints=Y1;class Si extends le{constructor(){super(...arguments),this.methods=new Z1(this._client),this.jobs=new yg(this._client),this.checkpoints=new gg(this._client),this.alpha=new pg(this._client)}}Si.Methods=Z1;Si.Jobs=yg;Si.Checkpoints=gg;Si.Alpha=pg;class Q1 extends le{}class vg extends le{constructor(){super(...arguments),this.graderModels=new Q1(this._client)}}vg.GraderModels=Q1;class X1 extends le{createVariation(e,n){return this._client.post("/images/variations",ya({body:e,...n},this._client))}edit(e,n){return this._client.post("/images/edits",ya({body:e,...n,stream:e.stream??!1},this._client))}generate(e,n){return this._client.post("/images/generations",{body:e,...n,stream:e.stream??!1})}}class eS extends le{retrieve(e,n){return this._client.get(z`/models/${e}`,n)}list(e){return this._client.getAPIList("/models",gd,e)}delete(e,n){return this._client.delete(z`/models/${e}`,n)}}class tS extends le{create(e,n){return this._client.post("/moderations",{body:e,...n})}}class nS extends le{accept(e,n,r){return this._client.post(z`/realtime/calls/${e}/accept`,{body:n,...r,headers:ne([{Accept:"*/*"},r==null?void 0:r.headers])})}hangup(e,n){return this._client.post(z`/realtime/calls/${e}/hangup`,{...n,headers:ne([{Accept:"*/*"},n==null?void 0:n.headers])})}refer(e,n,r){return this._client.post(z`/realtime/calls/${e}/refer`,{body:n,...r,headers:ne([{Accept:"*/*"},r==null?void 0:r.headers])})}reject(e,n={},r){return this._client.post(z`/realtime/calls/${e}/reject`,{body:n,...r,headers:ne([{Accept:"*/*"},r==null?void 0:r.headers])})}}class rS extends le{create(e,n){return this._client.post("/realtime/client_secrets",{body:e,...n})}}class wd extends le{constructor(){super(...arguments),this.clientSecrets=new rS(this._client),this.calls=new nS(this._client)}}wd.ClientSecrets=rS;wd.Calls=nS;function gI(t,e){return!e||!vI(e)?{...t,output_parsed:null,output:t.output.map(n=>n.type==="function_call"?{...n,parsed_arguments:null}:n.type==="message"?{...n,content:n.content.map(r=>({...r,parsed:null}))}:n)}:sS(t,e)}function sS(t,e){const n=t.output.map(s=>{if(s.type==="function_call")return{...s,parsed_arguments:xI(e,s)};if(s.type==="message"){const a=s.content.map(i=>i.type==="output_text"?{...i,parsed:yI(e,i.text)}:i);return{...s,content:a}}return s}),r=Object.assign({},t,{output:n});return Object.getOwnPropertyDescriptor(t,"output_text")||bm(r),Object.defineProperty(r,"output_parsed",{enumerable:!0,get(){for(const s of r.output)if(s.type==="message"){for(const a of s.content)if(a.type==="output_text"&&a.parsed!==null)return a.parsed}return null}}),r}function yI(t,e){var n,r,s,a;return((r=(n=t.text)==null?void 0:n.format)==null?void 0:r.type)!=="json_schema"?null:"$parseRaw"in((s=t.text)==null?void 0:s.format)?((a=t.text)==null?void 0:a.format).$parseRaw(e):JSON.parse(e)}function vI(t){var e;return!!rg((e=t.text)==null?void 0:e.format)}function _I(t){return(t==null?void 0:t.$brand)==="auto-parseable-tool"}function wI(t,e){return t.find(n=>n.type==="function"&&n.name===e)}function xI(t,e){const n=wI(t.tools??[],e.name);return{...e,...e,parsed_arguments:_I(n)?n.$parseRaw(e.arguments):n!=null&&n.strict?JSON.parse(e.arguments):null}}function bm(t){const e=[];for(const n of t.output)if(n.type==="message")for(const r of n.content)r.type==="output_text"&&e.push(r.text);t.output_text=e.join("")}var Ta,nc,cs,rc,kv,Ev,Nv,Tv;class _g extends ag{constructor(e){super(),Ta.add(this),nc.set(this,void 0),cs.set(this,void 0),rc.set(this,void 0),_e(this,nc,e)}static createResponse(e,n,r){const s=new _g(n);return s._run(()=>s._createOrRetrieveResponse(e,n,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createOrRetrieveResponse(e,n,r){var o;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),I(this,Ta,"m",kv).call(this);let a,i=null;"response_id"in n?(a=await e.responses.retrieve(n.response_id,{stream:!0},{...r,signal:this.controller.signal,stream:!0}),i=n.starting_after??null):a=await e.responses.create({...n,stream:!0},{...r,signal:this.controller.signal}),this._connected();for await(const l of a)I(this,Ta,"m",Ev).call(this,l,i);if((o=a.controller.signal)!=null&&o.aborted)throw new _n;return I(this,Ta,"m",Nv).call(this)}[(nc=new WeakMap,cs=new WeakMap,rc=new WeakMap,Ta=new WeakSet,kv=function(){this.ended||_e(this,cs,void 0)},Ev=function(n,r){if(this.ended)return;const s=(i,o)=>{(r==null||o.sequence_number>r)&&this._emit(i,o)},a=I(this,Ta,"m",Tv).call(this,n);switch(s("event",n),n.type){case"response.output_text.delta":{const i=a.output[n.output_index];if(!i)throw new ue(`missing output at index ${n.output_index}`);if(i.type==="message"){const o=i.content[n.content_index];if(!o)throw new ue(`missing content at index ${n.content_index}`);if(o.type!=="output_text")throw new ue(`expected content to be 'output_text', got ${o.type}`);s("response.output_text.delta",{...n,snapshot:o.text})}break}case"response.function_call_arguments.delta":{const i=a.output[n.output_index];if(!i)throw new ue(`missing output at index ${n.output_index}`);i.type==="function_call"&&s("response.function_call_arguments.delta",{...n,snapshot:i.arguments});break}default:s(n.type,n);break}},Nv=function(){if(this.ended)throw new ue("stream has ended, this shouldn't happen");const n=I(this,cs,"f");if(!n)throw new ue("request ended without sending any events");_e(this,cs,void 0);const r=bI(n,I(this,nc,"f"));return _e(this,rc,r),r},Tv=function(n){var s;let r=I(this,cs,"f");if(!r){if(n.type!=="response.created")throw new ue(`When snapshot hasn't been set yet, expected 'response.created' event, got ${n.type}`);return r=_e(this,cs,n.response),r}switch(n.type){case"response.output_item.added":{r.output.push(n.item);break}case"response.content_part.added":{const a=r.output[n.output_index];if(!a)throw new ue(`missing output at index ${n.output_index}`);const i=a.type,o=n.part;i==="message"&&o.type!=="reasoning_text"?a.content.push(o):i==="reasoning"&&o.type==="reasoning_text"&&(a.content||(a.content=[]),a.content.push(o));break}case"response.output_text.delta":{const a=r.output[n.output_index];if(!a)throw new ue(`missing output at index ${n.output_index}`);if(a.type==="message"){const i=a.content[n.content_index];if(!i)throw new ue(`missing content at index ${n.content_index}`);if(i.type!=="output_text")throw new ue(`expected content to be 'output_text', got ${i.type}`);i.text+=n.delta}break}case"response.function_call_arguments.delta":{const a=r.output[n.output_index];if(!a)throw new ue(`missing output at index ${n.output_index}`);a.type==="function_call"&&(a.arguments+=n.delta);break}case"response.reasoning_text.delta":{const a=r.output[n.output_index];if(!a)throw new ue(`missing output at index ${n.output_index}`);if(a.type==="reasoning"){const i=(s=a.content)==null?void 0:s[n.content_index];if(!i)throw new ue(`missing content at index ${n.content_index}`);if(i.type!=="reasoning_text")throw new ue(`expected content to be 'reasoning_text', got ${i.type}`);i.text+=n.delta}break}case"response.completed":{_e(this,cs,n.response);break}}return r},Symbol.asyncIterator)](){const e=[],n=[];let r=!1;return this.on("event",s=>{const a=n.shift();a?a.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of n)s.resolve(void 0);n.length=0}),this.on("abort",s=>{r=!0;for(const a of n)a.reject(s);n.length=0}),this.on("error",s=>{r=!0;for(const a of n)a.reject(s);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((a,i)=>n.push({resolve:a,reject:i})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();const e=I(this,rc,"f");if(!e)throw new ue("stream ended without producing a ChatCompletion");return e}}function bI(t,e){return gI(t,e)}class aS extends le{list(e,n={},r){return this._client.getAPIList(z`/responses/${e}/input_items`,mt,{query:n,...r})}}class iS extends le{count(e={},n){return this._client.post("/responses/input_tokens",{body:e,...n})}}class xd extends le{constructor(){super(...arguments),this.inputItems=new aS(this._client),this.inputTokens=new iS(this._client)}create(e,n){return this._client.post("/responses",{body:e,...n,stream:e.stream??!1})._thenUnwrap(r=>("object"in r&&r.object==="response"&&bm(r),r))}retrieve(e,n={},r){return this._client.get(z`/responses/${e}`,{query:n,...r,stream:(n==null?void 0:n.stream)??!1})._thenUnwrap(s=>("object"in s&&s.object==="response"&&bm(s),s))}delete(e,n){return this._client.delete(z`/responses/${e}`,{...n,headers:ne([{Accept:"*/*"},n==null?void 0:n.headers])})}parse(e,n){return this._client.responses.create(e,n)._thenUnwrap(r=>sS(r,e))}stream(e,n){return _g.createResponse(this._client,e,n)}cancel(e,n){return this._client.post(z`/responses/${e}/cancel`,n)}}xd.InputItems=aS;xd.InputTokens=iS;class oS extends le{create(e,n,r){return this._client.post(z`/uploads/${e}/parts`,ya({body:n,...r},this._client))}}class wg extends le{constructor(){super(...arguments),this.parts=new oS(this._client)}create(e,n){return this._client.post("/uploads",{body:e,...n})}cancel(e,n){return this._client.post(z`/uploads/${e}/cancel`,n)}complete(e,n,r){return this._client.post(z`/uploads/${e}/complete`,{body:n,...r})}}wg.Parts=oS;const SI=async t=>{const e=await Promise.allSettled(t),n=e.filter(s=>s.status==="rejected");if(n.length){for(const s of n)console.error(s.reason);throw new Error(`${n.length} promise(s) failed - see the above errors`)}const r=[];for(const s of e)s.status==="fulfilled"&&r.push(s.value);return r};class lS extends le{create(e,n,r){return this._client.post(z`/vector_stores/${e}/file_batches`,{body:n,...r,headers:ne([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}retrieve(e,n,r){const{vector_store_id:s}=n;return this._client.get(z`/vector_stores/${s}/file_batches/${e}`,{...r,headers:ne([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}cancel(e,n,r){const{vector_store_id:s}=n;return this._client.post(z`/vector_stores/${s}/file_batches/${e}/cancel`,{...r,headers:ne([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}async createAndPoll(e,n,r){const s=await this.create(e,n);return await this.poll(e,s.id,r)}listFiles(e,n,r){const{vector_store_id:s,...a}=n;return this._client.getAPIList(z`/vector_stores/${s}/file_batches/${e}/files`,mt,{query:a,...r,headers:ne([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}async poll(e,n,r){var a;const s=ne([r==null?void 0:r.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":((a=r==null?void 0:r.pollIntervalMs)==null?void 0:a.toString())??void 0}]);for(;;){const{data:i,response:o}=await this.retrieve(n,{vector_store_id:e},{...r,headers:s}).withResponse();switch(i.status){case"in_progress":let l=5e3;if(r!=null&&r.pollIntervalMs)l=r.pollIntervalMs;else{const u=o.headers.get("openai-poll-after-ms");if(u){const d=parseInt(u);isNaN(d)||(l=d)}}await pl(l);break;case"failed":case"cancelled":case"completed":return i}}}async uploadAndPoll(e,{files:n,fileIds:r=[]},s){if(n==null||n.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const a=(s==null?void 0:s.maxConcurrency)??5,i=Math.min(a,n.length),o=this._client,l=n.values(),u=[...r];async function d(f){for(let m of f){const v=await o.files.create({file:m,purpose:"assistants"},s);u.push(v.id)}}const h=Array(i).fill(l).map(d);return await SI(h),await this.createAndPoll(e,{file_ids:u})}}class cS extends le{create(e,n,r){return this._client.post(z`/vector_stores/${e}/files`,{body:n,...r,headers:ne([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}retrieve(e,n,r){const{vector_store_id:s}=n;return this._client.get(z`/vector_stores/${s}/files/${e}`,{...r,headers:ne([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}update(e,n,r){const{vector_store_id:s,...a}=n;return this._client.post(z`/vector_stores/${s}/files/${e}`,{body:a,...r,headers:ne([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}list(e,n={},r){return this._client.getAPIList(z`/vector_stores/${e}/files`,mt,{query:n,...r,headers:ne([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}delete(e,n,r){const{vector_store_id:s}=n;return this._client.delete(z`/vector_stores/${s}/files/${e}`,{...r,headers:ne([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}async createAndPoll(e,n,r){const s=await this.create(e,n,r);return await this.poll(e,s.id,r)}async poll(e,n,r){var a;const s=ne([r==null?void 0:r.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":((a=r==null?void 0:r.pollIntervalMs)==null?void 0:a.toString())??void 0}]);for(;;){const i=await this.retrieve(n,{vector_store_id:e},{...r,headers:s}).withResponse(),o=i.data;switch(o.status){case"in_progress":let l=5e3;if(r!=null&&r.pollIntervalMs)l=r.pollIntervalMs;else{const u=i.response.headers.get("openai-poll-after-ms");if(u){const d=parseInt(u);isNaN(d)||(l=d)}}await pl(l);break;case"failed":case"completed":return o}}}async upload(e,n,r){const s=await this._client.files.create({file:n,purpose:"assistants"},r);return this.create(e,{file_id:s.id},r)}async uploadAndPoll(e,n,r){const s=await this.upload(e,n,r);return await this.poll(e,s.id,r)}content(e,n,r){const{vector_store_id:s}=n;return this._client.getAPIList(z`/vector_stores/${s}/files/${e}/content`,gd,{...r,headers:ne([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}}class bd extends le{constructor(){super(...arguments),this.files=new cS(this._client),this.fileBatches=new lS(this._client)}create(e,n){return this._client.post("/vector_stores",{body:e,...n,headers:ne([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}retrieve(e,n){return this._client.get(z`/vector_stores/${e}`,{...n,headers:ne([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}update(e,n,r){return this._client.post(z`/vector_stores/${e}`,{body:n,...r,headers:ne([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}list(e={},n){return this._client.getAPIList("/vector_stores",mt,{query:e,...n,headers:ne([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}delete(e,n){return this._client.delete(z`/vector_stores/${e}`,{...n,headers:ne([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}search(e,n,r){return this._client.getAPIList(z`/vector_stores/${e}/search`,gd,{body:n,method:"post",...r,headers:ne([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}}bd.Files=cS;bd.FileBatches=lS;class uS extends le{create(e,n){return this._client.post("/videos",hv({body:e,...n},this._client))}retrieve(e,n){return this._client.get(z`/videos/${e}`,n)}list(e={},n){return this._client.getAPIList("/videos",vu,{query:e,...n})}delete(e,n){return this._client.delete(z`/videos/${e}`,n)}downloadContent(e,n={},r){return this._client.get(z`/videos/${e}/content`,{query:n,...r,headers:ne([{Accept:"application/binary"},r==null?void 0:r.headers]),__binaryResponse:!0})}remix(e,n,r){return this._client.post(z`/videos/${e}/remix`,hv({body:n,...r},this._client))}}var ja,dS,Bc;class hS extends le{constructor(){super(...arguments),ja.add(this)}async unwrap(e,n,r=this._client.webhookSecret,s=300){return await this.verifySignature(e,n,r,s),JSON.parse(e)}async verifySignature(e,n,r=this._client.webhookSecret,s=300){if(typeof crypto>"u"||typeof crypto.subtle.importKey!="function"||typeof crypto.subtle.verify!="function")throw new Error("Webhook signature verification is only supported when the `crypto` global is defined");I(this,ja,"m",dS).call(this,r);const a=ne([n]).values,i=I(this,ja,"m",Bc).call(this,a,"webhook-signature"),o=I(this,ja,"m",Bc).call(this,a,"webhook-timestamp"),l=I(this,ja,"m",Bc).call(this,a,"webhook-id"),u=parseInt(o,10);if(isNaN(u))throw new Ji("Invalid webhook timestamp format");const d=Math.floor(Date.now()/1e3);if(d-u>s)throw new Ji("Webhook timestamp is too old");if(u>d+s)throw new Ji("Webhook timestamp is too new");const h=i.split(" ").map(w=>w.startsWith("v1,")?w.substring(3):w),f=r.startsWith("whsec_")?Buffer.from(r.replace("whsec_",""),"base64"):Buffer.from(r,"utf-8"),m=l?`${l}.${o}.${e}`:`${o}.${e}`,v=await crypto.subtle.importKey("raw",f,{name:"HMAC",hash:"SHA-256"},!1,["verify"]);for(const w of h)try{const _=Buffer.from(w,"base64");if(await crypto.subtle.verify("HMAC",v,_,new TextEncoder().encode(m)))return}catch{continue}throw new Ji("The given webhook signature does not match the expected signature")}}ja=new WeakSet,dS=function(e){if(typeof e!="string"||e.length===0)throw new Error("The webhook secret must either be set using the env var, OPENAI_WEBHOOK_SECRET, on the client class, OpenAI({ webhookSecret: '123' }), or passed to this function")},Bc=function(e,n){if(!e)throw new Error("Headers are required");const r=e.get(n);if(r==null)throw new Error(`Missing required header: ${n}`);return r};var Sm,xg,Gc,fS;class Ae{constructor({baseURL:e=Na("OPENAI_BASE_URL"),apiKey:n=Na("OPENAI_API_KEY"),organization:r=Na("OPENAI_ORG_ID")??null,project:s=Na("OPENAI_PROJECT_ID")??null,webhookSecret:a=Na("OPENAI_WEBHOOK_SECRET")??null,...i}={}){if(Sm.add(this),Gc.set(this,void 0),this.completions=new B1(this),this.chat=new lg(this),this.embeddings=new W1(this),this.files=new q1(this),this.images=new X1(this),this.audio=new yl(this),this.moderations=new tS(this),this.models=new eS(this),this.fineTuning=new Si(this),this.graders=new vg(this),this.vectorStores=new bd(this),this.webhooks=new hS(this),this.beta=new bi(this),this.batches=new P1(this),this.uploads=new wg(this),this.responses=new xd(this),this.realtime=new wd(this),this.conversations=new hg(this),this.evals=new mg(this),this.containers=new dg(this),this.videos=new uS(this),n===void 0)throw new ue("Missing credentials. Please pass an `apiKey`, or set the `OPENAI_API_KEY` environment variable.");const o={apiKey:n,organization:r,project:s,webhookSecret:a,...i,baseURL:e||"https://api.openai.com/v1"};if(!o.dangerouslyAllowBrowser&&kC())throw new ue(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);this.baseURL=o.baseURL,this.timeout=o.timeout??xg.DEFAULT_TIMEOUT,this.logger=o.logger??console;const l="warn";this.logLevel=l,this.logLevel=uv(o.logLevel,"ClientOptions.logLevel",this)??uv(Na("OPENAI_LOG"),"process.env['OPENAI_LOG']",this)??l,this.fetchOptions=o.fetchOptions,this.maxRetries=o.maxRetries??2,this.fetch=o.fetch??CC(),_e(this,Gc,jC),this._options=o,this.apiKey=typeof n=="string"?n:"Missing Key",this.organization=r,this.project=s,this.webhookSecret=a}withOptions(e){return new this.constructor({...this._options,baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,organization:this.organization,project:this.project,webhookSecret:this.webhookSecret,...e})}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:n}){}async authHeaders(e){return ne([{Authorization:`Bearer ${this.apiKey}`}])}stringifyQuery(e){return DC(e,{arrayFormat:"brackets"})}getUserAgent(){return`${this.constructor.name}/JS ${Ca}`}defaultIdempotencyKey(){return`stainless-node-retry-${Lb()}`}makeStatusError(e,n,r,s){return $t.generate(e,n,r,s)}async _callApiKey(){const e=this._options.apiKey;if(typeof e!="function")return!1;let n;try{n=await e()}catch(r){throw r instanceof ue?r:new ue(`Failed to get token from 'apiKey' function: ${r.message}`,{cause:r})}if(typeof n!="string"||!n)throw new ue(`Expected 'apiKey' function argument to return a string but it returned ${n}`);return this.apiKey=n,!0}buildURL(e,n,r){const s=!I(this,Sm,"m",fS).call(this)&&r||this.baseURL,a=_C(e)?new URL(e):new URL(s+(s.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),i=this.defaultQuery();return wC(i)||(n={...i,...n}),typeof n=="object"&&n&&!Array.isArray(n)&&(a.search=this.stringifyQuery(n)),a.toString()}async prepareOptions(e){await this._callApiKey()}async prepareRequest(e,{url:n,options:r}){}get(e,n){return this.methodRequest("get",e,n)}post(e,n){return this.methodRequest("post",e,n)}patch(e,n){return this.methodRequest("patch",e,n)}put(e,n){return this.methodRequest("put",e,n)}delete(e,n){return this.methodRequest("delete",e,n)}methodRequest(e,n,r){return this.request(Promise.resolve(r).then(s=>({method:e,path:n,...s})))}request(e,n=null){return new pd(this,this.makeRequest(e,n,void 0))}async makeRequest(e,n,r){var y,p;const s=await e,a=s.maxRetries??this.maxRetries;n==null&&(n=a),await this.prepareOptions(s);const{req:i,url:o,timeout:l}=await this.buildRequest(s,{retryCount:a-n});await this.prepareRequest(i,{url:o,options:s});const u="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),d=r===void 0?"":`, retryOf: ${r}`,h=Date.now();if(jt(this).debug(`[${u}] sending request`,Zs({retryOfRequestLogID:r,method:s.method,url:o,options:s,headers:i.headers})),(y=s.signal)!=null&&y.aborted)throw new _n;const f=new AbortController,m=await this.fetchWithTimeout(o,i,l,f).catch(dm),v=Date.now();if(m instanceof globalThis.Error){const g=`retrying, ${n} attempts remaining`;if((p=s.signal)!=null&&p.aborted)throw new _n;const S=um(m)||/timed? ?out/i.test(String(m)+("cause"in m?String(m.cause):""));if(n)return jt(this).info(`[${u}] connection ${S?"timed out":"failed"} - ${g}`),jt(this).debug(`[${u}] connection ${S?"timed out":"failed"} (${g})`,Zs({retryOfRequestLogID:r,url:o,durationMs:v-h,message:m.message})),this.retryRequest(s,n,r??u);throw jt(this).info(`[${u}] connection ${S?"timed out":"failed"} - error; no more retries left`),jt(this).debug(`[${u}] connection ${S?"timed out":"failed"} (error; no more retries left)`,Zs({retryOfRequestLogID:r,url:o,durationMs:v-h,message:m.message})),S?new fd:new hd({cause:m})}const w=[...m.headers.entries()].filter(([g])=>g==="x-request-id").map(([g,S])=>", "+g+": "+JSON.stringify(S)).join(""),_=`[${u}${d}${w}] ${i.method} ${o} ${m.ok?"succeeded":"failed"} with status ${m.status} in ${v-h}ms`;if(!m.ok){const g=await this.shouldRetry(m);if(n&&g){const j=`retrying, ${n} attempts remaining`;return await IC(m.body),jt(this).info(`${_} - ${j}`),jt(this).debug(`[${u}] response error (${j})`,Zs({retryOfRequestLogID:r,url:m.url,status:m.status,headers:m.headers,durationMs:v-h})),this.retryRequest(s,n,r??u,m.headers)}const S=g?"error; no more retries left":"error; not retryable";jt(this).info(`${_} - ${S}`);const N=await m.text().catch(j=>dm(j).message),T=SC(N),A=T?void 0:N;throw jt(this).debug(`[${u}] response error (${S})`,Zs({retryOfRequestLogID:r,url:m.url,status:m.status,headers:m.headers,message:A,durationMs:Date.now()-h})),this.makeStatusError(m.status,T,A,m.headers)}return jt(this).info(_),jt(this).debug(`[${u}] response start`,Zs({retryOfRequestLogID:r,url:m.url,status:m.status,headers:m.headers,durationMs:v-h})),{response:m,options:s,controller:f,requestLogID:u,retryOfRequestLogID:r,startTime:h}}getAPIList(e,n,r){return this.requestAPIList(n,{method:"get",path:e,...r})}requestAPIList(e,n){const r=this.makeRequest(n,null,void 0);return new VC(this,r,e)}async fetchWithTimeout(e,n,r,s){const{signal:a,method:i,...o}=n||{};a&&a.addEventListener("abort",()=>s.abort());const l=setTimeout(()=>s.abort(),r),u=globalThis.ReadableStream&&o.body instanceof globalThis.ReadableStream||typeof o.body=="object"&&o.body!==null&&Symbol.asyncIterator in o.body,d={signal:s.signal,...u?{duplex:"half"}:{},method:"GET",...o};i&&(d.method=i.toUpperCase());try{return await this.fetch.call(void 0,e,d)}finally{clearTimeout(l)}}async shouldRetry(e){const n=e.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,n,r,s){let a;const i=s==null?void 0:s.get("retry-after-ms");if(i){const l=parseFloat(i);Number.isNaN(l)||(a=l)}const o=s==null?void 0:s.get("retry-after");if(o&&!a){const l=parseFloat(o);Number.isNaN(l)?a=Date.parse(o)-Date.now():a=l*1e3}if(!(a&&0<=a&&a<60*1e3)){const l=e.maxRetries??this.maxRetries;a=this.calculateDefaultRetryTimeoutMillis(n,l)}return await pl(a),this.makeRequest(e,n-1,r)}calculateDefaultRetryTimeoutMillis(e,n){const a=n-e,i=Math.min(.5*Math.pow(2,a),8),o=1-Math.random()*.25;return i*o*1e3}async buildRequest(e,{retryCount:n=0}={}){const r={...e},{method:s,path:a,query:i,defaultBaseURL:o}=r,l=this.buildURL(a,i,o);"timeout"in r&&bC("timeout",r.timeout),r.timeout=r.timeout??this.timeout;const{bodyHeaders:u,body:d}=this.buildBody({options:r}),h=await this.buildHeaders({options:e,method:s,bodyHeaders:u,retryCount:n});return{req:{method:s,headers:h,...r.signal&&{signal:r.signal},...globalThis.ReadableStream&&d instanceof globalThis.ReadableStream&&{duplex:"half"},...d&&{body:d},...this.fetchOptions??{},...r.fetchOptions??{}},url:l,timeout:r.timeout}}async buildHeaders({options:e,method:n,bodyHeaders:r,retryCount:s}){let a={};this.idempotencyHeader&&n!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),a[this.idempotencyHeader]=e.idempotencyKey);const i=ne([a,{Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(s),...e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{},...AC(),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project},await this.authHeaders(e),this._options.defaultHeaders,r,e.headers]);return this.validateHeaders(i),i.values}buildBody({options:{body:e,headers:n}}){if(!e)return{bodyHeaders:void 0,body:void 0};const r=ne([n]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&r.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:Kb(e)}:I(this,Gc,"f").call(this,{body:e,headers:r})}}xg=Ae,Gc=new WeakMap,Sm=new WeakSet,fS=function(){return this.baseURL!=="https://api.openai.com/v1"};Ae.OpenAI=xg;Ae.DEFAULT_TIMEOUT=6e5;Ae.OpenAIError=ue;Ae.APIError=$t;Ae.APIConnectionError=hd;Ae.APIConnectionTimeoutError=fd;Ae.APIUserAbortError=_n;Ae.NotFoundError=zb;Ae.ConflictError=Ub;Ae.RateLimitError=Gb;Ae.BadRequestError=Db;Ae.AuthenticationError=Mb;Ae.InternalServerError=Hb;Ae.PermissionDeniedError=Fb;Ae.UnprocessableEntityError=Bb;Ae.InvalidWebhookSignatureError=Ji;Ae.toFile=YC;Ae.Completions=B1;Ae.Chat=lg;Ae.Embeddings=W1;Ae.Files=q1;Ae.Images=X1;Ae.Audio=yl;Ae.Moderations=tS;Ae.Models=eS;Ae.FineTuning=Si;Ae.Graders=vg;Ae.VectorStores=bd;Ae.Webhooks=hS;Ae.Beta=bi;Ae.Batches=P1;Ae.Uploads=wg;Ae.Responses=xd;Ae.Realtime=wd;Ae.Conversations=hg;Ae.Evals=mg;Ae.Containers=dg;Ae.Videos=uS;function mS(t){if(!t||typeof t!="object")return t;let e;return t.constructor.name===fd.name&&"message"in t&&typeof t.message=="string"?(e=new Error(t.message),e.name="TimeoutError"):t.constructor.name===_n.name&&"message"in t&&typeof t.message=="string"?(e=new Error(t.message),e.name="AbortError"):"status"in t&&t.status===400&&"message"in t&&typeof t.message=="string"&&t.message.includes("tool_calls")?e=Jl(t,"INVALID_TOOL_RESULTS"):"status"in t&&t.status===401?e=Jl(t,"MODEL_AUTHENTICATION"):"status"in t&&t.status===429?e=Jl(t,"MODEL_RATE_LIMIT"):"status"in t&&t.status===404?e=Jl(t,"MODEL_NOT_FOUND"):e=t,e}var kI=Object.defineProperty,je=(t,e)=>{for(var n in e)kI(t,n,{get:e[n],enumerable:!0})};function Cr(t){return typeof t=="object"&&t!==null&&"type"in t&&typeof t.type=="string"&&"source_type"in t&&(t.source_type==="url"||t.source_type==="base64"||t.source_type==="text"||t.source_type==="id")}function bg(t){return Cr(t)&&t.source_type==="url"&&"url"in t&&typeof t.url=="string"}function Sg(t){return Cr(t)&&t.source_type==="base64"&&"data"in t&&typeof t.data=="string"}function EI(t){return Cr(t)&&t.source_type==="text"&&"text"in t&&typeof t.text=="string"}function pS(t){return Cr(t)&&t.source_type==="id"&&"id"in t&&typeof t.id=="string"}function gS(t){if(Cr(t)){if(t.source_type==="url")return{type:"image_url",image_url:{url:t.url}};if(t.source_type==="base64"){if(!t.mime_type)throw new Error("mime_type key is required for base64 data.");return{type:"image_url",image_url:{url:`data:${t.mime_type};base64,${t.data}`}}}}throw new Error("Unsupported source type. Only 'url' and 'base64' are supported.")}function km(t){const e=t.split(";")[0].split("/");if(e.length!==2)throw new Error(`Invalid mime type: "${t}" - does not match type/subtype format.`);const n=e[0].trim(),r=e[1].trim();if(n===""||r==="")throw new Error(`Invalid mime type: "${t}" - type or subtype is empty.`);const s={};for(const a of t.split(";").slice(1)){const i=a.split("=");if(i.length!==2)throw new Error(`Invalid parameter syntax in mime type: "${t}".`);const o=i[0].trim(),l=i[1].trim();if(o==="")throw new Error(`Invalid parameter syntax in mime type: "${t}".`);s[o]=l}return{type:n,subtype:r,parameters:s}}function Xo({dataUrl:t,asTypedArray:e=!1}){const n=t.match(/^data:(\w+\/\w+);base64,([A-Za-z0-9+/]+=*)$/);let r;if(n){r=n[1].toLowerCase();const s=e?Uint8Array.from(atob(n[2]),a=>a.charCodeAt(0)):n[2];return{mime_type:r,data:s}}}function kg(t,e){if(t.type==="text"){if(!e.fromStandardTextBlock)throw new Error(`Converter for ${e.providerName} does not implement \`fromStandardTextBlock\` method.`);return e.fromStandardTextBlock(t)}if(t.type==="image"){if(!e.fromStandardImageBlock)throw new Error(`Converter for ${e.providerName} does not implement \`fromStandardImageBlock\` method.`);return e.fromStandardImageBlock(t)}if(t.type==="audio"){if(!e.fromStandardAudioBlock)throw new Error(`Converter for ${e.providerName} does not implement \`fromStandardAudioBlock\` method.`);return e.fromStandardAudioBlock(t)}if(t.type==="file"){if(!e.fromStandardFileBlock)throw new Error(`Converter for ${e.providerName} does not implement \`fromStandardFileBlock\` method.`);return e.fromStandardFileBlock(t)}throw new Error(`Unable to convert content block type '${t.type}' to provider-specific format: not recognized.`)}function yS(t){return typeof t=="object"&&t!==null&&"type"in t&&"content"in t&&(typeof t.content=="string"||Array.isArray(t.content))}var NI=function(t,e){if(typeof t!="string")throw new TypeError("Expected a string");return e=typeof e>"u"?"_":e,t.replace(/([a-z\d])([A-Z])/g,"$1"+e+"$2").replace(/([A-Z]+)([A-Z][a-z\d]+)/g,"$1"+e+"$2").toLowerCase()};const TI=yw(NI);var vS={exports:{}};const AI=/[\p{Lu}]/u,CI=/[\p{Ll}]/u,Av=/^[\p{Lu}](?![\p{Lu}])/gu,_S=/([\p{Alpha}\p{N}_]|$)/u,wS=/[_.\- ]+/,II=new RegExp("^"+wS.source),Cv=new RegExp(wS.source+_S.source,"gu"),Iv=new RegExp("\\d+"+_S.source,"gu"),jI=(t,e,n)=>{let r=!1,s=!1,a=!1;for(let i=0;i<t.length;i++){const o=t[i];r&&AI.test(o)?(t=t.slice(0,i)+"-"+t.slice(i),r=!1,a=s,s=!0,i++):s&&a&&CI.test(o)?(t=t.slice(0,i-1)+"-"+t.slice(i-1),a=s,s=!1,r=!0):(r=e(o)===o&&n(o)!==o,a=s,s=n(o)===o&&e(o)!==o)}return t},RI=(t,e)=>(Av.lastIndex=0,t.replace(Av,n=>e(n))),OI=(t,e)=>(Cv.lastIndex=0,Iv.lastIndex=0,t.replace(Cv,(n,r)=>e(r)).replace(Iv,n=>e(n))),xS=(t,e)=>{if(!(typeof t=="string"||Array.isArray(t)))throw new TypeError("Expected the input to be `string | string[]`");if(e={pascalCase:!1,preserveConsecutiveUppercase:!1,...e},Array.isArray(t)?t=t.map(a=>a.trim()).filter(a=>a.length).join("-"):t=t.trim(),t.length===0)return"";const n=e.locale===!1?a=>a.toLowerCase():a=>a.toLocaleLowerCase(e.locale),r=e.locale===!1?a=>a.toUpperCase():a=>a.toLocaleUpperCase(e.locale);return t.length===1?e.pascalCase?r(t):n(t):(t!==n(t)&&(t=jI(t,n,r)),t=t.replace(II,""),e.preserveConsecutiveUppercase?t=RI(t,n):t=n(t),e.pascalCase&&(t=r(t.charAt(0))+t.slice(1)),OI(t,r))};vS.exports=xS;vS.exports.default=xS;function PI(t,e){return(e==null?void 0:e[t])||TI(t)}function $I(t,e,n){const r={};for(const s in t)Object.hasOwn(t,s)&&(r[e(s,n)]=t[s]);return r}var LI={};je(LI,{Serializable:()=>ci,get_lc_unique_name:()=>Eg});function jv(t){return Array.isArray(t)?[...t]:{...t}}function DI(t,e){const n=jv(t);for(const[r,s]of Object.entries(e)){const[a,...i]=r.split(".").reverse();let o=n;for(const l of i.reverse()){if(o[l]===void 0)break;o[l]=jv(o[l]),o=o[l]}o[a]!==void 0&&(o[a]={lc:1,type:"secret",id:[s]})}return n}function Eg(t){const e=Object.getPrototypeOf(t);return typeof t.lc_name=="function"&&(typeof e.lc_name!="function"||t.lc_name()!==e.lc_name())?t.lc_name():t.name}var ci=class bS{constructor(e,...n){k(this,"lc_serializable",!1);k(this,"lc_kwargs");this.lc_serializable_keys!==void 0?this.lc_kwargs=Object.fromEntries(Object.entries(e||{}).filter(([r])=>{var s;return(s=this.lc_serializable_keys)==null?void 0:s.includes(r)})):this.lc_kwargs=e??{}}static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,Eg(this.constructor)]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}get lc_serializable_keys(){}toJSON(){if(!this.lc_serializable)return this.toJSONNotImplemented();if(this.lc_kwargs instanceof bS||typeof this.lc_kwargs!="object"||Array.isArray(this.lc_kwargs))return this.toJSONNotImplemented();const e={},n={},r=Object.keys(this.lc_kwargs).reduce((s,a)=>(s[a]=a in this?this[a]:this.lc_kwargs[a],s),{});for(let s=Object.getPrototypeOf(this);s;s=Object.getPrototypeOf(s))Object.assign(e,Reflect.get(s,"lc_aliases",this)),Object.assign(n,Reflect.get(s,"lc_secrets",this)),Object.assign(r,Reflect.get(s,"lc_attributes",this));return Object.keys(n).forEach(s=>{let a=this,i=r;const[o,...l]=s.split(".").reverse();for(const u of l.reverse()){if(!(u in a)||a[u]===void 0)return;(!(u in i)||i[u]===void 0)&&(typeof a[u]=="object"&&a[u]!=null?i[u]={}:Array.isArray(a[u])&&(i[u]=[])),a=a[u],i=i[u]}o in a&&a[o]!==void 0&&(i[o]=i[o]||a[o])}),{lc:1,type:"constructor",id:this.lc_id,kwargs:$I(Object.keys(n).length?DI(r,n):r,PI,e)}}toJSONNotImplemented(){return{lc:1,type:"not_implemented",id:this.lc_id}}};function de(t,e){return be(t)&&t.type===e}function be(t){return typeof t=="object"&&t!==null}function Er(t){return Array.isArray(t)}function te(t){return typeof t=="string"}function Jn(t){return typeof t=="number"}function Ng(t){return t instanceof Uint8Array}function Rv(t){try{return JSON.parse(t)}catch{return}}const el=t=>t();function MI(t){if(t.type==="char_location"&&te(t.document_title)&&Jn(t.start_char_index)&&Jn(t.end_char_index)&&te(t.cited_text)){const{document_title:e,start_char_index:n,end_char_index:r,cited_text:s,...a}=t;return{...a,type:"citation",source:"char",title:e??void 0,startIndex:n,endIndex:r,citedText:s}}if(t.type==="page_location"&&te(t.document_title)&&Jn(t.start_page_number)&&Jn(t.end_page_number)&&te(t.cited_text)){const{document_title:e,start_page_number:n,end_page_number:r,cited_text:s,...a}=t;return{...a,type:"citation",source:"page",title:e??void 0,startIndex:n,endIndex:r,citedText:s}}if(t.type==="content_block_location"&&te(t.document_title)&&Jn(t.start_block_index)&&Jn(t.end_block_index)&&te(t.cited_text)){const{document_title:e,start_block_index:n,end_block_index:r,cited_text:s,...a}=t;return{...a,type:"citation",source:"block",title:e??void 0,startIndex:n,endIndex:r,citedText:s}}if(t.type==="web_search_result_location"&&te(t.url)&&te(t.title)&&te(t.encrypted_index)&&te(t.cited_text)){const{url:e,title:n,encrypted_index:r,cited_text:s,...a}=t;return{...a,type:"citation",source:"url",url:e,title:n,startIndex:Number(r),endIndex:Number(r),citedText:s}}if(t.type==="search_result_location"&&te(t.source)&&te(t.title)&&Jn(t.start_block_index)&&Jn(t.end_block_index)&&te(t.cited_text)){const{source:e,title:n,start_block_index:r,end_block_index:s,cited_text:a,...i}=t;return{...i,type:"citation",source:"search",url:e,title:n??void 0,startIndex:r,endIndex:s,citedText:a}}}function SS(t){if(de(t,"document")&&be(t.source)&&"type"in t.source){if(t.source.type==="base64"&&te(t.source.media_type)&&te(t.source.data))return{type:"file",mimeType:t.source.media_type,data:t.source.data};if(t.source.type==="url"&&te(t.source.url))return{type:"file",url:t.source.url};if(t.source.type==="file"&&te(t.source.file_id))return{type:"file",fileId:t.source.file_id};if(t.source.type==="text"&&te(t.source.data))return{type:"file",mimeType:String(t.source.media_type??"text/plain"),data:t.source.data}}else if(de(t,"image")&&be(t.source)&&"type"in t.source){if(t.source.type==="base64"&&te(t.source.media_type)&&te(t.source.data))return{type:"image",mimeType:t.source.media_type,data:t.source.data};if(t.source.type==="url"&&te(t.source.url))return{type:"image",url:t.source.url};if(t.source.type==="file"&&te(t.source.file_id))return{type:"image",fileId:t.source.file_id}}}function FI(t){function*e(){for(const n of t){const r=SS(n);r?yield r:yield n}}return Array.from(e())}function Ov(t){function*e(){var r;const n=typeof t.content=="string"?[{type:"text",text:t.content}]:t.content;for(const s of n){if(de(s,"text")&&te(s.text)){const{text:a,citations:i,...o}=s;if(Er(i)&&i.length){const l=i.reduce((u,d)=>{const h=MI(d);return h?[...u,h]:u},[]);yield{...o,type:"text",text:a,annotations:l};continue}else{yield{...o,type:"text",text:a};continue}}else if(de(s,"thinking")&&te(s.thinking)){const{thinking:a,signature:i,...o}=s;yield{...o,type:"reasoning",reasoning:a,signature:i};continue}else if(de(s,"redacted_thinking")){yield{type:"non_standard",value:s};continue}else if(de(s,"tool_use")&&te(s.name)&&te(s.id)){yield{type:"tool_call",id:s.id,name:s.name,args:s.input};continue}else if(de(s,"input_json_delta")){if(UI(t)&&((r=t.tool_call_chunks)!=null&&r.length)){const a=t.tool_call_chunks[0];yield{type:"tool_call_chunk",id:a.id,name:a.name,args:a.args,index:a.index};continue}}else if(de(s,"server_tool_use")&&te(s.name)&&te(s.id)){const{name:a,id:i}=s;if(a==="web_search"){const o=el(()=>{if(typeof s.input=="string")return s.input;if(be(s.input)&&te(s.input.query))return s.input.query;if(te(s.partial_json)){const l=Rv(s.partial_json);if(l!=null&&l.query)return l.query}return""});yield{id:i,type:"server_tool_call",name:"web_search",args:{query:o}};continue}else if(s.name==="code_execution"){const o=el(()=>{if(typeof s.input=="string")return s.input;if(be(s.input)&&te(s.input.code))return s.input.code;if(te(s.partial_json)){const l=Rv(s.partial_json);if(l!=null&&l.code)return l.code}return""});yield{id:i,type:"server_tool_call",name:"code_execution",args:{code:o}};continue}}else if(de(s,"web_search_tool_result")&&te(s.tool_use_id)&&Er(s.content)){const{content:a,tool_use_id:i}=s,o=a.reduce((l,u)=>de(u,"web_search_result")?[...l,u.url]:l,[]);yield{type:"server_tool_call_result",name:"web_search",toolCallId:i,status:"success",output:{urls:o}};continue}else if(de(s,"code_execution_tool_result")&&te(s.tool_use_id)&&be(s.content)){yield{type:"server_tool_call_result",name:"code_execution",toolCallId:s.tool_use_id,status:"success",output:s.content};continue}else if(de(s,"mcp_tool_use")){yield{id:s.id,type:"server_tool_call",name:"mcp_tool_use",args:s.input};continue}else if(de(s,"mcp_tool_result")&&te(s.tool_use_id)&&be(s.content)){yield{type:"server_tool_call_result",name:"mcp_tool_use",toolCallId:s.tool_use_id,status:"success",output:s.content};continue}else if(de(s,"container_upload")){yield{type:"server_tool_call",name:"container_upload",args:s.input};continue}else if(de(s,"search_result")){yield{id:s.id,type:"non_standard",value:s};continue}else if(de(s,"tool_result")){yield{id:s.id,type:"non_standard",value:s};continue}else{const a=SS(s);if(a){yield a;continue}}yield{type:"non_standard",value:s}}}return Array.from(e())}const zI={translateContent:Ov,translateContentChunk:Ov};function UI(t){return typeof(t==null?void 0:t._getType)=="function"&&typeof t.concat=="function"&&t._getType()==="ai"}function BI(t){return bg(t)?{type:t.type,mimeType:t.mime_type,url:t.url,metadata:t.metadata}:Sg(t)?{type:t.type,mimeType:t.mime_type??"application/octet-stream",data:t.data,metadata:t.metadata}:pS(t)?{type:t.type,mimeType:t.mime_type,fileId:t.id,metadata:t.metadata}:t}function GI(t){return t.map(BI)}function HI(t){return!!(de(t,"image_url")&&be(t.image_url)||de(t,"input_audio")&&be(t.input_audio)||de(t,"file")&&be(t.file))}function WI(t){if(de(t,"image_url")&&be(t.image_url)&&te(t.image_url.url)){const e=Xo({dataUrl:t.image_url.url});return e?{type:"image",mimeType:e.mime_type,data:e.data}:{type:"image",url:t.image_url.url}}else{if(de(t,"input_audio")&&be(t.input_audio)&&te(t.input_audio.data)&&te(t.input_audio.format))return{type:"audio",data:t.input_audio.data,mimeType:`audio/${t.input_audio.format}`};if(de(t,"file")&&be(t.file)&&te(t.file.data)){const e=Xo({dataUrl:t.file.data});if(e)return{type:"file",data:e.data,mimeType:e.mime_type};if(te(t.file.file_id))return{type:"file",fileId:t.file.file_id}}}return t}function VI(t){const e=[];typeof t.content=="string"?e.push({type:"text",text:t.content}):e.push(...Tg(t.content));for(const n of t.tool_calls??[])e.push({type:"tool_call",id:n.id,name:n.name,args:n.args});return e}function qI(t){const e=[];typeof t.content=="string"?e.push({type:"text",text:t.content}):e.push(...Tg(t.content));for(const n of t.tool_calls??[])e.push({type:"tool_call",id:n.id,name:n.name,args:n.args});return e}function Tg(t){const e=[];for(const n of t)HI(n)?e.push(WI(n)):e.push(n);return e}function ZI(t){if(t.type==="url_citation"){const{url:e,title:n,start_index:r,end_index:s}=t;return{type:"citation",url:e,title:n,startIndex:r,endIndex:s}}if(t.type==="file_citation"){const{file_id:e,filename:n,index:r}=t;return{type:"citation",title:n,startIndex:r,endIndex:r,fileId:e}}return t}function kS(t){function*e(){var r;be((r=t.additional_kwargs)==null?void 0:r.reasoning)&&Er(t.additional_kwargs.reasoning.summary)&&(yield{type:"reasoning",reasoning:t.additional_kwargs.reasoning.summary.reduce((a,i)=>be(i)&&te(i.text)?`${a}${i.text}`:a,"")});const n=typeof t.content=="string"?[{type:"text",text:t.content}]:t.content;for(const s of n)if(de(s,"text")){const{text:a,annotations:i,...o}=s;Array.isArray(i)?yield{...o,type:"text",text:String(a),annotations:i.map(ZI)}:yield{...o,type:"text",text:String(a)}}for(const s of t.tool_calls??[])yield{type:"tool_call",id:s.id,name:s.name,args:s.args};if(be(t.additional_kwargs)&&Er(t.additional_kwargs.tool_outputs))for(const s of t.additional_kwargs.tool_outputs){if(de(s,"web_search_call")){yield{id:s.id,type:"server_tool_call",name:"web_search",args:{query:s.query}};continue}else if(de(s,"file_search_call")){yield{id:s.id,type:"server_tool_call",name:"file_search",args:{query:s.query}};continue}else if(de(s,"computer_call")){yield{type:"non_standard",value:s};continue}else if(de(s,"code_interpreter_call")){if(te(s.code)&&(yield{id:s.id,type:"server_tool_call",name:"code_interpreter",args:{code:s.code}}),Er(s.outputs)){const a=el(()=>{if(s.status!=="in_progress"){if(s.status==="completed")return 0;if(s.status==="incomplete")return 127;if(s.status!=="interpreting"&&s.status==="failed")return 1}});for(const i of s.outputs)if(de(i,"logs")){yield{type:"server_tool_call_result",toolCallId:s.id??"",status:"success",output:{type:"code_interpreter_output",returnCode:a??0,stderr:[0,void 0].includes(a)?void 0:String(i.logs),stdout:[0,void 0].includes(a)?String(i.logs):void 0}};continue}}continue}else if(de(s,"mcp_call")){yield{id:s.id,type:"server_tool_call",name:"mcp_call",args:s.input};continue}else if(de(s,"mcp_list_tools")){yield{id:s.id,type:"server_tool_call",name:"mcp_list_tools",args:s.input};continue}else if(de(s,"mcp_approval_request")){yield{type:"non_standard",value:s};continue}else if(de(s,"image_generation_call")){yield{type:"non_standard",value:s};continue}be(s)&&(yield{type:"non_standard",value:s})}}return Array.from(e())}function KI(t){function*e(){yield*kS(t);for(const n of t.tool_call_chunks??[])yield{type:"tool_call_chunk",id:n.id,name:n.name,args:n.args}}return Array.from(e())}const JI={translateContent:t=>typeof t.content=="string"?VI(t):kS(t),translateContentChunk:t=>typeof t.content=="string"?qI(t):KI(t)};function YI(t,e="pretty"){return e==="pretty"?QI(t):JSON.stringify(t)}function QI(t){const e=[],n=` ${t.type.charAt(0).toUpperCase()+t.type.slice(1)} Message `,r=Math.floor((80-n.length)/2),s="=".repeat(r),a=n.length%2===0?s:`${s}=`;if(e.push(`${s}${n}${a}`),t.type==="ai"){const i=t;if(i.tool_calls&&i.tool_calls.length>0){e.push("Tool Calls:");for(const o of i.tool_calls){e.push(`  ${o.name} (${o.id})`),e.push(` Call ID: ${o.id}`),e.push("  Args:");for(const[l,u]of Object.entries(o.args))e.push(`    ${l}: ${u}`)}}}if(t.type==="tool"){const i=t;i.name&&e.push(`Name: ${i.name}`)}return typeof t.content=="string"&&t.content.trim()&&(e.length>1&&e.push(""),e.push(t.content)),e.join(`
`)}const Dh=Symbol.for("langchain.message");function Jr(t,e){return typeof t=="string"?t===""?e:typeof e=="string"?t+e:Array.isArray(e)&&e.length===0?t:Array.isArray(e)&&e.some(n=>Cr(n))?[{type:"text",source_type:"text",text:t},...e]:[{type:"text",text:t},...e]:Array.isArray(e)?vl(t,e)??[...t,...e]:e===""?t:Array.isArray(t)&&t.some(n=>Cr(n))?[...t,{type:"file",source_type:"text",text:e}]:[...t,{type:"text",text:e}]}function ES(t,e){return t==="error"||e==="error"?"error":"success"}function XI(t,e){function n(r,s){if(typeof r!="object"||r===null||r===void 0)return r;if(s>=e)return Array.isArray(r)?"[Array]":"[Object]";if(Array.isArray(r))return r.map(i=>n(i,s+1));const a={};for(const i of Object.keys(r))a[i]=n(r[i],s+1);return a}return JSON.stringify(n(t,0),null,2)}var gw,rs=class extends ci{constructor(e){const n=typeof e=="string"||Array.isArray(e)?{content:e}:e;n.additional_kwargs||(n.additional_kwargs={}),n.response_metadata||(n.response_metadata={});super(n);k(this,"lc_namespace",["langchain_core","messages"]);k(this,"lc_serializable",!0);k(this,gw,!0);k(this,"id");k(this,"name");k(this,"content");k(this,"additional_kwargs");k(this,"response_metadata");this.name=n.name,n.content===void 0&&n.contentBlocks!==void 0?(this.content=n.contentBlocks,this.response_metadata={output_version:"v1",...n.response_metadata}):n.content!==void 0?(this.content=n.content??[],this.response_metadata=n.response_metadata):(this.content=[],this.response_metadata=n.response_metadata),this.additional_kwargs=n.additional_kwargs,this.id=n.id}get lc_aliases(){return{additional_kwargs:"additional_kwargs",response_metadata:"response_metadata"}}_getType(){return this.type}getType(){return this._getType()}get text(){return typeof this.content=="string"?this.content:Array.isArray(this.content)?this.content.map(e=>typeof e=="string"?e:e.type==="text"?e.text:"").join(""):""}get contentBlocks(){const e=typeof this.content=="string"?[{type:"text",text:this.content}]:this.content;return[GI,Tg,FI].reduce((s,a)=>a(s),e)}toDict(){return{type:this.getType(),data:this.toJSON().kwargs}}static lc_name(){return"BaseMessage"}get _printableFields(){return{id:this.id,content:this.content,name:this.name,additional_kwargs:this.additional_kwargs,response_metadata:this.response_metadata}}static isInstance(e){return typeof e=="object"&&e!==null&&Dh in e&&e[Dh]===!0&&yS(e)}_updateId(e){this.id=e,this.lc_kwargs.id=e}get[(gw=Dh,Symbol.toStringTag)](){return this.constructor.lc_name()}[Symbol.for("nodejs.util.inspect.custom")](e){if(e===null)return this;const n=XI(this._printableFields,Math.max(4,e));return`${this.constructor.lc_name()} ${n}`}toFormattedString(e="pretty"){return YI(this,e)}};function e2(t){return Array.isArray(t)&&t.every(e=>typeof e.index=="number")}function Ut(t={},e={}){const n={...t};for(const[r,s]of Object.entries(e))if(n[r]==null)n[r]=s;else{if(s==null)continue;if(typeof n[r]!=typeof s||Array.isArray(n[r])!==Array.isArray(s))throw new Error(`field[${r}] already exists in the message chunk, but with a different type.`);if(typeof n[r]=="string"){if(r==="type")continue;["id","name","output_version","model_provider"].includes(r)?n[r]=s:n[r]+=s}else if(typeof n[r]=="object"&&!Array.isArray(n[r]))n[r]=Ut(n[r],s);else if(Array.isArray(n[r]))n[r]=vl(n[r],s);else{if(n[r]===s)continue;console.warn(`field[${r}] already exists in this message chunk and value has unsupported type.`)}}return n}function vl(t,e){if(!(t===void 0&&e===void 0)){if(t===void 0||e===void 0)return t||e;{const n=[...t];for(const r of e)if(typeof r=="object"&&r!==null&&"index"in r&&typeof r.index=="number"){const s=n.findIndex(a=>{const i=typeof a=="object",o="index"in a&&a.index===r.index,l="id"in a&&"id"in r&&(a==null?void 0:a.id)===(r==null?void 0:r.id),u=!("id"in a)||!(a!=null&&a.id)||!("id"in r)||!(r!=null&&r.id);return i&&o&&(l||u)});s!==-1&&typeof n[s]=="object"&&n[s]!==null?n[s]=Ut(n[s],r):n.push(r)}else{if(typeof r=="object"&&r!==null&&"text"in r&&r.text==="")continue;n.push(r)}return n}}}function NS(t,e){if(!t&&!e)throw new Error("Cannot merge two undefined objects.");if(!t||!e)return t||e;if(typeof t!=typeof e)throw new Error(`Cannot merge objects of different types.
Left ${typeof t}
Right ${typeof e}`);if(typeof t=="string"&&typeof e=="string")return t+e;if(Array.isArray(t)&&Array.isArray(e))return vl(t,e);if(typeof t=="object"&&typeof e=="object")return Ut(t,e);if(t===e)return t;throw new Error(`Can not merge objects of different types.
Left ${t}
Right ${e}`)}var Gs=class TS extends rs{static isInstance(e){if(!super.isInstance(e))return!1;let n=Object.getPrototypeOf(e);for(;n!==null;){if(n===TS.prototype)return!0;n=Object.getPrototypeOf(n)}return!1}};function AS(t){return typeof t.role=="string"}function xs(t){return typeof(t==null?void 0:t._getType)=="function"}function Ag(t){return Gs.isInstance(t)}function CS(t,e){return Ut(t??{},e??{})}function IS(t,e){const n={};return((t==null?void 0:t.audio)!==void 0||(e==null?void 0:e.audio)!==void 0)&&(n.audio=((t==null?void 0:t.audio)??0)+((e==null?void 0:e.audio)??0)),((t==null?void 0:t.image)!==void 0||(e==null?void 0:e.image)!==void 0)&&(n.image=((t==null?void 0:t.image)??0)+((e==null?void 0:e.image)??0)),((t==null?void 0:t.video)!==void 0||(e==null?void 0:e.video)!==void 0)&&(n.video=((t==null?void 0:t.video)??0)+((e==null?void 0:e.video)??0)),((t==null?void 0:t.document)!==void 0||(e==null?void 0:e.document)!==void 0)&&(n.document=((t==null?void 0:t.document)??0)+((e==null?void 0:e.document)??0)),((t==null?void 0:t.text)!==void 0||(e==null?void 0:e.text)!==void 0)&&(n.text=((t==null?void 0:t.text)??0)+((e==null?void 0:e.text)??0)),n}function t2(t,e){const n={...IS(t,e)};return((t==null?void 0:t.cache_read)!==void 0||(e==null?void 0:e.cache_read)!==void 0)&&(n.cache_read=((t==null?void 0:t.cache_read)??0)+((e==null?void 0:e.cache_read)??0)),((t==null?void 0:t.cache_creation)!==void 0||(e==null?void 0:e.cache_creation)!==void 0)&&(n.cache_creation=((t==null?void 0:t.cache_creation)??0)+((e==null?void 0:e.cache_creation)??0)),n}function n2(t,e){const n={...IS(t,e)};return((t==null?void 0:t.reasoning)!==void 0||(e==null?void 0:e.reasoning)!==void 0)&&(n.reasoning=((t==null?void 0:t.reasoning)??0)+((e==null?void 0:e.reasoning)??0)),n}function jS(t,e){return{input_tokens:((t==null?void 0:t.input_tokens)??0)+((e==null?void 0:e.input_tokens)??0),output_tokens:((t==null?void 0:t.output_tokens)??0)+((e==null?void 0:e.output_tokens)??0),total_tokens:((t==null?void 0:t.total_tokens)??0)+((e==null?void 0:e.total_tokens)??0),input_token_details:t2(t==null?void 0:t.input_token_details,e==null?void 0:e.input_token_details),output_token_details:n2(t==null?void 0:t.output_token_details,e==null?void 0:e.output_token_details)}}var r2={};je(r2,{ToolMessage:()=>Ir,ToolMessageChunk:()=>_l,defaultToolCallParser:()=>Ig,isDirectToolOutput:()=>Cg,isToolMessage:()=>RS,isToolMessageChunk:()=>OS});function Cg(t){return t!=null&&typeof t=="object"&&"lc_direct_tool_output"in t&&t.lc_direct_tool_output===!0}var Ir=class extends rs{constructor(e,n,r){const s=typeof e=="string"||Array.isArray(e)?{content:e,name:r,tool_call_id:n}:e;super(s);k(this,"lc_direct_tool_output",!0);k(this,"type","tool");k(this,"status");k(this,"tool_call_id");k(this,"metadata");k(this,"artifact");this.tool_call_id=s.tool_call_id,this.artifact=s.artifact,this.status=s.status,this.metadata=s.metadata}static lc_name(){return"ToolMessage"}get lc_aliases(){return{tool_call_id:"tool_call_id"}}static isInstance(e){return super.isInstance(e)&&e.type==="tool"}get _printableFields(){return{...super._printableFields,tool_call_id:this.tool_call_id,artifact:this.artifact}}},_l=class extends Gs{constructor(e){super(e);k(this,"type","tool");k(this,"tool_call_id");k(this,"status");k(this,"artifact");this.tool_call_id=e.tool_call_id,this.artifact=e.artifact,this.status=e.status}static lc_name(){return"ToolMessageChunk"}concat(e){const n=this.constructor;return new n({content:Jr(this.content,e.content),additional_kwargs:Ut(this.additional_kwargs,e.additional_kwargs),response_metadata:Ut(this.response_metadata,e.response_metadata),artifact:NS(this.artifact,e.artifact),tool_call_id:this.tool_call_id,id:this.id??e.id,status:ES(this.status,e.status)})}get _printableFields(){return{...super._printableFields,tool_call_id:this.tool_call_id,artifact:this.artifact}}};function Ig(t){const e=[],n=[];for(const r of t)if(r.function){const s=r.function.name;try{const a=JSON.parse(r.function.arguments);e.push({name:s||"",args:a||{},id:r.id})}catch{n.push({name:s,args:r.function.arguments,id:r.id,error:"Malformed args."})}}else continue;return[e,n]}function RS(t){return typeof t=="object"&&t!==null&&"getType"in t&&typeof t.getType=="function"&&t.getType()==="tool"}function OS(t){return t._getType()==="tool"}function Em(t,e=Sd){t=t.trim();const n=t.indexOf("```");if(n===-1)return e(t);let r=t.substring(n+3);r.startsWith(`json
`)?r=r.substring(5):r.startsWith("json")?r=r.substring(4):r.startsWith(`
`)&&(r=r.substring(1));const s=r.indexOf("```");let a=r;return s!==-1&&(a=r.substring(0,s)),e(a.trim())}function Sd(t){if(typeof t>"u")return null;try{return JSON.parse(t)}catch{}let e="";const n=[];let r=!1,s=!1;for(let a of t){if(r)a==='"'&&!s?r=!1:a===`
`&&!s?a="\\n":a==="\\"?s=!s:s=!1;else if(a==='"')r=!0,s=!1;else if(a==="{")n.push("}");else if(a==="[")n.push("]");else if(a==="}"||a==="]")if(n&&n[n.length-1]===a)n.pop();else return null;e+=a}r&&(e+='"');for(let a=n.length-1;a>=0;a-=1)e+=n[a];try{return JSON.parse(e)}catch{return null}}function jg(t){switch(t){case"csv":return"text/csv";case"doc":return"application/vnd.openxmlformats-officedocument.wordprocessingml.document";case"docx":return"application/vnd.openxmlformats-officedocument.wordprocessingml.document";case"html":return"text/html";case"md":return"text/markdown";case"pdf":return"application/pdf";case"txt":return"text/plain";case"xls":return"application/vnd.ms-excel";case"xlsx":return"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";case"gif":return"image/gif";case"jpeg":return"image/jpeg";case"jpg":return"image/jpeg";case"png":return"image/png";case"webp":return"image/webp";case"flv":return"video/flv";case"mkv":return"video/mkv";case"mov":return"video/mov";case"mp4":return"video/mp4";case"mpeg":return"video/mpeg";case"mpg":return"video/mpg";case"three_gp":return"video/three_gp";case"webm":return"video/webm";case"wmv":return"video/wmv";default:return"application/octet-stream"}}function s2(t){if(be(t.document)&&be(t.document.source)){const e=be(t.document)&&te(t.document.format)?t.document.format:"",n=jg(e);if(be(t.document.source)){if(be(t.document.source.s3Location)&&te(t.document.source.s3Location.uri))return{type:"file",mimeType:n,fileId:t.document.source.s3Location.uri};if(Ng(t.document.source.bytes))return{type:"file",mimeType:n,data:t.document.source.bytes};if(te(t.document.source.text))return{type:"file",mimeType:n,data:Buffer.from(t.document.source.text).toString("base64")};if(Er(t.document.source.content)){const r=t.document.source.content.reduce((s,a)=>be(a)&&te(a.text)?s+a.text:s,"");return{type:"file",mimeType:n,data:r}}}}return{type:"non_standard",value:t}}function a2(t){if(de(t,"image")&&be(t.image)){const e=be(t.image)&&te(t.image.format)?t.image.format:"",n=jg(e);if(be(t.image.source)){if(be(t.image.source.s3Location)&&te(t.image.source.s3Location.uri))return{type:"image",mimeType:n,fileId:t.image.source.s3Location.uri};if(Ng(t.image.source.bytes))return{type:"image",mimeType:n,data:t.image.source.bytes}}}return{type:"non_standard",value:t}}function i2(t){if(de(t,"video")&&be(t.video)){const e=be(t.video)&&te(t.video.format)?t.video.format:"",n=jg(e);if(be(t.video.source)){if(be(t.video.source.s3Location)&&te(t.video.source.s3Location.uri))return{type:"video",mimeType:n,fileId:t.video.source.s3Location.uri};if(Ng(t.video.source.bytes))return{type:"video",mimeType:n,data:t.video.source.bytes}}}return{type:"non_standard",value:t}}function Pv(t){function*e(){const n=typeof t.content=="string"?[{type:"text",text:t.content}]:t.content;for(const r of n){if(de(r,"cache_point")){yield{type:"non_standard",value:r};continue}else if(de(r,"citations_content")&&be(r.citationsContent)){const s=Er(r.citationsContent.content)?r.citationsContent.content.reduce((i,o)=>be(o)&&te(o.text)?i+o.text:i,""):"",a=Er(r.citationsContent.citations)?r.citationsContent.citations.reduce((i,o)=>{if(be(o)){const l=Er(o.sourceContent)?o.sourceContent.reduce((d,h)=>be(h)&&te(h.text)?d+h.text:d,""):"",u=el(()=>{if(be(o.location)){const d=o.location.documentChar||o.location.documentPage||o.location.documentChunk;if(be(d))return{source:Jn(d.documentIndex)?d.documentIndex.toString():void 0,startIndex:Jn(d.start)?d.start:void 0,endIndex:Jn(d.end)?d.end:void 0}}return{}});i.push({type:"citation",citedText:l,...u})}return i},[]):[];yield{type:"text",text:s,annotations:a};continue}else if(de(r,"document")&&be(r.document)){yield s2(r);continue}else if(de(r,"guard_content")){yield{type:"non_standard",value:r};continue}else if(de(r,"image")&&be(r.image)){yield a2(r);continue}else if(de(r,"reasoning_content")&&te(r.reasoningText)){yield{type:"reasoning",reasoning:r.reasoningText};continue}else if(de(r,"text")&&te(r.text)){yield{type:"text",text:r.text};continue}else if(de(r,"tool_result")){yield{type:"non_standard",value:r};continue}else{if(de(r,"tool_call"))continue;if(de(r,"video")&&be(r.video)){yield i2(r);continue}}yield{type:"non_standard",value:r}}}return Array.from(e())}const o2={translateContent:Pv,translateContentChunk:Pv};function $v(t){function*e(){const n=typeof t.content=="string"?[{type:"text",text:t.content}]:t.content;for(const r of n){if(de(r,"text")&&te(r.text)){yield{type:"text",text:r.text};continue}else if(de(r,"inlineData")&&be(r.inlineData)&&te(r.inlineData.mimeType)&&te(r.inlineData.data)){yield{type:"file",mimeType:r.inlineData.mimeType,data:r.inlineData.data};continue}else if(de(r,"functionCall")&&be(r.functionCall)&&te(r.functionCall.name)&&be(r.functionCall.args)){yield{type:"tool_call",id:t.id,name:r.functionCall.name,args:r.functionCall.args};continue}else if(de(r,"functionResponse")){yield{type:"non_standard",value:r};continue}else if(de(r,"fileData")&&be(r.fileData)&&te(r.fileData.mimeType)&&te(r.fileData.fileUri)){yield{type:"file",mimeType:r.fileData.mimeType,fileId:r.fileData.fileUri};continue}else if(de(r,"executableCode")){yield{type:"non_standard",value:r};continue}else if(de(r,"codeExecutionResult")){yield{type:"non_standard",value:r};continue}yield{type:"non_standard",value:r}}}return Array.from(e())}const l2={translateContent:$v,translateContentChunk:$v};function Lv(t){function*e(){const n=typeof t.content=="string"?[{type:"text",text:t.content}]:t.content;for(const r of n){if(de(r,"reasoning")&&te(r.reasoning)){const s=el(()=>{var i;const a=n.indexOf(r);if(Er((i=t.additional_kwargs)==null?void 0:i.signatures)&&a>=0)return t.additional_kwargs.signatures.at(a)});te(s)?yield{type:"reasoning",reasoning:r.reasoning,signature:s}:yield{type:"reasoning",reasoning:r.reasoning};continue}else if(de(r,"text")&&te(r.text)){yield{type:"text",text:r.text};continue}else if(de(r,"image_url")){if(te(r.image_url))if(r.image_url.startsWith("data:")){const s=/^data:([^;]+);base64,(.+)$/,a=r.image_url.match(s);a?yield{type:"image",data:a[2],mimeType:a[1]}:yield{type:"image",url:r.image_url}}else yield{type:"image",url:r.image_url};continue}else if(de(r,"media")&&te(r.mimeType)&&te(r.data)){yield{type:"file",mimeType:r.mimeType,data:r.data};continue}yield{type:"non_standard",value:r}}}return Array.from(e())}const c2={translateContent:Lv,translateContentChunk:Lv};globalThis.lc_block_translators_registry??(globalThis.lc_block_translators_registry=new Map([["anthropic",zI],["bedrock-converse",o2],["google-genai",l2],["google-vertexai",c2],["openai",JI]]));function PS(t){return globalThis.lc_block_translators_registry.get(t)}var hn=class extends rs{constructor(e){var r;let n;if(typeof e=="string"||Array.isArray(e))n={content:e,tool_calls:[],invalid_tool_calls:[],additional_kwargs:{}};else{n=e;const s=(r=n.additional_kwargs)==null?void 0:r.tool_calls,a=n.tool_calls;s!=null&&s.length>0&&(a===void 0||a.length===0)&&console.warn(["New LangChain packages are available that more efficiently handle",`tool calling.

Please upgrade your packages to versions that set`,"message tool calls. e.g., `pnpm install @langchain/anthropic`,","pnpm install @langchain/openai`, etc."].join(" "));try{if(s!=null&&a===void 0){const[i,o]=Ig(s);n.tool_calls=i??[],n.invalid_tool_calls=o??[]}else n.tool_calls=n.tool_calls??[],n.invalid_tool_calls=n.invalid_tool_calls??[]}catch{n.tool_calls=[],n.invalid_tool_calls=[]}if(n.response_metadata!==void 0&&"output_version"in n.response_metadata&&n.response_metadata.output_version==="v1"&&(n.contentBlocks=n.content,n.content=void 0),n.contentBlocks!==void 0){n.contentBlocks.push(...n.tool_calls.map(o=>({type:"tool_call",id:o.id,name:o.name,args:o.args})));const i=n.contentBlocks.filter(o=>o.type==="tool_call").filter(o=>{var l;return!((l=n.tool_calls)!=null&&l.some(u=>u.id===o.id&&u.name===o.name))});i.length>0&&(n.tool_calls=i.map(o=>({type:"tool_call",id:o.id,name:o.name,args:o.args})))}}super(n);k(this,"type","ai");k(this,"tool_calls",[]);k(this,"invalid_tool_calls",[]);k(this,"usage_metadata");typeof n!="string"&&(this.tool_calls=n.tool_calls??this.tool_calls,this.invalid_tool_calls=n.invalid_tool_calls??this.invalid_tool_calls),this.usage_metadata=n.usage_metadata}get lc_aliases(){return{...super.lc_aliases,tool_calls:"tool_calls",invalid_tool_calls:"invalid_tool_calls"}}static lc_name(){return"AIMessage"}get contentBlocks(){if(this.response_metadata&&"output_version"in this.response_metadata&&this.response_metadata.output_version==="v1")return this.content;if(this.response_metadata&&"model_provider"in this.response_metadata&&typeof this.response_metadata.model_provider=="string"){const n=PS(this.response_metadata.model_provider);if(n)return n.translateContent(this)}const e=super.contentBlocks;if(this.tool_calls){const n=this.tool_calls.filter(r=>!e.some(s=>s.id===r.id&&s.name===r.name));e.push(...n.map(r=>({...r,type:"tool_call",id:r.id,name:r.name,args:r.args})))}return e}get _printableFields(){return{...super._printableFields,tool_calls:this.tool_calls,invalid_tool_calls:this.invalid_tool_calls,usage_metadata:this.usage_metadata}}static isInstance(e){return super.isInstance(e)&&e.type==="ai"}};function kd(t){return t._getType()==="ai"}function Nm(t){return t._getType()==="ai"}var Rr=class extends Gs{constructor(e){var r,s;let n;if(typeof e=="string"||Array.isArray(e))n={content:e,tool_calls:[],invalid_tool_calls:[],tool_call_chunks:[]};else if(e.tool_call_chunks===void 0||e.tool_call_chunks.length===0)n={...e,tool_calls:e.tool_calls??[],invalid_tool_calls:[],tool_call_chunks:[],usage_metadata:e.usage_metadata!==void 0?e.usage_metadata:void 0};else{const i=(e.tool_call_chunks??[]).reduce((u,d)=>{const h=u.findIndex(([f])=>"id"in d&&d.id&&"index"in d&&d.index!==void 0?d.id===f.id&&d.index===f.index:"id"in d&&d.id?d.id===f.id:"index"in d&&d.index!==void 0?d.index===f.index:!1);return h!==-1?u[h].push(d):u.push([d]),u},[]),o=[],l=[];for(const u of i){let d=null;const h=((r=u[0])==null?void 0:r.name)??"",f=u.map(w=>w.args||"").join(""),m=f.length?f:"{}",v=(s=u[0])==null?void 0:s.id;try{if(d=Sd(m),!v||d===null||typeof d!="object"||Array.isArray(d))throw new Error("Malformed tool call chunk args.");o.push({name:h,args:d,id:v,type:"tool_call"})}catch{l.push({name:h,args:m,id:v,error:"Malformed args.",type:"invalid_tool_call"})}}n={...e,tool_calls:o,invalid_tool_calls:l,usage_metadata:e.usage_metadata!==void 0?e.usage_metadata:void 0}}super(n);k(this,"type","ai");k(this,"tool_calls",[]);k(this,"invalid_tool_calls",[]);k(this,"tool_call_chunks",[]);k(this,"usage_metadata");this.tool_call_chunks=n.tool_call_chunks??this.tool_call_chunks,this.tool_calls=n.tool_calls??this.tool_calls,this.invalid_tool_calls=n.invalid_tool_calls??this.invalid_tool_calls,this.usage_metadata=n.usage_metadata}get lc_aliases(){return{...super.lc_aliases,tool_calls:"tool_calls",invalid_tool_calls:"invalid_tool_calls",tool_call_chunks:"tool_call_chunks"}}static lc_name(){return"AIMessageChunk"}get contentBlocks(){if(this.response_metadata&&"output_version"in this.response_metadata&&this.response_metadata.output_version==="v1")return this.content;if(this.response_metadata&&"model_provider"in this.response_metadata&&typeof this.response_metadata.model_provider=="string"){const n=PS(this.response_metadata.model_provider);if(n)return n.translateContent(this)}const e=super.contentBlocks;if(this.tool_calls&&typeof this.content!="string"){const n=this.content.filter(r=>r.type==="tool_call").map(r=>r.id);for(const r of this.tool_calls)r.id&&!n.includes(r.id)&&e.push({...r,type:"tool_call",id:r.id,name:r.name,args:r.args})}return e}get _printableFields(){return{...super._printableFields,tool_calls:this.tool_calls,tool_call_chunks:this.tool_call_chunks,invalid_tool_calls:this.invalid_tool_calls,usage_metadata:this.usage_metadata}}concat(e){const n={content:Jr(this.content,e.content),additional_kwargs:Ut(this.additional_kwargs,e.additional_kwargs),response_metadata:CS(this.response_metadata,e.response_metadata),tool_call_chunks:[],id:this.id??e.id};if(this.tool_call_chunks!==void 0||e.tool_call_chunks!==void 0){const s=vl(this.tool_call_chunks,e.tool_call_chunks);s!==void 0&&s.length>0&&(n.tool_call_chunks=s)}(this.usage_metadata!==void 0||e.usage_metadata!==void 0)&&(n.usage_metadata=jS(this.usage_metadata,e.usage_metadata));const r=this.constructor;return new r(n)}static isInstance(e){return super.isInstance(e)&&e.type==="ai"}},ba=class $S extends rs{constructor(n,r){(typeof n=="string"||Array.isArray(n))&&(n={content:n,role:r});super(n);k(this,"type","generic");k(this,"role");this.role=n.role}static lc_name(){return"ChatMessage"}static _chatMessageClass(){return $S}static isInstance(n){return super.isInstance(n)&&n.type==="generic"}get _printableFields(){return{...super._printableFields,role:this.role}}},wl=class extends Gs{constructor(e,n){(typeof e=="string"||Array.isArray(e))&&(e={content:e,role:n});super(e);k(this,"type","generic");k(this,"role");this.role=e.role}static lc_name(){return"ChatMessageChunk"}concat(e){const n=this.constructor;return new n({content:Jr(this.content,e.content),additional_kwargs:Ut(this.additional_kwargs,e.additional_kwargs),response_metadata:Ut(this.response_metadata,e.response_metadata),role:this.role,id:this.id??e.id})}static isInstance(e){return super.isInstance(e)&&e.type==="generic"}get _printableFields(){return{...super._printableFields,role:this.role}}};function u2(t){return t._getType()==="generic"}function d2(t){return t._getType()==="generic"}var Ed=class extends rs{constructor(e){super(e);k(this,"type","function");k(this,"name");this.name=e.name}static lc_name(){return"FunctionMessage"}},xl=class extends Gs{constructor(){super(...arguments);k(this,"type","function")}static lc_name(){return"FunctionMessageChunk"}concat(e){const n=this.constructor;return new n({content:Jr(this.content,e.content),additional_kwargs:Ut(this.additional_kwargs,e.additional_kwargs),response_metadata:Ut(this.response_metadata,e.response_metadata),name:this.name??"",id:this.id??e.id})}};function h2(t){return t._getType()==="function"}function f2(t){return t._getType()==="function"}var Or=class extends rs{constructor(e){super(e);k(this,"type","human")}static lc_name(){return"HumanMessage"}static isInstance(e){return super.isInstance(e)&&e.type==="human"}},bl=class extends Gs{constructor(e){super(e);k(this,"type","human")}static lc_name(){return"HumanMessageChunk"}concat(e){const n=this.constructor;return new n({content:Jr(this.content,e.content),additional_kwargs:Ut(this.additional_kwargs,e.additional_kwargs),response_metadata:Ut(this.response_metadata,e.response_metadata),id:this.id??e.id})}static isInstance(e){return super.isInstance(e)&&e.type==="human"}};function m2(t){return t.getType()==="human"}function p2(t){return t.getType()==="human"}var Yr=class Hc extends rs{constructor(n){super(n);k(this,"type","system")}static lc_name(){return"SystemMessage"}concat(n){if(typeof n=="string")return new Hc({...this,content:Jr(this.content,n)});if(Hc.isInstance(n))return new Hc({...this,additional_kwargs:{...this.additional_kwargs,...n.additional_kwargs},response_metadata:{...this.response_metadata,...n.response_metadata},content:Jr(this.content,n.content)});throw new Error("Unexpected chunk type for system message")}static isInstance(n){return super.isInstance(n)&&n.type==="system"}},Ls=class extends Gs{constructor(e){super(e);k(this,"type","system")}static lc_name(){return"SystemMessageChunk"}concat(e){const n=this.constructor;return new n({content:Jr(this.content,e.content),additional_kwargs:Ut(this.additional_kwargs,e.additional_kwargs),response_metadata:Ut(this.response_metadata,e.response_metadata),id:this.id??e.id})}static isInstance(e){return super.isInstance(e)&&e.type==="system"}};function g2(t){return t._getType()==="system"}function y2(t){return t._getType()==="system"}var Nu=class extends rs{constructor(e){super({...e,content:[]});k(this,"type","remove");k(this,"id");this.id=e.id}get _printableFields(){return{...super._printableFields,id:this.id}}static isInstance(e){return super.isInstance(e)&&e.type==="remove"}};function LS(t,e){return t.lc_error_code=e,t.message=`${t.message}

Troubleshooting URL: https://docs.langchain.com/oss/javascript/langchain/errors/${e}/
`,t}function To(t){return!!(t&&typeof t=="object"&&"type"in t&&t.type==="tool_call")}function v2(t){return!!(t&&typeof t=="object"&&"toolCall"in t&&t.toolCall!=null&&typeof t.toolCall=="object"&&"id"in t.toolCall&&typeof t.toolCall.id=="string")}var Tu=class extends Error{constructor(e,n){super(e);k(this,"output");this.output=n}};const DS=t=>t();function _2(t){return To(t)?t:typeof t.id=="string"&&t.type==="function"&&typeof t.function=="object"&&t.function!==null&&"arguments"in t.function&&typeof t.function.arguments=="string"&&"name"in t.function&&typeof t.function.name=="string"?{id:t.id,args:JSON.parse(t.function.arguments),name:t.function.name,type:"tool_call"}:t}function w2(t){return typeof t=="object"&&t!=null&&t.lc===1&&Array.isArray(t.id)&&t.kwargs!=null&&typeof t.kwargs=="object"}function Mh(t){let e,n;if(w2(t)){const r=t.id.at(-1);r==="HumanMessage"||r==="HumanMessageChunk"?e="user":r==="AIMessage"||r==="AIMessageChunk"?e="assistant":r==="SystemMessage"||r==="SystemMessageChunk"?e="system":r==="FunctionMessage"||r==="FunctionMessageChunk"?e="function":r==="ToolMessage"||r==="ToolMessageChunk"?e="tool":e="unknown",n=t.kwargs}else{const{type:r,...s}=t;e=r,n=s}if(e==="human"||e==="user")return new Or(n);if(e==="ai"||e==="assistant"){const{tool_calls:r,...s}=n;if(!Array.isArray(r))return new hn(n);const a=r.map(_2);return new hn({...s,tool_calls:a})}else{if(e==="system")return new Yr(n);if(e==="developer")return new Yr({...n,additional_kwargs:{...n.additional_kwargs,__openai_role__:"developer"}});if(e==="tool"&&"tool_call_id"in n)return new Ir({...n,content:n.content,tool_call_id:n.tool_call_id,name:n.name});if(e==="remove"&&"id"in n&&typeof n.id=="string")return new Nu({...n,id:n.id});throw LS(new Error(`Unable to coerce message from array: only human, AI, system, developer, or tool message coercion is currently supported.

Received: ${JSON.stringify(t,null,2)}`),"MESSAGE_COERCION_FAILURE")}}function Ao(t){if(typeof t=="string")return new Or(t);if(xs(t))return t;if(Array.isArray(t)){const[e,n]=t;return Mh({type:e,content:n})}else if(AS(t)){const{role:e,...n}=t;return Mh({...n,type:e})}else return Mh(t)}function Rg(t,e="Human",n="AI"){const r=[];for(const s of t){let a;if(s._getType()==="human")a=e;else if(s._getType()==="ai")a=n;else if(s._getType()==="system")a="System";else if(s._getType()==="tool")a="Tool";else if(s._getType()==="generic")a=s.role;else throw new Error(`Got unsupported message type: ${s._getType()}`);const i=s.name?`${s.name}, `:"",o=typeof s.content=="string"?s.content:JSON.stringify(s.content,null,2);r.push(`${a}: ${i}${o}`)}return r.join(`
`)}function x2(t){if(t.data!==void 0)return t;{const e=t;return{type:e.type,data:{content:e.text,role:e.role,name:void 0,tool_call_id:void 0}}}}function Og(t){const e=x2(t);switch(e.type){case"human":return new Or(e.data);case"ai":return new hn(e.data);case"system":return new Yr(e.data);case"function":if(e.data.name===void 0)throw new Error("Name must be defined for function messages");return new Ed(e.data);case"tool":if(e.data.tool_call_id===void 0)throw new Error("Tool call ID must be defined for tool messages");return new Ir(e.data);case"generic":if(e.data.role===void 0)throw new Error("Role must be defined for chat messages");return new ba(e.data);default:throw new Error(`Got unexpected type: ${e.type}`)}}function b2(t){return t.map(Og)}function S2(t){return t.map(e=>e.toDict())}function Au(t){var n;const e=t._getType();if(e==="human")return new bl({...t});if(e==="ai"){let r={...t};return"tool_calls"in r&&(r={...r,tool_call_chunks:(n=r.tool_calls)==null?void 0:n.map(s=>({...s,type:"tool_call_chunk",index:void 0,args:JSON.stringify(s.args)}))}),new Rr({...r})}else{if(e==="system")return new Ls({...t});if(e==="function")return new xl({...t});if(ba.isInstance(t))return new wl({...t});throw new Error("Unknown message type.")}}const MS=Symbol.for("ls:tracing_async_local_storage"),Co=Symbol.for("lc:context_variables"),k2=t=>{globalThis[MS]=t},tl=()=>globalThis[MS];var Fh={},E2={};je(E2,{getEnv:()=>Pg,getEnvironmentVariable:()=>Nr,getRuntimeEnvironment:()=>GS,isBrowser:()=>FS,isDeno:()=>Nd,isJsDom:()=>US,isNode:()=>BS,isWebWorker:()=>zS});const FS=()=>typeof window<"u"&&typeof window.document<"u",zS=()=>typeof globalThis=="object"&&globalThis.constructor&&globalThis.constructor.name==="DedicatedWorkerGlobalScope",US=()=>typeof window<"u"&&window.name==="nodejs"||typeof navigator<"u"&&navigator.userAgent.includes("jsdom"),Nd=()=>typeof Deno<"u",BS=()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"&&!Nd(),Pg=()=>{let t;return FS()?t="browser":BS()?t="node":zS()?t="webworker":US()?t="jsdom":Nd()?t="deno":t="other",t};let zh;function GS(){return zh===void 0&&(zh={library:"langchain-js",runtime:Pg()}),zh}function Nr(t){try{return typeof process<"u"?Fh==null?void 0:Fh[t]:Nd()?Deno==null?void 0:Deno.env.get(t):void 0}catch{return}}const N2=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i;function Io(t){return typeof t=="string"&&N2.test(t)}function T2(t){if(!Io(t))throw TypeError("Invalid UUID");var e,n=new Uint8Array(16);return n[0]=(e=parseInt(t.slice(0,8),16))>>>24,n[1]=e>>>16&255,n[2]=e>>>8&255,n[3]=e&255,n[4]=(e=parseInt(t.slice(9,13),16))>>>8,n[5]=e&255,n[6]=(e=parseInt(t.slice(14,18),16))>>>8,n[7]=e&255,n[8]=(e=parseInt(t.slice(19,23),16))>>>8,n[9]=e&255,n[10]=(e=parseInt(t.slice(24,36),16))/1099511627776&255,n[11]=e/4294967296&255,n[12]=e>>>24&255,n[13]=e>>>16&255,n[14]=e>>>8&255,n[15]=e&255,n}var Ct=[];for(var Uh=0;Uh<256;++Uh)Ct.push((Uh+256).toString(16).slice(1));function $g(t,e=0){return(Ct[t[e+0]]+Ct[t[e+1]]+Ct[t[e+2]]+Ct[t[e+3]]+"-"+Ct[t[e+4]]+Ct[t[e+5]]+"-"+Ct[t[e+6]]+Ct[t[e+7]]+"-"+Ct[t[e+8]]+Ct[t[e+9]]+"-"+Ct[t[e+10]]+Ct[t[e+11]]+Ct[t[e+12]]+Ct[t[e+13]]+Ct[t[e+14]]+Ct[t[e+15]]).toLowerCase()}var sc,A2=new Uint8Array(16);function HS(){if(!sc&&(sc=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!sc))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return sc(A2)}function C2(t){t=unescape(encodeURIComponent(t));for(var e=[],n=0;n<t.length;++n)e.push(t.charCodeAt(n));return e}var I2="6ba7b810-9dad-11d1-80b4-00c04fd430c8",j2="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function R2(t,e,n){function r(s,a,i,o){var l;if(typeof s=="string"&&(s=C2(s)),typeof a=="string"&&(a=T2(a)),((l=a)===null||l===void 0?void 0:l.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var u=new Uint8Array(16+s.length);if(u.set(a),u.set(s,a.length),u=n(u),u[6]=u[6]&15|e,u[8]=u[8]&63|128,i){o=o||0;for(var d=0;d<16;++d)i[o+d]=u[d];return i}return $g(u)}try{r.name=t}catch{}return r.DNS=I2,r.URL=j2,r}var O2=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const Dv={randomUUID:O2};function rn(t,e,n){if(Dv.randomUUID&&!e&&!t)return Dv.randomUUID();t=t||{};var r=t.random||(t.rng||HS)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,$g(r)}function P2(t,e,n,r){switch(t){case 0:return e&n^~e&r;case 1:return e^n^r;case 2:return e&n^e&r^n&r;case 3:return e^n^r}}function Bh(t,e){return t<<e|t>>>32-e}function $2(t){var e=[1518500249,1859775393,2400959708,3395469782],n=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof t=="string"){var r=unescape(encodeURIComponent(t));t=[];for(var s=0;s<r.length;++s)t.push(r.charCodeAt(s))}else Array.isArray(t)||(t=Array.prototype.slice.call(t));t.push(128);for(var a=t.length/4+2,i=Math.ceil(a/16),o=new Array(i),l=0;l<i;++l){for(var u=new Uint32Array(16),d=0;d<16;++d)u[d]=t[l*64+d*4]<<24|t[l*64+d*4+1]<<16|t[l*64+d*4+2]<<8|t[l*64+d*4+3];o[l]=u}o[i-1][14]=(t.length-1)*8/Math.pow(2,32),o[i-1][14]=Math.floor(o[i-1][14]),o[i-1][15]=(t.length-1)*8&4294967295;for(var h=0;h<i;++h){for(var f=new Uint32Array(80),m=0;m<16;++m)f[m]=o[h][m];for(var v=16;v<80;++v)f[v]=Bh(f[v-3]^f[v-8]^f[v-14]^f[v-16],1);for(var w=n[0],_=n[1],y=n[2],p=n[3],g=n[4],S=0;S<80;++S){var N=Math.floor(S/20),T=Bh(w,5)+P2(N,_,y,p)+g+e[N]+f[S]>>>0;g=p,p=y,y=Bh(_,30)>>>0,_=w,w=T}n[0]=n[0]+w>>>0,n[1]=n[1]+_>>>0,n[2]=n[2]+y>>>0,n[3]=n[3]+p>>>0,n[4]=n[4]+g>>>0}return[n[0]>>24&255,n[0]>>16&255,n[0]>>8&255,n[0]&255,n[1]>>24&255,n[1]>>16&255,n[1]>>8&255,n[1]&255,n[2]>>24&255,n[2]>>16&255,n[2]>>8&255,n[2]&255,n[3]>>24&255,n[3]>>16&255,n[3]>>8&255,n[3]&255,n[4]>>24&255,n[4]>>16&255,n[4]>>8&255,n[4]&255]}var ao=R2("v5",80,$2),Mv=null,Fv=null,Un=0;function L2(t,e,n){t=t||{};var r=e&&n||0,s=e||new Uint8Array(16),a=t.random||(t.rng||HS)(),i=t.msecs!==void 0?t.msecs:Date.now(),o=t.seq!==void 0?t.seq:null,l=Fv,u=Mv;return i>Un&&t.msecs===void 0&&(Un=i,o!==null&&(l=null,u=null)),o!==null&&(o>2147483647&&(o=2147483647),l=o>>>19&4095,u=o&524287),(l===null||u===null)&&(l=a[6]&127,l=l<<8|a[7],u=a[8]&63,u=u<<8|a[9],u=u<<5|a[10]>>>3),i+1e4>Un&&o===null?++u>524287&&(u=0,++l>4095&&(l=0,Un++)):Un=i,Fv=l,Mv=u,s[r++]=Un/1099511627776&255,s[r++]=Un/4294967296&255,s[r++]=Un/16777216&255,s[r++]=Un/65536&255,s[r++]=Un/256&255,s[r++]=Un&255,s[r++]=l>>>4&15|112,s[r++]=l&255,s[r++]=u>>>13&63|128,s[r++]=u>>>5&255,s[r++]=u<<3&255|a[10]&7,s[r++]=a[11],s[r++]=a[12],s[r++]=a[13],s[r++]=a[14],s[r++]=a[15],e||$g(s)}var D2={};je(D2,{BaseCallbackHandler:()=>Sl,callbackHandlerPrefersStreaming:()=>Lg,isBaseCallbackHandler:()=>WS});var M2=class{};function Lg(t){return"lc_prefer_streaming"in t&&t.lc_prefer_streaming}var Sl=class extends M2{constructor(e){super();k(this,"lc_serializable",!1);k(this,"lc_kwargs");k(this,"ignoreLLM",!1);k(this,"ignoreChain",!1);k(this,"ignoreAgent",!1);k(this,"ignoreRetriever",!1);k(this,"ignoreCustomEvent",!1);k(this,"raiseError",!1);k(this,"awaitHandlers",Nr("LANGCHAIN_CALLBACKS_BACKGROUND")==="false");this.lc_kwargs=e||{},e&&(this.ignoreLLM=e.ignoreLLM??this.ignoreLLM,this.ignoreChain=e.ignoreChain??this.ignoreChain,this.ignoreAgent=e.ignoreAgent??this.ignoreAgent,this.ignoreRetriever=e.ignoreRetriever??this.ignoreRetriever,this.ignoreCustomEvent=e.ignoreCustomEvent??this.ignoreCustomEvent,this.raiseError=e.raiseError??this.raiseError,this.awaitHandlers=this.raiseError||(e._awaitHandler??this.awaitHandlers))}get lc_namespace(){return["langchain_core","callbacks",this.name]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}get lc_serializable_keys(){}static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,Eg(this.constructor)]}copy(){return new this.constructor(this)}toJSON(){return ci.prototype.toJSON.call(this)}toJSONNotImplemented(){return ci.prototype.toJSONNotImplemented.call(this)}static fromMethods(e){class n extends Sl{constructor(){super();k(this,"name",rn());Object.assign(this,e)}}return new n}};const WS=t=>{const e=t;return e!==void 0&&typeof e.copy=="function"&&typeof e.name=="string"&&typeof e.awaitHandlers=="boolean"},F2="gen_ai.operation.name",z2="gen_ai.system",zv="gen_ai.request.model",U2="gen_ai.response.model",Uv="gen_ai.usage.input_tokens",Bv="gen_ai.usage.output_tokens",Gv="gen_ai.usage.total_tokens",B2="gen_ai.request.max_tokens",G2="gen_ai.request.temperature",H2="gen_ai.request.top_p",W2="gen_ai.request.frequency_penalty",V2="gen_ai.request.presence_penalty",q2="gen_ai.response.finish_reasons",Z2="gen_ai.prompt",K2="gen_ai.completion",J2="gen_ai.request.extra_query",Y2="gen_ai.request.extra_body",Q2="gen_ai.serialized.name",X2="gen_ai.serialized.signature",ej="gen_ai.serialized.doc",tj="gen_ai.response.id",nj="gen_ai.response.service_tier",rj="gen_ai.response.system_fingerprint",sj="gen_ai.usage.input_token_details",aj="gen_ai.usage.output_token_details",ij="langsmith.trace.session_id",oj="langsmith.trace.session_name",lj="langsmith.span.kind",cj="langsmith.trace.name",uj="langsmith.metadata",Hv="langsmith.span.tags",dj="langsmith.request.streaming",hj="langsmith.request.headers",fj=(...t)=>fetch(...t),VS=Symbol.for("ls:fetch_implementation"),mj=()=>{const t=globalThis[VS];return t?typeof t=="function"&&"Headers"in t&&"Request"in t&&"Response"in t:!1},pj=t=>async(...e)=>{if(t||sn("DEBUG")==="true"){const[r,s]=e;console.log(` ${(s==null?void 0:s.method)||"GET"} ${r}`)}const n=await(globalThis[VS]??fj)(...e);return(t||sn("DEBUG")==="true")&&console.log(` ${n.status} ${n.statusText} ${n.url}`),n},qS=()=>sn("PROJECT")??jr("LANGCHAIN_SESSION")??"default",Wv={};function Tm(t){Wv[t]||(console.warn(t),Wv[t]=!0)}const gj=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function ke(t,e){if(!gj.test(t)){const n=e!==void 0?`Invalid UUID for ${e}: ${t}`:`Invalid UUID: ${t}`;throw new Error(n)}return t}function yj(t){const e=typeof t=="string"?Date.parse(t):t;return L2({msecs:e,seq:0})}const ZS="0.3.82";var jo={};let hr;const vj=()=>typeof window<"u"&&typeof window.document<"u",_j=()=>typeof globalThis=="object"&&globalThis.constructor&&globalThis.constructor.name==="DedicatedWorkerGlobalScope",wj=()=>typeof window<"u"&&window.name==="nodejs"||typeof navigator<"u"&&navigator.userAgent.includes("jsdom"),KS=()=>typeof Deno<"u",xj=()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"&&!KS(),JS=()=>hr||(typeof Bun<"u"?hr="bun":vj()?hr="browser":xj()?hr="node":_j()?hr="webworker":wj()?hr="jsdom":KS()?hr="deno":hr="other",hr);let Gh;function YS(){if(Gh===void 0){const t=JS(),e=Sj();Gh={library:"langsmith",runtime:t,sdk:"langsmith-js",sdk_version:ZS,...e}}return Gh}function QS(){const t=bj(),e={},n=["LANGCHAIN_API_KEY","LANGCHAIN_ENDPOINT","LANGCHAIN_TRACING_V2","LANGCHAIN_PROJECT","LANGCHAIN_SESSION","LANGSMITH_API_KEY","LANGSMITH_ENDPOINT","LANGSMITH_TRACING_V2","LANGSMITH_PROJECT","LANGSMITH_SESSION"];for(const[r,s]of Object.entries(t))typeof s=="string"&&!n.includes(r)&&!r.toLowerCase().includes("key")&&!r.toLowerCase().includes("secret")&&!r.toLowerCase().includes("token")&&(r==="LANGCHAIN_REVISION_ID"?e.revision_id=s:e[r]=s);return e}function bj(){const t={};try{if(typeof process<"u"&&jo)for(const[e,n]of Object.entries(jo))(e.startsWith("LANGCHAIN_")||e.startsWith("LANGSMITH_"))&&n!=null&&((e.toLowerCase().includes("key")||e.toLowerCase().includes("secret")||e.toLowerCase().includes("token"))&&typeof n=="string"?t[e]=n.slice(0,2)+"*".repeat(n.length-4)+n.slice(-2):t[e]=n)}catch{}return t}function jr(t){try{return typeof process<"u"?jo==null?void 0:jo[t]:void 0}catch{return}}function sn(t){return jr(`LANGSMITH_${t}`)||jr(`LANGCHAIN_${t}`)}let Hh;function Sj(){if(Hh!==void 0)return Hh;const t=["VERCEL_GIT_COMMIT_SHA","NEXT_PUBLIC_VERCEL_GIT_COMMIT_SHA","COMMIT_REF","RENDER_GIT_COMMIT","CI_COMMIT_SHA","CIRCLE_SHA1","CF_PAGES_COMMIT_SHA","REACT_APP_GIT_SHA","SOURCE_VERSION","GITHUB_SHA","TRAVIS_COMMIT","GIT_COMMIT","BUILD_VCS_NUMBER","bamboo_planRepository_revision","Build.SourceVersion","BITBUCKET_COMMIT","DRONE_COMMIT_SHA","SEMAPHORE_GIT_SHA","BUILDKITE_COMMIT"],e={};for(const n of t){const r=jr(n);r!==void 0&&(e[n]=r)}return Hh=e,e}function XS(){return jr("OTEL_ENABLED")==="true"||sn("OTEL_ENABLED")==="true"}class kj{constructor(){Object.defineProperty(this,"hasWarned",{enumerable:!0,configurable:!0,writable:!0,value:!1})}startActiveSpan(e,...n){!this.hasWarned&&XS()&&(console.warn('You have enabled OTEL export via the `OTEL_ENABLED` or `LANGSMITH_OTEL_ENABLED` environment variable, but have not initialized the required OTEL instances. Please add:\n```\nimport { initializeOTEL } from "langsmith/experimental/otel/setup";\ninitializeOTEL();\n```\nat the beginning of your code.'),this.hasWarned=!0);let r;if(n.length===1&&typeof n[0]=="function"?r=n[0]:n.length===2&&typeof n[1]=="function"?r=n[1]:n.length===3&&typeof n[2]=="function"&&(r=n[2]),typeof r=="function")return r()}}class Ej{constructor(){Object.defineProperty(this,"mockTracer",{enumerable:!0,configurable:!0,writable:!0,value:new kj})}getTracer(e,n){return this.mockTracer}getActiveSpan(){}setSpan(e,n){return e}getSpan(e){}setSpanContext(e,n){return e}getTracerProvider(){}setGlobalTracerProvider(e){return!1}}class Nj{active(){return{}}with(e,n){return n()}}const Wh=Symbol.for("ls:otel_trace"),Vh=Symbol.for("ls:otel_context"),Vv=Symbol.for("ls:otel_get_default_otlp_tracer_provider"),Tj=new Ej,Aj=new Nj;class Cj{getTraceInstance(){return globalThis[Wh]??Tj}getContextInstance(){return globalThis[Vh]??Aj}initializeGlobalInstances(e){globalThis[Wh]===void 0&&(globalThis[Wh]=e.trace),globalThis[Vh]===void 0&&(globalThis[Vh]=e.context)}setDefaultOTLPTracerComponents(e){globalThis[Vv]=e}getDefaultOTLPTracerComponents(){return globalThis[Vv]??void 0}}const Dg=new Cj;function ek(){return Dg.getTraceInstance()}function Ij(){return Dg.getContextInstance()}function jj(){return Dg.getDefaultOTLPTracerComponents()}const Rj={llm:"chat",tool:"execute_tool",retriever:"embeddings",embedding:"embeddings",prompt:"chat"};function Oj(t){return Rj[t]||t}class Pj{constructor(){Object.defineProperty(this,"spans",{enumerable:!0,configurable:!0,writable:!0,value:new Map})}exportBatch(e,n){for(const r of e)try{if(!r.run)continue;if(r.operation==="post"){const s=this.createSpanForRun(r,r.run,n.get(r.id));s&&!r.run.end_time&&this.spans.set(r.id,s)}else this.updateSpanForRun(r,r.run)}catch(s){console.error(`Error processing operation ${r.id}:`,s)}}createSpanForRun(e,n,r){const s=r&&ek().getSpan(r);if(s)try{return this.finishSpanSetup(s,n,e)}catch(a){console.error(`Failed to create span for run ${e.id}:`,a);return}}finishSpanSetup(e,n,r){return this.setSpanAttributes(e,n,r),n.error?(e.setStatus({code:2}),e.recordException(new Error(n.error))):e.setStatus({code:1}),n.end_time&&e.end(new Date(n.end_time)),e}updateSpanForRun(e,n){try{const r=this.spans.get(e.id);if(!r){console.debug(`No span found for run ${e.id} during update`);return}this.setSpanAttributes(r,n,e),n.error?(r.setStatus({code:2}),r.recordException(new Error(n.error))):r.setStatus({code:1});const s=n.end_time;s&&(r.end(new Date(s)),this.spans.delete(e.id))}catch(r){console.error(`Failed to update span for run ${e.id}:`,r)}}extractModelName(e){var n;if((n=e.extra)!=null&&n.metadata){const r=e.extra.metadata;if(r.ls_model_name)return r.ls_model_name;if(r.invocation_params){const s=r.invocation_params;if(s.model)return s.model;if(s.model_name)return s.model_name}}}setSpanAttributes(e,n,r){var o;if("run_type"in n&&n.run_type){e.setAttribute(lj,n.run_type);const l=Oj(n.run_type||"chain");e.setAttribute(F2,l)}"name"in n&&n.name&&e.setAttribute(cj,n.name),"session_id"in n&&n.session_id&&e.setAttribute(ij,n.session_id),"session_name"in n&&n.session_name&&e.setAttribute(oj,n.session_name),this.setGenAiSystem(e,n);const s=this.extractModelName(n);s&&e.setAttribute(zv,s),"prompt_tokens"in n&&typeof n.prompt_tokens=="number"&&e.setAttribute(Uv,n.prompt_tokens),"completion_tokens"in n&&typeof n.completion_tokens=="number"&&e.setAttribute(Bv,n.completion_tokens),"total_tokens"in n&&typeof n.total_tokens=="number"&&e.setAttribute(Gv,n.total_tokens),this.setInvocationParameters(e,n);const a=((o=n.extra)==null?void 0:o.metadata)||{};for(const[l,u]of Object.entries(a))u!=null&&e.setAttribute(`${uj}.${l}`,String(u));const i=n.tags;if(i&&Array.isArray(i)?e.setAttribute(Hv,i.join(", ")):i&&e.setAttribute(Hv,String(i)),"serialized"in n&&typeof n.serialized=="object"){const l=n.serialized;l.name&&e.setAttribute(Q2,String(l.name)),l.signature&&e.setAttribute(X2,String(l.signature)),l.doc&&e.setAttribute(ej,String(l.doc))}this.setIOAttributes(e,r)}setGenAiSystem(e,n){let r="langchain";const s=this.extractModelName(n);if(s){const a=s.toLowerCase();a.includes("anthropic")||a.startsWith("claude")?r="anthropic":a.includes("bedrock")?r="aws.bedrock":a.includes("azure")&&a.includes("openai")?r="az.ai.openai":a.includes("azure")&&a.includes("inference")?r="az.ai.inference":a.includes("cohere")?r="cohere":a.includes("deepseek")?r="deepseek":a.includes("gemini")?r="gemini":a.includes("groq")?r="groq":a.includes("watson")||a.includes("ibm")?r="ibm.watsonx.ai":a.includes("mistral")?r="mistral_ai":a.includes("gpt")||a.includes("openai")?r="openai":a.includes("perplexity")||a.includes("sonar")?r="perplexity":a.includes("vertex")?r="vertex_ai":(a.includes("xai")||a.includes("grok"))&&(r="xai")}e.setAttribute(z2,r)}setInvocationParameters(e,n){var s,a;if(!((a=(s=n.extra)==null?void 0:s.metadata)!=null&&a.invocation_params))return;const r=n.extra.metadata.invocation_params;r.max_tokens!==void 0&&e.setAttribute(B2,r.max_tokens),r.temperature!==void 0&&e.setAttribute(G2,r.temperature),r.top_p!==void 0&&e.setAttribute(H2,r.top_p),r.frequency_penalty!==void 0&&e.setAttribute(W2,r.frequency_penalty),r.presence_penalty!==void 0&&e.setAttribute(V2,r.presence_penalty)}setIOAttributes(e,n){if(n.run.inputs)try{const r=n.run.inputs;typeof r=="object"&&r!==null&&(r.model&&Array.isArray(r.messages)&&e.setAttribute(zv,r.model),r.stream!==void 0&&e.setAttribute(dj,r.stream),r.extra_headers&&e.setAttribute(hj,JSON.stringify(r.extra_headers)),r.extra_query&&e.setAttribute(J2,JSON.stringify(r.extra_query)),r.extra_body&&e.setAttribute(Y2,JSON.stringify(r.extra_body))),e.setAttribute(Z2,JSON.stringify(r))}catch(r){console.debug(`Failed to process inputs for run ${n.id}`,r)}if(n.run.outputs)try{const r=n.run.outputs,s=this.getUnifiedRunTokens(r);if(s&&(e.setAttribute(Uv,s[0]),e.setAttribute(Bv,s[1]),e.setAttribute(Gv,s[0]+s[1])),r&&typeof r=="object"){if(r.model&&e.setAttribute(U2,String(r.model)),r.id&&e.setAttribute(tj,r.id),r.choices&&Array.isArray(r.choices)){const a=r.choices.map(i=>i.finish_reason).filter(i=>i).map(String);a.length>0&&e.setAttribute(q2,a.join(", "))}if(r.service_tier&&e.setAttribute(nj,r.service_tier),r.system_fingerprint&&e.setAttribute(rj,r.system_fingerprint),r.usage_metadata&&typeof r.usage_metadata=="object"){const a=r.usage_metadata;a.input_token_details&&e.setAttribute(sj,JSON.stringify(a.input_token_details)),a.output_token_details&&e.setAttribute(aj,JSON.stringify(a.output_token_details))}}e.setAttribute(K2,JSON.stringify(r))}catch(r){console.debug(`Failed to process outputs for run ${n.id}`,r)}}getUnifiedRunTokens(e){if(!e)return null;let n=this.extractUnifiedRunTokens(e.usage_metadata);if(n)return n;const r=Object.keys(e);for(const i of r){const o=e[i];if(!(!o||typeof o!="object")&&(n=this.extractUnifiedRunTokens(o.usage_metadata),n||o.lc===1&&o.kwargs&&typeof o.kwargs=="object"&&(n=this.extractUnifiedRunTokens(o.kwargs.usage_metadata),n)))return n}const s=e.generations||[];if(!Array.isArray(s))return null;const a=Array.isArray(s[0])?s.flat():s;for(const i of a)if(typeof i=="object"&&i.message&&typeof i.message=="object"&&i.message.kwargs&&typeof i.message.kwargs=="object"&&(n=this.extractUnifiedRunTokens(i.message.kwargs.usage_metadata),n))return n;return null}extractUnifiedRunTokens(e){return!e||typeof e!="object"||typeof e.input_tokens!="number"||typeof e.output_tokens!="number"?null:[e.input_tokens,e.output_tokens]}}const $j=Object.prototype.toString,Lj=t=>$j.call(t)==="[object Error]",Dj=new Set(["network error","Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed","fetch failed","terminated"," A network error occurred.","Network connection lost"]);function Mj(t){if(!(t&&Lj(t)&&t.name==="TypeError"&&typeof t.message=="string"))return!1;const{message:n,stack:r}=t;return n==="Load failed"?r===void 0||"__sentry_captured__"in t:n.startsWith("error sending request for url")?!0:Dj.has(n)}function Fj(t){if(typeof t=="number"){if(t<0)throw new TypeError("Expected `retries` to be a non-negative number.");if(Number.isNaN(t))throw new TypeError("Expected `retries` to be a valid number or Infinity, got NaN.")}else if(t!==void 0)throw new TypeError("Expected `retries` to be a number or Infinity.")}function ac(t,e,{min:n=0,allowInfinity:r=!1}={}){if(e!==void 0){if(typeof e!="number"||Number.isNaN(e))throw new TypeError(`Expected \`${t}\` to be a number${r?" or Infinity":""}.`);if(!r&&!Number.isFinite(e))throw new TypeError(`Expected \`${t}\` to be a finite number.`);if(e<n)throw new TypeError(`Expected \`${t}\` to be  ${n}.`)}}let zj=class extends Error{constructor(e){super(),e instanceof Error?(this.originalError=e,{message:e}=e):(this.originalError=new Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}};function Uj(t,e){const n=Math.max(1,t+1),r=e.randomize?Math.random()+1:1;let s=Math.round(r*e.minTimeout*e.factor**(n-1));return s=Math.min(s,e.maxTimeout),s}function qv(t,e){return Number.isFinite(e)?e-(performance.now()-t):e}async function Bj({error:t,attemptNumber:e,retriesConsumed:n,startTime:r,options:s}){var m,v,w;const a=t instanceof Error?t:new TypeError(`Non-error was thrown: "${t}". You should only throw errors.`);if(a instanceof zj)throw a.originalError;const i=Number.isFinite(s.retries)?Math.max(0,s.retries-n):s.retries,o=s.maxRetryTime??Number.POSITIVE_INFINITY,l=Object.freeze({error:a,attemptNumber:e,retriesLeft:i,retriesConsumed:n});if(await s.onFailedAttempt(l),qv(r,o)<=0)throw a;const u=await s.shouldConsumeRetry(l),d=qv(r,o);if(d<=0||i<=0)throw a;if(a instanceof TypeError&&!Mj(a)){if(u)throw a;return(m=s.signal)==null||m.throwIfAborted(),!1}if(!await s.shouldRetry(l))throw a;if(!u)return(v=s.signal)==null||v.throwIfAborted(),!1;const h=Uj(n,s),f=Math.min(h,d);return f>0&&await new Promise((_,y)=>{var S,N;const p=()=>{var T;clearTimeout(g),(T=s.signal)==null||T.removeEventListener("abort",p),y(s.signal.reason)},g=setTimeout(()=>{var T;(T=s.signal)==null||T.removeEventListener("abort",p),_()},f);s.unref&&((S=g.unref)==null||S.call(g)),(N=s.signal)==null||N.addEventListener("abort",p,{once:!0})}),(w=s.signal)==null||w.throwIfAborted(),!0}async function Gj(t,e={}){var a,i,o;if(e={...e},Fj(e.retries),Object.hasOwn(e,"forever"))throw new Error("The `forever` option is no longer supported. For many use-cases, you can set `retries: Infinity` instead.");e.retries??(e.retries=10),e.factor??(e.factor=2),e.minTimeout??(e.minTimeout=1e3),e.maxTimeout??(e.maxTimeout=Number.POSITIVE_INFINITY),e.maxRetryTime??(e.maxRetryTime=Number.POSITIVE_INFINITY),e.randomize??(e.randomize=!1),e.onFailedAttempt??(e.onFailedAttempt=()=>{}),e.shouldRetry??(e.shouldRetry=()=>!0),e.shouldConsumeRetry??(e.shouldConsumeRetry=()=>!0),ac("factor",e.factor,{min:0,allowInfinity:!1}),ac("minTimeout",e.minTimeout,{min:0,allowInfinity:!1}),ac("maxTimeout",e.maxTimeout,{min:0,allowInfinity:!0}),ac("maxRetryTime",e.maxRetryTime,{min:0,allowInfinity:!0}),e.factor>0||(e.factor=1),(a=e.signal)==null||a.throwIfAborted();let n=0,r=0;const s=performance.now();for(;!Number.isFinite(e.retries)||r<=e.retries;){n++;try{(i=e.signal)==null||i.throwIfAborted();const l=await t(n);return(o=e.signal)==null||o.throwIfAborted(),l}catch(l){await Bj({error:l,attemptNumber:n,retriesConsumed:r,startTime:s,options:e})&&r++}}throw new Error("Retry attempts exhausted without throwing an error.")}var tk={},nk={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function s(l,u,d){this.fn=l,this.context=u,this.once=d||!1}function a(l,u,d,h,f){if(typeof d!="function")throw new TypeError("The listener must be a function");var m=new s(d,h||l,f),v=n?n+u:u;return l._events[v]?l._events[v].fn?l._events[v]=[l._events[v],m]:l._events[v].push(m):(l._events[v]=m,l._eventsCount++),l}function i(l,u){--l._eventsCount===0?l._events=new r:delete l._events[u]}function o(){this._events=new r,this._eventsCount=0}o.prototype.eventNames=function(){var u=[],d,h;if(this._eventsCount===0)return u;for(h in d=this._events)e.call(d,h)&&u.push(n?h.slice(1):h);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},o.prototype.listeners=function(u){var d=n?n+u:u,h=this._events[d];if(!h)return[];if(h.fn)return[h.fn];for(var f=0,m=h.length,v=new Array(m);f<m;f++)v[f]=h[f].fn;return v},o.prototype.listenerCount=function(u){var d=n?n+u:u,h=this._events[d];return h?h.fn?1:h.length:0},o.prototype.emit=function(u,d,h,f,m,v){var w=n?n+u:u;if(!this._events[w])return!1;var _=this._events[w],y=arguments.length,p,g;if(_.fn){switch(_.once&&this.removeListener(u,_.fn,void 0,!0),y){case 1:return _.fn.call(_.context),!0;case 2:return _.fn.call(_.context,d),!0;case 3:return _.fn.call(_.context,d,h),!0;case 4:return _.fn.call(_.context,d,h,f),!0;case 5:return _.fn.call(_.context,d,h,f,m),!0;case 6:return _.fn.call(_.context,d,h,f,m,v),!0}for(g=1,p=new Array(y-1);g<y;g++)p[g-1]=arguments[g];_.fn.apply(_.context,p)}else{var S=_.length,N;for(g=0;g<S;g++)switch(_[g].once&&this.removeListener(u,_[g].fn,void 0,!0),y){case 1:_[g].fn.call(_[g].context);break;case 2:_[g].fn.call(_[g].context,d);break;case 3:_[g].fn.call(_[g].context,d,h);break;case 4:_[g].fn.call(_[g].context,d,h,f);break;default:if(!p)for(N=1,p=new Array(y-1);N<y;N++)p[N-1]=arguments[N];_[g].fn.apply(_[g].context,p)}}return!0},o.prototype.on=function(u,d,h){return a(this,u,d,h,!1)},o.prototype.once=function(u,d,h){return a(this,u,d,h,!0)},o.prototype.removeListener=function(u,d,h,f){var m=n?n+u:u;if(!this._events[m])return this;if(!d)return i(this,m),this;var v=this._events[m];if(v.fn)v.fn===d&&(!f||v.once)&&(!h||v.context===h)&&i(this,m);else{for(var w=0,_=[],y=v.length;w<y;w++)(v[w].fn!==d||f&&!v[w].once||h&&v[w].context!==h)&&_.push(v[w]);_.length?this._events[m]=_.length===1?_[0]:_:i(this,m)}return this},o.prototype.removeAllListeners=function(u){var d;return u?(d=n?n+u:u,this._events[d]&&i(this,d)):(this._events=new r,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=n,o.EventEmitter=o,t.exports=o})(nk);var Hj=nk.exports,Td={exports:{}},Wj=(t,e)=>(e=e||(()=>{}),t.then(n=>new Promise(r=>{r(e())}).then(()=>n),n=>new Promise(r=>{r(e())}).then(()=>{throw n})));const Vj=Wj;class rk extends Error{constructor(e){super(e),this.name="TimeoutError"}}const sk=(t,e,n)=>new Promise((r,s)=>{if(typeof e!="number"||e<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(e===1/0){r(t);return}const a=setTimeout(()=>{if(typeof n=="function"){try{r(n())}catch(l){s(l)}return}const i=typeof n=="string"?n:`Promise timed out after ${e} milliseconds`,o=n instanceof Error?n:new rk(i);typeof t.cancel=="function"&&t.cancel(),s(o)},e);Vj(t.then(r,s),()=>{clearTimeout(a)})});Td.exports=sk;Td.exports.default=sk;Td.exports.TimeoutError=rk;var qj=Td.exports,Mg={},Fg={};Object.defineProperty(Fg,"__esModule",{value:!0});function Zj(t,e,n){let r=0,s=t.length;for(;s>0;){const a=s/2|0;let i=r+a;n(t[i],e)<=0?(r=++i,s-=a+1):s=a}return r}Fg.default=Zj;Object.defineProperty(Mg,"__esModule",{value:!0});const Kj=Fg;class Jj{constructor(){this._queue=[]}enqueue(e,n){n=Object.assign({priority:0},n);const r={priority:n.priority,run:e};if(this.size&&this._queue[this.size-1].priority>=n.priority){this._queue.push(r);return}const s=Kj.default(this._queue,r,(a,i)=>i.priority-a.priority);this._queue.splice(s,0,r)}dequeue(){const e=this._queue.shift();return e==null?void 0:e.run}filter(e){return this._queue.filter(n=>n.priority===e.priority).map(n=>n.run)}get size(){return this._queue.length}}Mg.default=Jj;Object.defineProperty(tk,"__esModule",{value:!0});const Yj=Hj,ak=qj,Qj=Mg,ic=()=>{},Xj=new ak.TimeoutError;class eR extends Yj{constructor(e){var n,r,s,a;if(super(),this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=ic,this._resolveIdle=ic,e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:Qj.default},e),!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(r=(n=e.intervalCap)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(a=(s=e.interval)===null||s===void 0?void 0:s.toString())!==null&&a!==void 0?a:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||e.interval===0,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=e.throwOnTimeout===!0,this._isPaused=e.autoStart===!1}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=ic,this._pendingCount===0&&(this._resolveIdle(),this._resolveIdle=ic,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){const e=Date.now();if(this._intervalId===void 0){const n=this._intervalEnd-e;if(n<0)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return this._timeoutId===void 0&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},n)),!0}return!1}_tryToStartAnother(){if(this._queue.size===0)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){const e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){const n=this._queue.dequeue();return n?(this.emit("active"),n(),e&&this._initializeIntervalIfNeeded(),!0):!1}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||this._intervalId!==void 0||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){this._intervalCount===0&&this._pendingCount===0&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,n={}){return new Promise((r,s)=>{const a=async()=>{this._pendingCount++,this._intervalCount++;try{const i=this._timeout===void 0&&n.timeout===void 0?e():ak.default(Promise.resolve(e()),n.timeout===void 0?this._timeout:n.timeout,()=>{(n.throwOnTimeout===void 0?this._throwOnTimeout:n.throwOnTimeout)&&s(Xj)});r(await i)}catch(i){s(i)}this._next()};this._queue.enqueue(a,n),this._tryToStartAnother(),this.emit("add")})}async addAll(e,n){return Promise.all(e.map(async r=>this.add(r,n)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(this._queue.size!==0)return new Promise(e=>{const n=this._resolveEmpty;this._resolveEmpty=()=>{n(),e()}})}async onIdle(){if(!(this._pendingCount===0&&this._queue.size===0))return new Promise(e=>{const n=this._resolveIdle;this._resolveIdle=()=>{n(),e()}})}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}}var Hr=tk.default=eR;const tR=[408,425,429,500,502,503,504];let Zv=class{constructor(e){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxQueueSizeBytes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onFailedResponseHook",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queueSizeBytes",{enumerable:!0,configurable:!0,writable:!0,value:0}),this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6,this.maxQueueSizeBytes=e.maxQueueSizeBytes,"default"in Hr?this.queue=new Hr.default({concurrency:this.maxConcurrency}):this.queue=new Hr({concurrency:this.maxConcurrency}),this.onFailedResponseHook=e==null?void 0:e.onFailedResponseHook}call(e,...n){return this.callWithOptions({},e,...n)}callWithOptions(e,n,...r){const s=e.sizeBytes??0;if(this.maxQueueSizeBytes!==void 0&&s>0&&this.queueSizeBytes+s>this.maxQueueSizeBytes)return Promise.reject(new Error(`Queue size limit (${this.maxQueueSizeBytes} bytes) exceeded. Current queue size: ${this.queueSizeBytes} bytes, attempted addition: ${s} bytes.`));s>0&&(this.queueSizeBytes+=s);const a=this.onFailedResponseHook;let i=this.queue.add(()=>Gj(()=>n(...r).catch(o=>{throw o instanceof Error?o:new Error(o)}),{async onFailedAttempt({error:o}){if(o.message.startsWith("Cancel")||o.message.startsWith("TimeoutError")||o.name==="TimeoutError"||o.message.startsWith("AbortError")||(o==null?void 0:o.code)==="ECONNABORTED")throw o;const l=o==null?void 0:o.response;if(a&&await a(l))return;const u=(l==null?void 0:l.status)??(o==null?void 0:o.status);if(u&&!tR.includes(+u))throw o},retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0});return s>0&&(i=i.finally(()=>{this.queueSizeBytes-=s})),e.signal?Promise.race([i,new Promise((o,l)=>{var u;(u=e.signal)==null||u.addEventListener("abort",()=>{l(new Error("AbortError"))})})]):i}};function Kv(t){return typeof(t==null?void 0:t._getType)=="function"}function Jv(t){const e={type:t._getType(),data:{content:t.content}};return t!=null&&t.additional_kwargs&&Object.keys(t.additional_kwargs).length>0&&(e.data.additional_kwargs={...t.additional_kwargs}),e}var Am={exports:{}};const nR="2.0.0",ik=256,rR=Number.MAX_SAFE_INTEGER||9007199254740991,sR=16,aR=ik-6,iR=["major","premajor","minor","preminor","patch","prepatch","prerelease"];var Ad={MAX_LENGTH:ik,MAX_SAFE_COMPONENT_LENGTH:sR,MAX_SAFE_BUILD_LENGTH:aR,MAX_SAFE_INTEGER:rR,RELEASE_TYPES:iR,SEMVER_SPEC_VERSION:nR,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},qh={};const oR=typeof process=="object"&&qh&&qh.NODE_DEBUG&&/\bsemver\b/i.test(qh.NODE_DEBUG)?(...t)=>console.error("SEMVER",...t):()=>{};var Cd=oR;(function(t,e){const{MAX_SAFE_COMPONENT_LENGTH:n,MAX_SAFE_BUILD_LENGTH:r,MAX_LENGTH:s}=Ad,a=Cd;e=t.exports={};const i=e.re=[],o=e.safeRe=[],l=e.src=[],u=e.safeSrc=[],d=e.t={};let h=0;const f="[a-zA-Z0-9-]",m=[["\\s",1],["\\d",s],[f,r]],v=_=>{for(const[y,p]of m)_=_.split(`${y}*`).join(`${y}{0,${p}}`).split(`${y}+`).join(`${y}{1,${p}}`);return _},w=(_,y,p)=>{const g=v(y),S=h++;a(_,S,y),d[_]=S,l[S]=y,u[S]=g,i[S]=new RegExp(y,p?"g":void 0),o[S]=new RegExp(g,p?"g":void 0)};w("NUMERICIDENTIFIER","0|[1-9]\\d*"),w("NUMERICIDENTIFIERLOOSE","\\d+"),w("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${f}*`),w("MAINVERSION",`(${l[d.NUMERICIDENTIFIER]})\\.(${l[d.NUMERICIDENTIFIER]})\\.(${l[d.NUMERICIDENTIFIER]})`),w("MAINVERSIONLOOSE",`(${l[d.NUMERICIDENTIFIERLOOSE]})\\.(${l[d.NUMERICIDENTIFIERLOOSE]})\\.(${l[d.NUMERICIDENTIFIERLOOSE]})`),w("PRERELEASEIDENTIFIER",`(?:${l[d.NONNUMERICIDENTIFIER]}|${l[d.NUMERICIDENTIFIER]})`),w("PRERELEASEIDENTIFIERLOOSE",`(?:${l[d.NONNUMERICIDENTIFIER]}|${l[d.NUMERICIDENTIFIERLOOSE]})`),w("PRERELEASE",`(?:-(${l[d.PRERELEASEIDENTIFIER]}(?:\\.${l[d.PRERELEASEIDENTIFIER]})*))`),w("PRERELEASELOOSE",`(?:-?(${l[d.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${l[d.PRERELEASEIDENTIFIERLOOSE]})*))`),w("BUILDIDENTIFIER",`${f}+`),w("BUILD",`(?:\\+(${l[d.BUILDIDENTIFIER]}(?:\\.${l[d.BUILDIDENTIFIER]})*))`),w("FULLPLAIN",`v?${l[d.MAINVERSION]}${l[d.PRERELEASE]}?${l[d.BUILD]}?`),w("FULL",`^${l[d.FULLPLAIN]}$`),w("LOOSEPLAIN",`[v=\\s]*${l[d.MAINVERSIONLOOSE]}${l[d.PRERELEASELOOSE]}?${l[d.BUILD]}?`),w("LOOSE",`^${l[d.LOOSEPLAIN]}$`),w("GTLT","((?:<|>)?=?)"),w("XRANGEIDENTIFIERLOOSE",`${l[d.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),w("XRANGEIDENTIFIER",`${l[d.NUMERICIDENTIFIER]}|x|X|\\*`),w("XRANGEPLAIN",`[v=\\s]*(${l[d.XRANGEIDENTIFIER]})(?:\\.(${l[d.XRANGEIDENTIFIER]})(?:\\.(${l[d.XRANGEIDENTIFIER]})(?:${l[d.PRERELEASE]})?${l[d.BUILD]}?)?)?`),w("XRANGEPLAINLOOSE",`[v=\\s]*(${l[d.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[d.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[d.XRANGEIDENTIFIERLOOSE]})(?:${l[d.PRERELEASELOOSE]})?${l[d.BUILD]}?)?)?`),w("XRANGE",`^${l[d.GTLT]}\\s*${l[d.XRANGEPLAIN]}$`),w("XRANGELOOSE",`^${l[d.GTLT]}\\s*${l[d.XRANGEPLAINLOOSE]}$`),w("COERCEPLAIN",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?`),w("COERCE",`${l[d.COERCEPLAIN]}(?:$|[^\\d])`),w("COERCEFULL",l[d.COERCEPLAIN]+`(?:${l[d.PRERELEASE]})?(?:${l[d.BUILD]})?(?:$|[^\\d])`),w("COERCERTL",l[d.COERCE],!0),w("COERCERTLFULL",l[d.COERCEFULL],!0),w("LONETILDE","(?:~>?)"),w("TILDETRIM",`(\\s*)${l[d.LONETILDE]}\\s+`,!0),e.tildeTrimReplace="$1~",w("TILDE",`^${l[d.LONETILDE]}${l[d.XRANGEPLAIN]}$`),w("TILDELOOSE",`^${l[d.LONETILDE]}${l[d.XRANGEPLAINLOOSE]}$`),w("LONECARET","(?:\\^)"),w("CARETTRIM",`(\\s*)${l[d.LONECARET]}\\s+`,!0),e.caretTrimReplace="$1^",w("CARET",`^${l[d.LONECARET]}${l[d.XRANGEPLAIN]}$`),w("CARETLOOSE",`^${l[d.LONECARET]}${l[d.XRANGEPLAINLOOSE]}$`),w("COMPARATORLOOSE",`^${l[d.GTLT]}\\s*(${l[d.LOOSEPLAIN]})$|^$`),w("COMPARATOR",`^${l[d.GTLT]}\\s*(${l[d.FULLPLAIN]})$|^$`),w("COMPARATORTRIM",`(\\s*)${l[d.GTLT]}\\s*(${l[d.LOOSEPLAIN]}|${l[d.XRANGEPLAIN]})`,!0),e.comparatorTrimReplace="$1$2$3",w("HYPHENRANGE",`^\\s*(${l[d.XRANGEPLAIN]})\\s+-\\s+(${l[d.XRANGEPLAIN]})\\s*$`),w("HYPHENRANGELOOSE",`^\\s*(${l[d.XRANGEPLAINLOOSE]})\\s+-\\s+(${l[d.XRANGEPLAINLOOSE]})\\s*$`),w("STAR","(<|>)?=?\\s*\\*"),w("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),w("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})(Am,Am.exports);var kl=Am.exports;const lR=Object.freeze({loose:!0}),cR=Object.freeze({}),uR=t=>t?typeof t!="object"?lR:t:cR;var zg=uR;const Yv=/^[0-9]+$/,ok=(t,e)=>{if(typeof t=="number"&&typeof e=="number")return t===e?0:t<e?-1:1;const n=Yv.test(t),r=Yv.test(e);return n&&r&&(t=+t,e=+e),t===e?0:n&&!r?-1:r&&!n?1:t<e?-1:1},dR=(t,e)=>ok(e,t);var lk={compareIdentifiers:ok,rcompareIdentifiers:dR};const oc=Cd,{MAX_LENGTH:Qv,MAX_SAFE_INTEGER:lc}=Ad,{safeRe:cc,t:uc}=kl,hR=zg,{compareIdentifiers:Zh}=lk;let fR=class mr{constructor(e,n){if(n=hR(n),e instanceof mr){if(e.loose===!!n.loose&&e.includePrerelease===!!n.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>Qv)throw new TypeError(`version is longer than ${Qv} characters`);oc("SemVer",e,n),this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease;const r=e.trim().match(n.loose?cc[uc.LOOSE]:cc[uc.FULL]);if(!r)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>lc||this.major<0)throw new TypeError("Invalid major version");if(this.minor>lc||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>lc||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(s=>{if(/^[0-9]+$/.test(s)){const a=+s;if(a>=0&&a<lc)return a}return s}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(oc("SemVer.compare",this.version,this.options,e),!(e instanceof mr)){if(typeof e=="string"&&e===this.version)return 0;e=new mr(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof mr||(e=new mr(e,this.options)),this.major<e.major?-1:this.major>e.major?1:this.minor<e.minor?-1:this.minor>e.minor?1:this.patch<e.patch?-1:this.patch>e.patch?1:0}comparePre(e){if(e instanceof mr||(e=new mr(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let n=0;do{const r=this.prerelease[n],s=e.prerelease[n];if(oc("prerelease compare",n,r,s),r===void 0&&s===void 0)return 0;if(s===void 0)return 1;if(r===void 0)return-1;if(r===s)continue;return Zh(r,s)}while(++n)}compareBuild(e){e instanceof mr||(e=new mr(e,this.options));let n=0;do{const r=this.build[n],s=e.build[n];if(oc("build compare",n,r,s),r===void 0&&s===void 0)return 0;if(s===void 0)return 1;if(r===void 0)return-1;if(r===s)continue;return Zh(r,s)}while(++n)}inc(e,n,r){if(e.startsWith("pre")){if(!n&&r===!1)throw new Error("invalid increment argument: identifier is empty");if(n){const s=`-${n}`.match(this.options.loose?cc[uc.PRERELEASELOOSE]:cc[uc.PRERELEASE]);if(!s||s[1]!==n)throw new Error(`invalid identifier: ${n}`)}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",n,r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",n,r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",n,r),this.inc("pre",n,r);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",n,r),this.inc("pre",n,r);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const s=Number(r)?1:0;if(this.prerelease.length===0)this.prerelease=[s];else{let a=this.prerelease.length;for(;--a>=0;)typeof this.prerelease[a]=="number"&&(this.prerelease[a]++,a=-2);if(a===-1){if(n===this.prerelease.join(".")&&r===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(s)}}if(n){let a=[n,s];r===!1&&(a=[n]),Zh(this.prerelease[0],n)===0?isNaN(this.prerelease[1])&&(this.prerelease=a):this.prerelease=a}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};var Yt=fR;const Xv=Yt,mR=(t,e,n=!1)=>{if(t instanceof Xv)return t;try{return new Xv(t,e)}catch(r){if(!n)return null;throw r}};var ki=mR;const pR=ki,gR=(t,e)=>{const n=pR(t,e);return n?n.version:null};var yR=gR;const vR=ki,_R=(t,e)=>{const n=vR(t.trim().replace(/^[=v]+/,""),e);return n?n.version:null};var wR=_R;const e_=Yt,xR=(t,e,n,r,s)=>{typeof n=="string"&&(s=r,r=n,n=void 0);try{return new e_(t instanceof e_?t.version:t,n).inc(e,r,s).version}catch{return null}};var bR=xR;const t_=ki,SR=(t,e)=>{const n=t_(t,null,!0),r=t_(e,null,!0),s=n.compare(r);if(s===0)return null;const a=s>0,i=a?n:r,o=a?r:n,l=!!i.prerelease.length;if(!!o.prerelease.length&&!l){if(!o.patch&&!o.minor)return"major";if(o.compareMain(i)===0)return o.minor&&!o.patch?"minor":"patch"}const d=l?"pre":"";return n.major!==r.major?d+"major":n.minor!==r.minor?d+"minor":n.patch!==r.patch?d+"patch":"prerelease"};var kR=SR;const ER=Yt,NR=(t,e)=>new ER(t,e).major;var TR=NR;const AR=Yt,CR=(t,e)=>new AR(t,e).minor;var IR=CR;const jR=Yt,RR=(t,e)=>new jR(t,e).patch;var OR=RR;const PR=ki,$R=(t,e)=>{const n=PR(t,e);return n&&n.prerelease.length?n.prerelease:null};var LR=$R;const n_=Yt,DR=(t,e,n)=>new n_(t,n).compare(new n_(e,n));var ir=DR;const MR=ir,FR=(t,e,n)=>MR(e,t,n);var zR=FR;const UR=ir,BR=(t,e)=>UR(t,e,!0);var GR=BR;const r_=Yt,HR=(t,e,n)=>{const r=new r_(t,n),s=new r_(e,n);return r.compare(s)||r.compareBuild(s)};var Ug=HR;const WR=Ug,VR=(t,e)=>t.sort((n,r)=>WR(n,r,e));var qR=VR;const ZR=Ug,KR=(t,e)=>t.sort((n,r)=>ZR(r,n,e));var JR=KR;const YR=ir,QR=(t,e,n)=>YR(t,e,n)>0;var Id=QR;const XR=ir,eO=(t,e,n)=>XR(t,e,n)<0;var Bg=eO;const tO=ir,nO=(t,e,n)=>tO(t,e,n)===0;var ck=nO;const rO=ir,sO=(t,e,n)=>rO(t,e,n)!==0;var uk=sO;const aO=ir,iO=(t,e,n)=>aO(t,e,n)>=0;var Gg=iO;const oO=ir,lO=(t,e,n)=>oO(t,e,n)<=0;var Hg=lO;const cO=ck,uO=uk,dO=Id,hO=Gg,fO=Bg,mO=Hg,pO=(t,e,n,r)=>{switch(e){case"===":return typeof t=="object"&&(t=t.version),typeof n=="object"&&(n=n.version),t===n;case"!==":return typeof t=="object"&&(t=t.version),typeof n=="object"&&(n=n.version),t!==n;case"":case"=":case"==":return cO(t,n,r);case"!=":return uO(t,n,r);case">":return dO(t,n,r);case">=":return hO(t,n,r);case"<":return fO(t,n,r);case"<=":return mO(t,n,r);default:throw new TypeError(`Invalid operator: ${e}`)}};var dk=pO;const gO=Yt,yO=ki,{safeRe:dc,t:hc}=kl,vO=(t,e)=>{if(t instanceof gO)return t;if(typeof t=="number"&&(t=String(t)),typeof t!="string")return null;e=e||{};let n=null;if(!e.rtl)n=t.match(e.includePrerelease?dc[hc.COERCEFULL]:dc[hc.COERCE]);else{const l=e.includePrerelease?dc[hc.COERCERTLFULL]:dc[hc.COERCERTL];let u;for(;(u=l.exec(t))&&(!n||n.index+n[0].length!==t.length);)(!n||u.index+u[0].length!==n.index+n[0].length)&&(n=u),l.lastIndex=u.index+u[1].length+u[2].length;l.lastIndex=-1}if(n===null)return null;const r=n[2],s=n[3]||"0",a=n[4]||"0",i=e.includePrerelease&&n[5]?`-${n[5]}`:"",o=e.includePrerelease&&n[6]?`+${n[6]}`:"";return yO(`${r}.${s}.${a}${i}${o}`,e)};var _O=vO;class wO{constructor(){this.max=1e3,this.map=new Map}get(e){const n=this.map.get(e);if(n!==void 0)return this.map.delete(e),this.map.set(e,n),n}delete(e){return this.map.delete(e)}set(e,n){if(!this.delete(e)&&n!==void 0){if(this.map.size>=this.max){const s=this.map.keys().next().value;this.delete(s)}this.map.set(e,n)}return this}}var xO=wO,Kh,s_;function or(){if(s_)return Kh;s_=1;const t=/\s+/g;class e{constructor(F,W){if(W=s(W),F instanceof e)return F.loose===!!W.loose&&F.includePrerelease===!!W.includePrerelease?F:new e(F.raw,W);if(F instanceof a)return this.raw=F.value,this.set=[[F]],this.formatted=void 0,this;if(this.options=W,this.loose=!!W.loose,this.includePrerelease=!!W.includePrerelease,this.raw=F.trim().replace(t," "),this.set=this.raw.split("||").map(J=>this.parseRange(J.trim())).filter(J=>J.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const J=this.set[0];if(this.set=this.set.filter($=>!w($[0])),this.set.length===0)this.set=[J];else if(this.set.length>1){for(const $ of this.set)if($.length===1&&_($[0])){this.set=[$];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let F=0;F<this.set.length;F++){F>0&&(this.formatted+="||");const W=this.set[F];for(let J=0;J<W.length;J++)J>0&&(this.formatted+=" "),this.formatted+=W[J].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(F){const J=((this.options.includePrerelease&&m)|(this.options.loose&&v))+":"+F,$=r.get(J);if($)return $;const M=this.options.loose,U=M?l[u.HYPHENRANGELOOSE]:l[u.HYPHENRANGE];F=F.replace(U,ye(this.options.includePrerelease)),i("hyphen replace",F),F=F.replace(l[u.COMPARATORTRIM],d),i("comparator trim",F),F=F.replace(l[u.TILDETRIM],h),i("tilde trim",F),F=F.replace(l[u.CARETTRIM],f),i("caret trim",F);let re=F.split(" ").map(Ee=>p(Ee,this.options)).join(" ").split(/\s+/).map(Ee=>D(Ee,this.options));M&&(re=re.filter(Ee=>(i("loose invalid filter",Ee,this.options),!!Ee.match(l[u.COMPARATORLOOSE])))),i("range list",re);const X=new Map,Te=re.map(Ee=>new a(Ee,this.options));for(const Ee of Te){if(w(Ee))return[Ee];X.set(Ee.value,Ee)}X.size>1&&X.has("")&&X.delete("");const ze=[...X.values()];return r.set(J,ze),ze}intersects(F,W){if(!(F instanceof e))throw new TypeError("a Range is required");return this.set.some(J=>y(J,W)&&F.set.some($=>y($,W)&&J.every(M=>$.every(U=>M.intersects(U,W)))))}test(F){if(!F)return!1;if(typeof F=="string")try{F=new o(F,this.options)}catch{return!1}for(let W=0;W<this.set.length;W++)if(Fe(this.set[W],F,this.options))return!0;return!1}}Kh=e;const n=xO,r=new n,s=zg,a=jd(),i=Cd,o=Yt,{safeRe:l,t:u,comparatorTrimReplace:d,tildeTrimReplace:h,caretTrimReplace:f}=kl,{FLAG_INCLUDE_PRERELEASE:m,FLAG_LOOSE:v}=Ad,w=G=>G.value==="<0.0.0-0",_=G=>G.value==="",y=(G,F)=>{let W=!0;const J=G.slice();let $=J.pop();for(;W&&J.length;)W=J.every(M=>$.intersects(M,F)),$=J.pop();return W},p=(G,F)=>(G=G.replace(l[u.BUILD],""),i("comp",G,F),G=T(G,F),i("caret",G),G=S(G,F),i("tildes",G),G=x(G,F),i("xrange",G),G=R(G,F),i("stars",G),G),g=G=>!G||G.toLowerCase()==="x"||G==="*",S=(G,F)=>G.trim().split(/\s+/).map(W=>N(W,F)).join(" "),N=(G,F)=>{const W=F.loose?l[u.TILDELOOSE]:l[u.TILDE];return G.replace(W,(J,$,M,U,re)=>{i("tilde",G,J,$,M,U,re);let X;return g($)?X="":g(M)?X=`>=${$}.0.0 <${+$+1}.0.0-0`:g(U)?X=`>=${$}.${M}.0 <${$}.${+M+1}.0-0`:re?(i("replaceTilde pr",re),X=`>=${$}.${M}.${U}-${re} <${$}.${+M+1}.0-0`):X=`>=${$}.${M}.${U} <${$}.${+M+1}.0-0`,i("tilde return",X),X})},T=(G,F)=>G.trim().split(/\s+/).map(W=>A(W,F)).join(" "),A=(G,F)=>{i("caret",G,F);const W=F.loose?l[u.CARETLOOSE]:l[u.CARET],J=F.includePrerelease?"-0":"";return G.replace(W,($,M,U,re,X)=>{i("caret",G,$,M,U,re,X);let Te;return g(M)?Te="":g(U)?Te=`>=${M}.0.0${J} <${+M+1}.0.0-0`:g(re)?M==="0"?Te=`>=${M}.${U}.0${J} <${M}.${+U+1}.0-0`:Te=`>=${M}.${U}.0${J} <${+M+1}.0.0-0`:X?(i("replaceCaret pr",X),M==="0"?U==="0"?Te=`>=${M}.${U}.${re}-${X} <${M}.${U}.${+re+1}-0`:Te=`>=${M}.${U}.${re}-${X} <${M}.${+U+1}.0-0`:Te=`>=${M}.${U}.${re}-${X} <${+M+1}.0.0-0`):(i("no pr"),M==="0"?U==="0"?Te=`>=${M}.${U}.${re}${J} <${M}.${U}.${+re+1}-0`:Te=`>=${M}.${U}.${re}${J} <${M}.${+U+1}.0-0`:Te=`>=${M}.${U}.${re} <${+M+1}.0.0-0`),i("caret return",Te),Te})},x=(G,F)=>(i("replaceXRanges",G,F),G.split(/\s+/).map(W=>j(W,F)).join(" ")),j=(G,F)=>{G=G.trim();const W=F.loose?l[u.XRANGELOOSE]:l[u.XRANGE];return G.replace(W,(J,$,M,U,re,X)=>{i("xRange",G,J,$,M,U,re,X);const Te=g(M),ze=Te||g(U),Ee=ze||g(re),E=Ee;return $==="="&&E&&($=""),X=F.includePrerelease?"-0":"",Te?$===">"||$==="<"?J="<0.0.0-0":J="*":$&&E?(ze&&(U=0),re=0,$===">"?($=">=",ze?(M=+M+1,U=0,re=0):(U=+U+1,re=0)):$==="<="&&($="<",ze?M=+M+1:U=+U+1),$==="<"&&(X="-0"),J=`${$+M}.${U}.${re}${X}`):ze?J=`>=${M}.0.0${X} <${+M+1}.0.0-0`:Ee&&(J=`>=${M}.${U}.0${X} <${M}.${+U+1}.0-0`),i("xRange return",J),J})},R=(G,F)=>(i("replaceStars",G,F),G.trim().replace(l[u.STAR],"")),D=(G,F)=>(i("replaceGTE0",G,F),G.trim().replace(l[F.includePrerelease?u.GTE0PRE:u.GTE0],"")),ye=G=>(F,W,J,$,M,U,re,X,Te,ze,Ee,E)=>(g(J)?W="":g($)?W=`>=${J}.0.0${G?"-0":""}`:g(M)?W=`>=${J}.${$}.0${G?"-0":""}`:U?W=`>=${W}`:W=`>=${W}${G?"-0":""}`,g(Te)?X="":g(ze)?X=`<${+Te+1}.0.0-0`:g(Ee)?X=`<${Te}.${+ze+1}.0-0`:E?X=`<=${Te}.${ze}.${Ee}-${E}`:G?X=`<${Te}.${ze}.${+Ee+1}-0`:X=`<=${X}`,`${W} ${X}`.trim()),Fe=(G,F,W)=>{for(let J=0;J<G.length;J++)if(!G[J].test(F))return!1;if(F.prerelease.length&&!W.includePrerelease){for(let J=0;J<G.length;J++)if(i(G[J].semver),G[J].semver!==a.ANY&&G[J].semver.prerelease.length>0){const $=G[J].semver;if($.major===F.major&&$.minor===F.minor&&$.patch===F.patch)return!0}return!1}return!0};return Kh}var Jh,a_;function jd(){if(a_)return Jh;a_=1;const t=Symbol("SemVer ANY");class e{static get ANY(){return t}constructor(d,h){if(h=n(h),d instanceof e){if(d.loose===!!h.loose)return d;d=d.value}d=d.trim().split(/\s+/).join(" "),i("comparator",d,h),this.options=h,this.loose=!!h.loose,this.parse(d),this.semver===t?this.value="":this.value=this.operator+this.semver.version,i("comp",this)}parse(d){const h=this.options.loose?r[s.COMPARATORLOOSE]:r[s.COMPARATOR],f=d.match(h);if(!f)throw new TypeError(`Invalid comparator: ${d}`);this.operator=f[1]!==void 0?f[1]:"",this.operator==="="&&(this.operator=""),f[2]?this.semver=new o(f[2],this.options.loose):this.semver=t}toString(){return this.value}test(d){if(i("Comparator.test",d,this.options.loose),this.semver===t||d===t)return!0;if(typeof d=="string")try{d=new o(d,this.options)}catch{return!1}return a(d,this.operator,this.semver,this.options)}intersects(d,h){if(!(d instanceof e))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new l(d.value,h).test(this.value):d.operator===""?d.value===""?!0:new l(this.value,h).test(d.semver):(h=n(h),h.includePrerelease&&(this.value==="<0.0.0-0"||d.value==="<0.0.0-0")||!h.includePrerelease&&(this.value.startsWith("<0.0.0")||d.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&d.operator.startsWith(">")||this.operator.startsWith("<")&&d.operator.startsWith("<")||this.semver.version===d.semver.version&&this.operator.includes("=")&&d.operator.includes("=")||a(this.semver,"<",d.semver,h)&&this.operator.startsWith(">")&&d.operator.startsWith("<")||a(this.semver,">",d.semver,h)&&this.operator.startsWith("<")&&d.operator.startsWith(">")))}}Jh=e;const n=zg,{safeRe:r,t:s}=kl,a=dk,i=Cd,o=Yt,l=or();return Jh}const bO=or(),SO=(t,e,n)=>{try{e=new bO(e,n)}catch{return!1}return e.test(t)};var Rd=SO;const kO=or(),EO=(t,e)=>new kO(t,e).set.map(n=>n.map(r=>r.value).join(" ").trim().split(" "));var NO=EO;const TO=Yt,AO=or(),CO=(t,e,n)=>{let r=null,s=null,a=null;try{a=new AO(e,n)}catch{return null}return t.forEach(i=>{a.test(i)&&(!r||s.compare(i)===-1)&&(r=i,s=new TO(r,n))}),r};var IO=CO;const jO=Yt,RO=or(),OO=(t,e,n)=>{let r=null,s=null,a=null;try{a=new RO(e,n)}catch{return null}return t.forEach(i=>{a.test(i)&&(!r||s.compare(i)===1)&&(r=i,s=new jO(r,n))}),r};var PO=OO;const Yh=Yt,$O=or(),i_=Id,LO=(t,e)=>{t=new $O(t,e);let n=new Yh("0.0.0");if(t.test(n)||(n=new Yh("0.0.0-0"),t.test(n)))return n;n=null;for(let r=0;r<t.set.length;++r){const s=t.set[r];let a=null;s.forEach(i=>{const o=new Yh(i.semver.version);switch(i.operator){case">":o.prerelease.length===0?o.patch++:o.prerelease.push(0),o.raw=o.format();case"":case">=":(!a||i_(o,a))&&(a=o);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${i.operator}`)}}),a&&(!n||i_(n,a))&&(n=a)}return n&&t.test(n)?n:null};var DO=LO;const MO=or(),FO=(t,e)=>{try{return new MO(t,e).range||"*"}catch{return null}};var zO=FO;const UO=Yt,hk=jd(),{ANY:BO}=hk,GO=or(),HO=Rd,o_=Id,l_=Bg,WO=Hg,VO=Gg,qO=(t,e,n,r)=>{t=new UO(t,r),e=new GO(e,r);let s,a,i,o,l;switch(n){case">":s=o_,a=WO,i=l_,o=">",l=">=";break;case"<":s=l_,a=VO,i=o_,o="<",l="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(HO(t,e,r))return!1;for(let u=0;u<e.set.length;++u){const d=e.set[u];let h=null,f=null;if(d.forEach(m=>{m.semver===BO&&(m=new hk(">=0.0.0")),h=h||m,f=f||m,s(m.semver,h.semver,r)?h=m:i(m.semver,f.semver,r)&&(f=m)}),h.operator===o||h.operator===l||(!f.operator||f.operator===o)&&a(t,f.semver))return!1;if(f.operator===l&&i(t,f.semver))return!1}return!0};var Wg=qO;const ZO=Wg,KO=(t,e,n)=>ZO(t,e,">",n);var JO=KO;const YO=Wg,QO=(t,e,n)=>YO(t,e,"<",n);var XO=QO;const c_=or(),eP=(t,e,n)=>(t=new c_(t,n),e=new c_(e,n),t.intersects(e,n));var tP=eP;const nP=Rd,rP=ir;var sP=(t,e,n)=>{const r=[];let s=null,a=null;const i=t.sort((d,h)=>rP(d,h,n));for(const d of i)nP(d,e,n)?(a=d,s||(s=d)):(a&&r.push([s,a]),a=null,s=null);s&&r.push([s,null]);const o=[];for(const[d,h]of r)d===h?o.push(d):!h&&d===i[0]?o.push("*"):h?d===i[0]?o.push(`<=${h}`):o.push(`${d} - ${h}`):o.push(`>=${d}`);const l=o.join(" || "),u=typeof e.raw=="string"?e.raw:String(e);return l.length<u.length?l:e};const u_=or(),Vg=jd(),{ANY:Qh}=Vg,Hi=Rd,qg=ir,aP=(t,e,n={})=>{if(t===e)return!0;t=new u_(t,n),e=new u_(e,n);let r=!1;e:for(const s of t.set){for(const a of e.set){const i=oP(s,a,n);if(r=r||i!==null,i)continue e}if(r)return!1}return!0},iP=[new Vg(">=0.0.0-0")],d_=[new Vg(">=0.0.0")],oP=(t,e,n)=>{if(t===e)return!0;if(t.length===1&&t[0].semver===Qh){if(e.length===1&&e[0].semver===Qh)return!0;n.includePrerelease?t=iP:t=d_}if(e.length===1&&e[0].semver===Qh){if(n.includePrerelease)return!0;e=d_}const r=new Set;let s,a;for(const m of t)m.operator===">"||m.operator===">="?s=h_(s,m,n):m.operator==="<"||m.operator==="<="?a=f_(a,m,n):r.add(m.semver);if(r.size>1)return null;let i;if(s&&a){if(i=qg(s.semver,a.semver,n),i>0)return null;if(i===0&&(s.operator!==">="||a.operator!=="<="))return null}for(const m of r){if(s&&!Hi(m,String(s),n)||a&&!Hi(m,String(a),n))return null;for(const v of e)if(!Hi(m,String(v),n))return!1;return!0}let o,l,u,d,h=a&&!n.includePrerelease&&a.semver.prerelease.length?a.semver:!1,f=s&&!n.includePrerelease&&s.semver.prerelease.length?s.semver:!1;h&&h.prerelease.length===1&&a.operator==="<"&&h.prerelease[0]===0&&(h=!1);for(const m of e){if(d=d||m.operator===">"||m.operator===">=",u=u||m.operator==="<"||m.operator==="<=",s){if(f&&m.semver.prerelease&&m.semver.prerelease.length&&m.semver.major===f.major&&m.semver.minor===f.minor&&m.semver.patch===f.patch&&(f=!1),m.operator===">"||m.operator===">="){if(o=h_(s,m,n),o===m&&o!==s)return!1}else if(s.operator===">="&&!Hi(s.semver,String(m),n))return!1}if(a){if(h&&m.semver.prerelease&&m.semver.prerelease.length&&m.semver.major===h.major&&m.semver.minor===h.minor&&m.semver.patch===h.patch&&(h=!1),m.operator==="<"||m.operator==="<="){if(l=f_(a,m,n),l===m&&l!==a)return!1}else if(a.operator==="<="&&!Hi(a.semver,String(m),n))return!1}if(!m.operator&&(a||s)&&i!==0)return!1}return!(s&&u&&!a&&i!==0||a&&d&&!s&&i!==0||f||h)},h_=(t,e,n)=>{if(!t)return e;const r=qg(t.semver,e.semver,n);return r>0?t:r<0||e.operator===">"&&t.operator===">="?e:t},f_=(t,e,n)=>{if(!t)return e;const r=qg(t.semver,e.semver,n);return r<0?t:r>0||e.operator==="<"&&t.operator==="<="?e:t};var lP=aP;const Xh=kl,m_=Ad,cP=Yt,p_=lk,uP=ki,dP=yR,hP=wR,fP=bR,mP=kR,pP=TR,gP=IR,yP=OR,vP=LR,_P=ir,wP=zR,xP=GR,bP=Ug,SP=qR,kP=JR,EP=Id,NP=Bg,TP=ck,AP=uk,CP=Gg,IP=Hg,jP=dk,RP=_O,OP=jd(),PP=or(),$P=Rd,LP=NO,DP=IO,MP=PO,FP=DO,zP=zO,UP=Wg,BP=JO,GP=XO,HP=tP,WP=sP,VP=lP;Xh.re,Xh.src,Xh.t,m_.SEMVER_SPEC_VERSION,m_.RELEASE_TYPES,p_.compareIdentifiers,p_.rcompareIdentifiers;function us(t){if(!t||t.split("/").length>2||t.startsWith("/")||t.endsWith("/")||t.split(":").length>2)throw new Error(`Invalid identifier format: ${t}`);const[e,n]=t.split(":"),r=n||"latest";if(e.includes("/")){const[s,a]=e.split("/",2);if(!s||!a)throw new Error(`Invalid identifier format: ${t}`);return[s,a,r]}else{if(!e)throw new Error(`Invalid identifier format: ${t}`);return["-",e,r]}}class qP extends Error{constructor(e){super(e),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="LangSmithConflictError",this.status=409}}async function ce(t,e,n){let r;if(t.ok){n&&(r=await t.text());return}if(t.status===403)try{const i=await t.json();(i==null?void 0:i.error)==="org_scoped_key_requires_workspace"&&(r="This API key is org-scoped and requires workspace specification. Please provide 'workspaceId' parameter, or set LANGSMITH_WORKSPACE_ID environment variable.")}catch{const o=new Error(`${t.status} ${t.statusText}`);throw o.status=t==null?void 0:t.status,o}if(r===void 0)try{r=await t.text()}catch{r=""}const s=`Failed to ${e}. Received status [${t.status}]: ${t.statusText}. Message: ${r}`;if(t.status===409)throw new qP(s);const a=new Error(s);throw a.status=t.status,a}const fk="ERR_CONFLICTING_ENDPOINTS";class ZP extends Error{constructor(){super("You cannot provide both LANGSMITH_ENDPOINT / LANGCHAIN_ENDPOINT and LANGSMITH_RUNS_ENDPOINTS."),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:fk}),this.name="ConflictingEndpointsError"}}function KP(t){return typeof t=="object"&&t!==null&&t.code===fk}var g_="[...]",JP={result:"[Circular]"},Cu=[],qa=[];const YP=new TextEncoder;function QP(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function fc(t){return YP.encode(t)}function mk(t){if(t&&typeof t=="object"&&t!==null){if(t instanceof Map)return Object.fromEntries(t);if(t instanceof Set)return Array.from(t);if(t instanceof Date)return t.toISOString();if(t instanceof RegExp)return t.toString();if(t instanceof Error)return{name:t.name,message:t.message}}else if(typeof t=="bigint")return t.toString();return t}function XP(t){return function(e,n){return mk(n)}}function pn(t,e,n,r,s){var a;try{const i=JSON.stringify(t,XP(n),r);return fc(i)}catch(i){if(!((a=i.message)!=null&&a.includes("Converting circular structure to JSON")))return console.warn(`[WARNING]: LangSmith received unserializable value.${e?`
Context: ${e}`:""}`),fc("[Unserializable]");sn("SUPPRESS_CIRCULAR_JSON_WARNINGS")!=="true"&&console.warn(`[WARNING]: LangSmith received circular JSON. This will decrease tracer performance. ${e?`
Context: ${e}`:""}`),typeof s>"u"&&(s=QP()),Cm(t,"",0,[],void 0,0,s);let o;try{qa.length===0?o=JSON.stringify(t,n,r):o=JSON.stringify(t,e$(n),r)}catch{return fc("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;Cu.length!==0;){const l=Cu.pop();l.length===4?Object.defineProperty(l[0],l[1],l[3]):l[0][l[1]]=l[2]}}return fc(o)}}function ef(t,e,n,r){var s=Object.getOwnPropertyDescriptor(r,n);s.get!==void 0?s.configurable?(Object.defineProperty(r,n,{value:t}),Cu.push([r,n,e,s])):qa.push([e,n,t]):(r[n]=t,Cu.push([r,n,e]))}function Cm(t,e,n,r,s,a,i){a+=1;var o;if(typeof t=="object"&&t!==null){for(o=0;o<r.length;o++)if(r[o]===t){ef(JP,t,e,s);return}if(typeof i.depthLimit<"u"&&a>i.depthLimit){ef(g_,t,e,s);return}if(typeof i.edgesLimit<"u"&&n+1>i.edgesLimit){ef(g_,t,e,s);return}if(r.push(t),Array.isArray(t))for(o=0;o<t.length;o++)Cm(t[o],o,o,r,t,a,i);else{t=mk(t);var l=Object.keys(t);for(o=0;o<l.length;o++){var u=l[o];Cm(t[u],u,o,r,t,a,i)}}r.pop()}}function e$(t){return t=typeof t<"u"?t:function(e,n){return n},function(e,n){if(qa.length>0)for(var r=0;r<qa.length;r++){var s=qa[r];if(s[1]===e&&s[0]===n){n=s[2],qa.splice(r,1);break}}return t.call(this,e,n)}}function y_(t,e){const n=YS(),r=e??QS(),s=t.extra??{},a=s.metadata;return t.extra={...s,runtime:{...n,...s==null?void 0:s.runtime},metadata:{...r,...r.revision_id||"revision_id"in t&&t.revision_id?{revision_id:("revision_id"in t?t.revision_id:void 0)??r.revision_id}:{},...a}},t}const t$=t=>{const e=(t==null?void 0:t.toString())??sn("TRACING_SAMPLING_RATE");if(e===void 0)return;const n=parseFloat(e);if(n<0||n>1)throw new Error(`LANGSMITH_TRACING_SAMPLING_RATE must be between 0 and 1 if set. Got: ${n}`);return n},n$=t=>{const n=t.replace("http://","").replace("https://","").split("/")[0].split(":")[0];return n==="localhost"||n==="127.0.0.1"||n==="::1"};async function r$(t){const e=[];for await(const n of t)e.push(n);return e}function mc(t){if(t!==void 0)return t.trim().replace(/^"(.*)"$/,"$1").replace(/^'(.*)'$/,"$1")}const s$=async t=>{if((t==null?void 0:t.status)===429){const e=parseInt(t.headers.get("retry-after")??"10",10)*1e3;if(e>0)return await new Promise(n=>setTimeout(n,e)),!0}return!1};function v_(t){return typeof t=="number"?Number(t.toFixed(4)):t}const a$=24*1024*1024,pk=1024*1024*1024,i$=1e4,o$=100,__="https://api.smith.langchain.com";class l${constructor(e){Object.defineProperty(this,"items",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"sizeBytes",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"maxSizeBytes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSizeBytes=e??pk}peek(){return this.items[0]}push(e){let n;const r=new Promise(a=>{n=a}),s=pn(e.item,`Serializing run with id: ${e.item.id}`).length;return this.sizeBytes+s>this.maxSizeBytes&&this.items.length>0?(console.warn(`AutoBatchQueue size limit (${this.maxSizeBytes} bytes) exceeded. Dropping run with id: ${e.item.id}. Current queue size: ${this.sizeBytes} bytes, attempted addition: ${s} bytes.`),n(),r):(this.items.push({action:e.action,payload:e.item,otelContext:e.otelContext,apiKey:e.apiKey,apiUrl:e.apiUrl,itemPromiseResolve:n,itemPromise:r,size:s}),this.sizeBytes+=s,r)}pop({upToSizeBytes:e,upToSize:n}){var a;if(e<1)throw new Error("Number of bytes to pop off may not be less than 1.");const r=[];let s=0;for(;s+(((a=this.peek())==null?void 0:a.size)??0)<e&&this.items.length>0&&r.length<n;){const i=this.items.shift();i&&(r.push(i),s+=i.size,this.sizeBytes-=i.size)}if(r.length===0&&this.items.length>0){const i=this.items.shift();r.push(i),s+=i.size,this.sizeBytes-=i.size}return[r.map(i=>({action:i.action,item:i.payload,otelContext:i.otelContext,apiKey:i.apiKey,apiUrl:i.apiUrl,size:i.size})),()=>r.forEach(i=>i.itemPromiseResolve())]}}class nl{get _fetch(){return this.fetchImplementation||pj(this.debug)}constructor(e={}){var s;Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"webUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"workspaceId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"batchIngestCaller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout_ms",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tenantId",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"hideInputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"hideOutputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tracingSampleRate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"filteredPostUuids",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"autoBatchTracing",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"autoBatchQueue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"autoBatchTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"autoBatchAggregationDelayMs",{enumerable:!0,configurable:!0,writable:!0,value:250}),Object.defineProperty(this,"batchSizeBytesLimit",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"batchSizeLimit",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fetchOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"blockOnRootRunFinalization",{enumerable:!0,configurable:!0,writable:!0,value:jr("LANGSMITH_TRACING_BACKGROUND")==="false"}),Object.defineProperty(this,"traceBatchConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:5}),Object.defineProperty(this,"_serverInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_getServerInfoPromise",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"manualFlushMode",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"langSmithToOTELTranslator",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fetchImplementation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cachedLSEnvVarsForMetadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"multipartStreamingDisabled",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"debug",{enumerable:!0,configurable:!0,writable:!0,value:jr("LANGSMITH_DEBUG")==="true"});const n=nl.getDefaultClientConfig();if(this.tracingSampleRate=t$(e.tracingSamplingRate),this.apiUrl=mc(e.apiUrl??n.apiUrl)??"",this.apiUrl.endsWith("/")&&(this.apiUrl=this.apiUrl.slice(0,-1)),this.apiKey=mc(e.apiKey??n.apiKey),this.webUrl=mc(e.webUrl??n.webUrl),(s=this.webUrl)!=null&&s.endsWith("/")&&(this.webUrl=this.webUrl.slice(0,-1)),this.workspaceId=mc(e.workspaceId??sn("WORKSPACE_ID")),this.timeout_ms=e.timeout_ms??9e4,this.caller=new Zv({...e.callerOptions??{},maxRetries:4,debug:e.debug??this.debug}),this.traceBatchConcurrency=e.traceBatchConcurrency??this.traceBatchConcurrency,this.traceBatchConcurrency<1)throw new Error("Trace batch concurrency must be positive.");this.debug=e.debug??this.debug,this.fetchImplementation=e.fetchImplementation;const r=e.maxIngestMemoryBytes??pk;this.batchIngestCaller=new Zv({maxRetries:4,maxConcurrency:this.traceBatchConcurrency,maxQueueSizeBytes:r,...e.callerOptions??{},onFailedResponseHook:s$,debug:e.debug??this.debug}),this.hideInputs=e.hideInputs??e.anonymizer??n.hideInputs,this.hideOutputs=e.hideOutputs??e.anonymizer??n.hideOutputs,this.autoBatchTracing=e.autoBatchTracing??this.autoBatchTracing,this.autoBatchQueue=new l$(r),this.blockOnRootRunFinalization=e.blockOnRootRunFinalization??this.blockOnRootRunFinalization,this.batchSizeBytesLimit=e.batchSizeBytesLimit,this.batchSizeLimit=e.batchSizeLimit,this.fetchOptions=e.fetchOptions||{},this.manualFlushMode=e.manualFlushMode??this.manualFlushMode,XS()&&(this.langSmithToOTELTranslator=new Pj),this.cachedLSEnvVarsForMetadata=QS()}static getDefaultClientConfig(){const e=sn("API_KEY"),n=sn("ENDPOINT")??__,r=sn("HIDE_INPUTS")==="true",s=sn("HIDE_OUTPUTS")==="true";return{apiUrl:n,apiKey:e,webUrl:void 0,hideInputs:r,hideOutputs:s}}getHostUrl(){return this.webUrl?this.webUrl:n$(this.apiUrl)?(this.webUrl="http://localhost:3000",this.webUrl):this.apiUrl.endsWith("/api/v1")?(this.webUrl=this.apiUrl.replace("/api/v1",""),this.webUrl):this.apiUrl.includes("/api")&&!this.apiUrl.split(".",1)[0].endsWith("api")?(this.webUrl=this.apiUrl.replace("/api",""),this.webUrl):this.apiUrl.split(".",1)[0].includes("dev")?(this.webUrl="https://dev.smith.langchain.com",this.webUrl):this.apiUrl.split(".",1)[0].includes("eu")?(this.webUrl="https://eu.smith.langchain.com",this.webUrl):this.apiUrl.split(".",1)[0].includes("beta")?(this.webUrl="https://beta.smith.langchain.com",this.webUrl):(this.webUrl="https://smith.langchain.com",this.webUrl)}get headers(){const e={"User-Agent":`langsmith-js/${ZS}`};return this.apiKey&&(e["x-api-key"]=`${this.apiKey}`),this.workspaceId&&(e["x-tenant-id"]=this.workspaceId),e}_getPlatformEndpointPath(e){return this.apiUrl.slice(-3)!=="/v1"&&this.apiUrl.slice(-4)!=="/v1/"?`/v1/platform/${e}`:`/platform/${e}`}async processInputs(e){return this.hideInputs===!1?e:this.hideInputs===!0?{}:typeof this.hideInputs=="function"?this.hideInputs(e):e}async processOutputs(e){return this.hideOutputs===!1?e:this.hideOutputs===!0?{}:typeof this.hideOutputs=="function"?this.hideOutputs(e):e}async prepareRunCreateOrUpdateInputs(e){const n={...e};return n.inputs!==void 0&&(n.inputs=await this.processInputs(n.inputs)),n.outputs!==void 0&&(n.outputs=await this.processOutputs(n.outputs)),n}async _getResponse(e,n){const r=(n==null?void 0:n.toString())??"",s=`${this.apiUrl}${e}?${r}`;return await this.caller.call(async()=>{const i=await this._fetch(s,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ce(i,`fetch ${e}`),i})}async _get(e,n){return(await this._getResponse(e,n)).json()}async*_getPaginated(e,n=new URLSearchParams,r){let s=Number(n.get("offset"))||0;const a=Number(n.get("limit"))||100;for(;;){n.set("offset",String(s)),n.set("limit",String(a));const i=`${this.apiUrl}${e}?${n}`,o=await this.caller.call(async()=>{const u=await this._fetch(i,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ce(u,`fetch ${e}`),u}),l=r?r(await o.json()):await o.json();if(l.length===0||(yield l,l.length<a))break;s+=l.length}}async*_getCursorPaginatedList(e,n=null,r="POST",s="runs"){const a=n?{...n}:{};for(;;){const i=JSON.stringify(a),l=await(await this.caller.call(async()=>{const d=await this._fetch(`${this.apiUrl}${e}`,{method:r,headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:i});return await ce(d,`fetch ${e}`),d})).json();if(!l||!l[s])break;yield l[s];const u=l.cursors;if(!u||!u.next)break;a.cursor=u.next}}_shouldSample(){return this.tracingSampleRate===void 0?!0:Math.random()<this.tracingSampleRate}_filterForSampling(e,n=!1){if(this.tracingSampleRate===void 0)return e;if(n){const r=[];for(const s of e)this.filteredPostUuids.has(s.trace_id)?s.id===s.trace_id&&this.filteredPostUuids.delete(s.trace_id):r.push(s);return r}else{const r=[];for(const s of e){const a=s.trace_id??s.id;this.filteredPostUuids.has(a)||(s.id===a?this._shouldSample()?r.push(s):this.filteredPostUuids.add(a):r.push(s))}return r}}async _getBatchSizeLimitBytes(){var n;const e=await this._ensureServerInfo();return this.batchSizeBytesLimit??((n=e.batch_ingest_config)==null?void 0:n.size_limit_bytes)??a$}async _getBatchSizeLimit(){var n;const e=await this._ensureServerInfo();return this.batchSizeLimit??((n=e.batch_ingest_config)==null?void 0:n.size_limit)??o$}async _getDatasetExamplesMultiPartSupport(){var n;return((n=(await this._ensureServerInfo()).instance_flags)==null?void 0:n.dataset_examples_multipart_enabled)??!1}drainAutoBatchQueue({batchSizeLimitBytes:e,batchSizeLimit:n}){const r=[];for(;this.autoBatchQueue.items.length>0;){const[s,a]=this.autoBatchQueue.pop({upToSizeBytes:e,upToSize:n});if(!s.length){a();break}const i=s.reduce((u,d)=>{const h=d.apiUrl??this.apiUrl,f=d.apiKey??this.apiKey,v=d.apiKey===this.apiKey&&d.apiUrl===this.apiUrl?"default":`${h}|${f}`;return u[v]||(u[v]=[]),u[v].push(d),u},{}),o=[];for(const[u,d]of Object.entries(i)){const h=this._processBatch(d,{apiUrl:u==="default"?void 0:u.split("|")[0],apiKey:u==="default"?void 0:u.split("|")[1]});o.push(h)}const l=Promise.all(o).finally(a);r.push(l)}return Promise.all(r)}async _processBatch(e,n){var s,a;if(!e.length)return;const r=e.reduce((i,o)=>i+(o.size??0),0);try{if(this.langSmithToOTELTranslator!==void 0)this._sendBatchToOTELTranslator(e);else{const i={runCreates:e.filter(l=>l.action==="create").map(l=>l.item),runUpdates:e.filter(l=>l.action==="update").map(l=>l.item)},o=await this._ensureServerInfo();if((s=o==null?void 0:o.batch_ingest_config)!=null&&s.use_multipart_endpoint){const l=(a=o==null?void 0:o.instance_flags)==null?void 0:a.gzip_body_enabled;await this.multipartIngestRuns(i,{...n,useGzip:l,sizeBytes:r})}else await this.batchIngestRuns(i,{...n,sizeBytes:r})}}catch(i){console.error("Error exporting batch:",i)}}_sendBatchToOTELTranslator(e){if(this.langSmithToOTELTranslator!==void 0){const n=new Map,r=[];for(const s of e)s.item.id&&s.otelContext&&(n.set(s.item.id,s.otelContext),s.action==="create"?r.push({operation:"post",id:s.item.id,trace_id:s.item.trace_id??s.item.id,run:s.item}):r.push({operation:"patch",id:s.item.id,trace_id:s.item.trace_id??s.item.id,run:s.item}));this.langSmithToOTELTranslator.exportBatch(r,n)}}async processRunOperation(e){clearTimeout(this.autoBatchTimeout),this.autoBatchTimeout=void 0,e.item=y_(e.item,this.cachedLSEnvVarsForMetadata);const n=this.autoBatchQueue.push(e);if(this.manualFlushMode)return n;const r=await this._getBatchSizeLimitBytes(),s=await this._getBatchSizeLimit();return(this.autoBatchQueue.sizeBytes>r||this.autoBatchQueue.items.length>s)&&this.drainAutoBatchQueue({batchSizeLimitBytes:r,batchSizeLimit:s}),this.autoBatchQueue.items.length>0&&(this.autoBatchTimeout=setTimeout(()=>{this.autoBatchTimeout=void 0,this.drainAutoBatchQueue({batchSizeLimitBytes:r,batchSizeLimit:s})},this.autoBatchAggregationDelayMs)),n}async _getServerInfo(){const n=await(await this.caller.call(async()=>{const r=await this._fetch(`${this.apiUrl}/info`,{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(i$),...this.fetchOptions});return await ce(r,"get server info"),r})).json();return this.debug&&console.log(`
=== LangSmith Server Configuration ===
`+JSON.stringify(n,null,2)+`
`),n}async _ensureServerInfo(){return this._getServerInfoPromise===void 0&&(this._getServerInfoPromise=(async()=>{if(this._serverInfo===void 0)try{this._serverInfo=await this._getServerInfo()}catch(e){console.warn(`[LANGSMITH]: Failed to fetch info on supported operations. Falling back to batch operations and default limits. Info: ${e.status??"Unspecified status code"} ${e.message}`)}return this._serverInfo??{}})()),this._getServerInfoPromise.then(e=>(this._serverInfo===void 0&&(this._getServerInfoPromise=void 0),e))}async _getSettings(){return this.settings||(this.settings=this._get("/settings")),await this.settings}async flush(){const e=await this._getBatchSizeLimitBytes(),n=await this._getBatchSizeLimit();await this.drainAutoBatchQueue({batchSizeLimitBytes:e,batchSizeLimit:n})}_cloneCurrentOTELContext(){const e=ek(),n=Ij();if(this.langSmithToOTELTranslator!==void 0){const r=e.getActiveSpan();if(r)return e.setSpan(n.active(),r)}}async createRun(e,n){if(!this._filterForSampling([e]).length)return;const r={...this.headers,"Content-Type":"application/json"},s=e.project_name;delete e.project_name;const a=await this.prepareRunCreateOrUpdateInputs({session_name:s,...e,start_time:e.start_time??Date.now()});if(this.autoBatchTracing&&a.trace_id!==void 0&&a.dotted_order!==void 0){const l=this._cloneCurrentOTELContext();this.processRunOperation({action:"create",item:a,otelContext:l,apiKey:n==null?void 0:n.apiKey,apiUrl:n==null?void 0:n.apiUrl}).catch(console.error);return}const i=y_(a,this.cachedLSEnvVarsForMetadata);(n==null?void 0:n.apiKey)!==void 0&&(r["x-api-key"]=n.apiKey),(n==null?void 0:n.workspaceId)!==void 0&&(r["x-tenant-id"]=n.workspaceId);const o=pn(i,`Creating run with id: ${i.id}`);await this.caller.call(async()=>{const l=await this._fetch(`${(n==null?void 0:n.apiUrl)??this.apiUrl}/runs`,{method:"POST",headers:r,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:o});return await ce(l,"create run",!0),l})}async batchIngestRuns({runCreates:e,runUpdates:n},r){if(e===void 0&&n===void 0)return;let s=await Promise.all((e==null?void 0:e.map(l=>this.prepareRunCreateOrUpdateInputs(l)))??[]),a=await Promise.all((n==null?void 0:n.map(l=>this.prepareRunCreateOrUpdateInputs(l)))??[]);if(s.length>0&&a.length>0){const l=s.reduce((d,h)=>(h.id&&(d[h.id]=h),d),{}),u=[];for(const d of a)d.id!==void 0&&l[d.id]?l[d.id]={...l[d.id],...d}:u.push(d);s=Object.values(l),a=u}const i={post:s,patch:a};if(!i.post.length&&!i.patch.length)return;const o={post:[],patch:[]};for(const l of["post","patch"]){const u=l,d=i[u].reverse();let h=d.pop();for(;h!==void 0;)o[u].push(h),h=d.pop()}if(o.post.length>0||o.patch.length>0){const l=o.post.map(u=>u.id).concat(o.patch.map(u=>u.id)).join(",");await this._postBatchIngestRuns(pn(o,`Ingesting runs with ids: ${l}`),r)}}async _postBatchIngestRuns(e,n){const r={...this.headers,"Content-Type":"application/json",Accept:"application/json"};(n==null?void 0:n.apiKey)!==void 0&&(r["x-api-key"]=n.apiKey),await this.batchIngestCaller.callWithOptions({sizeBytes:n==null?void 0:n.sizeBytes},async()=>{const s=await this._fetch(`${(n==null?void 0:n.apiUrl)??this.apiUrl}/runs/batch`,{method:"POST",headers:r,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:e});return await ce(s,"batch create run",!0),s})}async multipartIngestRuns({runCreates:e,runUpdates:n},r){if(e===void 0&&n===void 0)return;const s={};let a=[];for(const h of e??[]){const f=await this.prepareRunCreateOrUpdateInputs(h);f.id!==void 0&&f.attachments!==void 0&&(s[f.id]=f.attachments),delete f.attachments,a.push(f)}let i=[];for(const h of n??[])i.push(await this.prepareRunCreateOrUpdateInputs(h));if(a.find(h=>h.trace_id===void 0||h.dotted_order===void 0)!==void 0)throw new Error('Multipart ingest requires "trace_id" and "dotted_order" to be set when creating a run');if(i.find(h=>h.trace_id===void 0||h.dotted_order===void 0)!==void 0)throw new Error('Multipart ingest requires "trace_id" and "dotted_order" to be set when updating a run');if(a.length>0&&i.length>0){const h=a.reduce((m,v)=>(v.id&&(m[v.id]=v),m),{}),f=[];for(const m of i)m.id!==void 0&&h[m.id]?h[m.id]={...h[m.id],...m}:f.push(m);a=Object.values(h),i=f}if(a.length===0&&i.length===0)return;const u=[],d=[];for(const[h,f]of[["post",a],["patch",i]])for(const m of f){const{inputs:v,outputs:w,events:_,extra:y,error:p,serialized:g,attachments:S,...N}=m,T={inputs:v,outputs:w,events:_,extra:y,error:p,serialized:g},A=pn(N,`Serializing for multipart ingestion of run with id: ${N.id}`);d.push({name:`${h}.${N.id}`,payload:new Blob([A],{type:`application/json; length=${A.length}`})});for(const[x,j]of Object.entries(T)){if(j===void 0)continue;const R=pn(j,`Serializing ${x} for multipart ingestion of run with id: ${N.id}`);d.push({name:`${h}.${N.id}.${x}`,payload:new Blob([R],{type:`application/json; length=${R.length}`})})}if(N.id!==void 0){const x=s[N.id];if(x){delete s[N.id];for(const[j,R]of Object.entries(x)){let D,ye;if(Array.isArray(R)?[D,ye]=R:(D=R.mimeType,ye=R.data),j.includes(".")){console.warn(`Skipping attachment '${j}' for run ${N.id}: Invalid attachment name. Attachment names must not contain periods ('.'). Please rename the attachment and try again.`);continue}d.push({name:`attachment.${N.id}.${j}`,payload:new Blob([ye],{type:`${D}; length=${ye.byteLength}`})})}}}u.push(`trace=${N.trace_id},id=${N.id}`)}await this._sendMultipartRequest(d,u.join("; "),r)}async _createNodeFetchBody(e,n){const r=[];for(const i of e)r.push(new Blob([`--${n}\r
`])),r.push(new Blob([`Content-Disposition: form-data; name="${i.name}"\r
`,`Content-Type: ${i.payload.type}\r
\r
`])),r.push(i.payload),r.push(new Blob([`\r
`]));return r.push(new Blob([`--${n}--\r
`])),await new Blob(r).arrayBuffer()}async _createMultipartStream(e,n){const r=new TextEncoder;return new ReadableStream({async start(a){const i=async o=>{typeof o=="string"?a.enqueue(r.encode(o)):a.enqueue(o)};for(const o of e){await i(`--${n}\r
`),await i(`Content-Disposition: form-data; name="${o.name}"\r
`),await i(`Content-Type: ${o.payload.type}\r
\r
`);const u=o.payload.stream().getReader();try{let d;for(;!(d=await u.read()).done;)a.enqueue(d.value)}finally{u.releaseLock()}await i(`\r
`)}await i(`--${n}--\r
`),a.close()}})}async _sendMultipartRequest(e,n,r){const s="----LangSmithFormBoundary"+Math.random().toString(36).slice(2),a=mj(),i=()=>this._createNodeFetchBody(e,s),o=()=>this._createMultipartStream(e,s),l=async u=>this.batchIngestCaller.callWithOptions({sizeBytes:r==null?void 0:r.sizeBytes},async()=>{const d=await u(),h={...this.headers,"Content-Type":`multipart/form-data; boundary=${s}`};(r==null?void 0:r.apiKey)!==void 0&&(h["x-api-key"]=r.apiKey);let f=d;r!=null&&r.useGzip&&typeof d=="object"&&"pipeThrough"in d&&(f=d.pipeThrough(new CompressionStream("gzip")),h["Content-Encoding"]="gzip");const m=await this._fetch(`${(r==null?void 0:r.apiUrl)??this.apiUrl}/runs/multipart`,{method:"POST",headers:h,body:f,duplex:"half",signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ce(m,"Failed to send multipart request",!0),m});try{let u,d=!1;!a&&!this.multipartStreamingDisabled&&JS()!=="bun"?(d=!0,u=await l(o)):u=await l(i),(!this.multipartStreamingDisabled||d)&&u.status===422&&((r==null?void 0:r.apiUrl)??this.apiUrl)!==__&&(console.warn(`Streaming multipart upload to ${(r==null?void 0:r.apiUrl)??this.apiUrl}/runs/multipart failed. This usually means the host does not support chunked uploads. Retrying with a buffered upload for operation "${n}".`),this.multipartStreamingDisabled=!0,u=await l(i))}catch(u){console.warn(`${u.message.trim()}

Context: ${n}`)}}async updateRun(e,n,r){ke(e),n.inputs&&(n.inputs=await this.processInputs(n.inputs)),n.outputs&&(n.outputs=await this.processOutputs(n.outputs));const s={...n,id:e};if(!this._filterForSampling([s],!0).length)return;if(this.autoBatchTracing&&s.trace_id!==void 0&&s.dotted_order!==void 0){const o=this._cloneCurrentOTELContext();if(n.end_time!==void 0&&s.parent_run_id===void 0&&this.blockOnRootRunFinalization&&!this.manualFlushMode){await this.processRunOperation({action:"update",item:s,otelContext:o,apiKey:r==null?void 0:r.apiKey,apiUrl:r==null?void 0:r.apiUrl}).catch(console.error);return}else this.processRunOperation({action:"update",item:s,otelContext:o,apiKey:r==null?void 0:r.apiKey,apiUrl:r==null?void 0:r.apiUrl}).catch(console.error);return}const a={...this.headers,"Content-Type":"application/json"};(r==null?void 0:r.apiKey)!==void 0&&(a["x-api-key"]=r.apiKey),(r==null?void 0:r.workspaceId)!==void 0&&(a["x-tenant-id"]=r.workspaceId);const i=pn(n,`Serializing payload to update run with id: ${e}`);await this.caller.call(async()=>{const o=await this._fetch(`${(r==null?void 0:r.apiUrl)??this.apiUrl}/runs/${e}`,{method:"PATCH",headers:a,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:i});return await ce(o,"update run",!0),o})}async readRun(e,{loadChildRuns:n}={loadChildRuns:!1}){ke(e);let r=await this._get(`/runs/${e}`);return n&&(r=await this._loadChildRuns(r)),r}async getRunUrl({runId:e,run:n,projectOpts:r}){if(n!==void 0){let s;n.session_id?s=n.session_id:r!=null&&r.projectName?s=(await this.readProject({projectName:r==null?void 0:r.projectName})).id:r!=null&&r.projectId?s=r==null?void 0:r.projectId:s=(await this.readProject({projectName:sn("PROJECT")||"default"})).id;const a=await this._getTenantId();return`${this.getHostUrl()}/o/${a}/projects/p/${s}/r/${n.id}?poll=true`}else if(e!==void 0){const s=await this.readRun(e);if(!s.app_path)throw new Error(`Run ${e} has no app_path`);return`${this.getHostUrl()}${s.app_path}`}else throw new Error("Must provide either runId or run")}async _loadChildRuns(e){var a;const n=await r$(this.listRuns({isRoot:!1,projectId:e.session_id,traceId:e.trace_id})),r={},s={};n.sort((i,o)=>((i==null?void 0:i.dotted_order)??"").localeCompare((o==null?void 0:o.dotted_order)??""));for(const i of n){if(i.parent_run_id===null||i.parent_run_id===void 0)throw new Error(`Child run ${i.id} has no parent`);(a=i.dotted_order)!=null&&a.startsWith(e.dotted_order??"")&&i.id!==e.id&&(i.parent_run_id in r||(r[i.parent_run_id]=[]),r[i.parent_run_id].push(i),s[i.id]=i)}e.child_runs=r[e.id]||[];for(const i in r)i!==e.id&&(s[i].child_runs=r[i]);return e}async*listRuns(e){const{projectId:n,projectName:r,parentRunId:s,traceId:a,referenceExampleId:i,startTime:o,executionOrder:l,isRoot:u,runType:d,error:h,id:f,query:m,filter:v,traceFilter:w,treeFilter:_,limit:y,select:p,order:g}=e;let S=[];if(n&&(S=Array.isArray(n)?n:[n]),r){const x=Array.isArray(r)?r:[r],j=await Promise.all(x.map(R=>this.readProject({projectName:R}).then(D=>D.id)));S.push(...j)}const N=["app_path","completion_cost","completion_tokens","dotted_order","end_time","error","events","extra","feedback_stats","first_token_time","id","inputs","name","outputs","parent_run_id","parent_run_ids","prompt_cost","prompt_tokens","reference_example_id","run_type","session_id","start_time","status","tags","total_cost","total_tokens","trace_id"],T={session:S.length?S:null,run_type:d,reference_example:i,query:m,filter:v,trace_filter:w,tree_filter:_,execution_order:l,parent_run:s,start_time:o?o.toISOString():null,error:h,id:f,limit:y,trace:a,select:p||N,is_root:u,order:g};T.select.includes("child_run_ids")&&Tm("Deprecated: 'child_run_ids' in the listRuns select parameter is deprecated and will be removed in a future version.");let A=0;for await(const x of this._getCursorPaginatedList("/runs/query",T))if(y){if(A>=y)break;if(x.length+A>y){yield*x.slice(0,y-A);break}A+=x.length,yield*x}else yield*x}async*listGroupRuns(e){const{projectId:n,projectName:r,groupBy:s,filter:a,startTime:i,endTime:o,limit:l,offset:u}=e,h={session_id:n||(await this.readProject({projectName:r})).id,group_by:s,filter:a,start_time:i?i.toISOString():null,end_time:o?o.toISOString():null,limit:Number(l)||100};let f=Number(u)||0;const m="/runs/group",v=`${this.apiUrl}${m}`;for(;;){const w={...h,offset:f},_=Object.fromEntries(Object.entries(w).filter(([T,A])=>A!==void 0)),y=JSON.stringify(_),g=await(await this.caller.call(async()=>{const T=await this._fetch(v,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:y});return await ce(T,`Failed to fetch ${m}`),T})).json(),{groups:S,total:N}=g;if(S.length===0)break;for(const T of S)yield T;if(f+=S.length,f>=N)break}}async getRunStats({id:e,trace:n,parentRun:r,runType:s,projectNames:a,projectIds:i,referenceExampleIds:o,startTime:l,endTime:u,error:d,query:h,filter:f,traceFilter:m,treeFilter:v,isRoot:w,dataSourceType:_}){let y=i||[];a&&(y=[...i||[],...await Promise.all(a.map(A=>this.readProject({projectName:A}).then(x=>x.id)))]);const g=Object.fromEntries(Object.entries({id:e,trace:n,parent_run:r,run_type:s,session:y,reference_example:o,start_time:l,end_time:u,error:d,query:h,filter:f,trace_filter:m,tree_filter:v,is_root:w,data_source_type:_}).filter(([A,x])=>x!==void 0)),S=JSON.stringify(g);return await(await this.caller.call(async()=>{const A=await this._fetch(`${this.apiUrl}/runs/stats`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:S});return await ce(A,"get run stats"),A})).json()}async shareRun(e,{shareId:n}={}){const r={run_id:e,share_token:n||rn()};ke(e);const s=JSON.stringify(r),i=await(await this.caller.call(async()=>{const o=await this._fetch(`${this.apiUrl}/runs/${e}/share`,{method:"PUT",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:s});return await ce(o,"share run"),o})).json();if(i===null||!("share_token"in i))throw new Error("Invalid response from server");return`${this.getHostUrl()}/public/${i.share_token}/r`}async unshareRun(e){ke(e),await this.caller.call(async()=>{const n=await this._fetch(`${this.apiUrl}/runs/${e}/share`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ce(n,"unshare run",!0),n})}async readRunSharedLink(e){ke(e);const r=await(await this.caller.call(async()=>{const s=await this._fetch(`${this.apiUrl}/runs/${e}/share`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ce(s,"read run shared link"),s})).json();if(!(r===null||!("share_token"in r)))return`${this.getHostUrl()}/public/${r.share_token}/r`}async listSharedRuns(e,{runIds:n}={}){const r=new URLSearchParams({share_token:e});if(n!==void 0)for(const i of n)r.append("id",i);return ke(e),await(await this.caller.call(async()=>{const i=await this._fetch(`${this.apiUrl}/public/${e}/runs${r}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ce(i,"list shared runs"),i})).json()}async readDatasetSharedSchema(e,n){if(!e&&!n)throw new Error("Either datasetId or datasetName must be given");e||(e=(await this.readDataset({datasetName:n})).id),ke(e);const s=await(await this.caller.call(async()=>{const a=await this._fetch(`${this.apiUrl}/datasets/${e}/share`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ce(a,"read dataset shared schema"),a})).json();return s.url=`${this.getHostUrl()}/public/${s.share_token}/d`,s}async shareDataset(e,n){if(!e&&!n)throw new Error("Either datasetId or datasetName must be given");e||(e=(await this.readDataset({datasetName:n})).id);const r={dataset_id:e};ke(e);const s=JSON.stringify(r),i=await(await this.caller.call(async()=>{const o=await this._fetch(`${this.apiUrl}/datasets/${e}/share`,{method:"PUT",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:s});return await ce(o,"share dataset"),o})).json();return i.url=`${this.getHostUrl()}/public/${i.share_token}/d`,i}async unshareDataset(e){ke(e),await this.caller.call(async()=>{const n=await this._fetch(`${this.apiUrl}/datasets/${e}/share`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ce(n,"unshare dataset",!0),n})}async readSharedDataset(e){return ke(e),await(await this.caller.call(async()=>{const s=await this._fetch(`${this.apiUrl}/public/${e}/datasets`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ce(s,"read shared dataset"),s})).json()}async listSharedExamples(e,n){const r={};n!=null&&n.exampleIds&&(r.id=n.exampleIds);const s=new URLSearchParams;Object.entries(r).forEach(([o,l])=>{Array.isArray(l)?l.forEach(u=>s.append(o,u)):s.append(o,l)});const a=await this.caller.call(async()=>{const o=await this._fetch(`${this.apiUrl}/public/${e}/examples?${s.toString()}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ce(o,"list shared examples"),o}),i=await a.json();if(!a.ok)throw"detail"in i?new Error(`Failed to list shared examples.
Status: ${a.status}
Message: ${Array.isArray(i.detail)?i.detail.join(`
`):"Unspecified error"}`):new Error(`Failed to list shared examples: ${a.status} ${a.statusText}`);return i.map(o=>({...o,_hostUrl:this.getHostUrl()}))}async createProject({projectName:e,description:n=null,metadata:r=null,upsert:s=!1,projectExtra:a=null,referenceDatasetId:i=null}){const o=s?"?upsert=true":"",l=`${this.apiUrl}/sessions${o}`,u=a||{};r&&(u.metadata=r);const d={name:e,extra:u,description:n};i!==null&&(d.reference_dataset_id=i);const h=JSON.stringify(d);return await(await this.caller.call(async()=>{const v=await this._fetch(l,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:h});return await ce(v,"create project"),v})).json()}async updateProject(e,{name:n=null,description:r=null,metadata:s=null,projectExtra:a=null,endTime:i=null}){const o=`${this.apiUrl}/sessions/${e}`;let l=a;s&&(l={...l||{},metadata:s});const u=JSON.stringify({name:n,extra:l,description:r,end_time:i?new Date(i).toISOString():null});return await(await this.caller.call(async()=>{const f=await this._fetch(o,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:u});return await ce(f,"update project"),f})).json()}async hasProject({projectId:e,projectName:n}){let r="/sessions";const s=new URLSearchParams;if(e!==void 0&&n!==void 0)throw new Error("Must provide either projectName or projectId, not both");if(e!==void 0)ke(e),r+=`/${e}`;else if(n!==void 0)s.append("name",n);else throw new Error("Must provide projectName or projectId");const a=await this.caller.call(async()=>{const i=await this._fetch(`${this.apiUrl}${r}?${s}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ce(i,"has project"),i});try{const i=await a.json();return a.ok?Array.isArray(i)?i.length>0:!0:!1}catch{return!1}}async readProject({projectId:e,projectName:n,includeStats:r}){let s="/sessions";const a=new URLSearchParams;if(e!==void 0&&n!==void 0)throw new Error("Must provide either projectName or projectId, not both");if(e!==void 0)ke(e),s+=`/${e}`;else if(n!==void 0)a.append("name",n);else throw new Error("Must provide projectName or projectId");r!==void 0&&a.append("include_stats",r.toString());const i=await this._get(s,a);let o;if(Array.isArray(i)){if(i.length===0)throw new Error(`Project[id=${e}, name=${n}] not found`);o=i[0]}else o=i;return o}async getProjectUrl({projectId:e,projectName:n}){if(e===void 0&&n===void 0)throw new Error("Must provide either projectName or projectId");const r=await this.readProject({projectId:e,projectName:n}),s=await this._getTenantId();return`${this.getHostUrl()}/o/${s}/projects/p/${r.id}`}async getDatasetUrl({datasetId:e,datasetName:n}){if(e===void 0&&n===void 0)throw new Error("Must provide either datasetName or datasetId");const r=await this.readDataset({datasetId:e,datasetName:n}),s=await this._getTenantId();return`${this.getHostUrl()}/o/${s}/datasets/${r.id}`}async _getTenantId(){if(this._tenantId!==null)return this._tenantId;const e=new URLSearchParams({limit:"1"});for await(const n of this._getPaginated("/sessions",e))return this._tenantId=n[0].tenant_id,n[0].tenant_id;throw new Error("No projects found to resolve tenant.")}async*listProjects({projectIds:e,name:n,nameContains:r,referenceDatasetId:s,referenceDatasetName:a,includeStats:i,datasetVersion:o,referenceFree:l,metadata:u}={}){const d=new URLSearchParams;if(e!==void 0)for(const h of e)d.append("id",h);if(n!==void 0&&d.append("name",n),r!==void 0&&d.append("name_contains",r),s!==void 0)d.append("reference_dataset",s);else if(a!==void 0){const h=await this.readDataset({datasetName:a});d.append("reference_dataset",h.id)}i!==void 0&&d.append("include_stats",i.toString()),o!==void 0&&d.append("dataset_version",o),l!==void 0&&d.append("reference_free",l.toString()),u!==void 0&&d.append("metadata",JSON.stringify(u));for await(const h of this._getPaginated("/sessions",d))yield*h}async deleteProject({projectId:e,projectName:n}){let r;if(e===void 0&&n===void 0)throw new Error("Must provide projectName or projectId");if(e!==void 0&&n!==void 0)throw new Error("Must provide either projectName or projectId, not both");e===void 0?r=(await this.readProject({projectName:n})).id:r=e,ke(r),await this.caller.call(async()=>{const s=await this._fetch(`${this.apiUrl}/sessions/${r}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ce(s,`delete session ${r} (${n})`,!0),s})}async uploadCsv({csvFile:e,fileName:n,inputKeys:r,outputKeys:s,description:a,dataType:i,name:o}){const l=`${this.apiUrl}/datasets/upload`,u=new FormData;return u.append("file",e,n),r.forEach(f=>{u.append("input_keys",f)}),s.forEach(f=>{u.append("output_keys",f)}),a&&u.append("description",a),i&&u.append("data_type",i),o&&u.append("name",o),await(await this.caller.call(async()=>{const f=await this._fetch(l,{method:"POST",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:u});return await ce(f,"upload CSV"),f})).json()}async createDataset(e,{description:n,dataType:r,inputsSchema:s,outputsSchema:a,metadata:i}={}){const o={name:e,description:n,extra:i?{metadata:i}:void 0};r&&(o.data_type=r),s&&(o.inputs_schema_definition=s),a&&(o.outputs_schema_definition=a);const l=JSON.stringify(o);return await(await this.caller.call(async()=>{const h=await this._fetch(`${this.apiUrl}/datasets`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:l});return await ce(h,"create dataset"),h})).json()}async readDataset({datasetId:e,datasetName:n}){let r="/datasets";const s=new URLSearchParams({limit:"1"});if(e&&n)throw new Error("Must provide either datasetName or datasetId, not both");if(e)ke(e),r+=`/${e}`;else if(n)s.append("name",n);else throw new Error("Must provide datasetName or datasetId");const a=await this._get(r,s);let i;if(Array.isArray(a)){if(a.length===0)throw new Error(`Dataset[id=${e}, name=${n}] not found`);i=a[0]}else i=a;return i}async hasDataset({datasetId:e,datasetName:n}){try{return await this.readDataset({datasetId:e,datasetName:n}),!0}catch(r){if(r instanceof Error&&r.message.toLocaleLowerCase().includes("not found"))return!1;throw r}}async diffDatasetVersions({datasetId:e,datasetName:n,fromVersion:r,toVersion:s}){let a=e;if(a===void 0&&n===void 0)throw new Error("Must provide either datasetName or datasetId");if(a!==void 0&&n!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");a===void 0&&(a=(await this.readDataset({datasetName:n})).id);const i=new URLSearchParams({from_version:typeof r=="string"?r:r.toISOString(),to_version:typeof s=="string"?s:s.toISOString()});return await this._get(`/datasets/${a}/versions/diff`,i)}async readDatasetOpenaiFinetuning({datasetId:e,datasetName:n}){const r="/datasets";if(e===void 0)if(n!==void 0)e=(await this.readDataset({datasetName:n})).id;else throw new Error("Must provide either datasetName or datasetId");return(await(await this._getResponse(`${r}/${e}/openai_ft`)).text()).trim().split(`
`).map(o=>JSON.parse(o))}async*listDatasets({limit:e=100,offset:n=0,datasetIds:r,datasetName:s,datasetNameContains:a,metadata:i}={}){const o="/datasets",l=new URLSearchParams({limit:e.toString(),offset:n.toString()});if(r!==void 0)for(const u of r)l.append("id",u);s!==void 0&&l.append("name",s),a!==void 0&&l.append("name_contains",a),i!==void 0&&l.append("metadata",JSON.stringify(i));for await(const u of this._getPaginated(o,l))yield*u}async updateDataset(e){const{datasetId:n,datasetName:r,...s}=e;if(!n&&!r)throw new Error("Must provide either datasetName or datasetId");const a=n??(await this.readDataset({datasetName:r})).id;ke(a);const i=JSON.stringify(s);return await(await this.caller.call(async()=>{const l=await this._fetch(`${this.apiUrl}/datasets/${a}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:i});return await ce(l,"update dataset"),l})).json()}async updateDatasetTag(e){const{datasetId:n,datasetName:r,asOf:s,tag:a}=e;if(!n&&!r)throw new Error("Must provide either datasetName or datasetId");const i=n??(await this.readDataset({datasetName:r})).id;ke(i);const o=JSON.stringify({as_of:typeof s=="string"?s:s.toISOString(),tag:a});await this.caller.call(async()=>{const l=await this._fetch(`${this.apiUrl}/datasets/${i}/tags`,{method:"PUT",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:o});return await ce(l,"update dataset tags",!0),l})}async deleteDataset({datasetId:e,datasetName:n}){let r="/datasets",s=e;if(e!==void 0&&n!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(n!==void 0&&(s=(await this.readDataset({datasetName:n})).id),s!==void 0)ke(s),r+=`/${s}`;else throw new Error("Must provide datasetName or datasetId");await this.caller.call(async()=>{const a=await this._fetch(this.apiUrl+r,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ce(a,`delete ${r}`,!0),a})}async indexDataset({datasetId:e,datasetName:n,tag:r}){let s=e;if(!s&&!n)throw new Error("Must provide either datasetName or datasetId");if(s&&n)throw new Error("Must provide either datasetName or datasetId, not both");s||(s=(await this.readDataset({datasetName:n})).id),ke(s);const i=JSON.stringify({tag:r});await(await this.caller.call(async()=>{const l=await this._fetch(`${this.apiUrl}/datasets/${s}/index`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:i});return await ce(l,"index dataset"),l})).json()}async similarExamples(e,n,r,{filter:s}={}){const a={limit:r,inputs:e};s!==void 0&&(a.filter=s),ke(n);const i=JSON.stringify(a);return(await(await this.caller.call(async()=>{const u=await this._fetch(`${this.apiUrl}/datasets/${n}/search`,{headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,method:"POST",body:i});return await ce(u,"fetch similar examples"),u})).json()).examples}async createExample(e,n,r){var d;if(w_(e)&&(n!==void 0||r!==void 0))throw new Error("Cannot provide outputs or options when using ExampleCreate object");let s=n?r==null?void 0:r.datasetId:e.dataset_id;const a=n?r==null?void 0:r.datasetName:e.dataset_name;if(s===void 0&&a===void 0)throw new Error("Must provide either datasetName or datasetId");if(s!==void 0&&a!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");s===void 0&&(s=(await this.readDataset({datasetName:a})).id);const i=(n?r==null?void 0:r.createdAt:e.created_at)||new Date;let o;w_(e)?o=e:o={inputs:e,outputs:n,created_at:i==null?void 0:i.toISOString(),id:r==null?void 0:r.exampleId,metadata:r==null?void 0:r.metadata,split:r==null?void 0:r.split,source_run_id:r==null?void 0:r.sourceRunId,use_source_run_io:r==null?void 0:r.useSourceRunIO,use_source_run_attachments:r==null?void 0:r.useSourceRunAttachments,attachments:r==null?void 0:r.attachments};const l=await this._uploadExamplesMultipart(s,[o]);return await this.readExample(((d=l.example_ids)==null?void 0:d[0])??rn())}async createExamples(e){if(Array.isArray(e)){if(e.length===0)return[];const p=e;let g=p[0].dataset_id;const S=p[0].dataset_name;if(g===void 0&&S===void 0)throw new Error("Must provide either datasetName or datasetId");if(g!==void 0&&S!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");g===void 0&&(g=(await this.readDataset({datasetName:S})).id);const N=await this._uploadExamplesMultipart(g,p);return await Promise.all(N.example_ids.map(A=>this.readExample(A)))}const{inputs:n,outputs:r,metadata:s,splits:a,sourceRunIds:i,useSourceRunIOs:o,useSourceRunAttachments:l,attachments:u,exampleIds:d,datasetId:h,datasetName:f}=e;if(n===void 0)throw new Error("Must provide inputs when using legacy parameters");let m=h;const v=f;if(m===void 0&&v===void 0)throw new Error("Must provide either datasetName or datasetId");if(m!==void 0&&v!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");m===void 0&&(m=(await this.readDataset({datasetName:v})).id);const w=n.map((p,g)=>({dataset_id:m,inputs:p,outputs:r==null?void 0:r[g],metadata:s==null?void 0:s[g],split:a==null?void 0:a[g],id:d==null?void 0:d[g],attachments:u==null?void 0:u[g],source_run_id:i==null?void 0:i[g],use_source_run_io:o==null?void 0:o[g],use_source_run_attachments:l==null?void 0:l[g]})),_=await this._uploadExamplesMultipart(m,w);return await Promise.all(_.example_ids.map(p=>this.readExample(p)))}async createLLMExample(e,n,r){return this.createExample({input:e},{output:n},r)}async createChatExample(e,n,r){const s=e.map(i=>Kv(i)?Jv(i):i),a=Kv(n)?Jv(n):n;return this.createExample({input:s},{output:a},r)}async readExample(e){ke(e);const n=`/examples/${e}`,r=await this._get(n),{attachment_urls:s,...a}=r,i=a;return s&&(i.attachments=Object.entries(s).reduce((o,[l,u])=>(o[l.slice(11)]={presigned_url:u.presigned_url,mime_type:u.mime_type},o),{})),i}async*listExamples({datasetId:e,datasetName:n,exampleIds:r,asOf:s,splits:a,inlineS3Urls:i,metadata:o,limit:l,offset:u,filter:d,includeAttachments:h}={}){let f;if(e!==void 0&&n!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(e!==void 0)f=e;else if(n!==void 0)f=(await this.readDataset({datasetName:n})).id;else throw new Error("Must provide a datasetName or datasetId");const m=new URLSearchParams({dataset:f}),v=s?typeof s=="string"?s:s==null?void 0:s.toISOString():void 0;v&&m.append("as_of",v);const w=i??!0;if(m.append("inline_s3_urls",w.toString()),r!==void 0)for(const y of r)m.append("id",y);if(a!==void 0)for(const y of a)m.append("splits",y);if(o!==void 0){const y=JSON.stringify(o);m.append("metadata",y)}l!==void 0&&m.append("limit",l.toString()),u!==void 0&&m.append("offset",u.toString()),d!==void 0&&m.append("filter",d),h===!0&&["attachment_urls","outputs","metadata"].forEach(y=>m.append("select",y));let _=0;for await(const y of this._getPaginated("/examples",m)){for(const p of y){const{attachment_urls:g,...S}=p,N=S;g&&(N.attachments=Object.entries(g).reduce((T,[A,x])=>(T[A.slice(11)]={presigned_url:x.presigned_url,mime_type:x.mime_type||void 0},T),{})),yield N,_++}if(l!==void 0&&_>=l)break}}async deleteExample(e){ke(e);const n=`/examples/${e}`;await this.caller.call(async()=>{const r=await this._fetch(this.apiUrl+n,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ce(r,`delete ${n}`,!0),r})}async updateExample(e,n){let r;n?r=e:r=e.id,ke(r);let s;n?s={id:r,...n}:s=e;let a;return s.dataset_id!==void 0?a=s.dataset_id:a=(await this.readExample(r)).dataset_id,this._updateExamplesMultipart(a,[s])}async updateExamples(e){let n;return e[0].dataset_id===void 0?n=(await this.readExample(e[0].id)).dataset_id:n=e[0].dataset_id,this._updateExamplesMultipart(n,e)}async readDatasetVersion({datasetId:e,datasetName:n,asOf:r,tag:s}){let a;if(e?a=e:a=(await this.readDataset({datasetName:n})).id,ke(a),r&&s||!r&&!s)throw new Error("Exactly one of asOf and tag must be specified.");const i=new URLSearchParams;return r!==void 0&&i.append("as_of",typeof r=="string"?r:r.toISOString()),s!==void 0&&i.append("tag",s),await(await this.caller.call(async()=>{const l=await this._fetch(`${this.apiUrl}/datasets/${a}/version?${i.toString()}`,{method:"GET",headers:{...this.headers},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ce(l,"read dataset version"),l})).json()}async listDatasetSplits({datasetId:e,datasetName:n,asOf:r}){let s;if(e===void 0&&n===void 0)throw new Error("Must provide dataset name or ID");if(e!==void 0&&n!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");e===void 0?s=(await this.readDataset({datasetName:n})).id:s=e,ke(s);const a=new URLSearchParams,i=r?typeof r=="string"?r:r==null?void 0:r.toISOString():void 0;return i&&a.append("as_of",i),await this._get(`/datasets/${s}/splits`,a)}async updateDatasetSplits({datasetId:e,datasetName:n,splitName:r,exampleIds:s,remove:a=!1}){let i;if(e===void 0&&n===void 0)throw new Error("Must provide dataset name or ID");if(e!==void 0&&n!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");e===void 0?i=(await this.readDataset({datasetName:n})).id:i=e,ke(i);const o={split_name:r,examples:s.map(u=>(ke(u),u)),remove:a},l=JSON.stringify(o);await this.caller.call(async()=>{const u=await this._fetch(`${this.apiUrl}/datasets/${i}/splits`,{method:"PUT",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:l});return await ce(u,"update dataset splits",!0),u})}async evaluateRun(e,n,{sourceInfo:r,loadChildRuns:s,referenceExample:a}={loadChildRuns:!1}){Tm("This method is deprecated and will be removed in future LangSmith versions, use `evaluate` from `langsmith/evaluation` instead.");let i;if(typeof e=="string")i=await this.readRun(e,{loadChildRuns:s});else if(typeof e=="object"&&"id"in e)i=e;else throw new Error(`Invalid run type: ${typeof e}`);i.reference_example_id!==null&&i.reference_example_id!==void 0&&(a=await this.readExample(i.reference_example_id));const o=await n.evaluateRun(i,a),[l,u]=await this._logEvaluationFeedback(o,i,r);return u[0]}async createFeedback(e,n,{score:r,value:s,correction:a,comment:i,sourceInfo:o,feedbackSourceType:l="api",sourceRunId:u,feedbackId:d,feedbackConfig:h,projectId:f,comparativeExperimentId:m}){var p;if(!e&&!f)throw new Error("One of runId or projectId must be provided");if(e&&f)throw new Error("Only one of runId or projectId can be provided");const v={type:l??"api",metadata:o??{}};u!==void 0&&(v==null?void 0:v.metadata)!==void 0&&!v.metadata.__run&&(v.metadata.__run={run_id:u}),(v==null?void 0:v.metadata)!==void 0&&((p=v.metadata.__run)==null?void 0:p.run_id)!==void 0&&ke(v.metadata.__run.run_id);const w={id:d??rn(),run_id:e,key:n,score:v_(r),value:s,correction:a,comment:i,feedback_source:v,comparative_experiment_id:m,feedbackConfig:h,session_id:f},_=JSON.stringify(w),y=`${this.apiUrl}/feedback`;return await this.caller.call(async()=>{const g=await this._fetch(y,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:_});return await ce(g,"create feedback",!0),g}),w}async updateFeedback(e,{score:n,value:r,correction:s,comment:a}){const i={};n!=null&&(i.score=v_(n)),r!=null&&(i.value=r),s!=null&&(i.correction=s),a!=null&&(i.comment=a),ke(e);const o=JSON.stringify(i);await this.caller.call(async()=>{const l=await this._fetch(`${this.apiUrl}/feedback/${e}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:o});return await ce(l,"update feedback",!0),l})}async readFeedback(e){ke(e);const n=`/feedback/${e}`;return await this._get(n)}async deleteFeedback(e){ke(e);const n=`/feedback/${e}`;await this.caller.call(async()=>{const r=await this._fetch(this.apiUrl+n,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ce(r,`delete ${n}`,!0),r})}async*listFeedback({runIds:e,feedbackKeys:n,feedbackSourceTypes:r}={}){const s=new URLSearchParams;if(e)for(const a of e)ke(a),s.append("run",a);if(n)for(const a of n)s.append("key",a);if(r)for(const a of r)s.append("source",a);for await(const a of this._getPaginated("/feedback",s))yield*a}async createPresignedFeedbackToken(e,n,{expiration:r,feedbackConfig:s}={}){const a={run_id:e,feedback_key:n,feedback_config:s};r?typeof r=="string"?a.expires_at=r:(r!=null&&r.hours||r!=null&&r.minutes||r!=null&&r.days)&&(a.expires_in=r):a.expires_in={hours:3};const i=JSON.stringify(a);return await(await this.caller.call(async()=>{const l=await this._fetch(`${this.apiUrl}/feedback/tokens`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:i});return await ce(l,"create presigned feedback token"),l})).json()}async createComparativeExperiment({name:e,experimentIds:n,referenceDatasetId:r,createdAt:s,description:a,metadata:i,id:o}){var h;if(n.length===0)throw new Error("At least one experiment is required");if(r||(r=(await this.readProject({projectId:n[0]})).reference_dataset_id),!r==null)throw new Error("A reference dataset is required");const l={id:o,name:e,experiment_ids:n,reference_dataset_id:r,description:a,created_at:(h=s??new Date)==null?void 0:h.toISOString(),extra:{}};i&&(l.extra.metadata=i);const u=JSON.stringify(l);return(await this.caller.call(async()=>{const f=await this._fetch(`${this.apiUrl}/datasets/comparative`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:u});return await ce(f,"create comparative experiment"),f})).json()}async*listPresignedFeedbackTokens(e){ke(e);const n=new URLSearchParams({run_id:e});for await(const r of this._getPaginated("/feedback/tokens",n))yield*r}_selectEvalResults(e){let n;return"results"in e?n=e.results:Array.isArray(e)?n=e:n=[e],n}async _logEvaluationFeedback(e,n,r){const s=this._selectEvalResults(e),a=[];for(const i of s){let o=r||{};i.evaluatorInfo&&(o={...i.evaluatorInfo,...o});let l=null;i.targetRunId?l=i.targetRunId:n&&(l=n.id),a.push(await this.createFeedback(l,i.key,{score:i.score,value:i.value,comment:i.comment,correction:i.correction,sourceInfo:o,sourceRunId:i.sourceRunId,feedbackConfig:i.feedbackConfig,feedbackSourceType:"model"}))}return[s,a]}async logEvaluationFeedback(e,n,r){const[s]=await this._logEvaluationFeedback(e,n,r);return s}async*listAnnotationQueues(e={}){const{queueIds:n,name:r,nameContains:s,limit:a}=e,i=new URLSearchParams;n&&n.forEach((l,u)=>{ke(l,`queueIds[${u}]`),i.append("ids",l)}),r&&i.append("name",r),s&&i.append("name_contains",s),i.append("limit",(a!==void 0?Math.min(a,100):100).toString());let o=0;for await(const l of this._getPaginated("/annotation-queues",i))if(yield*l,o++,a!==void 0&&o>=a)break}async createAnnotationQueue(e){const{name:n,description:r,queueId:s,rubricInstructions:a}=e,i={name:n,description:r,id:s||rn(),rubric_instructions:a},o=JSON.stringify(Object.fromEntries(Object.entries(i).filter(([u,d])=>d!==void 0)));return(await this.caller.call(async()=>{const u=await this._fetch(`${this.apiUrl}/annotation-queues`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:o});return await ce(u,"create annotation queue"),u})).json()}async readAnnotationQueue(e){return(await this.caller.call(async()=>{const r=await this._fetch(`${this.apiUrl}/annotation-queues/${ke(e,"queueId")}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ce(r,"read annotation queue"),r})).json()}async updateAnnotationQueue(e,n){const{name:r,description:s,rubricInstructions:a}=n,i=JSON.stringify({name:r,description:s,rubric_instructions:a});await this.caller.call(async()=>{const o=await this._fetch(`${this.apiUrl}/annotation-queues/${ke(e,"queueId")}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:i});return await ce(o,"update annotation queue",!0),o})}async deleteAnnotationQueue(e){await this.caller.call(async()=>{const n=await this._fetch(`${this.apiUrl}/annotation-queues/${ke(e,"queueId")}`,{method:"DELETE",headers:{...this.headers,Accept:"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ce(n,"delete annotation queue",!0),n})}async addRunsToAnnotationQueue(e,n){const r=JSON.stringify(n.map((s,a)=>ke(s,`runIds[${a}]`).toString()));await this.caller.call(async()=>{const s=await this._fetch(`${this.apiUrl}/annotation-queues/${ke(e,"queueId")}/runs`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:r});return await ce(s,"add runs to annotation queue",!0),s})}async getRunFromAnnotationQueue(e,n){const r=`/annotation-queues/${ke(e,"queueId")}/run`;return(await this.caller.call(async()=>{const a=await this._fetch(`${this.apiUrl}${r}/${n}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ce(a,"get run from annotation queue"),a})).json()}async deleteRunFromAnnotationQueue(e,n){await this.caller.call(async()=>{const r=await this._fetch(`${this.apiUrl}/annotation-queues/${ke(e,"queueId")}/runs/${ke(n,"queueRunId")}`,{method:"DELETE",headers:{...this.headers,Accept:"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ce(r,"delete run from annotation queue",!0),r})}async getSizeFromAnnotationQueue(e){return(await this.caller.call(async()=>{const r=await this._fetch(`${this.apiUrl}/annotation-queues/${ke(e,"queueId")}/size`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ce(r,"get size from annotation queue"),r})).json()}async _currentTenantIsOwner(e){const n=await this._getSettings();return e=="-"||n.tenant_handle===e}async _ownerConflictError(e,n){const r=await this._getSettings();return new Error(`Cannot ${e} for another tenant.

      Current tenant: ${r.tenant_handle}

      Requested tenant: ${n}`)}async _getLatestCommitHash(e){const r=await(await this.caller.call(async()=>{const s=await this._fetch(`${this.apiUrl}/commits/${e}/?limit=1&offset=0`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ce(s,"get latest commit hash"),s})).json();if(r.commits.length!==0)return r.commits[0].commit_hash}async _likeOrUnlikePrompt(e,n){const[r,s,a]=us(e),i=JSON.stringify({like:n});return(await this.caller.call(async()=>{const l=await this._fetch(`${this.apiUrl}/likes/${r}/${s}`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:i});return await ce(l,`${n?"like":"unlike"} prompt`),l})).json()}async _getPromptUrl(e){const[n,r,s]=us(e);if(await this._currentTenantIsOwner(n)){const a=await this._getSettings();return s!=="latest"?`${this.getHostUrl()}/prompts/${r}/${s.substring(0,8)}?organizationId=${a.id}`:`${this.getHostUrl()}/prompts/${r}?organizationId=${a.id}`}else return s!=="latest"?`${this.getHostUrl()}/hub/${n}/${r}/${s.substring(0,8)}`:`${this.getHostUrl()}/hub/${n}/${r}`}async promptExists(e){return!!await this.getPrompt(e)}async likePrompt(e){return this._likeOrUnlikePrompt(e,!0)}async unlikePrompt(e){return this._likeOrUnlikePrompt(e,!1)}async*listCommits(e){for await(const n of this._getPaginated(`/commits/${e}/`,new URLSearchParams,r=>r.commits))yield*n}async*listPrompts(e){const n=new URLSearchParams;n.append("sort_field",(e==null?void 0:e.sortField)??"updated_at"),n.append("sort_direction","desc"),n.append("is_archived",(!!(e!=null&&e.isArchived)).toString()),(e==null?void 0:e.isPublic)!==void 0&&n.append("is_public",e.isPublic.toString()),e!=null&&e.query&&n.append("query",e.query);for await(const r of this._getPaginated("/repos",n,s=>s.repos))yield*r}async getPrompt(e){const[n,r,s]=us(e),a=await this.caller.call(async()=>{const o=await this._fetch(`${this.apiUrl}/repos/${n}/${r}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return(o==null?void 0:o.status)===404?null:(await ce(o,"get prompt"),o)}),i=await(a==null?void 0:a.json());return i!=null&&i.repo?i.repo:null}async createPrompt(e,n){const r=await this._getSettings();if(n!=null&&n.isPublic&&!r.tenant_handle)throw new Error(`Cannot create a public prompt without first

        creating a LangChain Hub handle.
        You can add a handle by creating a public prompt at:

        https://smith.langchain.com/prompts`);const[s,a,i]=us(e);if(!await this._currentTenantIsOwner(s))throw await this._ownerConflictError("create a prompt",s);const o={repo_handle:a,...(n==null?void 0:n.description)&&{description:n.description},...(n==null?void 0:n.readme)&&{readme:n.readme},...(n==null?void 0:n.tags)&&{tags:n.tags},is_public:!!(n!=null&&n.isPublic)},l=JSON.stringify(o),u=await this.caller.call(async()=>{const h=await this._fetch(`${this.apiUrl}/repos/`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:l});return await ce(h,"create prompt"),h}),{repo:d}=await u.json();return d}async createCommit(e,n,r){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[s,a,i]=us(e),o=(r==null?void 0:r.parentCommitHash)==="latest"||!(r!=null&&r.parentCommitHash)?await this._getLatestCommitHash(`${s}/${a}`):r==null?void 0:r.parentCommitHash,l={manifest:JSON.parse(JSON.stringify(n)),parent_commit:o},u=JSON.stringify(l),h=await(await this.caller.call(async()=>{const f=await this._fetch(`${this.apiUrl}/commits/${s}/${a}`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:u});return await ce(f,"create commit"),f})).json();return this._getPromptUrl(`${s}/${a}${h.commit_hash?`:${h.commit_hash}`:""}`)}async updateExamplesMultipart(e,n=[]){return this._updateExamplesMultipart(e,n)}async _updateExamplesMultipart(e,n=[]){var i;if(!await this._getDatasetExamplesMultiPartSupport())throw new Error("Your LangSmith deployment does not allow using the multipart examples endpoint, please upgrade your deployment to the latest version.");const r=new FormData;for(const o of n){const l=o.id,u={...o.metadata&&{metadata:o.metadata},...o.split&&{split:o.split}},d=pn(u,`Serializing body for example with id: ${l}`),h=new Blob([d],{type:"application/json"});if(r.append(l,h),o.inputs){const f=pn(o.inputs,`Serializing inputs for example with id: ${l}`),m=new Blob([f],{type:"application/json"});r.append(`${l}.inputs`,m)}if(o.outputs){const f=pn(o.outputs,`Serializing outputs whle updating example with id: ${l}`),m=new Blob([f],{type:"application/json"});r.append(`${l}.outputs`,m)}if(o.attachments)for(const[f,m]of Object.entries(o.attachments)){let v,w;Array.isArray(m)?[v,w]=m:(v=m.mimeType,w=m.data);const _=new Blob([w],{type:`${v}; length=${w.byteLength}`});r.append(`${l}.attachment.${f}`,_)}if(o.attachments_operations){const f=pn(o.attachments_operations,`Serializing attachments while updating example with id: ${l}`),m=new Blob([f],{type:"application/json"});r.append(`${l}.attachments_operations`,m)}}const s=e??((i=n[0])==null?void 0:i.dataset_id);return(await this.caller.call(async()=>{const o=await this._fetch(`${this.apiUrl}${this._getPlatformEndpointPath(`datasets/${s}/examples`)}`,{method:"PATCH",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:r});return await ce(o,"update examples"),o})).json()}async uploadExamplesMultipart(e,n=[]){return this._uploadExamplesMultipart(e,n)}async _uploadExamplesMultipart(e,n=[]){if(!await this._getDatasetExamplesMultiPartSupport())throw new Error("Your LangSmith deployment does not allow using the multipart examples endpoint, please upgrade your deployment to the latest version.");const r=new FormData;for(const a of n){const i=(a.id??rn()).toString(),o={created_at:a.created_at,...a.metadata&&{metadata:a.metadata},...a.split&&{split:a.split},...a.source_run_id&&{source_run_id:a.source_run_id},...a.use_source_run_io&&{use_source_run_io:a.use_source_run_io},...a.use_source_run_attachments&&{use_source_run_attachments:a.use_source_run_attachments}},l=pn(o,`Serializing body for uploaded example with id: ${i}`),u=new Blob([l],{type:"application/json"});if(r.append(i,u),a.inputs){const d=pn(a.inputs,`Serializing inputs for uploaded example with id: ${i}`),h=new Blob([d],{type:"application/json"});r.append(`${i}.inputs`,h)}if(a.outputs){const d=pn(a.outputs,`Serializing outputs for uploaded example with id: ${i}`),h=new Blob([d],{type:"application/json"});r.append(`${i}.outputs`,h)}if(a.attachments)for(const[d,h]of Object.entries(a.attachments)){let f,m;Array.isArray(h)?[f,m]=h:(f=h.mimeType,m=h.data);const v=new Blob([m],{type:`${f}; length=${m.byteLength}`});r.append(`${i}.attachment.${d}`,v)}}return(await this.caller.call(async()=>{const a=await this._fetch(`${this.apiUrl}${this._getPlatformEndpointPath(`datasets/${e}/examples`)}`,{method:"POST",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:r});return await ce(a,"upload examples"),a})).json()}async updatePrompt(e,n){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[r,s]=us(e);if(!await this._currentTenantIsOwner(r))throw await this._ownerConflictError("update a prompt",r);const a={};if((n==null?void 0:n.description)!==void 0&&(a.description=n.description),(n==null?void 0:n.readme)!==void 0&&(a.readme=n.readme),(n==null?void 0:n.tags)!==void 0&&(a.tags=n.tags),(n==null?void 0:n.isPublic)!==void 0&&(a.is_public=n.isPublic),(n==null?void 0:n.isArchived)!==void 0&&(a.is_archived=n.isArchived),Object.keys(a).length===0)throw new Error("No valid update options provided");const i=JSON.stringify(a);return(await this.caller.call(async()=>{const l=await this._fetch(`${this.apiUrl}/repos/${r}/${s}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:i});return await ce(l,"update prompt"),l})).json()}async deletePrompt(e){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[n,r,s]=us(e);if(!await this._currentTenantIsOwner(n))throw await this._ownerConflictError("delete a prompt",n);return(await this.caller.call(async()=>{const i=await this._fetch(`${this.apiUrl}/repos/${n}/${r}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ce(i,"delete prompt"),i})).json()}async pullPromptCommit(e,n){const[r,s,a]=us(e),o=await(await this.caller.call(async()=>{const l=await this._fetch(`${this.apiUrl}/commits/${r}/${s}/${a}${n!=null&&n.includeModel?"?include_model=true":""}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ce(l,"pull prompt commit"),l})).json();return{owner:r,repo:s,commit_hash:o.commit_hash,manifest:o.manifest,examples:o.examples}}async _pullPrompt(e,n){const r=await this.pullPromptCommit(e,{includeModel:n==null?void 0:n.includeModel});return JSON.stringify(r.manifest)}async pushPrompt(e,n){return await this.promptExists(e)?n&&Object.keys(n).some(s=>s!=="object")&&await this.updatePrompt(e,{description:n==null?void 0:n.description,readme:n==null?void 0:n.readme,tags:n==null?void 0:n.tags,isPublic:n==null?void 0:n.isPublic}):await this.createPrompt(e,{description:n==null?void 0:n.description,readme:n==null?void 0:n.readme,tags:n==null?void 0:n.tags,isPublic:n==null?void 0:n.isPublic}),n!=null&&n.object?await this.createCommit(e,n==null?void 0:n.object,{parentCommitHash:n==null?void 0:n.parentCommitHash}):await this._getPromptUrl(e)}async clonePublicDataset(e,n={}){const{sourceApiUrl:r=this.apiUrl,datasetName:s}=n,[a,i]=this.parseTokenOrUrl(e,r),o=new nl({apiUrl:a,apiKey:"placeholder"}),l=await o.readSharedDataset(i),u=s||l.name;try{if(await this.hasDataset({datasetId:u})){console.log(`Dataset ${u} already exists in your tenant. Skipping.`);return}}catch{}const d=await o.listSharedExamples(i),h=await this.createDataset(u,{description:l.description,dataType:l.data_type||"kv",inputsSchema:l.inputs_schema_definition??void 0,outputsSchema:l.outputs_schema_definition??void 0});try{await this.createExamples({inputs:d.map(f=>f.inputs),outputs:d.flatMap(f=>f.outputs?[f.outputs]:[]),datasetId:h.id})}catch(f){throw console.error(`An error occurred while creating dataset ${u}. You should delete it manually.`),f}}parseTokenOrUrl(e,n,r=2,s="dataset"){try{return ke(e),[n,e]}catch{}try{const i=new URL(e).pathname.split("/").filter(o=>o!=="");if(i.length>=r){const o=i[i.length-r];return[n,o]}else throw new Error(`Invalid public ${s} URL: ${e}`)}catch{throw new Error(`Invalid public ${s} URL or token: ${e}`)}}async awaitPendingTraceBatches(){var e,n;if(this.manualFlushMode)return console.warn("[WARNING]: When tracing in manual flush mode, you must call `await client.flush()` manually to submit trace batches."),Promise.resolve();await Promise.all([...this.autoBatchQueue.items.map(({itemPromise:r})=>r),this.batchIngestCaller.queue.onIdle()]),this.langSmithToOTELTranslator!==void 0&&await((n=(e=jj())==null?void 0:e.DEFAULT_LANGSMITH_SPAN_PROCESSOR)==null?void 0:n.forceFlush())}}function w_(t){return"dataset_id"in t||"dataset_name"in t}const c$=t=>!!["TRACING_V2","TRACING"].find(n=>sn(n)==="true"),Rs=Symbol.for("lc:context_variables"),tf=Symbol.for("langsmith:replica_trace_roots");function x_(t,e){if(Rs in t)return t[Rs][e]}function u$(t,e,n){const r=Rs in t?t[Rs]:{};r[e]=n,t[Rs]=r}const Wi=36,io="6ba7b810-9dad-11d1-80b4-00c04fd430c8";function b_(t){const n=Object.keys(t).sort().map(r=>`${r}:${t[r]??""}`).join("|");return ao(n,io)}function d$(t){return t.replace(/[-:.]/g,"")}function gk(t,e=1){const n=e.toFixed(0).slice(0,3).padStart(3,"0");return`${new Date(t).toISOString().slice(0,-1)}${n}Z`}function yk(t,e,n=1){const r=gk(t,n);return{dottedOrder:d$(r)+e,microsecondPrecisionDatestring:r}}class Iu{constructor(e,n,r,s){Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"project_name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"replicas",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.metadata=e,this.tags=n,this.project_name=r,this.replicas=s}static fromHeader(e){const n=e.split(",");let r={},s=[],a,i;for(const o of n){const[l,u]=o.split("="),d=decodeURIComponent(u);l==="langsmith-metadata"?r=JSON.parse(d):l==="langsmith-tags"?s=d.split(","):l==="langsmith-project"?a=d:l==="langsmith-replicas"&&(i=JSON.parse(d))}return new Iu(r,s,a,i)}toHeader(){const e=[];return this.metadata&&Object.keys(this.metadata).length>0&&e.push(`langsmith-metadata=${encodeURIComponent(JSON.stringify(this.metadata))}`),this.tags&&this.tags.length>0&&e.push(`langsmith-tags=${encodeURIComponent(this.tags.join(","))}`),this.project_name&&e.push(`langsmith-project=${encodeURIComponent(this.project_name)}`),e.join(",")}}class en{constructor(e){var o;if(Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"run_type",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"project_name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"parent_run",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"parent_run_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"child_runs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"start_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"end_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"extra",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"error",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"serialized",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reference_example_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"trace_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dotted_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tracingEnabled",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"execution_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"child_execution_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"attachments",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"replicas",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"distributedParentId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_serialized_start_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),h$(e)){Object.assign(this,{...e});return}const n=en.getDefaultConfig(),{metadata:r,...s}=e,a=s.client??en.getSharedClient(),i={...r,...(o=s==null?void 0:s.extra)==null?void 0:o.metadata};if(s.extra={...s.extra,metadata:i},"id"in s&&s.id==null&&delete s.id,Object.assign(this,{...n,...s,client:a}),this.execution_order??(this.execution_order=1),this.child_execution_order??(this.child_execution_order=1),this.dotted_order||(this._serialized_start_time=gk(this.start_time,this.execution_order)),this.id||(this.id=yj(this._serialized_start_time??this.start_time)),this.trace_id||(this.parent_run?this.trace_id=this.parent_run.trace_id??this.id:this.trace_id=this.id),this.replicas=g$(this.replicas),!this.dotted_order){const{dottedOrder:l}=yk(this.start_time,this.id,this.execution_order);this.parent_run?this.dotted_order=this.parent_run.dotted_order+"."+l:this.dotted_order=l}}set metadata(e){var n;this.extra={...this.extra,metadata:{...(n=this.extra)==null?void 0:n.metadata,...e}}}get metadata(){var e;return(e=this.extra)==null?void 0:e.metadata}static getDefaultConfig(){const e=Date.now();return{run_type:"chain",project_name:qS(),child_runs:[],api_url:jr("LANGCHAIN_ENDPOINT")??"http://localhost:1984",api_key:jr("LANGCHAIN_API_KEY"),caller_options:{},start_time:e,serialized:{},inputs:{},extra:{}}}static getSharedClient(){return en.sharedClient||(en.sharedClient=new nl),en.sharedClient}createChild(e){var d,h,f,m,v,w,_;const n=this.child_execution_order+1,r=(d=this.replicas)==null?void 0:d.map(y=>{const{reroot:p,...g}=y;return g}),s=e.replicas??r,a=new en({...e,parent_run:this,project_name:this.project_name,replicas:s,client:this.client,tracingEnabled:this.tracingEnabled,execution_order:n,child_execution_order:n});Rs in this&&(a[Rs]=this[Rs]);const i=Symbol.for("lc:child_config"),o=((h=e.extra)==null?void 0:h[i])??this.extra[i];if(m$(o)){const y={...o},p=f$(y.callbacks)?(m=(f=y.callbacks).copy)==null?void 0:m.call(f):void 0;p&&(Object.assign(p,{_parentRunId:a.id}),(_=(w=(v=p.handlers)==null?void 0:v.find(vk))==null?void 0:w.updateFromRunTree)==null||_.call(w,a),y.callbacks=p),a.extra[i]=y}const l=new Set;let u=this;for(;u!=null&&!l.has(u.id);)l.add(u.id),u.child_execution_order=Math.max(u.child_execution_order,n),u=u.parent_run;return this.child_runs.push(a),a}async end(e,n,r=Date.now(),s){this.outputs=this.outputs??e,this.error=this.error??n,this.end_time=this.end_time??r,s&&Object.keys(s).length>0&&(this.extra=this.extra?{...this.extra,metadata:{...this.extra.metadata,...s}}:{metadata:s})}_convertToCreate(e,n,r=!0){var o,l;const s=e.extra??{};if(((o=s==null?void 0:s.runtime)==null?void 0:o.library)===void 0&&(s.runtime||(s.runtime={}),n))for(const[u,d]of Object.entries(n))s.runtime[u]||(s.runtime[u]=d);let a,i;return r?(i=((l=e.parent_run)==null?void 0:l.id)??e.parent_run_id,a=[]):(a=e.child_runs.map(u=>this._convertToCreate(u,n,r)),i=void 0),{id:e.id,name:e.name,start_time:e._serialized_start_time??e.start_time,end_time:e.end_time,run_type:e.run_type,reference_example_id:e.reference_example_id,extra:s,serialized:e.serialized,error:e.error,inputs:e.inputs,outputs:e.outputs,session_name:e.project_name,child_runs:a,parent_run_id:i,trace_id:e.trace_id,dotted_order:e.dotted_order,tags:e.tags,attachments:e.attachments,events:e.events}}_sliceParentId(e,n){if(n.dotted_order){const r=n.dotted_order.split(".");let s=null;for(let a=0;a<r.length;a++)if(r[a].slice(-Wi)===e){s=a;break}if(s!==null){const a=r.slice(s+1);n.dotted_order=a.join("."),a.length>0?n.trace_id=a[0].slice(-Wi):n.trace_id=n.id}}n.parent_run_id===e&&(n.parent_run_id=void 0)}_setReplicaTraceRoot(e,n){const r=x_(this,tf)??{};r[e]=n,u$(this,tf,r);for(const s of this.child_runs)s._setReplicaTraceRoot(e,n)}_remapForProject(e){const{projectName:n,runtimeEnv:r,excludeChildRuns:s=!0,reroot:a=!1,distributedParentId:i,apiUrl:o,apiKey:l,workspaceId:u}=e,d=this._convertToCreate(this,r,s);if(n===this.project_name)return{...d,session_name:n};if(a){if(i)this._sliceParentId(i,d);else if(d.parent_run_id=void 0,d.dotted_order){const p=d.dotted_order.split(".");p.length>0&&(d.dotted_order=p[p.length-1],d.trace_id=d.id)}const y=b_({projectName:n,apiUrl:o,apiKey:l,workspaceId:u});this._setReplicaTraceRoot(y,d.id)}let h;if(!a){const y=x_(this,tf)??{},p=b_({projectName:n,apiUrl:o,apiKey:l,workspaceId:u});if(h=y[p],h&&(d.trace_id=h,d.dotted_order)){const g=d.dotted_order.split(".");let S=null;for(let N=0;N<g.length;N++)if(g[N].slice(-Wi)===h){S=N;break}if(S!==null){const N=g.slice(S);d.dotted_order=N.join(".")}}}const f=d.id,m=ao(`${f}:${n}`,io);let v;d.trace_id?v=ao(`${d.trace_id}:${n}`,io):v=m;let w;d.parent_run_id&&(w=ao(`${d.parent_run_id}:${n}`,io));let _;return d.dotted_order&&(_=d.dotted_order.split(".").map(g=>{const S=g.slice(-Wi),N=ao(`${S}:${n}`,io);return g.slice(0,-Wi)+N}).join(".")),{...d,id:m,trace_id:v,parent_run_id:w,dotted_order:_,session_name:n}}async postRun(e=!0){try{const n=YS();if(this.replicas&&this.replicas.length>0)for(const{projectName:r,apiKey:s,apiUrl:a,workspaceId:i,reroot:o}of this.replicas){const l=this._remapForProject({projectName:r??this.project_name,runtimeEnv:n,excludeChildRuns:!0,reroot:o,distributedParentId:this.distributedParentId,apiUrl:a,apiKey:s,workspaceId:i});await this.client.createRun(l,{apiKey:s,apiUrl:a,workspaceId:i})}else{const r=this._convertToCreate(this,n,e);await this.client.createRun(r)}if(!e){Tm("Posting with excludeChildRuns=false is deprecated and will be removed in a future version.");for(const r of this.child_runs)await r.postRun(!1)}}catch(n){console.error(`Error in postRun for run ${this.id}:`,n)}}async patchRun(e){var n;if(this.replicas&&this.replicas.length>0)for(const{projectName:r,apiKey:s,apiUrl:a,workspaceId:i,updates:o,reroot:l}of this.replicas){const u=this._remapForProject({projectName:r??this.project_name,runtimeEnv:void 0,excludeChildRuns:!0,reroot:l,distributedParentId:this.distributedParentId,apiUrl:a,apiKey:s,workspaceId:i}),d={id:u.id,name:u.name,run_type:u.run_type,start_time:u.start_time,outputs:u.outputs,error:u.error,parent_run_id:u.parent_run_id,session_name:u.session_name,reference_example_id:u.reference_example_id,end_time:u.end_time,dotted_order:u.dotted_order,trace_id:u.trace_id,events:u.events,tags:u.tags,extra:u.extra,attachments:this.attachments,...o};e!=null&&e.excludeInputs||(d.inputs=u.inputs),await this.client.updateRun(u.id,d,{apiKey:s,apiUrl:a,workspaceId:i})}else try{const r={name:this.name,run_type:this.run_type,start_time:this._serialized_start_time??this.start_time,end_time:this.end_time,error:this.error,outputs:this.outputs,parent_run_id:((n=this.parent_run)==null?void 0:n.id)??this.parent_run_id,reference_example_id:this.reference_example_id,extra:this.extra,events:this.events,dotted_order:this.dotted_order,trace_id:this.trace_id,tags:this.tags,attachments:this.attachments,session_name:this.project_name};e!=null&&e.excludeInputs||(r.inputs=this.inputs),await this.client.updateRun(this.id,r)}catch(r){console.error(`Error in patchRun for run ${this.id}`,r)}}toJSON(){return this._convertToCreate(this,void 0,!1)}addEvent(e){this.events||(this.events=[]),typeof e=="string"?this.events.push({name:"event",time:new Date().toISOString(),message:e}):this.events.push({...e,time:e.time??new Date().toISOString()})}static fromRunnableConfig(e,n){var u,d,h,f;const r=e==null?void 0:e.callbacks;let s,a,i,o=c$();if(r){const m=((u=r==null?void 0:r.getParentRunId)==null?void 0:u.call(r))??"",v=(d=r==null?void 0:r.handlers)==null?void 0:d.find(w=>(w==null?void 0:w.name)=="langchain_tracer");s=(h=v==null?void 0:v.getRun)==null?void 0:h.call(v,m),a=v==null?void 0:v.projectName,i=v==null?void 0:v.client,o=o||!!v}return s?new en({name:s.name,id:s.id,trace_id:s.trace_id,dotted_order:s.dotted_order,client:i,tracingEnabled:o,project_name:a,tags:[...new Set(((s==null?void 0:s.tags)??[]).concat((e==null?void 0:e.tags)??[]))],extra:{metadata:{...(f=s==null?void 0:s.extra)==null?void 0:f.metadata,...e==null?void 0:e.metadata}}}).createChild(n):new en({...n,client:i,tracingEnabled:o,project_name:a})}static fromDottedOrder(e){return this.fromHeaders({"langsmith-trace":e})}static fromHeaders(e,n){var d;const r="get"in e&&typeof e.get=="function"?{"langsmith-trace":e.get("langsmith-trace"),baggage:e.get("baggage")}:e,s=r["langsmith-trace"];if(!s||typeof s!="string")return;const a=s.trim(),i=a.split(".").map(h=>{const[f,m]=h.split("Z");return{strTime:f,time:Date.parse(f+"Z"),uuid:m}}),o=i[0].uuid,l={...n,name:(n==null?void 0:n.name)??"parent",run_type:(n==null?void 0:n.run_type)??"chain",start_time:(n==null?void 0:n.start_time)??Date.now(),id:(d=i.at(-1))==null?void 0:d.uuid,trace_id:o,dotted_order:a};if(r.baggage&&typeof r.baggage=="string"){const h=Iu.fromHeader(r.baggage);l.metadata=h.metadata,l.tags=h.tags,l.project_name=h.project_name,l.replicas=h.replicas}const u=new en(l);return u.distributedParentId=u.id,u}toHeaders(e){var r;const n={"langsmith-trace":this.dotted_order,baggage:new Iu((r=this.extra)==null?void 0:r.metadata,this.tags,this.project_name,this.replicas).toHeader()};if(e)for(const[s,a]of Object.entries(n))e.set(s,a);return n}}Object.defineProperty(en,"sharedClient",{enumerable:!0,configurable:!0,writable:!0,value:null});function h$(t){return t!=null&&typeof t.createChild=="function"&&typeof t.postRun=="function"}function vk(t){return typeof t=="object"&&t!=null&&typeof t.name=="string"&&t.name==="langchain_tracer"}function S_(t){return Array.isArray(t)&&t.some(e=>vk(e))}function f$(t){return typeof t=="object"&&t!=null&&Array.isArray(t.handlers)}function m$(t){var e;return t!=null&&typeof t.callbacks=="object"&&(S_((e=t.callbacks)==null?void 0:e.handlers)||S_(t.callbacks))}function p$(){const t=jr("LANGSMITH_RUNS_ENDPOINTS");if(!t)return[];try{const e=JSON.parse(t);if(Array.isArray(e)){const n=[];for(const r of e){if(typeof r!="object"||r===null){console.warn(`Invalid item type in LANGSMITH_RUNS_ENDPOINTS: expected object, got ${typeof r}`);continue}if(typeof r.api_url!="string"){console.warn(`Invalid api_url type in LANGSMITH_RUNS_ENDPOINTS: expected string, got ${typeof r.api_url}`);continue}if(typeof r.api_key!="string"){console.warn(`Invalid api_key type in LANGSMITH_RUNS_ENDPOINTS: expected string, got ${typeof r.api_key}`);continue}n.push({apiUrl:r.api_url.replace(/\/$/,""),apiKey:r.api_key})}return n}else if(typeof e=="object"&&e!==null){y$(e);const n=[];for(const[r,s]of Object.entries(e)){const a=r.replace(/\/$/,"");if(typeof s=="string")n.push({apiUrl:a,apiKey:s});else{console.warn(`Invalid value type in LANGSMITH_RUNS_ENDPOINTS for URL ${r}: expected string, got ${typeof s}`);continue}}return n}else return console.warn(`Invalid LANGSMITH_RUNS_ENDPOINTS  must be valid JSON array of objects with api_url and api_key properties, or object mapping url->apiKey, got ${typeof e}`),[]}catch(e){if(KP(e))throw e;return console.warn("Invalid LANGSMITH_RUNS_ENDPOINTS  must be valid JSON array of objects with api_url and api_key properties, or object mapping url->apiKey"),[]}}function g$(t){return t?t.map(e=>Array.isArray(e)?{projectName:e[0],updates:e[1]}:e):p$()}function y$(t){if(Object.keys(t).length>0&&sn("ENDPOINT"))throw new ZP}var v$={};je(v$,{BaseTracer:()=>Ei,isBaseTracer:()=>Ra});const _$=t=>{if(t)return t.events=t.events??[],t.child_runs=t.child_runs??[],t};function Im(t,e){if(t)return new en({...t,start_time:t._serialized_start_time??t.start_time,parent_run:Im(e),child_runs:t.child_runs.map(n=>Im(n)).filter(n=>n!==void 0),extra:{...t.extra,runtime:GS()},tracingEnabled:!1})}function nf(t,e){return t&&!Array.isArray(t)&&typeof t=="object"?t:{[e]:t}}function Ra(t){return typeof t._addRunToRunMap=="function"}var Ei=class extends Sl{constructor(e){super(...arguments);k(this,"runMap",new Map);k(this,"runTreeMap",new Map);k(this,"usesRunTreeMap",!1)}copy(){return this}getRunById(e){if(e!==void 0)return this.usesRunTreeMap?_$(this.runTreeMap.get(e)):this.runMap.get(e)}stringifyError(e){return e instanceof Error?e.message+(e!=null&&e.stack?`

${e.stack}`:""):typeof e=="string"?e:`${e}`}_addChildRun(e,n){e.child_runs.push(n)}_addRunToRunMap(e){const{dottedOrder:n,microsecondPrecisionDatestring:r}=yk(new Date(e.start_time).getTime(),e.id,e.execution_order),s={...e},a=this.getRunById(s.parent_run_id);if(s.parent_run_id!==void 0?a&&(this._addChildRun(a,s),a.child_execution_order=Math.max(a.child_execution_order,s.child_execution_order),s.trace_id=a.trace_id,a.dotted_order!==void 0&&(s.dotted_order=[a.dotted_order,n].join("."),s._serialized_start_time=r)):(s.trace_id=s.id,s.dotted_order=n,s._serialized_start_time=r),this.usesRunTreeMap){const i=Im(s,a);i!==void 0&&this.runTreeMap.set(s.id,i)}else this.runMap.set(s.id,s);return s}async _endTrace(e){var r;const n=e.parent_run_id!==void 0&&this.getRunById(e.parent_run_id);n?n.child_execution_order=Math.max(n.child_execution_order,e.child_execution_order):await this.persistRun(e),await((r=this.onRunUpdate)==null?void 0:r.call(this,e)),this.usesRunTreeMap?this.runTreeMap.delete(e.id):this.runMap.delete(e.id)}_getExecutionOrder(e){const n=e!==void 0&&this.getRunById(e);return n?n.child_execution_order+1:1}_createRunForLLMStart(e,n,r,s,a,i,o,l){const u=this._getExecutionOrder(s),d=Date.now(),h=o?{...a,metadata:o}:a,f={id:r,name:l??e.id[e.id.length-1],parent_run_id:s,start_time:d,serialized:e,events:[{name:"start",time:new Date(d).toISOString()}],inputs:{prompts:n},execution_order:u,child_runs:[],child_execution_order:u,run_type:"llm",extra:h??{},tags:i||[]};return this._addRunToRunMap(f)}async handleLLMStart(e,n,r,s,a,i,o,l){var d,h;const u=this.getRunById(r)??this._createRunForLLMStart(e,n,r,s,a,i,o,l);return await((d=this.onRunCreate)==null?void 0:d.call(this,u)),await((h=this.onLLMStart)==null?void 0:h.call(this,u)),u}_createRunForChatModelStart(e,n,r,s,a,i,o,l){const u=this._getExecutionOrder(s),d=Date.now(),h=o?{...a,metadata:o}:a,f={id:r,name:l??e.id[e.id.length-1],parent_run_id:s,start_time:d,serialized:e,events:[{name:"start",time:new Date(d).toISOString()}],inputs:{messages:n},execution_order:u,child_runs:[],child_execution_order:u,run_type:"llm",extra:h??{},tags:i||[]};return this._addRunToRunMap(f)}async handleChatModelStart(e,n,r,s,a,i,o,l){var d,h;const u=this.getRunById(r)??this._createRunForChatModelStart(e,n,r,s,a,i,o,l);return await((d=this.onRunCreate)==null?void 0:d.call(this,u)),await((h=this.onLLMStart)==null?void 0:h.call(this,u)),u}async handleLLMEnd(e,n,r,s,a){var o;const i=this.getRunById(n);if(!i||(i==null?void 0:i.run_type)!=="llm")throw new Error("No LLM run to end.");return i.end_time=Date.now(),i.outputs=e,i.events.push({name:"end",time:new Date(i.end_time).toISOString()}),i.extra={...i.extra,...a},await((o=this.onLLMEnd)==null?void 0:o.call(this,i)),await this._endTrace(i),i}async handleLLMError(e,n,r,s,a){var o;const i=this.getRunById(n);if(!i||(i==null?void 0:i.run_type)!=="llm")throw new Error("No LLM run to end.");return i.end_time=Date.now(),i.error=this.stringifyError(e),i.events.push({name:"error",time:new Date(i.end_time).toISOString()}),i.extra={...i.extra,...a},await((o=this.onLLMError)==null?void 0:o.call(this,i)),await this._endTrace(i),i}_createRunForChainStart(e,n,r,s,a,i,o,l){const u=this._getExecutionOrder(s),d=Date.now(),h={id:r,name:l??e.id[e.id.length-1],parent_run_id:s,start_time:d,serialized:e,events:[{name:"start",time:new Date(d).toISOString()}],inputs:n,execution_order:u,child_execution_order:u,run_type:o??"chain",child_runs:[],extra:i?{metadata:i}:{},tags:a||[]};return this._addRunToRunMap(h)}async handleChainStart(e,n,r,s,a,i,o,l){var d,h;const u=this.getRunById(r)??this._createRunForChainStart(e,n,r,s,a,i,o,l);return await((d=this.onRunCreate)==null?void 0:d.call(this,u)),await((h=this.onChainStart)==null?void 0:h.call(this,u)),u}async handleChainEnd(e,n,r,s,a){var o;const i=this.getRunById(n);if(!i)throw new Error("No chain run to end.");return i.end_time=Date.now(),i.outputs=nf(e,"output"),i.events.push({name:"end",time:new Date(i.end_time).toISOString()}),(a==null?void 0:a.inputs)!==void 0&&(i.inputs=nf(a.inputs,"input")),await((o=this.onChainEnd)==null?void 0:o.call(this,i)),await this._endTrace(i),i}async handleChainError(e,n,r,s,a){var o;const i=this.getRunById(n);if(!i)throw new Error("No chain run to end.");return i.end_time=Date.now(),i.error=this.stringifyError(e),i.events.push({name:"error",time:new Date(i.end_time).toISOString()}),(a==null?void 0:a.inputs)!==void 0&&(i.inputs=nf(a.inputs,"input")),await((o=this.onChainError)==null?void 0:o.call(this,i)),await this._endTrace(i),i}_createRunForToolStart(e,n,r,s,a,i,o){const l=this._getExecutionOrder(s),u=Date.now(),d={id:r,name:o??e.id[e.id.length-1],parent_run_id:s,start_time:u,serialized:e,events:[{name:"start",time:new Date(u).toISOString()}],inputs:{input:n},execution_order:l,child_execution_order:l,run_type:"tool",child_runs:[],extra:i?{metadata:i}:{},tags:a||[]};return this._addRunToRunMap(d)}async handleToolStart(e,n,r,s,a,i,o){var u,d;const l=this.getRunById(r)??this._createRunForToolStart(e,n,r,s,a,i,o);return await((u=this.onRunCreate)==null?void 0:u.call(this,l)),await((d=this.onToolStart)==null?void 0:d.call(this,l)),l}async handleToolEnd(e,n){var s;const r=this.getRunById(n);if(!r||(r==null?void 0:r.run_type)!=="tool")throw new Error("No tool run to end");return r.end_time=Date.now(),r.outputs={output:e},r.events.push({name:"end",time:new Date(r.end_time).toISOString()}),await((s=this.onToolEnd)==null?void 0:s.call(this,r)),await this._endTrace(r),r}async handleToolError(e,n){var s;const r=this.getRunById(n);if(!r||(r==null?void 0:r.run_type)!=="tool")throw new Error("No tool run to end");return r.end_time=Date.now(),r.error=this.stringifyError(e),r.events.push({name:"error",time:new Date(r.end_time).toISOString()}),await((s=this.onToolError)==null?void 0:s.call(this,r)),await this._endTrace(r),r}async handleAgentAction(e,n){var a;const r=this.getRunById(n);if(!r||(r==null?void 0:r.run_type)!=="chain")return;const s=r;s.actions=s.actions||[],s.actions.push(e),s.events.push({name:"agent_action",time:new Date().toISOString(),kwargs:{action:e}}),await((a=this.onAgentAction)==null?void 0:a.call(this,r))}async handleAgentEnd(e,n){var s;const r=this.getRunById(n);!r||(r==null?void 0:r.run_type)!=="chain"||(r.events.push({name:"agent_end",time:new Date().toISOString(),kwargs:{action:e}}),await((s=this.onAgentEnd)==null?void 0:s.call(this,r)))}_createRunForRetrieverStart(e,n,r,s,a,i,o){const l=this._getExecutionOrder(s),u=Date.now(),d={id:r,name:o??e.id[e.id.length-1],parent_run_id:s,start_time:u,serialized:e,events:[{name:"start",time:new Date(u).toISOString()}],inputs:{query:n},execution_order:l,child_execution_order:l,run_type:"retriever",child_runs:[],extra:i?{metadata:i}:{},tags:a||[]};return this._addRunToRunMap(d)}async handleRetrieverStart(e,n,r,s,a,i,o){var u,d;const l=this.getRunById(r)??this._createRunForRetrieverStart(e,n,r,s,a,i,o);return await((u=this.onRunCreate)==null?void 0:u.call(this,l)),await((d=this.onRetrieverStart)==null?void 0:d.call(this,l)),l}async handleRetrieverEnd(e,n){var s;const r=this.getRunById(n);if(!r||(r==null?void 0:r.run_type)!=="retriever")throw new Error("No retriever run to end");return r.end_time=Date.now(),r.outputs={documents:e},r.events.push({name:"end",time:new Date(r.end_time).toISOString()}),await((s=this.onRetrieverEnd)==null?void 0:s.call(this,r)),await this._endTrace(r),r}async handleRetrieverError(e,n){var s;const r=this.getRunById(n);if(!r||(r==null?void 0:r.run_type)!=="retriever")throw new Error("No retriever run to end");return r.end_time=Date.now(),r.error=this.stringifyError(e),r.events.push({name:"error",time:new Date(r.end_time).toISOString()}),await((s=this.onRetrieverError)==null?void 0:s.call(this,r)),await this._endTrace(r),r}async handleText(e,n){var s;const r=this.getRunById(n);!r||(r==null?void 0:r.run_type)!=="chain"||(r.events.push({name:"text",time:new Date().toISOString(),kwargs:{text:e}}),await((s=this.onText)==null?void 0:s.call(this,r)))}async handleLLMNewToken(e,n,r,s,a,i){var l;const o=this.getRunById(r);if(!o||(o==null?void 0:o.run_type)!=="llm")throw new Error('Invalid "runId" provided to "handleLLMNewToken" callback.');return o.events.push({name:"new_token",time:new Date().toISOString(),kwargs:{token:e,idx:n,chunk:i==null?void 0:i.chunk}}),await((l=this.onLLMNewToken)==null?void 0:l.call(this,o,e,{chunk:i==null?void 0:i.chunk})),o}},Zg={exports:{}};Zg.exports;(function(t){const n=(a=0)=>i=>`\x1B[${38+a};5;${i}m`,r=(a=0)=>(i,o,l)=>`\x1B[${38+a};2;${i};${o};${l}m`;function s(){const a=new Map,i={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};i.color.gray=i.color.blackBright,i.bgColor.bgGray=i.bgColor.bgBlackBright,i.color.grey=i.color.blackBright,i.bgColor.bgGrey=i.bgColor.bgBlackBright;for(const[o,l]of Object.entries(i)){for(const[u,d]of Object.entries(l))i[u]={open:`\x1B[${d[0]}m`,close:`\x1B[${d[1]}m`},l[u]=i[u],a.set(d[0],d[1]);Object.defineProperty(i,o,{value:l,enumerable:!1})}return Object.defineProperty(i,"codes",{value:a,enumerable:!1}),i.color.close="\x1B[39m",i.bgColor.close="\x1B[49m",i.color.ansi256=n(),i.color.ansi16m=r(),i.bgColor.ansi256=n(10),i.bgColor.ansi16m=r(10),Object.defineProperties(i,{rgbToAnsi256:{value:(o,l,u)=>o===l&&l===u?o<8?16:o>248?231:Math.round((o-8)/247*24)+232:16+36*Math.round(o/255*5)+6*Math.round(l/255*5)+Math.round(u/255*5),enumerable:!1},hexToRgb:{value:o=>{const l=/(?<colorString>[a-f\d]{6}|[a-f\d]{3})/i.exec(o.toString(16));if(!l)return[0,0,0];let{colorString:u}=l.groups;u.length===3&&(u=u.split("").map(h=>h+h).join(""));const d=Number.parseInt(u,16);return[d>>16&255,d>>8&255,d&255]},enumerable:!1},hexToAnsi256:{value:o=>i.rgbToAnsi256(...i.hexToRgb(o)),enumerable:!1}}),i}Object.defineProperty(t,"exports",{enumerable:!0,get:s})})(Zg);var w$=Zg.exports;const _k=yw(w$);var x$={};je(x$,{ConsoleCallbackHandler:()=>jm});function Gt(t,e){return`${t.open}${e}${t.close}`}function In(t,e){try{return JSON.stringify(t,null,2)}catch{return e}}function k_(t){return typeof t=="string"?t.trim():t==null?t:In(t,t.toString())}function ds(t){if(!t.end_time)return"";const e=t.end_time-t.start_time;return e<1e3?`${e}ms`:`${(e/1e3).toFixed(2)}s`}const{color:Xt}=_k;var jm=class extends Ei{constructor(){super(...arguments);k(this,"name","console_callback_handler")}persistRun(e){return Promise.resolve()}getParents(e){const n=[];let r=e;for(;r.parent_run_id;){const s=this.runMap.get(r.parent_run_id);if(s)n.push(s),r=s;else break}return n}getBreadcrumbs(e){const r=[...this.getParents(e).reverse(),e].map((s,a,i)=>{const o=`${s.execution_order}:${s.run_type}:${s.name}`;return a===i.length-1?Gt(_k.bold,o):o}).join(" > ");return Gt(Xt.grey,r)}onChainStart(e){const n=this.getBreadcrumbs(e);console.log(`${Gt(Xt.green,"[chain/start]")} [${n}] Entering Chain run with input: ${In(e.inputs,"[inputs]")}`)}onChainEnd(e){const n=this.getBreadcrumbs(e);console.log(`${Gt(Xt.cyan,"[chain/end]")} [${n}] [${ds(e)}] Exiting Chain run with output: ${In(e.outputs,"[outputs]")}`)}onChainError(e){const n=this.getBreadcrumbs(e);console.log(`${Gt(Xt.red,"[chain/error]")} [${n}] [${ds(e)}] Chain run errored with error: ${In(e.error,"[error]")}`)}onLLMStart(e){const n=this.getBreadcrumbs(e),r="prompts"in e.inputs?{prompts:e.inputs.prompts.map(s=>s.trim())}:e.inputs;console.log(`${Gt(Xt.green,"[llm/start]")} [${n}] Entering LLM run with input: ${In(r,"[inputs]")}`)}onLLMEnd(e){const n=this.getBreadcrumbs(e);console.log(`${Gt(Xt.cyan,"[llm/end]")} [${n}] [${ds(e)}] Exiting LLM run with output: ${In(e.outputs,"[response]")}`)}onLLMError(e){const n=this.getBreadcrumbs(e);console.log(`${Gt(Xt.red,"[llm/error]")} [${n}] [${ds(e)}] LLM run errored with error: ${In(e.error,"[error]")}`)}onToolStart(e){const n=this.getBreadcrumbs(e);console.log(`${Gt(Xt.green,"[tool/start]")} [${n}] Entering Tool run with input: "${k_(e.inputs.input)}"`)}onToolEnd(e){var r;const n=this.getBreadcrumbs(e);console.log(`${Gt(Xt.cyan,"[tool/end]")} [${n}] [${ds(e)}] Exiting Tool run with output: "${k_((r=e.outputs)==null?void 0:r.output)}"`)}onToolError(e){const n=this.getBreadcrumbs(e);console.log(`${Gt(Xt.red,"[tool/error]")} [${n}] [${ds(e)}] Tool run errored with error: ${In(e.error,"[error]")}`)}onRetrieverStart(e){const n=this.getBreadcrumbs(e);console.log(`${Gt(Xt.green,"[retriever/start]")} [${n}] Entering Retriever run with input: ${In(e.inputs,"[inputs]")}`)}onRetrieverEnd(e){const n=this.getBreadcrumbs(e);console.log(`${Gt(Xt.cyan,"[retriever/end]")} [${n}] [${ds(e)}] Exiting Retriever run with output: ${In(e.outputs,"[outputs]")}`)}onRetrieverError(e){const n=this.getBreadcrumbs(e);console.log(`${Gt(Xt.red,"[retriever/error]")} [${n}] [${ds(e)}] Retriever run errored with error: ${In(e.error,"[error]")}`)}onAgentAction(e){const n=e,r=this.getBreadcrumbs(e);console.log(`${Gt(Xt.blue,"[agent/action]")} [${r}] Agent selected action: ${In(n.actions[n.actions.length-1],"[action]")}`)}};let rf;const wk=()=>{if(rf===void 0){const t=Nr("LANGCHAIN_CALLBACKS_BACKGROUND")==="false"?{blockOnRootRunFinalization:!0}:{};rf=new nl(t)}return rf};let b$=class{getStore(){}run(e,n){return n()}};const sf=Symbol.for("ls:tracing_async_local_storage"),S$=new b$;let k$=class{getInstance(){return globalThis[sf]??S$}initializeGlobalInstance(e){globalThis[sf]===void 0&&(globalThis[sf]=e)}};const E$=new k$;function N$(t=!1){const e=E$.getInstance().getStore();if(!t&&e===void 0)throw new Error(`Could not get the current run tree.

Please make sure you are calling this method within a traceable function and that tracing is enabled.`);return e}function Kg(t){return typeof t=="function"&&"langsmith:traceable"in t}var T$={};je(T$,{LangChainTracer:()=>Wc});var Wc=class xk extends Ei{constructor(n={}){super(n);k(this,"name","langchain_tracer");k(this,"projectName");k(this,"exampleId");k(this,"client");k(this,"replicas");k(this,"usesRunTreeMap",!0);const{exampleId:r,projectName:s,client:a,replicas:i}=n;this.projectName=s??qS(),this.replicas=i,this.exampleId=r,this.client=a??wk();const o=xk.getTraceableRunTree();o&&this.updateFromRunTree(o)}async persistRun(n){}async onRunCreate(n){const r=this.getRunTreeWithTracingConfig(n.id);await(r==null?void 0:r.postRun())}async onRunUpdate(n){const r=this.getRunTreeWithTracingConfig(n.id);await(r==null?void 0:r.patchRun())}getRun(n){return this.runTreeMap.get(n)}updateFromRunTree(n){this.runTreeMap.set(n.id,n);let r=n;const s=new Set;for(;r.parent_run&&!(s.has(r.id)||(s.add(r.id),!r.parent_run));)r=r.parent_run;s.clear();const a=[r];for(;a.length>0;){const i=a.shift();!i||s.has(i.id)||(s.add(i.id),this.runTreeMap.set(i.id,i),i.child_runs&&a.push(...i.child_runs))}this.client=n.client??this.client,this.replicas=n.replicas??this.replicas,this.projectName=n.project_name??this.projectName,this.exampleId=n.reference_example_id??this.exampleId}getRunTreeWithTracingConfig(n){const r=this.runTreeMap.get(n);if(r)return new en({...r,client:this.client,project_name:this.projectName,replicas:this.replicas,reference_example_id:this.exampleId,tracingEnabled:!0})}static getTraceableRunTree(){try{return N$(!0)}catch{return}}};let la;function A$(){const t="default"in Hr?Hr.default:Hr;return new t({autoStart:!0,concurrency:1})}function C$(){return typeof la>"u"&&(la=A$()),la}async function ht(t,e){if(e===!0){const n=tl();n!==void 0?await n.run(void 0,async()=>t()):await t()}else la=C$(),la.add(async()=>{const n=tl();n!==void 0?await n.run(void 0,async()=>t()):await t()})}async function I$(){const t=wk();await Promise.allSettled([typeof la<"u"?la.onIdle():Promise.resolve(),t.awaitPendingTraceBatches()])}var j$={};je(j$,{awaitAllCallbacks:()=>I$,consumeCallback:()=>ht});const R$=t=>!!["LANGSMITH_TRACING_V2","LANGCHAIN_TRACING_V2","LANGSMITH_TRACING","LANGCHAIN_TRACING"].find(n=>Nr(n)==="true");function bk(t){var r;const e=tl();if(e===void 0)return;const n=e.getStore();return(r=n==null?void 0:n[Co])==null?void 0:r[t]}const O$=Symbol("lc:configure_hooks"),P$=()=>bk(O$)||[];var $$={};je($$,{BaseCallbackManager:()=>Sk,BaseRunManager:()=>El,CallbackManager:()=>dn,CallbackManagerForChainRun:()=>Ek,CallbackManagerForLLMRun:()=>Rm,CallbackManagerForRetrieverRun:()=>kk,CallbackManagerForToolRun:()=>Nk,ensureHandler:()=>rl,parseCallbackConfigArg:()=>Od});function Od(t){return t?Array.isArray(t)||"name"in t?{callbacks:t}:t:{}}var Sk=class{setHandler(t){return this.setHandlers([t])}},El=class{constructor(t,e,n,r,s,a,i,o){this.runId=t,this.handlers=e,this.inheritableHandlers=n,this.tags=r,this.inheritableTags=s,this.metadata=a,this.inheritableMetadata=i,this._parentRunId=o}get parentRunId(){return this._parentRunId}async handleText(t){await Promise.all(this.handlers.map(e=>ht(async()=>{var n;try{await((n=e.handleText)==null?void 0:n.call(e,t,this.runId,this._parentRunId,this.tags))}catch(r){if((e.raiseError?console.error:console.warn)(`Error in handler ${e.constructor.name}, handleText: ${r}`),e.raiseError)throw r}},e.awaitHandlers)))}async handleCustomEvent(t,e,n,r,s){await Promise.all(this.handlers.map(a=>ht(async()=>{var i;try{await((i=a.handleCustomEvent)==null?void 0:i.call(a,t,e,this.runId,this.tags,this.metadata))}catch(o){if((a.raiseError?console.error:console.warn)(`Error in handler ${a.constructor.name}, handleCustomEvent: ${o}`),a.raiseError)throw o}},a.awaitHandlers)))}},kk=class extends El{getChild(t){const e=new dn(this.runId);return e.setHandlers(this.inheritableHandlers),e.addTags(this.inheritableTags),e.addMetadata(this.inheritableMetadata),t&&e.addTags([t],!1),e}async handleRetrieverEnd(t){await Promise.all(this.handlers.map(e=>ht(async()=>{var n;if(!e.ignoreRetriever)try{await((n=e.handleRetrieverEnd)==null?void 0:n.call(e,t,this.runId,this._parentRunId,this.tags))}catch(r){if((e.raiseError?console.error:console.warn)(`Error in handler ${e.constructor.name}, handleRetriever`),e.raiseError)throw r}},e.awaitHandlers)))}async handleRetrieverError(t){await Promise.all(this.handlers.map(e=>ht(async()=>{var n;if(!e.ignoreRetriever)try{await((n=e.handleRetrieverError)==null?void 0:n.call(e,t,this.runId,this._parentRunId,this.tags))}catch(r){if((e.raiseError?console.error:console.warn)(`Error in handler ${e.constructor.name}, handleRetrieverError: ${r}`),e.raiseError)throw t}},e.awaitHandlers)))}},Rm=class extends El{async handleLLMNewToken(t,e,n,r,s,a){await Promise.all(this.handlers.map(i=>ht(async()=>{var o;if(!i.ignoreLLM)try{await((o=i.handleLLMNewToken)==null?void 0:o.call(i,t,e??{prompt:0,completion:0},this.runId,this._parentRunId,this.tags,a))}catch(l){if((i.raiseError?console.error:console.warn)(`Error in handler ${i.constructor.name}, handleLLMNewToken: ${l}`),i.raiseError)throw l}},i.awaitHandlers)))}async handleLLMError(t,e,n,r,s){await Promise.all(this.handlers.map(a=>ht(async()=>{var i;if(!a.ignoreLLM)try{await((i=a.handleLLMError)==null?void 0:i.call(a,t,this.runId,this._parentRunId,this.tags,s))}catch(o){if((a.raiseError?console.error:console.warn)(`Error in handler ${a.constructor.name}, handleLLMError: ${o}`),a.raiseError)throw o}},a.awaitHandlers)))}async handleLLMEnd(t,e,n,r,s){await Promise.all(this.handlers.map(a=>ht(async()=>{var i;if(!a.ignoreLLM)try{await((i=a.handleLLMEnd)==null?void 0:i.call(a,t,this.runId,this._parentRunId,this.tags,s))}catch(o){if((a.raiseError?console.error:console.warn)(`Error in handler ${a.constructor.name}, handleLLMEnd: ${o}`),a.raiseError)throw o}},a.awaitHandlers)))}},Ek=class extends El{getChild(t){const e=new dn(this.runId);return e.setHandlers(this.inheritableHandlers),e.addTags(this.inheritableTags),e.addMetadata(this.inheritableMetadata),t&&e.addTags([t],!1),e}async handleChainError(t,e,n,r,s){await Promise.all(this.handlers.map(a=>ht(async()=>{var i;if(!a.ignoreChain)try{await((i=a.handleChainError)==null?void 0:i.call(a,t,this.runId,this._parentRunId,this.tags,s))}catch(o){if((a.raiseError?console.error:console.warn)(`Error in handler ${a.constructor.name}, handleChainError: ${o}`),a.raiseError)throw o}},a.awaitHandlers)))}async handleChainEnd(t,e,n,r,s){await Promise.all(this.handlers.map(a=>ht(async()=>{var i;if(!a.ignoreChain)try{await((i=a.handleChainEnd)==null?void 0:i.call(a,t,this.runId,this._parentRunId,this.tags,s))}catch(o){if((a.raiseError?console.error:console.warn)(`Error in handler ${a.constructor.name}, handleChainEnd: ${o}`),a.raiseError)throw o}},a.awaitHandlers)))}async handleAgentAction(t){await Promise.all(this.handlers.map(e=>ht(async()=>{var n;if(!e.ignoreAgent)try{await((n=e.handleAgentAction)==null?void 0:n.call(e,t,this.runId,this._parentRunId,this.tags))}catch(r){if((e.raiseError?console.error:console.warn)(`Error in handler ${e.constructor.name}, handleAgentAction: ${r}`),e.raiseError)throw r}},e.awaitHandlers)))}async handleAgentEnd(t){await Promise.all(this.handlers.map(e=>ht(async()=>{var n;if(!e.ignoreAgent)try{await((n=e.handleAgentEnd)==null?void 0:n.call(e,t,this.runId,this._parentRunId,this.tags))}catch(r){if((e.raiseError?console.error:console.warn)(`Error in handler ${e.constructor.name}, handleAgentEnd: ${r}`),e.raiseError)throw r}},e.awaitHandlers)))}},Nk=class extends El{getChild(t){const e=new dn(this.runId);return e.setHandlers(this.inheritableHandlers),e.addTags(this.inheritableTags),e.addMetadata(this.inheritableMetadata),t&&e.addTags([t],!1),e}async handleToolError(t){await Promise.all(this.handlers.map(e=>ht(async()=>{var n;if(!e.ignoreAgent)try{await((n=e.handleToolError)==null?void 0:n.call(e,t,this.runId,this._parentRunId,this.tags))}catch(r){if((e.raiseError?console.error:console.warn)(`Error in handler ${e.constructor.name}, handleToolError: ${r}`),e.raiseError)throw r}},e.awaitHandlers)))}async handleToolEnd(t){await Promise.all(this.handlers.map(e=>ht(async()=>{var n;if(!e.ignoreAgent)try{await((n=e.handleToolEnd)==null?void 0:n.call(e,t,this.runId,this._parentRunId,this.tags))}catch(r){if((e.raiseError?console.error:console.warn)(`Error in handler ${e.constructor.name}, handleToolEnd: ${r}`),e.raiseError)throw r}},e.awaitHandlers)))}},dn=class oo extends Sk{constructor(n,r){super();k(this,"handlers",[]);k(this,"inheritableHandlers",[]);k(this,"tags",[]);k(this,"inheritableTags",[]);k(this,"metadata",{});k(this,"inheritableMetadata",{});k(this,"name","callback_manager");k(this,"_parentRunId");this.handlers=(r==null?void 0:r.handlers)??this.handlers,this.inheritableHandlers=(r==null?void 0:r.inheritableHandlers)??this.inheritableHandlers,this.tags=(r==null?void 0:r.tags)??this.tags,this.inheritableTags=(r==null?void 0:r.inheritableTags)??this.inheritableTags,this.metadata=(r==null?void 0:r.metadata)??this.metadata,this.inheritableMetadata=(r==null?void 0:r.inheritableMetadata)??this.inheritableMetadata,this._parentRunId=n}getParentRunId(){return this._parentRunId}async handleLLMStart(n,r,s=void 0,a=void 0,i=void 0,o=void 0,l=void 0,u=void 0){return Promise.all(r.map(async(d,h)=>{const f=h===0&&s?s:rn();return await Promise.all(this.handlers.map(m=>{if(!m.ignoreLLM)return Ra(m)&&m._createRunForLLMStart(n,[d],f,this._parentRunId,i,this.tags,this.metadata,u),ht(async()=>{var v;try{await((v=m.handleLLMStart)==null?void 0:v.call(m,n,[d],f,this._parentRunId,i,this.tags,this.metadata,u))}catch(w){if((m.raiseError?console.error:console.warn)(`Error in handler ${m.constructor.name}, handleLLMStart: ${w}`),m.raiseError)throw w}},m.awaitHandlers)})),new Rm(f,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChatModelStart(n,r,s=void 0,a=void 0,i=void 0,o=void 0,l=void 0,u=void 0){return Promise.all(r.map(async(d,h)=>{const f=h===0&&s?s:rn();return await Promise.all(this.handlers.map(m=>{if(!m.ignoreLLM)return Ra(m)&&m._createRunForChatModelStart(n,[d],f,this._parentRunId,i,this.tags,this.metadata,u),ht(async()=>{var v,w;try{if(m.handleChatModelStart)await((v=m.handleChatModelStart)==null?void 0:v.call(m,n,[d],f,this._parentRunId,i,this.tags,this.metadata,u));else if(m.handleLLMStart){const _=Rg(d);await((w=m.handleLLMStart)==null?void 0:w.call(m,n,[_],f,this._parentRunId,i,this.tags,this.metadata,u))}}catch(_){if((m.raiseError?console.error:console.warn)(`Error in handler ${m.constructor.name}, handleLLMStart: ${_}`),m.raiseError)throw _}},m.awaitHandlers)})),new Rm(f,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChainStart(n,r,s=rn(),a=void 0,i=void 0,o=void 0,l=void 0){return await Promise.all(this.handlers.map(u=>{if(!u.ignoreChain)return Ra(u)&&u._createRunForChainStart(n,r,s,this._parentRunId,this.tags,this.metadata,a,l),ht(async()=>{var d;try{await((d=u.handleChainStart)==null?void 0:d.call(u,n,r,s,this._parentRunId,this.tags,this.metadata,a,l))}catch(h){if((u.raiseError?console.error:console.warn)(`Error in handler ${u.constructor.name}, handleChainStart: ${h}`),u.raiseError)throw h}},u.awaitHandlers)})),new Ek(s,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleToolStart(n,r,s=rn(),a=void 0,i=void 0,o=void 0,l=void 0){return await Promise.all(this.handlers.map(u=>{if(!u.ignoreAgent)return Ra(u)&&u._createRunForToolStart(n,r,s,this._parentRunId,this.tags,this.metadata,l),ht(async()=>{var d;try{await((d=u.handleToolStart)==null?void 0:d.call(u,n,r,s,this._parentRunId,this.tags,this.metadata,l))}catch(h){if((u.raiseError?console.error:console.warn)(`Error in handler ${u.constructor.name}, handleToolStart: ${h}`),u.raiseError)throw h}},u.awaitHandlers)})),new Nk(s,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleRetrieverStart(n,r,s=rn(),a=void 0,i=void 0,o=void 0,l=void 0){return await Promise.all(this.handlers.map(u=>{if(!u.ignoreRetriever)return Ra(u)&&u._createRunForRetrieverStart(n,r,s,this._parentRunId,this.tags,this.metadata,l),ht(async()=>{var d;try{await((d=u.handleRetrieverStart)==null?void 0:d.call(u,n,r,s,this._parentRunId,this.tags,this.metadata,l))}catch(h){if((u.raiseError?console.error:console.warn)(`Error in handler ${u.constructor.name}, handleRetrieverStart: ${h}`),u.raiseError)throw h}},u.awaitHandlers)})),new kk(s,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleCustomEvent(n,r,s,a,i){await Promise.all(this.handlers.map(o=>ht(async()=>{var l;if(!o.ignoreCustomEvent)try{await((l=o.handleCustomEvent)==null?void 0:l.call(o,n,r,s,this.tags,this.metadata))}catch(u){if((o.raiseError?console.error:console.warn)(`Error in handler ${o.constructor.name}, handleCustomEvent: ${u}`),o.raiseError)throw u}},o.awaitHandlers)))}addHandler(n,r=!0){this.handlers.push(n),r&&this.inheritableHandlers.push(n)}removeHandler(n){this.handlers=this.handlers.filter(r=>r!==n),this.inheritableHandlers=this.inheritableHandlers.filter(r=>r!==n)}setHandlers(n,r=!0){this.handlers=[],this.inheritableHandlers=[];for(const s of n)this.addHandler(s,r)}addTags(n,r=!0){this.removeTags(n),this.tags.push(...n),r&&this.inheritableTags.push(...n)}removeTags(n){this.tags=this.tags.filter(r=>!n.includes(r)),this.inheritableTags=this.inheritableTags.filter(r=>!n.includes(r))}addMetadata(n,r=!0){this.metadata={...this.metadata,...n},r&&(this.inheritableMetadata={...this.inheritableMetadata,...n})}removeMetadata(n){for(const r of Object.keys(n))delete this.metadata[r],delete this.inheritableMetadata[r]}copy(n=[],r=!0){const s=new oo(this._parentRunId);for(const a of this.handlers){const i=this.inheritableHandlers.includes(a);s.addHandler(a,i)}for(const a of this.tags){const i=this.inheritableTags.includes(a);s.addTags([a],i)}for(const a of Object.keys(this.metadata)){const i=Object.keys(this.inheritableMetadata).includes(a);s.addMetadata({[a]:this.metadata[a]},i)}for(const a of n)s.handlers.filter(i=>i.name==="console_callback_handler").some(i=>i.name===a.name)||s.addHandler(a,r);return s}static fromHandlers(n){class r extends Sl{constructor(){super();k(this,"name",rn());Object.assign(this,n)}}const s=new this;return s.addHandler(new r),s}static configure(n,r,s,a,i,o,l){return this._configureSync(n,r,s,a,i,o,l)}static _configureSync(n,r,s,a,i,o,l){var m;let u;(n||r)&&(Array.isArray(n)||!n?(u=new oo,u.setHandlers((n==null?void 0:n.map(rl))??[],!0)):u=n,u=u.copy(Array.isArray(r)?r.map(rl):r==null?void 0:r.handlers,!1));const d=Nr("LANGCHAIN_VERBOSE")==="true"||(l==null?void 0:l.verbose),h=((m=Wc.getTraceableRunTree())==null?void 0:m.tracingEnabled)||R$(),f=h||(Nr("LANGCHAIN_TRACING")??!1);if(d||f){if(u||(u=new oo),d&&!u.handlers.some(v=>v.name===jm.prototype.name)){const v=new jm;u.addHandler(v,!0)}if(f&&!u.handlers.some(v=>v.name==="langchain_tracer")&&h){const v=new Wc;u.addHandler(v,!0)}if(h){const v=Wc.getTraceableRunTree();if(v&&u._parentRunId===void 0){u._parentRunId=v.id;const w=u.handlers.find(_=>_.name==="langchain_tracer");w==null||w.updateFromRunTree(v)}}}for(const{contextVar:v,inheritable:w=!0,handlerClass:_,envVar:y}of P$()){const p=y&&Nr(y)==="true"&&_;let g;const S=v!==void 0?bk(v):void 0;S&&WS(S)?g=S:p&&(g=new _({})),g!==void 0&&(u||(u=new oo),u.handlers.some(N=>N.name===g.name)||u.addHandler(g,w))}return(s||a)&&u&&(u.addTags(s??[]),u.addTags(a??[],!1)),(i||o)&&u&&(u.addMetadata(i??{}),u.addMetadata(o??{},!1)),u}};function rl(t){return"name"in t?t:Sl.fromMethods(t)}var Tk=class{getStore(){}run(t,e){return e()}enterWith(t){}};const L$=new Tk,E_=Symbol.for("lc:child_config");var D$=class{getInstance(){return tl()??L$}getRunnableConfig(){var e,n;return(n=(e=this.getInstance().getStore())==null?void 0:e.extra)==null?void 0:n[E_]}runWithConfig(t,e,n){var u;const r=dn._configureSync(t==null?void 0:t.callbacks,void 0,t==null?void 0:t.tags,void 0,t==null?void 0:t.metadata),s=this.getInstance(),a=s.getStore(),i=r==null?void 0:r.getParentRunId(),o=(u=r==null?void 0:r.handlers)==null?void 0:u.find(d=>(d==null?void 0:d.name)==="langchain_tracer");let l;return o&&i?l=o.getRunTreeWithTracingConfig(i):n||(l=new en({name:"<runnable_lambda>",tracingEnabled:!1})),l&&(l.extra={...l.extra,[E_]:t}),a!==void 0&&a[Co]!==void 0&&(l===void 0&&(l={}),l[Co]=a[Co]),s.run(l,e)}initializeGlobalInstance(t){tl()===void 0&&k2(t)}};const rr=new D$;var M$={};je(M$,{AsyncLocalStorageProviderSingleton:()=>rr,MockAsyncLocalStorage:()=>Tk,_CONTEXT_VARIABLES_KEY:()=>Co});const af=25;async function xn(t){return dn._configureSync(t==null?void 0:t.callbacks,void 0,t==null?void 0:t.tags,void 0,t==null?void 0:t.metadata)}function ju(...t){const e={};for(const n of t.filter(r=>!!r))for(const r of Object.keys(n))if(r==="metadata")e[r]={...e[r],...n[r]};else if(r==="tags"){const s=e[r]??[];e[r]=[...new Set(s.concat(n[r]??[]))]}else if(r==="configurable")e[r]={...e[r],...n[r]};else if(r==="timeout")e.timeout===void 0?e.timeout=n.timeout:n.timeout!==void 0&&(e.timeout=Math.min(e.timeout,n.timeout));else if(r==="signal")e.signal===void 0?e.signal=n.signal:n.signal!==void 0&&("any"in AbortSignal?e.signal=AbortSignal.any([e.signal,n.signal]):e.signal=n.signal);else if(r==="callbacks"){const s=e.callbacks,a=n.callbacks;if(Array.isArray(a))if(!s)e.callbacks=a;else if(Array.isArray(s))e.callbacks=s.concat(a);else{const i=s.copy();for(const o of a)i.addHandler(rl(o),!0);e.callbacks=i}else if(a)if(!s)e.callbacks=a;else if(Array.isArray(s)){const i=a.copy();for(const o of s)i.addHandler(rl(o),!0);e.callbacks=i}else e.callbacks=new dn(a._parentRunId,{handlers:s.handlers.concat(a.handlers),inheritableHandlers:s.inheritableHandlers.concat(a.inheritableHandlers),tags:Array.from(new Set(s.tags.concat(a.tags))),inheritableTags:Array.from(new Set(s.inheritableTags.concat(a.inheritableTags))),metadata:{...s.metadata,...a.metadata}})}else{const s=r;e[s]=n[s]??e[s]}return e}const F$=new Set(["string","number","boolean"]);function $e(t){var r;const e=rr.getRunnableConfig();let n={tags:[],metadata:{},recursionLimit:25,runId:void 0};if(e){const{runId:s,runName:a,...i}=e;n=Object.entries(i).reduce((o,[l,u])=>(u!==void 0&&(o[l]=u),o),n)}if(t&&(n=Object.entries(t).reduce((s,[a,i])=>(i!==void 0&&(s[a]=i),s),n)),n!=null&&n.configurable)for(const s of Object.keys(n.configurable))F$.has(typeof n.configurable[s])&&!((r=n.metadata)!=null&&r[s])&&(n.metadata||(n.metadata={}),n.metadata[s]=n.configurable[s]);if(n.timeout!==void 0){if(n.timeout<=0)throw new Error("Timeout must be a positive number");const s=AbortSignal.timeout(n.timeout);n.signal!==void 0?"any"in AbortSignal&&(n.signal=AbortSignal.any([n.signal,s])):n.signal=s,delete n.timeout}return n}function Je(t={},{callbacks:e,maxConcurrency:n,recursionLimit:r,runName:s,configurable:a,runId:i}={}){const o=$e(t);return e!==void 0&&(delete o.runName,o.callbacks=e),r!==void 0&&(o.recursionLimit=r),n!==void 0&&(o.maxConcurrency=n),s!==void 0&&(o.runName=s),a!==void 0&&(o.configurable={...o.configurable,...a}),i!==void 0&&delete o.runId,o}function Qr(t){if(t)return{configurable:t.configurable,recursionLimit:t.recursionLimit,callbacks:t.callbacks,tags:t.tags,metadata:t.metadata,maxConcurrency:t.maxConcurrency,timeout:t.timeout,signal:t.signal,store:t.store}}async function Xr(t,e){if(e===void 0)return t;let n;return Promise.race([t.catch(r=>{if(!(e!=null&&e.aborted))throw r}),new Promise((r,s)=>{n=()=>{s(sl(e))},e.addEventListener("abort",n),e.aborted&&s(sl(e))})]).finally(()=>e.removeEventListener("abort",n))}function sl(t){return(t==null?void 0:t.reason)instanceof Error?t.reason:typeof(t==null?void 0:t.reason)=="string"?new Error(t.reason):new Error("Aborted")}var z$={};je(z$,{AsyncGeneratorWithSetup:()=>Sa,IterableReadableStream:()=>sr,atee:()=>Jg,concat:()=>Ds,pipeGeneratorWithSetup:()=>Ak});var sr=class Om extends ReadableStream{constructor(){super(...arguments);k(this,"reader")}ensureReader(){this.reader||(this.reader=this.getReader())}async next(){this.ensureReader();try{const n=await this.reader.read();return n.done?(this.reader.releaseLock(),{done:!0,value:void 0}):{done:!1,value:n.value}}catch(n){throw this.reader.releaseLock(),n}}async return(){if(this.ensureReader(),this.locked){const n=this.reader.cancel();this.reader.releaseLock(),await n}return{done:!0,value:void 0}}async throw(n){if(this.ensureReader(),this.locked){const r=this.reader.cancel();this.reader.releaseLock(),await r}throw n}[Symbol.asyncIterator](){return this}async[Symbol.asyncDispose](){await this.return()}static fromReadableStream(n){const r=n.getReader();return new Om({start(s){return a();function a(){return r.read().then(({done:i,value:o})=>{if(i){s.close();return}return s.enqueue(o),a()})}},cancel(){r.releaseLock()}})}static fromAsyncGenerator(n){return new Om({async pull(r){const{value:s,done:a}=await n.next();a&&r.close(),r.enqueue(s)},async cancel(r){await n.return(r)}})}};function Jg(t,e=2){const n=Array.from({length:e},()=>[]);return n.map(async function*(s){for(;;)if(s.length===0){const a=await t.next();for(const i of n)i.push(a)}else{if(s[0].done)return;yield s.shift().value}})}function Ds(t,e){if(Array.isArray(t)&&Array.isArray(e))return t.concat(e);if(typeof t=="string"&&typeof e=="string")return t+e;if(typeof t=="number"&&typeof e=="number")return t+e;if("concat"in t&&typeof t.concat=="function")return t.concat(e);if(typeof t=="object"&&typeof e=="object"){const n={...t};for(const[r,s]of Object.entries(e))r in n&&!Array.isArray(n[r])?n[r]=Ds(n[r],s):n[r]=s;return n}else throw new Error(`Cannot concat ${typeof t} and ${typeof e}`)}var Sa=class{constructor(t){k(this,"generator");k(this,"setup");k(this,"config");k(this,"signal");k(this,"firstResult");k(this,"firstResultUsed",!1);var e;this.generator=t.generator,this.config=t.config,this.signal=t.signal??((e=this.config)==null?void 0:e.signal),this.setup=new Promise((n,r)=>{rr.runWithConfig(Qr(t.config),async()=>{this.firstResult=t.generator.next(),t.startSetup?this.firstResult.then(t.startSetup).then(n,r):this.firstResult.then(s=>n(void 0),r)},!0)})}async next(...t){var e;return(e=this.signal)==null||e.throwIfAborted(),this.firstResultUsed?rr.runWithConfig(Qr(this.config),this.signal?async()=>Xr(this.generator.next(...t),this.signal):async()=>this.generator.next(...t),!0):(this.firstResultUsed=!0,this.firstResult)}async return(t){return this.generator.return(t)}async throw(t){return this.generator.throw(t)}[Symbol.asyncIterator](){return this}async[Symbol.asyncDispose](){await this.return()}};async function Ak(t,e,n,r,...s){const a=new Sa({generator:e,startSetup:n,signal:r}),i=await a.setup;return{output:t(a,i,...s),setup:i}}/*!
* https://github.com/Starcounter-Jack/JSON-Patch
* (c) 2017-2022 Joachim Wester
* MIT licensed
*/const U$=Object.prototype.hasOwnProperty;function Pm(t,e){return U$.call(t,e)}function $m(t){if(Array.isArray(t)){const n=new Array(t.length);for(let r=0;r<n.length;r++)n[r]=""+r;return n}if(Object.keys)return Object.keys(t);let e=[];for(let n in t)Pm(t,n)&&e.push(n);return e}function $n(t){switch(typeof t){case"object":return JSON.parse(JSON.stringify(t));case"undefined":return null;default:return t}}function Lm(t){let e=0;const n=t.length;let r;for(;e<n;){if(r=t.charCodeAt(e),r>=48&&r<=57){e++;continue}return!1}return!0}function Ks(t){return t.indexOf("/")===-1&&t.indexOf("~")===-1?t:t.replace(/~/g,"~0").replace(/\//g,"~1")}function Ck(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}function Dm(t){if(t===void 0)return!0;if(t){if(Array.isArray(t)){for(let n=0,r=t.length;n<r;n++)if(Dm(t[n]))return!0}else if(typeof t=="object"){const n=$m(t),r=n.length;for(var e=0;e<r;e++)if(Dm(t[n[e]]))return!0}}return!1}function N_(t,e){const n=[t];for(const r in e){const s=typeof e[r]=="object"?JSON.stringify(e[r],null,2):e[r];typeof s<"u"&&n.push(`${r}: ${s}`)}return n.join(`
`)}var Ik=class extends Error{constructor(t,e,n,r,s){super(N_(t,{name:e,index:n,operation:r,tree:s})),this.name=e,this.index=n,this.operation=r,this.tree=s,Object.setPrototypeOf(this,new.target.prototype),this.message=N_(t,{name:e,index:n,operation:r,tree:s})}},jk={};je(jk,{JsonPatchError:()=>it,_areEquals:()=>al,applyOperation:()=>ca,applyPatch:()=>ui,applyReducer:()=>H$,deepClone:()=>B$,getValueByPointer:()=>Ru,validate:()=>Rk,validator:()=>Ou});const it=Ik,B$=$n,Za={add:function(t,e,n){return t[e]=this.value,{newDocument:n}},remove:function(t,e,n){var r=t[e];return delete t[e],{newDocument:n,removed:r}},replace:function(t,e,n){var r=t[e];return t[e]=this.value,{newDocument:n,removed:r}},move:function(t,e,n){let r=Ru(n,this.path);r&&(r=$n(r));const s=ca(n,{op:"remove",path:this.from}).removed;return ca(n,{op:"add",path:this.path,value:s}),{newDocument:n,removed:r}},copy:function(t,e,n){const r=Ru(n,this.from);return ca(n,{op:"add",path:this.path,value:$n(r)}),{newDocument:n}},test:function(t,e,n){return{newDocument:n,test:al(t[e],this.value)}},_get:function(t,e,n){return this.value=t[e],{newDocument:n}}};var G$={add:function(t,e,n){return Lm(e)?t.splice(e,0,this.value):t[e]=this.value,{newDocument:n,index:e}},remove:function(t,e,n){var r=t.splice(e,1);return{newDocument:n,removed:r[0]}},replace:function(t,e,n){var r=t[e];return t[e]=this.value,{newDocument:n,removed:r}},move:Za.move,copy:Za.copy,test:Za.test,_get:Za._get};function Ru(t,e){if(e=="")return t;var n={op:"_get",path:e};return ca(t,n),n.value}function ca(t,e,n=!1,r=!0,s=!0,a=0){if(n&&(typeof n=="function"?n(e,0,t,e.path):Ou(e,0)),e.path===""){let i={newDocument:t};if(e.op==="add")return i.newDocument=e.value,i;if(e.op==="replace")return i.newDocument=e.value,i.removed=t,i;if(e.op==="move"||e.op==="copy")return i.newDocument=Ru(t,e.from),e.op==="move"&&(i.removed=t),i;if(e.op==="test"){if(i.test=al(t,e.value),i.test===!1)throw new it("Test operation failed","TEST_OPERATION_FAILED",a,e,t);return i.newDocument=t,i}else{if(e.op==="remove")return i.removed=t,i.newDocument=null,i;if(e.op==="_get")return e.value=t,i;if(n)throw new it("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",a,e,t);return i}}else{r||(t=$n(t));const o=(e.path||"").split("/");let l=t,u=1,d=o.length,h,f,m;for(typeof n=="function"?m=n:m=Ou;;){if(f=o[u],f&&f.indexOf("~")!=-1&&(f=Ck(f)),s&&(f=="__proto__"||f=="prototype"&&u>0&&o[u-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&h===void 0&&(l[f]===void 0?h=o.slice(0,u).join("/"):u==d-1&&(h=e.path),h!==void 0&&m(e,0,t,h)),u++,Array.isArray(l)){if(f==="-")f=l.length;else{if(n&&!Lm(f))throw new it("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",a,e,t);Lm(f)&&(f=~~f)}if(u>=d){if(n&&e.op==="add"&&f>l.length)throw new it("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",a,e,t);const v=G$[e.op].call(e,l,f,t);if(v.test===!1)throw new it("Test operation failed","TEST_OPERATION_FAILED",a,e,t);return v}}else if(u>=d){const v=Za[e.op].call(e,l,f,t);if(v.test===!1)throw new it("Test operation failed","TEST_OPERATION_FAILED",a,e,t);return v}if(l=l[f],n&&u<d&&(!l||typeof l!="object"))throw new it("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",a,e,t)}}}function ui(t,e,n,r=!0,s=!0){if(n&&!Array.isArray(e))throw new it("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(t=$n(t));const a=new Array(e.length);for(let i=0,o=e.length;i<o;i++)a[i]=ca(t,e[i],n,!0,s,i),t=a[i].newDocument;return a.newDocument=t,a}function H$(t,e,n){const r=ca(t,e);if(r.test===!1)throw new it("Test operation failed","TEST_OPERATION_FAILED",n,e,t);return r.newDocument}function Ou(t,e,n,r){if(typeof t!="object"||t===null||Array.isArray(t))throw new it("Operation is not an object","OPERATION_NOT_AN_OBJECT",e,t,n);if(Za[t.op]){if(typeof t.path!="string")throw new it("Operation `path` property is not a string","OPERATION_PATH_INVALID",e,t,n);if(t.path.indexOf("/")!==0&&t.path.length>0)throw new it('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",e,t,n);if((t.op==="move"||t.op==="copy")&&typeof t.from!="string")throw new it("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",e,t,n);if((t.op==="add"||t.op==="replace"||t.op==="test")&&t.value===void 0)throw new it("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",e,t,n);if((t.op==="add"||t.op==="replace"||t.op==="test")&&Dm(t.value))throw new it("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",e,t,n);if(n){if(t.op=="add"){var s=t.path.split("/").length,a=r.split("/").length;if(s!==a+1&&s!==a)throw new it("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",e,t,n)}else if(t.op==="replace"||t.op==="remove"||t.op==="_get"){if(t.path!==r)throw new it("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",e,t,n)}else if(t.op==="move"||t.op==="copy"){var i={op:"_get",path:t.from,value:void 0},o=Rk([i],n);if(o&&o.name==="OPERATION_PATH_UNRESOLVABLE")throw new it("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",e,t,n)}}}else throw new it("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",e,t,n)}function Rk(t,e,n){try{if(!Array.isArray(t))throw new it("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(e)ui($n(e),$n(t),n||!0);else{n=n||Ou;for(var r=0;r<t.length;r++)n(t[r],r,e,void 0)}}catch(s){if(s instanceof it)return s;throw s}}function al(t,e){if(t===e)return!0;if(t&&e&&typeof t=="object"&&typeof e=="object"){var n=Array.isArray(t),r=Array.isArray(e),s,a,i;if(n&&r){if(a=t.length,a!=e.length)return!1;for(s=a;s--!==0;)if(!al(t[s],e[s]))return!1;return!0}if(n!=r)return!1;var o=Object.keys(t);if(a=o.length,a!==Object.keys(e).length)return!1;for(s=a;s--!==0;)if(!e.hasOwnProperty(o[s]))return!1;for(s=a;s--!==0;)if(i=o[s],!al(t[i],e[i]))return!1;return!0}return t!==t&&e!==e}function Ok(t,e,n,r,s){if(e!==t){typeof e.toJSON=="function"&&(e=e.toJSON());for(var a=$m(e),i=$m(t),o=!1,l=i.length-1;l>=0;l--){var u=i[l],d=t[u];if(Pm(e,u)&&!(e[u]===void 0&&d!==void 0&&Array.isArray(e)===!1)){var h=e[u];typeof d=="object"&&d!=null&&typeof h=="object"&&h!=null&&Array.isArray(d)===Array.isArray(h)?Ok(d,h,n,r+"/"+Ks(u),s):d!==h&&(s&&n.push({op:"test",path:r+"/"+Ks(u),value:$n(d)}),n.push({op:"replace",path:r+"/"+Ks(u),value:$n(h)}))}else Array.isArray(t)===Array.isArray(e)?(s&&n.push({op:"test",path:r+"/"+Ks(u),value:$n(d)}),n.push({op:"remove",path:r+"/"+Ks(u)}),o=!0):(s&&n.push({op:"test",path:r,value:t}),n.push({op:"replace",path:r,value:e}))}if(!(!o&&a.length==i.length))for(var l=0;l<a.length;l++){var u=a[l];!Pm(t,u)&&e[u]!==void 0&&n.push({op:"add",path:r+"/"+Ks(u),value:$n(e[u])})}}}function Yg(t,e,n=!1){var r=[];return Ok(t,e,r,"",n),r}({...jk});var W$={};je(W$,{LogStreamCallbackHandler:()=>Fm,RunLog:()=>Qg,RunLogPatch:()=>Fr,isLogStreamHandler:()=>Pk});var Fr=class{constructor(t){k(this,"ops");this.ops=t.ops??[]}concat(t){const e=this.ops.concat(t.ops),n=ui({},e);return new Qg({ops:e,state:n[n.length-1].newDocument})}},Qg=class Mm extends Fr{constructor(n){super(n);k(this,"state");this.state=n.state}concat(n){const r=this.ops.concat(n.ops),s=ui(this.state,n.ops);return new Mm({ops:r,state:s[s.length-1].newDocument})}static fromRunLogPatch(n){const r=ui({},n.ops);return new Mm({ops:n.ops,state:r[r.length-1].newDocument})}};const Pk=t=>t.name==="log_stream_tracer";async function T_(t,e){if(e==="original")throw new Error("Do not assign inputs with original schema drop the key for now. When inputs are added to streamLog they should be added with standardized schema for streaming events.");const{inputs:n}=t;if(["retriever","llm","prompt"].includes(t.run_type))return n;if(!(Object.keys(n).length===1&&(n==null?void 0:n.input)===""))return n.input}async function A_(t,e){const{outputs:n}=t;return e==="original"||["retriever","llm","prompt"].includes(t.run_type)?n:n!==void 0&&Object.keys(n).length===1&&(n==null?void 0:n.output)!==void 0?n.output:n}function V$(t){return t!==void 0&&t.message!==void 0}var Fm=class extends Ei{constructor(e){super({_awaitHandler:!0,...e});k(this,"autoClose",!0);k(this,"includeNames");k(this,"includeTypes");k(this,"includeTags");k(this,"excludeNames");k(this,"excludeTypes");k(this,"excludeTags");k(this,"_schemaFormat","original");k(this,"rootId");k(this,"keyMapByRunId",{});k(this,"counterMapByRunName",{});k(this,"transformStream");k(this,"writer");k(this,"receiveStream");k(this,"name","log_stream_tracer");k(this,"lc_prefer_streaming",!0);this.autoClose=(e==null?void 0:e.autoClose)??!0,this.includeNames=e==null?void 0:e.includeNames,this.includeTypes=e==null?void 0:e.includeTypes,this.includeTags=e==null?void 0:e.includeTags,this.excludeNames=e==null?void 0:e.excludeNames,this.excludeTypes=e==null?void 0:e.excludeTypes,this.excludeTags=e==null?void 0:e.excludeTags,this._schemaFormat=(e==null?void 0:e._schemaFormat)??this._schemaFormat,this.transformStream=new TransformStream,this.writer=this.transformStream.writable.getWriter(),this.receiveStream=sr.fromReadableStream(this.transformStream.readable)}[Symbol.asyncIterator](){return this.receiveStream}async persistRun(e){}_includeRun(e){if(e.id===this.rootId)return!1;const n=e.tags??[];let r=this.includeNames===void 0&&this.includeTags===void 0&&this.includeTypes===void 0;return this.includeNames!==void 0&&(r=r||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(r=r||this.includeTypes.includes(e.run_type)),this.includeTags!==void 0&&(r=r||n.find(s=>{var a;return(a=this.includeTags)==null?void 0:a.includes(s)})!==void 0),this.excludeNames!==void 0&&(r=r&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(r=r&&!this.excludeTypes.includes(e.run_type)),this.excludeTags!==void 0&&(r=r&&n.every(s=>{var a;return!((a=this.excludeTags)!=null&&a.includes(s))})),r}async*tapOutputIterable(e,n){for await(const r of n){if(e!==this.rootId){const s=this.keyMapByRunId[e];s&&await this.writer.write(new Fr({ops:[{op:"add",path:`/logs/${s}/streamed_output/-`,value:r}]}))}yield r}}async onRunCreate(e){var s;if(this.rootId===void 0&&(this.rootId=e.id,await this.writer.write(new Fr({ops:[{op:"replace",path:"",value:{id:e.id,name:e.name,type:e.run_type,streamed_output:[],final_output:void 0,logs:{}}}]}))),!this._includeRun(e))return;this.counterMapByRunName[e.name]===void 0&&(this.counterMapByRunName[e.name]=0),this.counterMapByRunName[e.name]+=1;const n=this.counterMapByRunName[e.name];this.keyMapByRunId[e.id]=n===1?e.name:`${e.name}:${n}`;const r={id:e.id,name:e.name,type:e.run_type,tags:e.tags??[],metadata:((s=e.extra)==null?void 0:s.metadata)??{},start_time:new Date(e.start_time).toISOString(),streamed_output:[],streamed_output_str:[],final_output:void 0,end_time:void 0};this._schemaFormat==="streaming_events"&&(r.inputs=await T_(e,this._schemaFormat)),await this.writer.write(new Fr({ops:[{op:"add",path:`/logs/${this.keyMapByRunId[e.id]}`,value:r}]}))}async onRunUpdate(e){try{const n=this.keyMapByRunId[e.id];if(n===void 0)return;const r=[];this._schemaFormat==="streaming_events"&&r.push({op:"replace",path:`/logs/${n}/inputs`,value:await T_(e,this._schemaFormat)}),r.push({op:"add",path:`/logs/${n}/final_output`,value:await A_(e,this._schemaFormat)}),e.end_time!==void 0&&r.push({op:"add",path:`/logs/${n}/end_time`,value:new Date(e.end_time).toISOString()});const s=new Fr({ops:r});await this.writer.write(s)}finally{if(e.id===this.rootId){const n=new Fr({ops:[{op:"replace",path:"/final_output",value:await A_(e,this._schemaFormat)}]});await this.writer.write(n),this.autoClose&&await this.writer.close()}}}async onLLMNewToken(e,n,r){const s=this.keyMapByRunId[e.id];if(s===void 0)return;const a=e.inputs.messages!==void 0;let i;a?V$(r==null?void 0:r.chunk)?i=r==null?void 0:r.chunk:i=new Rr({id:`run-${e.id}`,content:n}):i=n;const o=new Fr({ops:[{op:"add",path:`/logs/${s}/streamed_output_str/-`,value:n},{op:"add",path:`/logs/${s}/streamed_output/-`,value:i}]});await this.writer.write(o)}},q$={};je(q$,{ChatGenerationChunk:()=>hi,GenerationChunk:()=>di,RUN_KEY:()=>il});const il="__run";var di=class $k{constructor(e){k(this,"text");k(this,"generationInfo");this.text=e.text,this.generationInfo=e.generationInfo}concat(e){return new $k({text:this.text+e.text,generationInfo:{...this.generationInfo,...e.generationInfo}})}},hi=class Lk extends di{constructor(n){super(n);k(this,"message");this.message=n.message}concat(n){return new Lk({text:this.text+n.text,generationInfo:{...this.generationInfo,...n.generationInfo},message:this.message.concat(n.message)})}};function pc({name:t,serialized:e}){return t!==void 0?t:(e==null?void 0:e.name)!==void 0?e.name:(e==null?void 0:e.id)!==void 0&&Array.isArray(e==null?void 0:e.id)?e.id[e.id.length-1]:"Unnamed"}const Z$=t=>t.name==="event_stream_tracer";var K$=class extends Ei{constructor(e){super({_awaitHandler:!0,...e});k(this,"autoClose",!0);k(this,"includeNames");k(this,"includeTypes");k(this,"includeTags");k(this,"excludeNames");k(this,"excludeTypes");k(this,"excludeTags");k(this,"runInfoMap",new Map);k(this,"tappedPromises",new Map);k(this,"transformStream");k(this,"writer");k(this,"receiveStream");k(this,"name","event_stream_tracer");k(this,"lc_prefer_streaming",!0);this.autoClose=(e==null?void 0:e.autoClose)??!0,this.includeNames=e==null?void 0:e.includeNames,this.includeTypes=e==null?void 0:e.includeTypes,this.includeTags=e==null?void 0:e.includeTags,this.excludeNames=e==null?void 0:e.excludeNames,this.excludeTypes=e==null?void 0:e.excludeTypes,this.excludeTags=e==null?void 0:e.excludeTags,this.transformStream=new TransformStream,this.writer=this.transformStream.writable.getWriter(),this.receiveStream=sr.fromReadableStream(this.transformStream.readable)}[Symbol.asyncIterator](){return this.receiveStream}async persistRun(e){}_includeRun(e){const n=e.tags??[];let r=this.includeNames===void 0&&this.includeTags===void 0&&this.includeTypes===void 0;return this.includeNames!==void 0&&(r=r||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(r=r||this.includeTypes.includes(e.runType)),this.includeTags!==void 0&&(r=r||n.find(s=>{var a;return(a=this.includeTags)==null?void 0:a.includes(s)})!==void 0),this.excludeNames!==void 0&&(r=r&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(r=r&&!this.excludeTypes.includes(e.runType)),this.excludeTags!==void 0&&(r=r&&n.every(s=>{var a;return!((a=this.excludeTags)!=null&&a.includes(s))})),r}async*tapOutputIterable(e,n){const r=await n.next();if(r.done)return;const s=this.runInfoMap.get(e);if(s===void 0){yield r.value;return}function a(o,l){return o==="llm"&&typeof l=="string"?new di({text:l}):l}let i=this.tappedPromises.get(e);if(i===void 0){let o;i=new Promise(l=>{o=l}),this.tappedPromises.set(e,i);try{const l={event:`on_${s.runType}_stream`,run_id:e,name:s.name,tags:s.tags,metadata:s.metadata,data:{}};await this.send({...l,data:{chunk:a(s.runType,r.value)}},s),yield r.value;for await(const u of n)s.runType!=="tool"&&s.runType!=="retriever"&&await this.send({...l,data:{chunk:a(s.runType,u)}},s),yield u}finally{o==null||o()}}else{yield r.value;for await(const o of n)yield o}}async send(e,n){this._includeRun(n)&&await this.writer.write(e)}async sendEndEvent(e,n){const r=this.tappedPromises.get(e.run_id);r!==void 0?r.then(()=>{this.send(e,n)}):await this.send(e,n)}async onLLMStart(e){var i,o;const n=pc(e),r=e.inputs.messages!==void 0?"chat_model":"llm",s={tags:e.tags??[],metadata:((i=e.extra)==null?void 0:i.metadata)??{},name:n,runType:r,inputs:e.inputs};this.runInfoMap.set(e.id,s);const a=`on_${r}_start`;await this.send({event:a,data:{input:e.inputs},name:n,tags:e.tags??[],run_id:e.id,metadata:((o=e.extra)==null?void 0:o.metadata)??{}},s)}async onLLMNewToken(e,n,r){const s=this.runInfoMap.get(e.id);let a,i;if(s===void 0)throw new Error(`onLLMNewToken: Run ID ${e.id} not found in run map.`);if(this.runInfoMap.size!==1){if(s.runType==="chat_model")i="on_chat_model_stream",(r==null?void 0:r.chunk)===void 0?a=new Rr({content:n,id:`run-${e.id}`}):a=r.chunk.message;else if(s.runType==="llm")i="on_llm_stream",(r==null?void 0:r.chunk)===void 0?a=new di({text:n}):a=r.chunk;else throw new Error(`Unexpected run type ${s.runType}`);await this.send({event:i,data:{chunk:a},run_id:e.id,name:s.name,tags:s.tags,metadata:s.metadata},s)}}async onLLMEnd(e){var i,o,l;const n=this.runInfoMap.get(e.id);this.runInfoMap.delete(e.id);let r;if(n===void 0)throw new Error(`onLLMEnd: Run ID ${e.id} not found in run map.`);const s=(i=e.outputs)==null?void 0:i.generations;let a;if(n.runType==="chat_model"){for(const u of s??[]){if(a!==void 0)break;a=(o=u[0])==null?void 0:o.message}r="on_chat_model_end"}else if(n.runType==="llm")a={generations:s==null?void 0:s.map(u=>u.map(d=>({text:d.text,generationInfo:d.generationInfo}))),llmOutput:((l=e.outputs)==null?void 0:l.llmOutput)??{}},r="on_llm_end";else throw new Error(`onLLMEnd: Unexpected run type: ${n.runType}`);await this.sendEndEvent({event:r,data:{output:a,input:n.inputs},run_id:e.id,name:n.name,tags:n.tags,metadata:n.metadata},n)}async onChainStart(e){var i,o;const n=pc(e),r=e.run_type??"chain",s={tags:e.tags??[],metadata:((i=e.extra)==null?void 0:i.metadata)??{},name:n,runType:e.run_type};let a={};e.inputs.input===""&&Object.keys(e.inputs).length===1?(a={},s.inputs={}):e.inputs.input!==void 0?(a.input=e.inputs.input,s.inputs=e.inputs.input):(a.input=e.inputs,s.inputs=e.inputs),this.runInfoMap.set(e.id,s),await this.send({event:`on_${r}_start`,data:a,name:n,tags:e.tags??[],run_id:e.id,metadata:((o=e.extra)==null?void 0:o.metadata)??{}},s)}async onChainEnd(e){var o;const n=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),n===void 0)throw new Error(`onChainEnd: Run ID ${e.id} not found in run map.`);const r=`on_${e.run_type}_end`,s=e.inputs??n.inputs??{},i={output:((o=e.outputs)==null?void 0:o.output)??e.outputs,input:s};s.input&&Object.keys(s).length===1&&(i.input=s.input,n.inputs=s.input),await this.sendEndEvent({event:r,data:i,run_id:e.id,name:n.name,tags:n.tags,metadata:n.metadata??{}},n)}async onToolStart(e){var s,a;const n=pc(e),r={tags:e.tags??[],metadata:((s=e.extra)==null?void 0:s.metadata)??{},name:n,runType:"tool",inputs:e.inputs??{}};this.runInfoMap.set(e.id,r),await this.send({event:"on_tool_start",data:{input:e.inputs??{}},name:n,run_id:e.id,tags:e.tags??[],metadata:((a=e.extra)==null?void 0:a.metadata)??{}},r)}async onToolEnd(e){var s;const n=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),n===void 0)throw new Error(`onToolEnd: Run ID ${e.id} not found in run map.`);if(n.inputs===void 0)throw new Error(`onToolEnd: Run ID ${e.id} is a tool call, and is expected to have traced inputs.`);const r=((s=e.outputs)==null?void 0:s.output)===void 0?e.outputs:e.outputs.output;await this.sendEndEvent({event:"on_tool_end",data:{output:r,input:n.inputs},run_id:e.id,name:n.name,tags:n.tags,metadata:n.metadata},n)}async onRetrieverStart(e){var a,i;const n=pc(e),s={tags:e.tags??[],metadata:((a=e.extra)==null?void 0:a.metadata)??{},name:n,runType:"retriever",inputs:{query:e.inputs.query}};this.runInfoMap.set(e.id,s),await this.send({event:"on_retriever_start",data:{input:{query:e.inputs.query}},name:n,tags:e.tags??[],run_id:e.id,metadata:((i=e.extra)==null?void 0:i.metadata)??{}},s)}async onRetrieverEnd(e){var r;const n=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),n===void 0)throw new Error(`onRetrieverEnd: Run ID ${e.id} not found in run map.`);await this.sendEndEvent({event:"on_retriever_end",data:{output:((r=e.outputs)==null?void 0:r.documents)??e.outputs,input:n.inputs},run_id:e.id,name:n.name,tags:n.tags,metadata:n.metadata},n)}async handleCustomEvent(e,n,r){const s=this.runInfoMap.get(r);if(s===void 0)throw new Error(`handleCustomEvent: Run ID ${r} not found in run map.`);await this.send({event:"on_custom_event",run_id:r,name:e,tags:s.tags,metadata:s.metadata,data:n},s)}async finish(){const e=[...this.tappedPromises.values()];Promise.all(e).finally(()=>{this.writer.close()})}};const J$=Object.prototype.toString,Y$=t=>J$.call(t)==="[object Error]",Q$=new Set(["network error","Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed","fetch failed","terminated"," A network error occurred.","Network connection lost"]);function X$(t){if(!(t&&Y$(t)&&t.name==="TypeError"&&typeof t.message=="string"))return!1;const{message:n,stack:r}=t;return n==="Load failed"?r===void 0||"__sentry_captured__"in t:n.startsWith("error sending request for url")?!0:Q$.has(n)}function e4(t){if(typeof t=="number"){if(t<0)throw new TypeError("Expected `retries` to be a non-negative number.");if(Number.isNaN(t))throw new TypeError("Expected `retries` to be a valid number or Infinity, got NaN.")}else if(t!==void 0)throw new TypeError("Expected `retries` to be a number or Infinity.")}function gc(t,e,{min:n=0,allowInfinity:r=!1}={}){if(e!==void 0){if(typeof e!="number"||Number.isNaN(e))throw new TypeError(`Expected \`${t}\` to be a number${r?" or Infinity":""}.`);if(!r&&!Number.isFinite(e))throw new TypeError(`Expected \`${t}\` to be a finite number.`);if(e<n)throw new TypeError(`Expected \`${t}\` to be  ${n}.`)}}class t4 extends Error{constructor(e){super(),e instanceof Error?(this.originalError=e,{message:e}=e):(this.originalError=new Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}}function n4(t,e){const n=Math.max(1,t+1),r=e.randomize?Math.random()+1:1;let s=Math.round(r*e.minTimeout*e.factor**(n-1));return s=Math.min(s,e.maxTimeout),s}function C_(t,e){return Number.isFinite(e)?e-(performance.now()-t):e}async function r4({error:t,attemptNumber:e,retriesConsumed:n,startTime:r,options:s}){var m,v,w;const a=t instanceof Error?t:new TypeError(`Non-error was thrown: "${t}". You should only throw errors.`);if(a instanceof t4)throw a.originalError;const i=Number.isFinite(s.retries)?Math.max(0,s.retries-n):s.retries,o=s.maxRetryTime??Number.POSITIVE_INFINITY,l=Object.freeze({error:a,attemptNumber:e,retriesLeft:i,retriesConsumed:n});if(await s.onFailedAttempt(l),C_(r,o)<=0)throw a;const u=await s.shouldConsumeRetry(l),d=C_(r,o);if(d<=0||i<=0)throw a;if(a instanceof TypeError&&!X$(a)){if(u)throw a;return(m=s.signal)==null||m.throwIfAborted(),!1}if(!await s.shouldRetry(l))throw a;if(!u)return(v=s.signal)==null||v.throwIfAborted(),!1;const h=n4(n,s),f=Math.min(h,d);return f>0&&await new Promise((_,y)=>{var S,N;const p=()=>{var T;clearTimeout(g),(T=s.signal)==null||T.removeEventListener("abort",p),y(s.signal.reason)},g=setTimeout(()=>{var T;(T=s.signal)==null||T.removeEventListener("abort",p),_()},f);s.unref&&((S=g.unref)==null||S.call(g)),(N=s.signal)==null||N.addEventListener("abort",p,{once:!0})}),(w=s.signal)==null||w.throwIfAborted(),!0}async function zm(t,e={}){var a,i,o;if(e={...e},e4(e.retries),Object.hasOwn(e,"forever"))throw new Error("The `forever` option is no longer supported. For many use-cases, you can set `retries: Infinity` instead.");e.retries??(e.retries=10),e.factor??(e.factor=2),e.minTimeout??(e.minTimeout=1e3),e.maxTimeout??(e.maxTimeout=Number.POSITIVE_INFINITY),e.maxRetryTime??(e.maxRetryTime=Number.POSITIVE_INFINITY),e.randomize??(e.randomize=!1),e.onFailedAttempt??(e.onFailedAttempt=()=>{}),e.shouldRetry??(e.shouldRetry=()=>!0),e.shouldConsumeRetry??(e.shouldConsumeRetry=()=>!0),gc("factor",e.factor,{min:0,allowInfinity:!1}),gc("minTimeout",e.minTimeout,{min:0,allowInfinity:!1}),gc("maxTimeout",e.maxTimeout,{min:0,allowInfinity:!0}),gc("maxRetryTime",e.maxRetryTime,{min:0,allowInfinity:!0}),e.factor>0||(e.factor=1),(a=e.signal)==null||a.throwIfAborted();let n=0,r=0;const s=performance.now();for(;!Number.isFinite(e.retries)||r<=e.retries;){n++;try{(i=e.signal)==null||i.throwIfAborted();const l=await t(n);return(o=e.signal)==null||o.throwIfAborted(),l}catch(l){await r4({error:l,attemptNumber:n,retriesConsumed:r,startTime:s,options:e})&&r++}}throw new Error("Retry attempts exhausted without throwing an error.")}var s4={};je(s4,{AsyncCaller:()=>Nl});const a4=[400,401,402,403,404,405,406,407,409],i4=t=>{var n,r;if(t.message.startsWith("Cancel")||t.message.startsWith("AbortError")||t.name==="AbortError"||(t==null?void 0:t.code)==="ECONNABORTED")throw t;const e=((n=t==null?void 0:t.response)==null?void 0:n.status)??(t==null?void 0:t.status);if(e&&a4.includes(+e))throw t;if(((r=t==null?void 0:t.error)==null?void 0:r.code)==="insufficient_quota"){const s=new Error(t==null?void 0:t.message);throw s.name="InsufficientQuotaError",s}};var Nl=class{constructor(t){k(this,"maxConcurrency");k(this,"maxRetries");k(this,"onFailedAttempt");k(this,"queue");this.maxConcurrency=t.maxConcurrency??1/0,this.maxRetries=t.maxRetries??6,this.onFailedAttempt=t.onFailedAttempt??i4;const e="default"in Hr?Hr.default:Hr;this.queue=new e({concurrency:this.maxConcurrency})}call(t,...e){return this.queue.add(()=>zm(()=>t(...e).catch(n=>{throw n instanceof Error?n:new Error(n)}),{onFailedAttempt:({error:n})=>{var r;return(r=this.onFailedAttempt)==null?void 0:r.call(this,n)},retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0})}callWithOptions(t,e,...n){if(t.signal){let r;return Promise.race([this.call(e,...n),new Promise((s,a)=>{var i;r=()=>{a(sl(t.signal))},(i=t.signal)==null||i.addEventListener("abort",r)})]).finally(()=>{t.signal&&r&&t.signal.removeEventListener("abort",r)})}return this.call(e,...n)}fetch(...t){return this.call(()=>fetch(...t).then(e=>e.ok?e:Promise.reject(e)))}},Dk=class extends Ei{constructor({config:e,onStart:n,onEnd:r,onError:s}){super({_awaitHandler:!0});k(this,"name","RootListenersTracer");k(this,"rootId");k(this,"config");k(this,"argOnStart");k(this,"argOnEnd");k(this,"argOnError");this.config=e,this.argOnStart=n,this.argOnEnd=r,this.argOnError=s}persistRun(e){return Promise.resolve()}async onRunCreate(e){this.rootId||(this.rootId=e.id,this.argOnStart&&await this.argOnStart(e,this.config))}async onRunUpdate(e){e.id===this.rootId&&(e.error?this.argOnError&&await this.argOnError(e,this.config):this.argOnEnd&&await this.argOnEnd(e,this.config))}};function Xg(t){return t?t.lc_runnable:!1}var o4=class{constructor(t){k(this,"includeNames");k(this,"includeTypes");k(this,"includeTags");k(this,"excludeNames");k(this,"excludeTypes");k(this,"excludeTags");this.includeNames=t.includeNames,this.includeTypes=t.includeTypes,this.includeTags=t.includeTags,this.excludeNames=t.excludeNames,this.excludeTypes=t.excludeTypes,this.excludeTags=t.excludeTags}includeEvent(t,e){let n=this.includeNames===void 0&&this.includeTypes===void 0&&this.includeTags===void 0;const r=t.tags??[];return this.includeNames!==void 0&&(n=n||this.includeNames.includes(t.name)),this.includeTypes!==void 0&&(n=n||this.includeTypes.includes(e)),this.includeTags!==void 0&&(n=n||r.some(s=>{var a;return(a=this.includeTags)==null?void 0:a.includes(s)})),this.excludeNames!==void 0&&(n=n&&!this.excludeNames.includes(t.name)),this.excludeTypes!==void 0&&(n=n&&!this.excludeTypes.includes(e)),this.excludeTags!==void 0&&(n=n&&r.every(s=>{var a;return!((a=this.excludeTags)!=null&&a.includes(s))})),n}};function Ni(t,e,n){function r(o,l){if(o._zod||Object.defineProperty(o,"_zod",{value:{def:l,constr:i,traits:new Set},enumerable:!1}),o._zod.traits.has(t))return;o._zod.traits.add(t),e(o,l);const u=i.prototype,d=Object.keys(u);for(let h=0;h<d.length;h++){const f=d[h];f in o||(o[f]=u[f].bind(o))}}const s=(n==null?void 0:n.Parent)??Object;class a extends s{}Object.defineProperty(a,"name",{value:t});function i(o){var l;const u=n!=null&&n.Parent?new a:this;r(u,o),(l=u._zod).deferred??(l.deferred=[]);for(const d of u._zod.deferred)d();return u}return Object.defineProperty(i,"init",{value:r}),Object.defineProperty(i,Symbol.hasInstance,{value:o=>{var l,u;return n!=null&&n.Parent&&o instanceof n.Parent?!0:(u=(l=o==null?void 0:o._zod)==null?void 0:l.traits)==null?void 0:u.has(t)}}),Object.defineProperty(i,"name",{value:t}),i}class Ro extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}const l4={};function Pd(t){return l4}function c4(t){const e=Object.values(t).filter(r=>typeof r=="number");return Object.entries(t).filter(([r,s])=>e.indexOf(+r)===-1).map(([r,s])=>s)}function u4(t,e){return typeof e=="bigint"?e.toString():e}function d4(t){const e=t.startsWith("^")?1:0,n=t.endsWith("$")?t.length-1:t.length;return t.slice(e,n)}const I_=Symbol("evaluating");function j_(t,e,n){let r;Object.defineProperty(t,e,{get(){if(r!==I_)return r===void 0&&(r=I_,r=n()),r},set(s){Object.defineProperty(t,e,{value:s})},configurable:!0})}function Mk(t,e,n){Object.defineProperty(t,e,{value:n,writable:!0,enumerable:!0,configurable:!0})}function Fk(...t){const e={};for(const n of t){const r=Object.getOwnPropertyDescriptors(n);Object.assign(e,r)}return Object.defineProperties({},e)}const zk="captureStackTrace"in Error?Error.captureStackTrace:(...t)=>{};function R_(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}function h4(t){if(R_(t)===!1)return!1;const e=t.constructor;if(e===void 0||typeof e!="function")return!0;const n=e.prototype;return!(R_(n)===!1||Object.prototype.hasOwnProperty.call(n,"isPrototypeOf")===!1)}function es(t,e,n){const r=new t._zod.constr(e??t._zod.def);return(!e||n!=null&&n.parent)&&(r._zod.parent=t),r}function f4(t){return{}}function m4(t,e){if(!h4(e))throw new Error("Invalid input to extend: expected a plain object");const n=t._zod.def.checks;if(n&&n.length>0)throw new Error("Object schemas containing refinements cannot be extended. Use `.safeExtend()` instead.");const s=Fk(t._zod.def,{get shape(){const a={...t._zod.def.shape,...e};return Mk(this,"shape",a),a},checks:[]});return es(t,s)}function p4(t,e,n){const r=Fk(e._zod.def,{get shape(){const s=e._zod.def.shape,a={...s};for(const i in s)a[i]=t?new t({type:"optional",innerType:s[i]}):s[i];return Mk(this,"shape",a),a},checks:[]});return es(e,r)}function yc(t,e=0){var n;if(t.aborted===!0)return!0;for(let r=e;r<t.issues.length;r++)if(((n=t.issues[r])==null?void 0:n.continue)!==!0)return!0;return!1}function vc(t){return typeof t=="string"?t:t==null?void 0:t.message}function $d(t,e,n){var s,a,i,o,l,u;const r={...t,path:t.path??[]};if(!t.message){const d=vc((i=(a=(s=t.inst)==null?void 0:s._zod.def)==null?void 0:a.error)==null?void 0:i.call(a,t))??vc((o=e==null?void 0:e.error)==null?void 0:o.call(e,t))??vc((l=n.customError)==null?void 0:l.call(n,t))??vc((u=n.localeError)==null?void 0:u.call(n,t))??"Invalid input";r.message=d}return delete r.inst,delete r.continue,e!=null&&e.reportInput||delete r.input,r}const Uk=(t,e)=>{t.name="$ZodError",Object.defineProperty(t,"_zod",{value:t._zod,enumerable:!1}),Object.defineProperty(t,"issues",{value:e,enumerable:!1}),t.message=JSON.stringify(e,u4,2),Object.defineProperty(t,"toString",{value:()=>t.message,enumerable:!1})},g4=Ni("$ZodError",Uk),Ld=Ni("$ZodError",Uk,{Parent:Error});function y4(t){const e=[],n=t.map(r=>typeof r=="object"?r.key:r);for(const r of n)typeof r=="number"?e.push(`[${r}]`):typeof r=="symbol"?e.push(`[${JSON.stringify(String(r))}]`):/[^\w$]/.test(r)?e.push(`[${JSON.stringify(r)}]`):(e.length&&e.push("."),e.push(r));return e.join("")}function v4(t){var r;const e=[],n=[...t.issues].sort((s,a)=>(s.path??[]).length-(a.path??[]).length);for(const s of n)e.push(` ${s.message}`),(r=s.path)!=null&&r.length&&e.push(`   at ${y4(s.path)}`);return e.join(`
`)}const _4=t=>(e,n,r,s)=>{const a=r?Object.assign(r,{async:!1}):{async:!1},i=e._zod.run({value:n,issues:[]},a);if(i instanceof Promise)throw new Ro;if(i.issues.length){const o=new((s==null?void 0:s.Err)??t)(i.issues.map(l=>$d(l,a,Pd())));throw zk(o,s==null?void 0:s.callee),o}return i.value},Dd=_4(Ld),w4=t=>async(e,n,r,s)=>{const a=r?Object.assign(r,{async:!0}):{async:!0};let i=e._zod.run({value:n,issues:[]},a);if(i instanceof Promise&&(i=await i),i.issues.length){const o=new((s==null?void 0:s.Err)??t)(i.issues.map(l=>$d(l,a,Pd())));throw zk(o,s==null?void 0:s.callee),o}return i.value},Bk=w4(Ld),x4=t=>(e,n,r)=>{const s=r?{...r,async:!1}:{async:!1},a=e._zod.run({value:n,issues:[]},s);if(a instanceof Promise)throw new Ro;return a.issues.length?{success:!1,error:new(t??g4)(a.issues.map(i=>$d(i,s,Pd())))}:{success:!0,data:a.value}},b4=x4(Ld),S4=t=>async(e,n,r)=>{const s=r?Object.assign(r,{async:!0}):{async:!0};let a=e._zod.run({value:n,issues:[]},s);return a instanceof Promise&&(a=await a),a.issues.length?{success:!1,error:new t(a.issues.map(i=>$d(i,s,Pd())))}:{success:!0,data:a.value}},k4=S4(Ld),E4={major:4,minor:1,patch:13},ey=Ni("$ZodType",(t,e)=>{var s;var n;t??(t={}),t._zod.def=e,t._zod.bag=t._zod.bag||{},t._zod.version=E4;const r=[...t._zod.def.checks??[]];t._zod.traits.has("$ZodCheck")&&r.unshift(t);for(const a of r)for(const i of a._zod.onattach)i(t);if(r.length===0)(n=t._zod).deferred??(n.deferred=[]),(s=t._zod.deferred)==null||s.push(()=>{t._zod.run=t._zod.parse});else{const a=(o,l,u)=>{let d=yc(o),h;for(const f of l){if(f._zod.def.when){if(!f._zod.def.when(o))continue}else if(d)continue;const m=o.issues.length,v=f._zod.check(o);if(v instanceof Promise&&(u==null?void 0:u.async)===!1)throw new Ro;if(h||v instanceof Promise)h=(h??Promise.resolve()).then(async()=>{await v,o.issues.length!==m&&(d||(d=yc(o,m)))});else{if(o.issues.length===m)continue;d||(d=yc(o,m))}}return h?h.then(()=>o):o},i=(o,l,u)=>{if(yc(o))return o.aborted=!0,o;const d=a(l,r,u);if(d instanceof Promise){if(u.async===!1)throw new Ro;return d.then(h=>t._zod.parse(h,u))}return t._zod.parse(d,u)};t._zod.run=(o,l)=>{if(l.skipChecks)return t._zod.parse(o,l);if(l.direction==="backward"){const d=t._zod.parse({value:o.value,issues:[]},{...l,skipChecks:!0});return d instanceof Promise?d.then(h=>i(h,o,l)):i(d,o,l)}const u=t._zod.parse(o,l);if(u instanceof Promise){if(l.async===!1)throw new Ro;return u.then(d=>a(d,r,l))}return a(u,r,l)}}t["~standard"]={validate:a=>{var i;try{const o=b4(t,a);return o.success?{value:o.data}:{issues:(i=o.error)==null?void 0:i.issues}}catch{return k4(t,a).then(l=>{var u;return l.success?{value:l.data}:{issues:(u=l.error)==null?void 0:u.issues}})}},vendor:"zod",version:1}}),N4=Ni("$ZodUnknown",(t,e)=>{ey.init(t,e),t._zod.parse=n=>n}),T4=Ni("$ZodNever",(t,e)=>{ey.init(t,e),t._zod.parse=(n,r)=>(n.issues.push({expected:"never",code:"invalid_type",input:n.value,inst:t}),n)});function O_(t,e){return t.issues.length&&e===void 0?{issues:[],value:void 0}:t}const Gk=Ni("$ZodOptional",(t,e)=>{ey.init(t,e),t._zod.optin="optional",t._zod.optout="optional",j_(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,void 0]):void 0),j_(t._zod,"pattern",()=>{const n=e.innerType._zod.pattern;return n?new RegExp(`^(${d4(n.source)})?$`):void 0}),t._zod.parse=(n,r)=>{if(e.innerType._zod.optin==="optional"){const s=e.innerType._zod.run(n,r);return s instanceof Promise?s.then(a=>O_(a,n.value)):O_(s,n.value)}return n.value===void 0?n:e.innerType._zod.run(n,r)}});var P_;class Hk{constructor(){this._map=new WeakMap,this._idmap=new Map}add(e,...n){const r=n[0];if(this._map.set(e,r),r&&typeof r=="object"&&"id"in r){if(this._idmap.has(r.id))throw new Error(`ID ${r.id} already exists in the registry`);this._idmap.set(r.id,e)}return this}clear(){return this._map=new WeakMap,this._idmap=new Map,this}remove(e){const n=this._map.get(e);return n&&typeof n=="object"&&"id"in n&&this._idmap.delete(n.id),this._map.delete(e),this}get(e){const n=e._zod.parent;if(n){const r={...this.get(n)??{}};delete r.id;const s={...r,...this._map.get(e)};return Object.keys(s).length?s:void 0}return this._map.get(e)}has(e){return this._map.has(e)}}function A4(){return new Hk}(P_=globalThis).__zod_globalRegistry??(P_.__zod_globalRegistry=A4());const on=globalThis.__zod_globalRegistry;function C4(t){return new t({type:"unknown"})}function I4(t,e){return new t({type:"never",...f4()})}class $_{constructor(e){this.counter=0,this.metadataRegistry=(e==null?void 0:e.metadata)??on,this.target=(e==null?void 0:e.target)??"draft-2020-12",this.unrepresentable=(e==null?void 0:e.unrepresentable)??"throw",this.override=(e==null?void 0:e.override)??(()=>{}),this.io=(e==null?void 0:e.io)??"output",this.seen=new Map}process(e,n={path:[],schemaPath:[]}){var h,f,m;var r;const s=e._zod.def,a={guid:"uuid",url:"uri",datetime:"date-time",json_string:"json-string",regex:""},i=this.seen.get(e);if(i)return i.count++,n.schemaPath.includes(e)&&(i.cycle=n.path),i.schema;const o={schema:{},count:1,cycle:void 0,path:n.path};this.seen.set(e,o);const l=(f=(h=e._zod).toJSONSchema)==null?void 0:f.call(h);if(l)o.schema=l;else{const v={...n,schemaPath:[...n.schemaPath,e],path:n.path},w=e._zod.parent;if(w)o.ref=w,this.process(w,v),this.seen.get(w).isParent=!0;else{const _=o.schema;switch(s.type){case"string":{const y=_;y.type="string";const{minimum:p,maximum:g,format:S,patterns:N,contentEncoding:T}=e._zod.bag;if(typeof p=="number"&&(y.minLength=p),typeof g=="number"&&(y.maxLength=g),S&&(y.format=a[S]??S,y.format===""&&delete y.format),T&&(y.contentEncoding=T),N&&N.size>0){const A=[...N];A.length===1?y.pattern=A[0].source:A.length>1&&(o.schema.allOf=[...A.map(x=>({...this.target==="draft-7"||this.target==="draft-4"||this.target==="openapi-3.0"?{type:"string"}:{},pattern:x.source}))])}break}case"number":{const y=_,{minimum:p,maximum:g,format:S,multipleOf:N,exclusiveMaximum:T,exclusiveMinimum:A}=e._zod.bag;typeof S=="string"&&S.includes("int")?y.type="integer":y.type="number",typeof A=="number"&&(this.target==="draft-4"||this.target==="openapi-3.0"?(y.minimum=A,y.exclusiveMinimum=!0):y.exclusiveMinimum=A),typeof p=="number"&&(y.minimum=p,typeof A=="number"&&this.target!=="draft-4"&&(A>=p?delete y.minimum:delete y.exclusiveMinimum)),typeof T=="number"&&(this.target==="draft-4"||this.target==="openapi-3.0"?(y.maximum=T,y.exclusiveMaximum=!0):y.exclusiveMaximum=T),typeof g=="number"&&(y.maximum=g,typeof T=="number"&&this.target!=="draft-4"&&(T<=g?delete y.maximum:delete y.exclusiveMaximum)),typeof N=="number"&&(y.multipleOf=N);break}case"boolean":{const y=_;y.type="boolean";break}case"bigint":{if(this.unrepresentable==="throw")throw new Error("BigInt cannot be represented in JSON Schema");break}case"symbol":{if(this.unrepresentable==="throw")throw new Error("Symbols cannot be represented in JSON Schema");break}case"null":{this.target==="openapi-3.0"?(_.type="string",_.nullable=!0,_.enum=[null]):_.type="null";break}case"any":break;case"unknown":break;case"undefined":{if(this.unrepresentable==="throw")throw new Error("Undefined cannot be represented in JSON Schema");break}case"void":{if(this.unrepresentable==="throw")throw new Error("Void cannot be represented in JSON Schema");break}case"never":{_.not={};break}case"date":{if(this.unrepresentable==="throw")throw new Error("Date cannot be represented in JSON Schema");break}case"array":{const y=_,{minimum:p,maximum:g}=e._zod.bag;typeof p=="number"&&(y.minItems=p),typeof g=="number"&&(y.maxItems=g),y.type="array",y.items=this.process(s.element,{...v,path:[...v.path,"items"]});break}case"object":{const y=_;y.type="object",y.properties={};const p=s.shape;for(const N in p)y.properties[N]=this.process(p[N],{...v,path:[...v.path,"properties",N]});const g=new Set(Object.keys(p)),S=new Set([...g].filter(N=>{const T=s.shape[N]._zod;return this.io==="input"?T.optin===void 0:T.optout===void 0}));S.size>0&&(y.required=Array.from(S)),((m=s.catchall)==null?void 0:m._zod.def.type)==="never"?y.additionalProperties=!1:s.catchall?s.catchall&&(y.additionalProperties=this.process(s.catchall,{...v,path:[...v.path,"additionalProperties"]})):this.io==="output"&&(y.additionalProperties=!1);break}case"union":{const y=_,p=s.discriminator!==void 0,g=s.options.map((S,N)=>this.process(S,{...v,path:[...v.path,p?"oneOf":"anyOf",N]}));p?y.oneOf=g:y.anyOf=g;break}case"intersection":{const y=_,p=this.process(s.left,{...v,path:[...v.path,"allOf",0]}),g=this.process(s.right,{...v,path:[...v.path,"allOf",1]}),S=T=>"allOf"in T&&Object.keys(T).length===1,N=[...S(p)?p.allOf:[p],...S(g)?g.allOf:[g]];y.allOf=N;break}case"tuple":{const y=_;y.type="array";const p=this.target==="draft-2020-12"?"prefixItems":"items",g=this.target==="draft-2020-12"||this.target==="openapi-3.0"?"items":"additionalItems",S=s.items.map((x,j)=>this.process(x,{...v,path:[...v.path,p,j]})),N=s.rest?this.process(s.rest,{...v,path:[...v.path,g,...this.target==="openapi-3.0"?[s.items.length]:[]]}):null;this.target==="draft-2020-12"?(y.prefixItems=S,N&&(y.items=N)):this.target==="openapi-3.0"?(y.items={anyOf:S},N&&y.items.anyOf.push(N),y.minItems=S.length,N||(y.maxItems=S.length)):(y.items=S,N&&(y.additionalItems=N));const{minimum:T,maximum:A}=e._zod.bag;typeof T=="number"&&(y.minItems=T),typeof A=="number"&&(y.maxItems=A);break}case"record":{const y=_;y.type="object",(this.target==="draft-7"||this.target==="draft-2020-12")&&(y.propertyNames=this.process(s.keyType,{...v,path:[...v.path,"propertyNames"]})),y.additionalProperties=this.process(s.valueType,{...v,path:[...v.path,"additionalProperties"]});break}case"map":{if(this.unrepresentable==="throw")throw new Error("Map cannot be represented in JSON Schema");break}case"set":{if(this.unrepresentable==="throw")throw new Error("Set cannot be represented in JSON Schema");break}case"enum":{const y=_,p=c4(s.entries);p.every(g=>typeof g=="number")&&(y.type="number"),p.every(g=>typeof g=="string")&&(y.type="string"),y.enum=p;break}case"literal":{const y=_,p=[];for(const g of s.values)if(g===void 0){if(this.unrepresentable==="throw")throw new Error("Literal `undefined` cannot be represented in JSON Schema")}else if(typeof g=="bigint"){if(this.unrepresentable==="throw")throw new Error("BigInt literals cannot be represented in JSON Schema");p.push(Number(g))}else p.push(g);if(p.length!==0)if(p.length===1){const g=p[0];y.type=g===null?"null":typeof g,this.target==="draft-4"||this.target==="openapi-3.0"?y.enum=[g]:y.const=g}else p.every(g=>typeof g=="number")&&(y.type="number"),p.every(g=>typeof g=="string")&&(y.type="string"),p.every(g=>typeof g=="boolean")&&(y.type="string"),p.every(g=>g===null)&&(y.type="null"),y.enum=p;break}case"file":{const y=_,p={type:"string",format:"binary",contentEncoding:"binary"},{minimum:g,maximum:S,mime:N}=e._zod.bag;g!==void 0&&(p.minLength=g),S!==void 0&&(p.maxLength=S),N?N.length===1?(p.contentMediaType=N[0],Object.assign(y,p)):y.anyOf=N.map(T=>({...p,contentMediaType:T})):Object.assign(y,p);break}case"transform":{if(this.unrepresentable==="throw")throw new Error("Transforms cannot be represented in JSON Schema");break}case"nullable":{const y=this.process(s.innerType,v);this.target==="openapi-3.0"?(o.ref=s.innerType,_.nullable=!0):_.anyOf=[y,{type:"null"}];break}case"nonoptional":{this.process(s.innerType,v),o.ref=s.innerType;break}case"success":{const y=_;y.type="boolean";break}case"default":{this.process(s.innerType,v),o.ref=s.innerType,_.default=JSON.parse(JSON.stringify(s.defaultValue));break}case"prefault":{this.process(s.innerType,v),o.ref=s.innerType,this.io==="input"&&(_._prefault=JSON.parse(JSON.stringify(s.defaultValue)));break}case"catch":{this.process(s.innerType,v),o.ref=s.innerType;let y;try{y=s.catchValue(void 0)}catch{throw new Error("Dynamic catch values are not supported in JSON Schema")}_.default=y;break}case"nan":{if(this.unrepresentable==="throw")throw new Error("NaN cannot be represented in JSON Schema");break}case"template_literal":{const y=_,p=e._zod.pattern;if(!p)throw new Error("Pattern not found in template literal");y.type="string",y.pattern=p.source;break}case"pipe":{const y=this.io==="input"?s.in._zod.def.type==="transform"?s.out:s.in:s.out;this.process(y,v),o.ref=y;break}case"readonly":{this.process(s.innerType,v),o.ref=s.innerType,_.readOnly=!0;break}case"promise":{this.process(s.innerType,v),o.ref=s.innerType;break}case"optional":{this.process(s.innerType,v),o.ref=s.innerType;break}case"lazy":{const y=e._zod.innerType;this.process(y,v),o.ref=y;break}case"custom":{if(this.unrepresentable==="throw")throw new Error("Custom types cannot be represented in JSON Schema");break}case"function":{if(this.unrepresentable==="throw")throw new Error("Function types cannot be represented in JSON Schema");break}}}}const u=this.metadataRegistry.get(e);return u&&Object.assign(o.schema,u),this.io==="input"&&Wt(e)&&(delete o.schema.examples,delete o.schema.default),this.io==="input"&&o.schema._prefault&&((r=o.schema).default??(r.default=o.schema._prefault)),delete o.schema._prefault,this.seen.get(e).schema}emit(e,n){var d,h,f,m,v,w;const r={cycles:(n==null?void 0:n.cycles)??"ref",reused:(n==null?void 0:n.reused)??"inline",external:(n==null?void 0:n.external)??void 0},s=this.seen.get(e);if(!s)throw new Error("Unprocessed schema. This is a bug in Zod.");const a=_=>{var N;const y=this.target==="draft-2020-12"?"$defs":"definitions";if(r.external){const T=(N=r.external.registry.get(_[0]))==null?void 0:N.id,A=r.external.uri??(j=>j);if(T)return{ref:A(T)};const x=_[1].defId??_[1].schema.id??`schema${this.counter++}`;return _[1].defId=x,{defId:x,ref:`${A("__shared")}#/${y}/${x}`}}if(_[1]===s)return{ref:"#"};const g=`#/${y}/`,S=_[1].schema.id??`__schema${this.counter++}`;return{defId:S,ref:g+S}},i=_=>{if(_[1].schema.$ref)return;const y=_[1],{ref:p,defId:g}=a(_);y.def={...y.schema},g&&(y.defId=g);const S=y.schema;for(const N in S)delete S[N];S.$ref=p};if(r.cycles==="throw")for(const _ of this.seen.entries()){const y=_[1];if(y.cycle)throw new Error(`Cycle detected: #/${(d=y.cycle)==null?void 0:d.join("/")}/<root>

Set the \`cycles\` parameter to \`"ref"\` to resolve cyclical schemas with defs.`)}for(const _ of this.seen.entries()){const y=_[1];if(e===_[0]){i(_);continue}if(r.external){const g=(h=r.external.registry.get(_[0]))==null?void 0:h.id;if(e!==_[0]&&g){i(_);continue}}if((f=this.metadataRegistry.get(_[0]))==null?void 0:f.id){i(_);continue}if(y.cycle){i(_);continue}if(y.count>1&&r.reused==="ref"){i(_);continue}}const o=(_,y)=>{const p=this.seen.get(_),g=p.def??p.schema,S={...g};if(p.ref===null)return;const N=p.ref;if(p.ref=null,N){o(N,y);const T=this.seen.get(N).schema;T.$ref&&(y.target==="draft-7"||y.target==="draft-4"||y.target==="openapi-3.0")?(g.allOf=g.allOf??[],g.allOf.push(T)):(Object.assign(g,T),Object.assign(g,S))}p.isParent||this.override({zodSchema:_,jsonSchema:g,path:p.path??[]})};for(const _ of[...this.seen.entries()].reverse())o(_[0],{target:this.target});const l={};if(this.target==="draft-2020-12"?l.$schema="https://json-schema.org/draft/2020-12/schema":this.target==="draft-7"?l.$schema="http://json-schema.org/draft-07/schema#":this.target==="draft-4"?l.$schema="http://json-schema.org/draft-04/schema#":this.target==="openapi-3.0"||console.warn(`Invalid target: ${this.target}`),(m=r.external)!=null&&m.uri){const _=(v=r.external.registry.get(e))==null?void 0:v.id;if(!_)throw new Error("Schema is missing an `id` property");l.$id=r.external.uri(_)}Object.assign(l,s.def);const u=((w=r.external)==null?void 0:w.defs)??{};for(const _ of this.seen.entries()){const y=_[1];y.def&&y.defId&&(u[y.defId]=y.def)}r.external||Object.keys(u).length>0&&(this.target==="draft-2020-12"?l.$defs=u:l.definitions=u);try{return JSON.parse(JSON.stringify(l))}catch{throw new Error("Error converting schema to JSON.")}}}function Pu(t,e){if(t instanceof Hk){const r=new $_(e),s={};for(const o of t._idmap.entries()){const[l,u]=o;r.process(u)}const a={},i={registry:t,uri:e==null?void 0:e.uri,defs:s};for(const o of t._idmap.entries()){const[l,u]=o;a[l]=r.emit(u,{...e,external:i})}if(Object.keys(s).length>0){const o=r.target==="draft-2020-12"?"$defs":"definitions";a.__shared={[o]:s}}return{schemas:a}}const n=new $_(e);return n.process(t),n.emit(t,e)}function Wt(t,e){const n=e??{seen:new Set};if(n.seen.has(t))return!1;n.seen.add(t);const r=t._zod.def;if(r.type==="transform")return!0;if(r.type==="array")return Wt(r.element,n);if(r.type==="set")return Wt(r.valueType,n);if(r.type==="lazy")return Wt(r.getter(),n);if(r.type==="promise"||r.type==="optional"||r.type==="nonoptional"||r.type==="nullable"||r.type==="readonly"||r.type==="default"||r.type==="prefault")return Wt(r.innerType,n);if(r.type==="intersection")return Wt(r.left,n)||Wt(r.right,n);if(r.type==="record"||r.type==="map")return Wt(r.keyType,n)||Wt(r.valueType,n);if(r.type==="pipe")return Wt(r.in,n)||Wt(r.out,n);if(r.type==="object"){for(const s in r.shape)if(Wt(r.shape[s],n))return!0;return!1}if(r.type==="union"){for(const s of r.options)if(Wt(s,n))return!0;return!1}if(r.type==="tuple"){for(const s of r.items)if(Wt(s,n))return!0;return!!(r.rest&&Wt(r.rest,n))}return!1}function ct(t){if(typeof t!="object"||t===null)return!1;const e=t;if(!("_zod"in e))return!1;const n=e._zod;return typeof n=="object"&&n!==null&&"def"in n}function pt(t){if(typeof t!="object"||t===null)return!1;const e=t;if(!("_def"in e)||"_zod"in e)return!1;const n=e._def;return typeof n=="object"&&n!=null&&"typeName"in n}function j4(t){return ct(t)&&console.warn("[WARNING] Attempting to use Zod 4 schema in a context where Zod 3 schema is expected. This may cause unexpected behavior."),pt(t)}function xr(t){return!t||typeof t!="object"||Array.isArray(t)?!1:!!(ct(t)||pt(t))}function Wk(t){return typeof t=="object"&&t!==null&&"_def"in t&&typeof t._def=="object"&&t._def!==null&&"typeName"in t._def&&t._def.typeName==="ZodLiteral"}function Vk(t){return ct(t)?typeof t=="object"&&t!==null&&"_zod"in t&&typeof t._zod=="object"&&t._zod!==null&&"def"in t._zod&&typeof t._zod.def=="object"&&t._zod.def!==null&&"type"in t._zod.def&&t._zod.def.type==="literal":!1}function R4(t){return!!(Wk(t)||Vk(t))}async function qk(t,e){if(ct(t))try{return{success:!0,data:await Bk(t,e)}}catch(n){return{success:!1,error:n}}if(pt(t))return await t.safeParseAsync(e);throw new Error("Schema must be an instance of z3.ZodType or z4.$ZodType")}async function Md(t,e){if(ct(t))return await Bk(t,e);if(pt(t))return await t.parseAsync(e);throw new Error("Schema must be an instance of z3.ZodType or z4.$ZodType")}function O4(t,e){if(ct(t))try{return{success:!0,data:Dd(t,e)}}catch(n){return{success:!1,error:n}}if(pt(t))return t.safeParse(e);throw new Error("Schema must be an instance of z3.ZodType or z4.$ZodType")}function P4(t,e){if(ct(t))return Dd(t,e);if(pt(t))return t.parse(e);throw new Error("Schema must be an instance of z3.ZodType or z4.$ZodType")}function Fd(t){var e;if(ct(t))return(e=on.get(t))==null?void 0:e.description;if(pt(t)||"description"in t&&typeof t.description=="string")return t.description}function $4(t){if(!xr(t))return!1;if(pt(t)){const e=t._def;if(e.typeName==="ZodObject"){const n=t;return!n.shape||Object.keys(n.shape).length===0}if(e.typeName==="ZodRecord")return!0}if(ct(t)){const e=t._zod.def;if(e.type==="object"){const n=t;return!n.shape||Object.keys(n.shape).length===0}if(e.type==="record")return!0}return typeof t=="object"&&t!==null&&!("shape"in t)}function ty(t){return xr(t)?pt(t)?t._def.typeName==="ZodString":ct(t)?t._zod.def.type==="string":!1:!1}function ny(t){return typeof t=="object"&&t!==null&&"_def"in t&&typeof t._def=="object"&&t._def!==null&&"typeName"in t._def&&t._def.typeName==="ZodObject"}function Tr(t){return ct(t)?typeof t=="object"&&t!==null&&"_zod"in t&&typeof t._zod=="object"&&t._zod!==null&&"def"in t._zod&&typeof t._zod.def=="object"&&t._zod.def!==null&&"type"in t._zod.def&&t._zod.def.type==="object":!1}function zd(t){return ct(t)?typeof t=="object"&&t!==null&&"_zod"in t&&typeof t._zod=="object"&&t._zod!==null&&"def"in t._zod&&typeof t._zod.def=="object"&&t._zod.def!==null&&"type"in t._zod.def&&t._zod.def.type==="array":!1}function L4(t){return!!(ny(t)||Tr(t))}function Um(t){if(pt(t))return t.shape;if(ct(t))return t._zod.def.shape;throw new Error("Schema must be an instance of z3.ZodObject or z4.$ZodObject")}function D4(t,e){if(pt(t))return t.extend(e);if(ct(t))return m4(t,e);throw new Error("Schema must be an instance of z3.ZodObject or z4.$ZodObject")}function M4(t){if(pt(t))return t.partial();if(ct(t))return p4(Gk,t);throw new Error("Schema must be an instance of z3.ZodObject or z4.$ZodObject")}function $u(t,e=!1){if(pt(t))return t.strict();if(Tr(t)){const n=t._zod.def.shape;if(e)for(const[a,i]of Object.entries(t._zod.def.shape)){if(Tr(i)){const l=$u(i,e);n[a]=l}else if(zd(i)){let l=i._zod.def.element;Tr(l)&&(l=$u(l,e)),n[a]=es(i,{...i._zod.def,element:l})}else n[a]=i;const o=on.get(i);o&&on.add(n[a],o)}const r=es(t,{...t._zod.def,shape:n,catchall:I4(T4)}),s=on.get(t);return s&&on.add(r,s),r}throw new Error("Schema must be an instance of z3.ZodObject or z4.$ZodObject")}function Bm(t,e=!1){if(ny(t))return t.passthrough();if(Tr(t)){const n=t._zod.def.shape;if(e)for(const[a,i]of Object.entries(t._zod.def.shape)){if(Tr(i)){const l=Bm(i,e);n[a]=l}else if(zd(i)){let l=i._zod.def.element;Tr(l)&&(l=Bm(l,e)),n[a]=es(i,{...i._zod.def,element:l})}else n[a]=i;const o=on.get(i);o&&on.add(n[a],o)}const r=es(t,{...t._zod.def,shape:n,catchall:C4(N4)}),s=on.get(t);return s&&on.add(r,s),r}throw new Error("Schema must be an instance of z3.ZodObject or z4.$ZodObject")}function F4(t){if(pt(t))try{const e=t.parse(void 0);return()=>e}catch{return}if(ct(t))try{const e=Dd(t,void 0);return()=>e}catch{return}}function z4(t){return pt(t)&&"typeName"in t._def&&t._def.typeName==="ZodEffects"}function U4(t){return ct(t)&&t._zod.def.type==="pipe"}function lo(t,e,n){const r=n.get(t);if(r!==void 0)return r;if(pt(t))return z4(t)?lo(t._def.schema,e,n):t;if(ct(t)){let s=t;if(U4(t)&&(s=lo(t._zod.def.in,e,n)),e){if(Tr(s)){const i=s._zod.def.shape;for(const[o,l]of Object.entries(s._zod.def.shape))i[o]=lo(l,e,n);s=es(s,{...s._zod.def,shape:i})}else if(zd(s)){const i=lo(s._zod.def.element,e,n);s=es(s,{...s._zod.def,element:i})}}const a=on.get(t);return a&&on.add(s,a),n.set(t,s),s}throw new Error("Schema must be an instance of z3.ZodType or z4.$ZodType")}function Zk(t,e=!1){return lo(t,e,new WeakMap)}function B4(t,e){if(pt(t)){const n=Um(t),r={};for(const[s,a]of Object.entries(n))e(s,a)?r[s]=a.optional():r[s]=a;return t.extend(r)}if(ct(t)){const n=Um(t),r={...t._zod.def.shape};for(const[i,o]of Object.entries(n))e(i,o)&&(r[i]=new Gk({type:"optional",innerType:o}));const s=es(t,{...t._zod.def,shape:r}),a=on.get(t);return a&&on.add(s,a),s}throw new Error("Schema must be an instance of z3.ZodObject or z4.$ZodObject")}function Kk(t){return t instanceof Error&&(t.constructor.name==="ZodError"||t.constructor.name==="$ZodError")}function of(t){return t.replace(/[^a-zA-Z-_0-9]/g,"_")}const G4=["*","_","`"];function H4(t){let e="";for(const[n,r]of Object.entries(t))e+=`	classDef ${n} ${r};
`;return e}function W4(t,e,n){const{firstNode:r,lastNode:s,nodeColors:a,withStyles:i=!0,curveStyle:o="linear",wrapLabelNWords:l=9}=n??{};let u=i?`%%{init: {'flowchart': {'curve': '${o}'}}}%%
graph TD;
`:`graph TD;
`;if(i){const m="default",v={[m]:"{0}({1})"};r!==void 0&&(v[r]="{0}([{1}]):::first"),s!==void 0&&(v[s]="{0}([{1}]):::last");for(const[w,_]of Object.entries(t)){const y=_.name.split(":").pop()??"";let g=G4.some(N=>y.startsWith(N)&&y.endsWith(N))?`<p>${y}</p>`:y;Object.keys(_.metadata??{}).length&&(g+=`<hr/><small><em>${Object.entries(_.metadata??{}).map(([N,T])=>`${N} = ${T}`).join(`
`)}</em></small>`);const S=(v[w]??v[m]).replace("{0}",of(w)).replace("{1}",g);u+=`	${S}
`}}const d={};for(const m of e){const v=m.source.split(":"),w=m.target.split(":"),_=v.filter((y,p)=>y===w[p]).join(":");d[_]||(d[_]=[]),d[_].push(m)}const h=new Set;function f(m,v){const w=m.length===1&&m[0].source===m[0].target;if(v&&!w){const _=v.split(":").pop();if(h.has(_))throw new Error(`Found duplicate subgraph '${_}' -- this likely means that you're reusing a subgraph node with the same name. Please adjust your graph to have subgraph nodes with unique names.`);h.add(_),u+=`	subgraph ${_}
`}for(const _ of m){const{source:y,target:p,data:g,conditional:S}=_;let N="";if(g!==void 0){let T=g;const A=T.split(" ");A.length>l&&(T=Array.from({length:Math.ceil(A.length/l)},(x,j)=>A.slice(j*l,(j+1)*l).join(" ")).join("&nbsp;<br>&nbsp;")),N=S?` -. &nbsp;${T}&nbsp; .-> `:` -- &nbsp;${T}&nbsp; --> `}else N=S?" -.-> ":" --> ";u+=`	${of(y)}${N}${of(p)};
`}for(const _ in d)_.startsWith(`${v}:`)&&_!==v&&f(d[_],_);v&&!w&&(u+=`	end
`)}f(d[""]??[],"");for(const m in d)!m.includes(":")&&m!==""&&f(d[m],m);return i&&(u+=H4(a??{})),u}async function V4(t,e){let n=(e==null?void 0:e.backgroundColor)??"white";const r=(e==null?void 0:e.imageType)??"png",s=btoa(t);n!==void 0&&(/^#(?:[0-9a-fA-F]{3}){1,2}$/.test(n)||(n=`!${n}`));const a=`https://mermaid.ink/img/${s}?bgColor=${n}&type=${r}`,i=await fetch(a);if(!i.ok)throw new Error(["Failed to render the graph using the Mermaid.INK API.",`Status code: ${i.status}`,`Status text: ${i.statusText}`].join(`
`));return await i.blob()}const q4=Symbol("Let zodToJsonSchema decide on which parser to use"),Z4={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref",openAiAnyTypeName:"OpenAiAnyType"},K4=t=>({...Z4,...t}),J4=t=>{const e=K4(t),n=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,flags:{hasReferencedOpenAiAnyType:!1},currentPath:n,propertyPath:void 0,seen:new Map(Object.entries(e.definitions).map(([r,s])=>[s._def,{def:s._def,path:[...e.basePath,e.definitionPath,r],jsonSchema:void 0}]))}},Jk=(t,e)=>{let n=0;for(;n<t.length&&n<e.length&&t[n]===e[n];n++);return[(t.length-n).toString(),...e.slice(n)].join("/")};function Sn(t){if(t.target!=="openAi")return{};const e=[...t.basePath,t.definitionPath,t.openAiAnyTypeName];return t.flags.hasReferencedOpenAiAnyType=!0,{$ref:t.$refStrategy==="relative"?Jk(e,t.currentPath):e.join("/")}}function Yk(t,e,n,r){r!=null&&r.errorMessages&&n&&(t.errorMessage={...t.errorMessage,[e]:n})}function Ue(t,e,n,r,s){t[e]=n,Yk(t,e,r,s)}var Le;(function(t){t.assertEqual=s=>{};function e(s){}t.assertIs=e;function n(s){throw new Error}t.assertNever=n,t.arrayToEnum=s=>{const a={};for(const i of s)a[i]=i;return a},t.getValidEnumValues=s=>{const a=t.objectKeys(s).filter(o=>typeof s[s[o]]!="number"),i={};for(const o of a)i[o]=s[o];return t.objectValues(i)},t.objectValues=s=>t.objectKeys(s).map(function(a){return s[a]}),t.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const a=[];for(const i in s)Object.prototype.hasOwnProperty.call(s,i)&&a.push(i);return a},t.find=(s,a)=>{for(const i of s)if(a(i))return i},t.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&Number.isFinite(s)&&Math.floor(s)===s;function r(s,a=" | "){return s.map(i=>typeof i=="string"?`'${i}'`:i).join(a)}t.joinValues=r,t.jsonStringifyReplacer=(s,a)=>typeof a=="bigint"?a.toString():a})(Le||(Le={}));var L_;(function(t){t.mergeShapes=(e,n)=>({...e,...n})})(L_||(L_={}));const ae=Le.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),ms=t=>{switch(typeof t){case"undefined":return ae.undefined;case"string":return ae.string;case"number":return Number.isNaN(t)?ae.nan:ae.number;case"boolean":return ae.boolean;case"function":return ae.function;case"bigint":return ae.bigint;case"symbol":return ae.symbol;case"object":return Array.isArray(t)?ae.array:t===null?ae.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?ae.promise:typeof Map<"u"&&t instanceof Map?ae.map:typeof Set<"u"&&t instanceof Set?ae.set:typeof Date<"u"&&t instanceof Date?ae.date:ae.object;default:return ae.unknown}},H=Le.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class ts extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=e}format(e){const n=e||function(a){return a.message},r={_errors:[]},s=a=>{for(const i of a.issues)if(i.code==="invalid_union")i.unionErrors.map(s);else if(i.code==="invalid_return_type")s(i.returnTypeError);else if(i.code==="invalid_arguments")s(i.argumentsError);else if(i.path.length===0)r._errors.push(n(i));else{let o=r,l=0;for(;l<i.path.length;){const u=i.path[l];l===i.path.length-1?(o[u]=o[u]||{_errors:[]},o[u]._errors.push(n(i))):o[u]=o[u]||{_errors:[]},o=o[u],l++}}};return s(this),r}static assert(e){if(!(e instanceof ts))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Le.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=n=>n.message){const n=Object.create(null),r=[];for(const s of this.issues)if(s.path.length>0){const a=s.path[0];n[a]=n[a]||[],n[a].push(e(s))}else r.push(e(s));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}ts.create=t=>new ts(t);const Gm=(t,e)=>{let n;switch(t.code){case H.invalid_type:t.received===ae.undefined?n="Required":n=`Expected ${t.expected}, received ${t.received}`;break;case H.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(t.expected,Le.jsonStringifyReplacer)}`;break;case H.unrecognized_keys:n=`Unrecognized key(s) in object: ${Le.joinValues(t.keys,", ")}`;break;case H.invalid_union:n="Invalid input";break;case H.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${Le.joinValues(t.options)}`;break;case H.invalid_enum_value:n=`Invalid enum value. Expected ${Le.joinValues(t.options)}, received '${t.received}'`;break;case H.invalid_arguments:n="Invalid function arguments";break;case H.invalid_return_type:n="Invalid function return type";break;case H.invalid_date:n="Invalid date";break;case H.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(n=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?n=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?n=`Invalid input: must end with "${t.validation.endsWith}"`:Le.assertNever(t.validation):t.validation!=="regex"?n=`Invalid ${t.validation}`:n="Invalid";break;case H.too_small:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="bigint"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:n="Invalid input";break;case H.too_big:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?n=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:n="Invalid input";break;case H.custom:n="Invalid input";break;case H.invalid_intersection_types:n="Intersection results could not be merged";break;case H.not_multiple_of:n=`Number must be a multiple of ${t.multipleOf}`;break;case H.not_finite:n="Number must be finite";break;default:n=e.defaultError,Le.assertNever(t)}return{message:n}};let Y4=Gm;function Q4(){return Y4}const X4=t=>{const{data:e,path:n,errorMaps:r,issueData:s}=t,a=[...n,...s.path||[]],i={...s,path:a};if(s.message!==void 0)return{...s,path:a,message:s.message};let o="";const l=r.filter(u=>!!u).slice().reverse();for(const u of l)o=u(i,{data:e,defaultError:o}).message;return{...s,path:a,message:o}};function Q(t,e){const n=Q4(),r=X4({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,n,n===Gm?void 0:Gm].filter(s=>!!s)});t.common.issues.push(r)}class kn{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,n){const r=[];for(const s of n){if(s.status==="aborted")return Se;s.status==="dirty"&&e.dirty(),r.push(s.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,n){const r=[];for(const s of n){const a=await s.key,i=await s.value;r.push({key:a,value:i})}return kn.mergeObjectSync(e,r)}static mergeObjectSync(e,n){const r={};for(const s of n){const{key:a,value:i}=s;if(a.status==="aborted"||i.status==="aborted")return Se;a.status==="dirty"&&e.dirty(),i.status==="dirty"&&e.dirty(),a.value!=="__proto__"&&(typeof i.value<"u"||s.alwaysSet)&&(r[a.value]=i.value)}return{status:e.value,value:r}}}const Se=Object.freeze({status:"aborted"}),co=t=>({status:"dirty",value:t}),Fn=t=>({status:"valid",value:t}),D_=t=>t.status==="aborted",M_=t=>t.status==="dirty",fi=t=>t.status==="valid",Lu=t=>typeof Promise<"u"&&t instanceof Promise;var ie;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(ie||(ie={}));class Ms{constructor(e,n,r,s){this._cachedPath=[],this.parent=e,this.data=n,this._path=r,this._key=s}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const F_=(t,e)=>{if(fi(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new ts(t.common.issues);return this._error=n,this._error}}};function Ce(t){if(!t)return{};const{errorMap:e,invalid_type_error:n,required_error:r,description:s}=t;if(e&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(i,o)=>{const{message:l}=t;return i.code==="invalid_enum_value"?{message:l??o.defaultError}:typeof o.data>"u"?{message:l??r??o.defaultError}:i.code!=="invalid_type"?{message:o.defaultError}:{message:l??n??o.defaultError}},description:s}}class Oe{get description(){return this._def.description}_getType(e){return ms(e.data)}_getOrReturnCtx(e,n){return n||{common:e.parent.common,data:e.data,parsedType:ms(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new kn,ctx:{common:e.parent.common,data:e.data,parsedType:ms(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const n=this._parse(e);if(Lu(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(e){const n=this._parse(e);return Promise.resolve(n)}parse(e,n){const r=this.safeParse(e,n);if(r.success)return r.data;throw r.error}safeParse(e,n){const r={common:{issues:[],async:(n==null?void 0:n.async)??!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ms(e)},s=this._parseSync({data:e,path:r.path,parent:r});return F_(r,s)}"~validate"(e){var r,s;const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ms(e)};if(!this["~standard"].async)try{const a=this._parseSync({data:e,path:[],parent:n});return fi(a)?{value:a.value}:{issues:n.common.issues}}catch(a){(s=(r=a==null?void 0:a.message)==null?void 0:r.toLowerCase())!=null&&s.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:n}).then(a=>fi(a)?{value:a.value}:{issues:n.common.issues})}async parseAsync(e,n){const r=await this.safeParseAsync(e,n);if(r.success)return r.data;throw r.error}async safeParseAsync(e,n){const r={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ms(e)},s=this._parse({data:e,path:r.path,parent:r}),a=await(Lu(s)?s:Promise.resolve(s));return F_(r,a)}refine(e,n){const r=s=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(s):n;return this._refinement((s,a)=>{const i=e(s),o=()=>a.addIssue({code:H.custom,...r(s)});return typeof Promise<"u"&&i instanceof Promise?i.then(l=>l?!0:(o(),!1)):i?!0:(o(),!1)})}refinement(e,n){return this._refinement((r,s)=>e(r)?!0:(s.addIssue(typeof n=="function"?n(r,s):n),!1))}_refinement(e){return new pi({schema:this,typeName:P.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return Os.create(this,this._def)}nullable(){return gi.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Ar.create(this)}promise(){return zu.create(this,this._def)}or(e){return Mu.create([this,e],this._def)}and(e){return Fu.create(this,e,this._def)}transform(e){return new pi({...Ce(this._def),schema:this,typeName:P.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const n=typeof e=="function"?e:()=>e;return new Vm({...Ce(this._def),innerType:this,defaultValue:n,typeName:P.ZodDefault})}brand(){return new bL({typeName:P.ZodBranded,type:this,...Ce(this._def)})}catch(e){const n=typeof e=="function"?e:()=>e;return new qm({...Ce(this._def),innerType:this,catchValue:n,typeName:P.ZodCatch})}describe(e){const n=this.constructor;return new n({...this._def,description:e})}pipe(e){return ry.create(this,e)}readonly(){return Zm.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const eL=/^c[^\s-]{8,}$/i,tL=/^[0-9a-z]+$/,nL=/^[0-9A-HJKMNP-TV-Z]{26}$/i,rL=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,sL=/^[a-z0-9_-]{21}$/i,aL=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,iL=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,oL=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,lL="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let lf;const cL=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,uL=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,dL=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,hL=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,fL=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,mL=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Qk="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",pL=new RegExp(`^${Qk}$`);function Xk(t){let e="[0-5]\\d";t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`);const n=t.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${n}`}function gL(t){return new RegExp(`^${Xk(t)}$`)}function yL(t){let e=`${Qk}T${Xk(t)}`;const n=[];return n.push(t.local?"Z?":"Z"),t.offset&&n.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${n.join("|")})`,new RegExp(`^${e}$`)}function vL(t,e){return!!((e==="v4"||!e)&&cL.test(t)||(e==="v6"||!e)&&dL.test(t))}function _L(t,e){if(!aL.test(t))return!1;try{const[n]=t.split(".");if(!n)return!1;const r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),s=JSON.parse(atob(r));return!(typeof s!="object"||s===null||"typ"in s&&(s==null?void 0:s.typ)!=="JWT"||!s.alg||e&&s.alg!==e)}catch{return!1}}function wL(t,e){return!!((e==="v4"||!e)&&uL.test(t)||(e==="v6"||!e)&&hL.test(t))}class bs extends Oe{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==ae.string){const a=this._getOrReturnCtx(e);return Q(a,{code:H.invalid_type,expected:ae.string,received:a.parsedType}),Se}const r=new kn;let s;for(const a of this._def.checks)if(a.kind==="min")e.data.length<a.value&&(s=this._getOrReturnCtx(e,s),Q(s,{code:H.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),r.dirty());else if(a.kind==="max")e.data.length>a.value&&(s=this._getOrReturnCtx(e,s),Q(s,{code:H.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),r.dirty());else if(a.kind==="length"){const i=e.data.length>a.value,o=e.data.length<a.value;(i||o)&&(s=this._getOrReturnCtx(e,s),i?Q(s,{code:H.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):o&&Q(s,{code:H.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),r.dirty())}else if(a.kind==="email")oL.test(e.data)||(s=this._getOrReturnCtx(e,s),Q(s,{validation:"email",code:H.invalid_string,message:a.message}),r.dirty());else if(a.kind==="emoji")lf||(lf=new RegExp(lL,"u")),lf.test(e.data)||(s=this._getOrReturnCtx(e,s),Q(s,{validation:"emoji",code:H.invalid_string,message:a.message}),r.dirty());else if(a.kind==="uuid")rL.test(e.data)||(s=this._getOrReturnCtx(e,s),Q(s,{validation:"uuid",code:H.invalid_string,message:a.message}),r.dirty());else if(a.kind==="nanoid")sL.test(e.data)||(s=this._getOrReturnCtx(e,s),Q(s,{validation:"nanoid",code:H.invalid_string,message:a.message}),r.dirty());else if(a.kind==="cuid")eL.test(e.data)||(s=this._getOrReturnCtx(e,s),Q(s,{validation:"cuid",code:H.invalid_string,message:a.message}),r.dirty());else if(a.kind==="cuid2")tL.test(e.data)||(s=this._getOrReturnCtx(e,s),Q(s,{validation:"cuid2",code:H.invalid_string,message:a.message}),r.dirty());else if(a.kind==="ulid")nL.test(e.data)||(s=this._getOrReturnCtx(e,s),Q(s,{validation:"ulid",code:H.invalid_string,message:a.message}),r.dirty());else if(a.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),Q(s,{validation:"url",code:H.invalid_string,message:a.message}),r.dirty()}else a.kind==="regex"?(a.regex.lastIndex=0,a.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),Q(s,{validation:"regex",code:H.invalid_string,message:a.message}),r.dirty())):a.kind==="trim"?e.data=e.data.trim():a.kind==="includes"?e.data.includes(a.value,a.position)||(s=this._getOrReturnCtx(e,s),Q(s,{code:H.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),r.dirty()):a.kind==="toLowerCase"?e.data=e.data.toLowerCase():a.kind==="toUpperCase"?e.data=e.data.toUpperCase():a.kind==="startsWith"?e.data.startsWith(a.value)||(s=this._getOrReturnCtx(e,s),Q(s,{code:H.invalid_string,validation:{startsWith:a.value},message:a.message}),r.dirty()):a.kind==="endsWith"?e.data.endsWith(a.value)||(s=this._getOrReturnCtx(e,s),Q(s,{code:H.invalid_string,validation:{endsWith:a.value},message:a.message}),r.dirty()):a.kind==="datetime"?yL(a).test(e.data)||(s=this._getOrReturnCtx(e,s),Q(s,{code:H.invalid_string,validation:"datetime",message:a.message}),r.dirty()):a.kind==="date"?pL.test(e.data)||(s=this._getOrReturnCtx(e,s),Q(s,{code:H.invalid_string,validation:"date",message:a.message}),r.dirty()):a.kind==="time"?gL(a).test(e.data)||(s=this._getOrReturnCtx(e,s),Q(s,{code:H.invalid_string,validation:"time",message:a.message}),r.dirty()):a.kind==="duration"?iL.test(e.data)||(s=this._getOrReturnCtx(e,s),Q(s,{validation:"duration",code:H.invalid_string,message:a.message}),r.dirty()):a.kind==="ip"?vL(e.data,a.version)||(s=this._getOrReturnCtx(e,s),Q(s,{validation:"ip",code:H.invalid_string,message:a.message}),r.dirty()):a.kind==="jwt"?_L(e.data,a.alg)||(s=this._getOrReturnCtx(e,s),Q(s,{validation:"jwt",code:H.invalid_string,message:a.message}),r.dirty()):a.kind==="cidr"?wL(e.data,a.version)||(s=this._getOrReturnCtx(e,s),Q(s,{validation:"cidr",code:H.invalid_string,message:a.message}),r.dirty()):a.kind==="base64"?fL.test(e.data)||(s=this._getOrReturnCtx(e,s),Q(s,{validation:"base64",code:H.invalid_string,message:a.message}),r.dirty()):a.kind==="base64url"?mL.test(e.data)||(s=this._getOrReturnCtx(e,s),Q(s,{validation:"base64url",code:H.invalid_string,message:a.message}),r.dirty()):Le.assertNever(a);return{status:r.value,value:e.data}}_regex(e,n,r){return this.refinement(s=>e.test(s),{validation:n,code:H.invalid_string,...ie.errToObj(r)})}_addCheck(e){return new bs({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...ie.errToObj(e)})}url(e){return this._addCheck({kind:"url",...ie.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...ie.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...ie.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...ie.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...ie.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...ie.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...ie.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...ie.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...ie.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...ie.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...ie.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...ie.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(e==null?void 0:e.offset)??!1,local:(e==null?void 0:e.local)??!1,...ie.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...ie.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...ie.errToObj(e)})}regex(e,n){return this._addCheck({kind:"regex",regex:e,...ie.errToObj(n)})}includes(e,n){return this._addCheck({kind:"includes",value:e,position:n==null?void 0:n.position,...ie.errToObj(n==null?void 0:n.message)})}startsWith(e,n){return this._addCheck({kind:"startsWith",value:e,...ie.errToObj(n)})}endsWith(e,n){return this._addCheck({kind:"endsWith",value:e,...ie.errToObj(n)})}min(e,n){return this._addCheck({kind:"min",value:e,...ie.errToObj(n)})}max(e,n){return this._addCheck({kind:"max",value:e,...ie.errToObj(n)})}length(e,n){return this._addCheck({kind:"length",value:e,...ie.errToObj(n)})}nonempty(e){return this.min(1,ie.errToObj(e))}trim(){return new bs({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new bs({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new bs({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxLength(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}bs.create=t=>new bs({checks:[],typeName:P.ZodString,coerce:(t==null?void 0:t.coerce)??!1,...Ce(t)});function xL(t,e){const n=(t.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,s=n>r?n:r,a=Number.parseInt(t.toFixed(s).replace(".","")),i=Number.parseInt(e.toFixed(s).replace(".",""));return a%i/10**s}class ol extends Oe{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==ae.number){const a=this._getOrReturnCtx(e);return Q(a,{code:H.invalid_type,expected:ae.number,received:a.parsedType}),Se}let r;const s=new kn;for(const a of this._def.checks)a.kind==="int"?Le.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),Q(r,{code:H.invalid_type,expected:"integer",received:"float",message:a.message}),s.dirty()):a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(r=this._getOrReturnCtx(e,r),Q(r,{code:H.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),s.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(r=this._getOrReturnCtx(e,r),Q(r,{code:H.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),s.dirty()):a.kind==="multipleOf"?xL(e.data,a.value)!==0&&(r=this._getOrReturnCtx(e,r),Q(r,{code:H.not_multiple_of,multipleOf:a.value,message:a.message}),s.dirty()):a.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),Q(r,{code:H.not_finite,message:a.message}),s.dirty()):Le.assertNever(a);return{status:s.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,ie.toString(n))}gt(e,n){return this.setLimit("min",e,!1,ie.toString(n))}lte(e,n){return this.setLimit("max",e,!0,ie.toString(n))}lt(e,n){return this.setLimit("max",e,!1,ie.toString(n))}setLimit(e,n,r,s){return new ol({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:ie.toString(s)}]})}_addCheck(e){return new ol({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:ie.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:ie.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:ie.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:ie.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:ie.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:ie.toString(n)})}finite(e){return this._addCheck({kind:"finite",message:ie.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:ie.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:ie.toString(e)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Le.isInteger(e.value))}get isFinite(){let e=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(n)&&Number.isFinite(e)}}ol.create=t=>new ol({checks:[],typeName:P.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...Ce(t)});class ll extends Oe{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==ae.bigint)return this._getInvalidInput(e);let r;const s=new kn;for(const a of this._def.checks)a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(r=this._getOrReturnCtx(e,r),Q(r,{code:H.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),s.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(r=this._getOrReturnCtx(e,r),Q(r,{code:H.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),s.dirty()):a.kind==="multipleOf"?e.data%a.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),Q(r,{code:H.not_multiple_of,multipleOf:a.value,message:a.message}),s.dirty()):Le.assertNever(a);return{status:s.value,value:e.data}}_getInvalidInput(e){const n=this._getOrReturnCtx(e);return Q(n,{code:H.invalid_type,expected:ae.bigint,received:n.parsedType}),Se}gte(e,n){return this.setLimit("min",e,!0,ie.toString(n))}gt(e,n){return this.setLimit("min",e,!1,ie.toString(n))}lte(e,n){return this.setLimit("max",e,!0,ie.toString(n))}lt(e,n){return this.setLimit("max",e,!1,ie.toString(n))}setLimit(e,n,r,s){return new ll({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:ie.toString(s)}]})}_addCheck(e){return new ll({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:ie.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:ie.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:ie.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:ie.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:ie.toString(n)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}ll.create=t=>new ll({checks:[],typeName:P.ZodBigInt,coerce:(t==null?void 0:t.coerce)??!1,...Ce(t)});class z_ extends Oe{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==ae.boolean){const r=this._getOrReturnCtx(e);return Q(r,{code:H.invalid_type,expected:ae.boolean,received:r.parsedType}),Se}return Fn(e.data)}}z_.create=t=>new z_({typeName:P.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...Ce(t)});class Du extends Oe{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==ae.date){const a=this._getOrReturnCtx(e);return Q(a,{code:H.invalid_type,expected:ae.date,received:a.parsedType}),Se}if(Number.isNaN(e.data.getTime())){const a=this._getOrReturnCtx(e);return Q(a,{code:H.invalid_date}),Se}const r=new kn;let s;for(const a of this._def.checks)a.kind==="min"?e.data.getTime()<a.value&&(s=this._getOrReturnCtx(e,s),Q(s,{code:H.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),r.dirty()):a.kind==="max"?e.data.getTime()>a.value&&(s=this._getOrReturnCtx(e,s),Q(s,{code:H.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),r.dirty()):Le.assertNever(a);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Du({...this._def,checks:[...this._def.checks,e]})}min(e,n){return this._addCheck({kind:"min",value:e.getTime(),message:ie.toString(n)})}max(e,n){return this._addCheck({kind:"max",value:e.getTime(),message:ie.toString(n)})}get minDate(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e!=null?new Date(e):null}}Du.create=t=>new Du({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:P.ZodDate,...Ce(t)});class U_ extends Oe{_parse(e){if(this._getType(e)!==ae.symbol){const r=this._getOrReturnCtx(e);return Q(r,{code:H.invalid_type,expected:ae.symbol,received:r.parsedType}),Se}return Fn(e.data)}}U_.create=t=>new U_({typeName:P.ZodSymbol,...Ce(t)});class B_ extends Oe{_parse(e){if(this._getType(e)!==ae.undefined){const r=this._getOrReturnCtx(e);return Q(r,{code:H.invalid_type,expected:ae.undefined,received:r.parsedType}),Se}return Fn(e.data)}}B_.create=t=>new B_({typeName:P.ZodUndefined,...Ce(t)});class G_ extends Oe{_parse(e){if(this._getType(e)!==ae.null){const r=this._getOrReturnCtx(e);return Q(r,{code:H.invalid_type,expected:ae.null,received:r.parsedType}),Se}return Fn(e.data)}}G_.create=t=>new G_({typeName:P.ZodNull,...Ce(t)});class Hm extends Oe{constructor(){super(...arguments),this._any=!0}_parse(e){return Fn(e.data)}}Hm.create=t=>new Hm({typeName:P.ZodAny,...Ce(t)});class H_ extends Oe{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Fn(e.data)}}H_.create=t=>new H_({typeName:P.ZodUnknown,...Ce(t)});class Fs extends Oe{_parse(e){const n=this._getOrReturnCtx(e);return Q(n,{code:H.invalid_type,expected:ae.never,received:n.parsedType}),Se}}Fs.create=t=>new Fs({typeName:P.ZodNever,...Ce(t)});class W_ extends Oe{_parse(e){if(this._getType(e)!==ae.undefined){const r=this._getOrReturnCtx(e);return Q(r,{code:H.invalid_type,expected:ae.void,received:r.parsedType}),Se}return Fn(e.data)}}W_.create=t=>new W_({typeName:P.ZodVoid,...Ce(t)});class Ar extends Oe{_parse(e){const{ctx:n,status:r}=this._processInputParams(e),s=this._def;if(n.parsedType!==ae.array)return Q(n,{code:H.invalid_type,expected:ae.array,received:n.parsedType}),Se;if(s.exactLength!==null){const i=n.data.length>s.exactLength.value,o=n.data.length<s.exactLength.value;(i||o)&&(Q(n,{code:i?H.too_big:H.too_small,minimum:o?s.exactLength.value:void 0,maximum:i?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),r.dirty())}if(s.minLength!==null&&n.data.length<s.minLength.value&&(Q(n,{code:H.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),r.dirty()),s.maxLength!==null&&n.data.length>s.maxLength.value&&(Q(n,{code:H.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((i,o)=>s.type._parseAsync(new Ms(n,i,n.path,o)))).then(i=>kn.mergeArray(r,i));const a=[...n.data].map((i,o)=>s.type._parseSync(new Ms(n,i,n.path,o)));return kn.mergeArray(r,a)}get element(){return this._def.type}min(e,n){return new Ar({...this._def,minLength:{value:e,message:ie.toString(n)}})}max(e,n){return new Ar({...this._def,maxLength:{value:e,message:ie.toString(n)}})}length(e,n){return new Ar({...this._def,exactLength:{value:e,message:ie.toString(n)}})}nonempty(e){return this.min(1,e)}}Ar.create=(t,e)=>new Ar({type:t,minLength:null,maxLength:null,exactLength:null,typeName:P.ZodArray,...Ce(e)});function Oa(t){if(t instanceof ot){const e={};for(const n in t.shape){const r=t.shape[n];e[n]=Os.create(Oa(r))}return new ot({...t._def,shape:()=>e})}else return t instanceof Ar?new Ar({...t._def,type:Oa(t.element)}):t instanceof Os?Os.create(Oa(t.unwrap())):t instanceof gi?gi.create(Oa(t.unwrap())):t instanceof va?va.create(t.items.map(e=>Oa(e))):t}class ot extends Oe{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),n=Le.objectKeys(e);return this._cached={shape:e,keys:n},this._cached}_parse(e){if(this._getType(e)!==ae.object){const u=this._getOrReturnCtx(e);return Q(u,{code:H.invalid_type,expected:ae.object,received:u.parsedType}),Se}const{status:r,ctx:s}=this._processInputParams(e),{shape:a,keys:i}=this._getCached(),o=[];if(!(this._def.catchall instanceof Fs&&this._def.unknownKeys==="strip"))for(const u in s.data)i.includes(u)||o.push(u);const l=[];for(const u of i){const d=a[u],h=s.data[u];l.push({key:{status:"valid",value:u},value:d._parse(new Ms(s,h,s.path,u)),alwaysSet:u in s.data})}if(this._def.catchall instanceof Fs){const u=this._def.unknownKeys;if(u==="passthrough")for(const d of o)l.push({key:{status:"valid",value:d},value:{status:"valid",value:s.data[d]}});else if(u==="strict")o.length>0&&(Q(s,{code:H.unrecognized_keys,keys:o}),r.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const u=this._def.catchall;for(const d of o){const h=s.data[d];l.push({key:{status:"valid",value:d},value:u._parse(new Ms(s,h,s.path,d)),alwaysSet:d in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const u=[];for(const d of l){const h=await d.key,f=await d.value;u.push({key:h,value:f,alwaysSet:d.alwaysSet})}return u}).then(u=>kn.mergeObjectSync(r,u)):kn.mergeObjectSync(r,l)}get shape(){return this._def.shape()}strict(e){return ie.errToObj,new ot({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(n,r)=>{var a,i;const s=((i=(a=this._def).errorMap)==null?void 0:i.call(a,n,r).message)??r.defaultError;return n.code==="unrecognized_keys"?{message:ie.errToObj(e).message??s}:{message:s}}}:{}})}strip(){return new ot({...this._def,unknownKeys:"strip"})}passthrough(){return new ot({...this._def,unknownKeys:"passthrough"})}extend(e){return new ot({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new ot({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:P.ZodObject})}setKey(e,n){return this.augment({[e]:n})}catchall(e){return new ot({...this._def,catchall:e})}pick(e){const n={};for(const r of Le.objectKeys(e))e[r]&&this.shape[r]&&(n[r]=this.shape[r]);return new ot({...this._def,shape:()=>n})}omit(e){const n={};for(const r of Le.objectKeys(this.shape))e[r]||(n[r]=this.shape[r]);return new ot({...this._def,shape:()=>n})}deepPartial(){return Oa(this)}partial(e){const n={};for(const r of Le.objectKeys(this.shape)){const s=this.shape[r];e&&!e[r]?n[r]=s:n[r]=s.optional()}return new ot({...this._def,shape:()=>n})}required(e){const n={};for(const r of Le.objectKeys(this.shape))if(e&&!e[r])n[r]=this.shape[r];else{let a=this.shape[r];for(;a instanceof Os;)a=a._def.innerType;n[r]=a}return new ot({...this._def,shape:()=>n})}keyof(){return eE(Le.objectKeys(this.shape))}}ot.create=(t,e)=>new ot({shape:()=>t,unknownKeys:"strip",catchall:Fs.create(),typeName:P.ZodObject,...Ce(e)});ot.strictCreate=(t,e)=>new ot({shape:()=>t,unknownKeys:"strict",catchall:Fs.create(),typeName:P.ZodObject,...Ce(e)});ot.lazycreate=(t,e)=>new ot({shape:t,unknownKeys:"strip",catchall:Fs.create(),typeName:P.ZodObject,...Ce(e)});class Mu extends Oe{_parse(e){const{ctx:n}=this._processInputParams(e),r=this._def.options;function s(a){for(const o of a)if(o.result.status==="valid")return o.result;for(const o of a)if(o.result.status==="dirty")return n.common.issues.push(...o.ctx.common.issues),o.result;const i=a.map(o=>new ts(o.ctx.common.issues));return Q(n,{code:H.invalid_union,unionErrors:i}),Se}if(n.common.async)return Promise.all(r.map(async a=>{const i={...n,common:{...n.common,issues:[]},parent:null};return{result:await a._parseAsync({data:n.data,path:n.path,parent:i}),ctx:i}})).then(s);{let a;const i=[];for(const l of r){const u={...n,common:{...n.common,issues:[]},parent:null},d=l._parseSync({data:n.data,path:n.path,parent:u});if(d.status==="valid")return d;d.status==="dirty"&&!a&&(a={result:d,ctx:u}),u.common.issues.length&&i.push(u.common.issues)}if(a)return n.common.issues.push(...a.ctx.common.issues),a.result;const o=i.map(l=>new ts(l));return Q(n,{code:H.invalid_union,unionErrors:o}),Se}}get options(){return this._def.options}}Mu.create=(t,e)=>new Mu({options:t,typeName:P.ZodUnion,...Ce(e)});function Wm(t,e){const n=ms(t),r=ms(e);if(t===e)return{valid:!0,data:t};if(n===ae.object&&r===ae.object){const s=Le.objectKeys(e),a=Le.objectKeys(t).filter(o=>s.indexOf(o)!==-1),i={...t,...e};for(const o of a){const l=Wm(t[o],e[o]);if(!l.valid)return{valid:!1};i[o]=l.data}return{valid:!0,data:i}}else if(n===ae.array&&r===ae.array){if(t.length!==e.length)return{valid:!1};const s=[];for(let a=0;a<t.length;a++){const i=t[a],o=e[a],l=Wm(i,o);if(!l.valid)return{valid:!1};s.push(l.data)}return{valid:!0,data:s}}else return n===ae.date&&r===ae.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class Fu extends Oe{_parse(e){const{status:n,ctx:r}=this._processInputParams(e),s=(a,i)=>{if(D_(a)||D_(i))return Se;const o=Wm(a.value,i.value);return o.valid?((M_(a)||M_(i))&&n.dirty(),{status:n.value,value:o.data}):(Q(r,{code:H.invalid_intersection_types}),Se)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([a,i])=>s(a,i)):s(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}Fu.create=(t,e,n)=>new Fu({left:t,right:e,typeName:P.ZodIntersection,...Ce(n)});class va extends Oe{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==ae.array)return Q(r,{code:H.invalid_type,expected:ae.array,received:r.parsedType}),Se;if(r.data.length<this._def.items.length)return Q(r,{code:H.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Se;!this._def.rest&&r.data.length>this._def.items.length&&(Q(r,{code:H.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const a=[...r.data].map((i,o)=>{const l=this._def.items[o]||this._def.rest;return l?l._parse(new Ms(r,i,r.path,o)):null}).filter(i=>!!i);return r.common.async?Promise.all(a).then(i=>kn.mergeArray(n,i)):kn.mergeArray(n,a)}get items(){return this._def.items}rest(e){return new va({...this._def,rest:e})}}va.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new va({items:t,typeName:P.ZodTuple,rest:null,...Ce(e)})};class V_ extends Oe{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==ae.map)return Q(r,{code:H.invalid_type,expected:ae.map,received:r.parsedType}),Se;const s=this._def.keyType,a=this._def.valueType,i=[...r.data.entries()].map(([o,l],u)=>({key:s._parse(new Ms(r,o,r.path,[u,"key"])),value:a._parse(new Ms(r,l,r.path,[u,"value"]))}));if(r.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const l of i){const u=await l.key,d=await l.value;if(u.status==="aborted"||d.status==="aborted")return Se;(u.status==="dirty"||d.status==="dirty")&&n.dirty(),o.set(u.value,d.value)}return{status:n.value,value:o}})}else{const o=new Map;for(const l of i){const u=l.key,d=l.value;if(u.status==="aborted"||d.status==="aborted")return Se;(u.status==="dirty"||d.status==="dirty")&&n.dirty(),o.set(u.value,d.value)}return{status:n.value,value:o}}}}V_.create=(t,e,n)=>new V_({valueType:e,keyType:t,typeName:P.ZodMap,...Ce(n)});class cl extends Oe{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==ae.set)return Q(r,{code:H.invalid_type,expected:ae.set,received:r.parsedType}),Se;const s=this._def;s.minSize!==null&&r.data.size<s.minSize.value&&(Q(r,{code:H.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),n.dirty()),s.maxSize!==null&&r.data.size>s.maxSize.value&&(Q(r,{code:H.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),n.dirty());const a=this._def.valueType;function i(l){const u=new Set;for(const d of l){if(d.status==="aborted")return Se;d.status==="dirty"&&n.dirty(),u.add(d.value)}return{status:n.value,value:u}}const o=[...r.data.values()].map((l,u)=>a._parse(new Ms(r,l,r.path,u)));return r.common.async?Promise.all(o).then(l=>i(l)):i(o)}min(e,n){return new cl({...this._def,minSize:{value:e,message:ie.toString(n)}})}max(e,n){return new cl({...this._def,maxSize:{value:e,message:ie.toString(n)}})}size(e,n){return this.min(e,n).max(e,n)}nonempty(e){return this.min(1,e)}}cl.create=(t,e)=>new cl({valueType:t,minSize:null,maxSize:null,typeName:P.ZodSet,...Ce(e)});class q_ extends Oe{get schema(){return this._def.getter()}_parse(e){const{ctx:n}=this._processInputParams(e);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}q_.create=(t,e)=>new q_({getter:t,typeName:P.ZodLazy,...Ce(e)});class Z_ extends Oe{_parse(e){if(e.data!==this._def.value){const n=this._getOrReturnCtx(e);return Q(n,{received:n.data,code:H.invalid_literal,expected:this._def.value}),Se}return{status:"valid",value:e.data}}get value(){return this._def.value}}Z_.create=(t,e)=>new Z_({value:t,typeName:P.ZodLiteral,...Ce(e)});function eE(t,e){return new mi({values:t,typeName:P.ZodEnum,...Ce(e)})}class mi extends Oe{_parse(e){if(typeof e.data!="string"){const n=this._getOrReturnCtx(e),r=this._def.values;return Q(n,{expected:Le.joinValues(r),received:n.parsedType,code:H.invalid_type}),Se}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const n=this._getOrReturnCtx(e),r=this._def.values;return Q(n,{received:n.data,code:H.invalid_enum_value,options:r}),Se}return Fn(e.data)}get options(){return this._def.values}get enum(){const e={};for(const n of this._def.values)e[n]=n;return e}get Values(){const e={};for(const n of this._def.values)e[n]=n;return e}get Enum(){const e={};for(const n of this._def.values)e[n]=n;return e}extract(e,n=this._def){return mi.create(e,{...this._def,...n})}exclude(e,n=this._def){return mi.create(this.options.filter(r=>!e.includes(r)),{...this._def,...n})}}mi.create=eE;class K_ extends Oe{_parse(e){const n=Le.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==ae.string&&r.parsedType!==ae.number){const s=Le.objectValues(n);return Q(r,{expected:Le.joinValues(s),received:r.parsedType,code:H.invalid_type}),Se}if(this._cache||(this._cache=new Set(Le.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const s=Le.objectValues(n);return Q(r,{received:r.data,code:H.invalid_enum_value,options:s}),Se}return Fn(e.data)}get enum(){return this._def.values}}K_.create=(t,e)=>new K_({values:t,typeName:P.ZodNativeEnum,...Ce(e)});class zu extends Oe{unwrap(){return this._def.type}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==ae.promise&&n.common.async===!1)return Q(n,{code:H.invalid_type,expected:ae.promise,received:n.parsedType}),Se;const r=n.parsedType===ae.promise?n.data:Promise.resolve(n.data);return Fn(r.then(s=>this._def.type.parseAsync(s,{path:n.path,errorMap:n.common.contextualErrorMap})))}}zu.create=(t,e)=>new zu({type:t,typeName:P.ZodPromise,...Ce(e)});class pi extends Oe{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===P.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:n,ctx:r}=this._processInputParams(e),s=this._def.effect||null,a={addIssue:i=>{Q(r,i),i.fatal?n.abort():n.dirty()},get path(){return r.path}};if(a.addIssue=a.addIssue.bind(a),s.type==="preprocess"){const i=s.transform(r.data,a);if(r.common.async)return Promise.resolve(i).then(async o=>{if(n.value==="aborted")return Se;const l=await this._def.schema._parseAsync({data:o,path:r.path,parent:r});return l.status==="aborted"?Se:l.status==="dirty"||n.value==="dirty"?co(l.value):l});{if(n.value==="aborted")return Se;const o=this._def.schema._parseSync({data:i,path:r.path,parent:r});return o.status==="aborted"?Se:o.status==="dirty"||n.value==="dirty"?co(o.value):o}}if(s.type==="refinement"){const i=o=>{const l=s.refinement(o,a);if(r.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return o.status==="aborted"?Se:(o.status==="dirty"&&n.dirty(),i(o.value),{status:n.value,value:o.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>o.status==="aborted"?Se:(o.status==="dirty"&&n.dirty(),i(o.value).then(()=>({status:n.value,value:o.value}))))}if(s.type==="transform")if(r.common.async===!1){const i=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!fi(i))return Se;const o=s.transform(i.value,a);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:o}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(i=>fi(i)?Promise.resolve(s.transform(i.value,a)).then(o=>({status:n.value,value:o})):Se);Le.assertNever(s)}}pi.create=(t,e,n)=>new pi({schema:t,typeName:P.ZodEffects,effect:e,...Ce(n)});pi.createWithPreprocess=(t,e,n)=>new pi({schema:e,effect:{type:"preprocess",transform:t},typeName:P.ZodEffects,...Ce(n)});class Os extends Oe{_parse(e){return this._getType(e)===ae.undefined?Fn(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Os.create=(t,e)=>new Os({innerType:t,typeName:P.ZodOptional,...Ce(e)});class gi extends Oe{_parse(e){return this._getType(e)===ae.null?Fn(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}gi.create=(t,e)=>new gi({innerType:t,typeName:P.ZodNullable,...Ce(e)});class Vm extends Oe{_parse(e){const{ctx:n}=this._processInputParams(e);let r=n.data;return n.parsedType===ae.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}Vm.create=(t,e)=>new Vm({innerType:t,typeName:P.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Ce(e)});class qm extends Oe{_parse(e){const{ctx:n}=this._processInputParams(e),r={...n,common:{...n.common,issues:[]}},s=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return Lu(s)?s.then(a=>({status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new ts(r.common.issues)},input:r.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new ts(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}qm.create=(t,e)=>new qm({innerType:t,typeName:P.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Ce(e)});class J_ extends Oe{_parse(e){if(this._getType(e)!==ae.nan){const r=this._getOrReturnCtx(e);return Q(r,{code:H.invalid_type,expected:ae.nan,received:r.parsedType}),Se}return{status:"valid",value:e.data}}}J_.create=t=>new J_({typeName:P.ZodNaN,...Ce(t)});class bL extends Oe{_parse(e){const{ctx:n}=this._processInputParams(e),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class ry extends Oe{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const a=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?Se:a.status==="dirty"?(n.dirty(),co(a.value)):this._def.out._parseAsync({data:a.value,path:r.path,parent:r})})();{const s=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?Se:s.status==="dirty"?(n.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:r.path,parent:r})}}static create(e,n){return new ry({in:e,out:n,typeName:P.ZodPipeline})}}class Zm extends Oe{_parse(e){const n=this._def.innerType._parse(e),r=s=>(fi(s)&&(s.value=Object.freeze(s.value)),s);return Lu(n)?n.then(s=>r(s)):r(n)}unwrap(){return this._def.innerType}}Zm.create=(t,e)=>new Zm({innerType:t,typeName:P.ZodReadonly,...Ce(e)});ot.lazycreate;var P;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(P||(P={}));const Ud=bs.create,Y_=Hm.create;Fs.create;Ar.create;const Bd=ot.create;ot.strictCreate;Mu.create;Fu.create;va.create;mi.create;zu.create;Os.create;gi.create;function SL(t,e){var r,s,a;const n={type:"array"};return(r=t.type)!=null&&r._def&&((a=(s=t.type)==null?void 0:s._def)==null?void 0:a.typeName)!==P.ZodAny&&(n.items=Me(t.type._def,{...e,currentPath:[...e.currentPath,"items"]})),t.minLength&&Ue(n,"minItems",t.minLength.value,t.minLength.message,e),t.maxLength&&Ue(n,"maxItems",t.maxLength.value,t.maxLength.message,e),t.exactLength&&(Ue(n,"minItems",t.exactLength.value,t.exactLength.message,e),Ue(n,"maxItems",t.exactLength.value,t.exactLength.message,e)),n}function kL(t,e){const n={type:"integer",format:"int64"};if(!t.checks)return n;for(const r of t.checks)switch(r.kind){case"min":e.target==="jsonSchema7"?r.inclusive?Ue(n,"minimum",r.value,r.message,e):Ue(n,"exclusiveMinimum",r.value,r.message,e):(r.inclusive||(n.exclusiveMinimum=!0),Ue(n,"minimum",r.value,r.message,e));break;case"max":e.target==="jsonSchema7"?r.inclusive?Ue(n,"maximum",r.value,r.message,e):Ue(n,"exclusiveMaximum",r.value,r.message,e):(r.inclusive||(n.exclusiveMaximum=!0),Ue(n,"maximum",r.value,r.message,e));break;case"multipleOf":Ue(n,"multipleOf",r.value,r.message,e);break}return n}function EL(){return{type:"boolean"}}function tE(t,e){return Me(t.type._def,e)}const NL=(t,e)=>Me(t.innerType._def,e);function nE(t,e,n){const r=n??e.dateStrategy;if(Array.isArray(r))return{anyOf:r.map(s=>nE(t,e,s))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return TL(t,e)}}const TL=(t,e)=>{const n={type:"integer",format:"unix-time"};if(e.target==="openApi3")return n;for(const r of t.checks)switch(r.kind){case"min":Ue(n,"minimum",r.value,r.message,e);break;case"max":Ue(n,"maximum",r.value,r.message,e);break}return n};function AL(t,e){return{...Me(t.innerType._def,e),default:t.defaultValue()}}function CL(t,e){return e.effectStrategy==="input"?Me(t.schema._def,e):Sn(e)}function IL(t){return{type:"string",enum:Array.from(t.values)}}const jL=t=>"type"in t&&t.type==="string"?!1:"allOf"in t;function RL(t,e){const n=[Me(t.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),Me(t.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(a=>!!a);let r=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const s=[];return n.forEach(a=>{if(jL(a))s.push(...a.allOf),a.unevaluatedProperties===void 0&&(r=void 0);else{let i=a;if("additionalProperties"in a&&a.additionalProperties===!1){const{additionalProperties:o,...l}=a;i=l}else r=void 0;s.push(i)}}),s.length?{allOf:s,...r}:void 0}function OL(t,e){const n=typeof t.value;return n!=="bigint"&&n!=="number"&&n!=="boolean"&&n!=="string"?{type:Array.isArray(t.value)?"array":"object"}:e.target==="openApi3"?{type:n==="bigint"?"integer":n,enum:[t.value]}:{type:n==="bigint"?"integer":n,const:t.value}}let cf;const Bn={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(cf===void 0&&(cf=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),cf),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function rE(t,e){const n={type:"string"};if(t.checks)for(const r of t.checks)switch(r.kind){case"min":Ue(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,r.value):r.value,r.message,e);break;case"max":Ue(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,r.value):r.value,r.message,e);break;case"email":switch(e.emailStrategy){case"format:email":Gn(n,"email",r.message,e);break;case"format:idn-email":Gn(n,"idn-email",r.message,e);break;case"pattern:zod":Ht(n,Bn.email,r.message,e);break}break;case"url":Gn(n,"uri",r.message,e);break;case"uuid":Gn(n,"uuid",r.message,e);break;case"regex":Ht(n,r.regex,r.message,e);break;case"cuid":Ht(n,Bn.cuid,r.message,e);break;case"cuid2":Ht(n,Bn.cuid2,r.message,e);break;case"startsWith":Ht(n,RegExp(`^${uf(r.value,e)}`),r.message,e);break;case"endsWith":Ht(n,RegExp(`${uf(r.value,e)}$`),r.message,e);break;case"datetime":Gn(n,"date-time",r.message,e);break;case"date":Gn(n,"date",r.message,e);break;case"time":Gn(n,"time",r.message,e);break;case"duration":Gn(n,"duration",r.message,e);break;case"length":Ue(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,r.value):r.value,r.message,e),Ue(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,r.value):r.value,r.message,e);break;case"includes":Ht(n,RegExp(uf(r.value,e)),r.message,e);break;case"ip":r.version!=="v6"&&Gn(n,"ipv4",r.message,e),r.version!=="v4"&&Gn(n,"ipv6",r.message,e);break;case"base64url":Ht(n,Bn.base64url,r.message,e);break;case"jwt":Ht(n,Bn.jwt,r.message,e);break;case"cidr":r.version!=="v6"&&Ht(n,Bn.ipv4Cidr,r.message,e),r.version!=="v4"&&Ht(n,Bn.ipv6Cidr,r.message,e);break;case"emoji":Ht(n,Bn.emoji(),r.message,e);break;case"ulid":Ht(n,Bn.ulid,r.message,e);break;case"base64":switch(e.base64Strategy){case"format:binary":Gn(n,"binary",r.message,e);break;case"contentEncoding:base64":Ue(n,"contentEncoding","base64",r.message,e);break;case"pattern:zod":Ht(n,Bn.base64,r.message,e);break}break;case"nanoid":Ht(n,Bn.nanoid,r.message,e);break}return n}function uf(t,e){return e.patternStrategy==="escape"?$L(t):t}const PL=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function $L(t){let e="";for(let n=0;n<t.length;n++)PL.has(t[n])||(e+="\\"),e+=t[n];return e}function Gn(t,e,n,r){var s;t.format||(s=t.anyOf)!=null&&s.some(a=>a.format)?(t.anyOf||(t.anyOf=[]),t.format&&(t.anyOf.push({format:t.format,...t.errorMessage&&r.errorMessages&&{errorMessage:{format:t.errorMessage.format}}}),delete t.format,t.errorMessage&&(delete t.errorMessage.format,Object.keys(t.errorMessage).length===0&&delete t.errorMessage)),t.anyOf.push({format:e,...n&&r.errorMessages&&{errorMessage:{format:n}}})):Ue(t,"format",e,n,r)}function Ht(t,e,n,r){var s;t.pattern||(s=t.allOf)!=null&&s.some(a=>a.pattern)?(t.allOf||(t.allOf=[]),t.pattern&&(t.allOf.push({pattern:t.pattern,...t.errorMessage&&r.errorMessages&&{errorMessage:{pattern:t.errorMessage.pattern}}}),delete t.pattern,t.errorMessage&&(delete t.errorMessage.pattern,Object.keys(t.errorMessage).length===0&&delete t.errorMessage)),t.allOf.push({pattern:Q_(e,r),...n&&r.errorMessages&&{errorMessage:{pattern:n}}})):Ue(t,"pattern",Q_(e,r),n,r)}function Q_(t,e){var l;if(!e.applyRegexFlags||!t.flags)return t.source;const n={i:t.flags.includes("i"),m:t.flags.includes("m"),s:t.flags.includes("s")},r=n.i?t.source.toLowerCase():t.source;let s="",a=!1,i=!1,o=!1;for(let u=0;u<r.length;u++){if(a){s+=r[u],a=!1;continue}if(n.i){if(i){if(r[u].match(/[a-z]/)){o?(s+=r[u],s+=`${r[u-2]}-${r[u]}`.toUpperCase(),o=!1):r[u+1]==="-"&&((l=r[u+2])!=null&&l.match(/[a-z]/))?(s+=r[u],o=!0):s+=`${r[u]}${r[u].toUpperCase()}`;continue}}else if(r[u].match(/[a-z]/)){s+=`[${r[u]}${r[u].toUpperCase()}]`;continue}}if(n.m){if(r[u]==="^"){s+=`(^|(?<=[\r
]))`;continue}else if(r[u]==="$"){s+=`($|(?=[\r
]))`;continue}}if(n.s&&r[u]==="."){s+=i?`${r[u]}\r
`:`[${r[u]}\r
]`;continue}s+=r[u],r[u]==="\\"?a=!0:i&&r[u]==="]"?i=!1:!i&&r[u]==="["&&(i=!0)}try{new RegExp(s)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),t.source}return s}function sE(t,e){var r,s,a,i,o,l;if(e.target==="openAi"&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),e.target==="openApi3"&&((r=t.keyType)==null?void 0:r._def.typeName)===P.ZodEnum)return{type:"object",required:t.keyType._def.values,properties:t.keyType._def.values.reduce((u,d)=>({...u,[d]:Me(t.valueType._def,{...e,currentPath:[...e.currentPath,"properties",d]})??Sn(e)}),{}),additionalProperties:e.rejectedAdditionalProperties};const n={type:"object",additionalProperties:Me(t.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??e.allowedAdditionalProperties};if(e.target==="openApi3")return n;if(((s=t.keyType)==null?void 0:s._def.typeName)===P.ZodString&&((a=t.keyType._def.checks)!=null&&a.length)){const{type:u,...d}=rE(t.keyType._def,e);return{...n,propertyNames:d}}else{if(((i=t.keyType)==null?void 0:i._def.typeName)===P.ZodEnum)return{...n,propertyNames:{enum:t.keyType._def.values}};if(((o=t.keyType)==null?void 0:o._def.typeName)===P.ZodBranded&&t.keyType._def.type._def.typeName===P.ZodString&&((l=t.keyType._def.type._def.checks)!=null&&l.length)){const{type:u,...d}=tE(t.keyType._def,e);return{...n,propertyNames:d}}}return n}function LL(t,e){if(e.mapStrategy==="record")return sE(t,e);const n=Me(t.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||Sn(e),r=Me(t.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||Sn(e);return{type:"array",maxItems:125,items:{type:"array",items:[n,r],minItems:2,maxItems:2}}}function DL(t){const e=t.values,r=Object.keys(t.values).filter(a=>typeof e[e[a]]!="number").map(a=>e[a]),s=Array.from(new Set(r.map(a=>typeof a)));return{type:s.length===1?s[0]==="string"?"string":"number":["string","number"],enum:r}}function ML(t){return t.target==="openAi"?void 0:{not:Sn({...t,currentPath:[...t.currentPath,"not"]})}}function FL(t){return t.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const Uu={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function zL(t,e){if(e.target==="openApi3")return X_(t,e);const n=t.options instanceof Map?Array.from(t.options.values()):t.options;if(n.every(r=>r._def.typeName in Uu&&(!r._def.checks||!r._def.checks.length))){const r=n.reduce((s,a)=>{const i=Uu[a._def.typeName];return i&&!s.includes(i)?[...s,i]:s},[]);return{type:r.length>1?r:r[0]}}else if(n.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=n.reduce((s,a)=>{const i=typeof a._def.value;switch(i){case"string":case"number":case"boolean":return[...s,i];case"bigint":return[...s,"integer"];case"object":return a._def.value===null?[...s,"null"]:s;case"symbol":case"undefined":case"function":default:return s}},[]);if(r.length===n.length){const s=r.filter((a,i,o)=>o.indexOf(a)===i);return{type:s.length>1?s:s[0],enum:n.reduce((a,i)=>a.includes(i._def.value)?a:[...a,i._def.value],[])}}}else if(n.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:n.reduce((r,s)=>[...r,...s._def.values.filter(a=>!r.includes(a))],[])};return X_(t,e)}const X_=(t,e)=>{const n=(t.options instanceof Map?Array.from(t.options.values()):t.options).map((r,s)=>Me(r._def,{...e,currentPath:[...e.currentPath,"anyOf",`${s}`]})).filter(r=>!!r&&(!e.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return n.length?{anyOf:n}:void 0};function UL(t,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(t.innerType._def.typeName)&&(!t.innerType._def.checks||!t.innerType._def.checks.length))return e.target==="openApi3"?{type:Uu[t.innerType._def.typeName],nullable:!0}:{type:[Uu[t.innerType._def.typeName],"null"]};if(e.target==="openApi3"){const r=Me(t.innerType._def,{...e,currentPath:[...e.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const n=Me(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return n&&{anyOf:[n,{type:"null"}]}}function BL(t,e){const n={type:"number"};if(!t.checks)return n;for(const r of t.checks)switch(r.kind){case"int":n.type="integer",Yk(n,"type",r.message,e);break;case"min":e.target==="jsonSchema7"?r.inclusive?Ue(n,"minimum",r.value,r.message,e):Ue(n,"exclusiveMinimum",r.value,r.message,e):(r.inclusive||(n.exclusiveMinimum=!0),Ue(n,"minimum",r.value,r.message,e));break;case"max":e.target==="jsonSchema7"?r.inclusive?Ue(n,"maximum",r.value,r.message,e):Ue(n,"exclusiveMaximum",r.value,r.message,e):(r.inclusive||(n.exclusiveMaximum=!0),Ue(n,"maximum",r.value,r.message,e));break;case"multipleOf":Ue(n,"multipleOf",r.value,r.message,e);break}return n}function GL(t,e){const n=e.target==="openAi",r={type:"object",properties:{}},s=[],a=t.shape();for(const o in a){let l=a[o];if(l===void 0||l._def===void 0)continue;let u=WL(l);u&&n&&(l._def.typeName==="ZodOptional"&&(l=l._def.innerType),l.isNullable()||(l=l.nullable()),u=!1);const d=Me(l._def,{...e,currentPath:[...e.currentPath,"properties",o],propertyPath:[...e.currentPath,"properties",o]});d!==void 0&&(r.properties[o]=d,u||s.push(o))}s.length&&(r.required=s);const i=HL(t,e);return i!==void 0&&(r.additionalProperties=i),r}function HL(t,e){if(t.catchall._def.typeName!=="ZodNever")return Me(t.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]});switch(t.unknownKeys){case"passthrough":return e.allowedAdditionalProperties;case"strict":return e.rejectedAdditionalProperties;case"strip":return e.removeAdditionalStrategy==="strict"?e.allowedAdditionalProperties:e.rejectedAdditionalProperties}}function WL(t){try{return t.isOptional()}catch{return!0}}const VL=(t,e)=>{var r;if(e.currentPath.toString()===((r=e.propertyPath)==null?void 0:r.toString()))return Me(t.innerType._def,e);const n=Me(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return n?{anyOf:[{not:Sn(e)},n]}:Sn(e)},qL=(t,e)=>{if(e.pipeStrategy==="input")return Me(t.in._def,e);if(e.pipeStrategy==="output")return Me(t.out._def,e);const n=Me(t.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),r=Me(t.out._def,{...e,currentPath:[...e.currentPath,"allOf",n?"1":"0"]});return{allOf:[n,r].filter(s=>s!==void 0)}};function ZL(t,e){return Me(t.type._def,e)}function KL(t,e){const r={type:"array",uniqueItems:!0,items:Me(t.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return t.minSize&&Ue(r,"minItems",t.minSize.value,t.minSize.message,e),t.maxSize&&Ue(r,"maxItems",t.maxSize.value,t.maxSize.message,e),r}function JL(t,e){return t.rest?{type:"array",minItems:t.items.length,items:t.items.map((n,r)=>Me(n._def,{...e,currentPath:[...e.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[]),additionalItems:Me(t.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:t.items.length,maxItems:t.items.length,items:t.items.map((n,r)=>Me(n._def,{...e,currentPath:[...e.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[])}}function YL(t){return{not:Sn(t)}}function QL(t){return Sn(t)}const XL=(t,e)=>Me(t.innerType._def,e),e5=(t,e,n)=>{switch(e){case P.ZodString:return rE(t,n);case P.ZodNumber:return BL(t,n);case P.ZodObject:return GL(t,n);case P.ZodBigInt:return kL(t,n);case P.ZodBoolean:return EL();case P.ZodDate:return nE(t,n);case P.ZodUndefined:return YL(n);case P.ZodNull:return FL(n);case P.ZodArray:return SL(t,n);case P.ZodUnion:case P.ZodDiscriminatedUnion:return zL(t,n);case P.ZodIntersection:return RL(t,n);case P.ZodTuple:return JL(t,n);case P.ZodRecord:return sE(t,n);case P.ZodLiteral:return OL(t,n);case P.ZodEnum:return IL(t);case P.ZodNativeEnum:return DL(t);case P.ZodNullable:return UL(t,n);case P.ZodOptional:return VL(t,n);case P.ZodMap:return LL(t,n);case P.ZodSet:return KL(t,n);case P.ZodLazy:return()=>t.getter()._def;case P.ZodPromise:return ZL(t,n);case P.ZodNaN:case P.ZodNever:return ML(n);case P.ZodEffects:return CL(t,n);case P.ZodAny:return Sn(n);case P.ZodUnknown:return QL(n);case P.ZodDefault:return AL(t,n);case P.ZodBranded:return tE(t,n);case P.ZodReadonly:return XL(t,n);case P.ZodCatch:return NL(t,n);case P.ZodPipeline:return qL(t,n);case P.ZodFunction:case P.ZodVoid:case P.ZodSymbol:return;default:return(r=>{})()}};function Me(t,e,n=!1){var o;const r=e.seen.get(t);if(e.override){const l=(o=e.override)==null?void 0:o.call(e,t,e,r,n);if(l!==q4)return l}if(r&&!n){const l=t5(r,e);if(l!==void 0)return l}const s={def:t,path:e.currentPath,jsonSchema:void 0};e.seen.set(t,s);const a=e5(t,t.typeName,e),i=typeof a=="function"?Me(a(),e):a;if(i&&n5(t,e,i),e.postProcess){const l=e.postProcess(i,t,e);return s.jsonSchema=i,l}return s.jsonSchema=i,i}const t5=(t,e)=>{switch(e.$refStrategy){case"root":return{$ref:t.path.join("/")};case"relative":return{$ref:Jk(e.currentPath,t.path)};case"none":case"seen":return t.path.length<e.currentPath.length&&t.path.every((n,r)=>e.currentPath[r]===n)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),Sn(e)):e.$refStrategy==="seen"?Sn(e):void 0}},n5=(t,e,n)=>(t.description&&(n.description=t.description,e.markdownDescription&&(n.markdownDescription=t.description)),n),r5=(t,e)=>{const n=J4(e);let r;const s=e==null?void 0:e.name,a=Me(t._def,n,!1)??Sn(n);n.flags.hasReferencedOpenAiAnyType&&(r||(r={}),r[n.openAiAnyTypeName]||(r[n.openAiAnyTypeName]={type:["string","number","integer","boolean","array","null"],items:{$ref:n.$refStrategy==="relative"?"1":[...n.basePath,n.definitionPath,n.openAiAnyTypeName].join("/")}}));const i=s===void 0?r?{...a,[n.definitionPath]:r}:a:{$ref:[...n.$refStrategy==="relative"?[]:n.basePath,n.definitionPath,s].join("/"),[n.definitionPath]:{...r,[s]:a}};return n.target==="jsonSchema7"?i.$schema="http://json-schema.org/draft-07/schema#":(n.target==="jsonSchema2019-09"||n.target==="openAi")&&(i.$schema="https://json-schema.org/draft/2019-09/schema#"),n.target==="openAi"&&("anyOf"in i||"oneOf"in i||"allOf"in i||"type"in i&&Array.isArray(i.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),i};function ua(t,e){const n=typeof t;if(n!==typeof e)return!1;if(Array.isArray(t)){if(!Array.isArray(e))return!1;const r=t.length;if(r!==e.length)return!1;for(let s=0;s<r;s++)if(!ua(t[s],e[s]))return!1;return!0}if(n==="object"){if(!t||!e)return t===e;const r=Object.keys(t),s=Object.keys(e);if(r.length!==s.length)return!1;for(const i of r)if(!ua(t[i],e[i]))return!1;return!0}return t===e}function qn(t){return encodeURI(s5(t))}function s5(t){return t.replace(/~/g,"~0").replace(/\//g,"~1")}const a5={prefixItems:!0,items:!0,allOf:!0,anyOf:!0,oneOf:!0},i5={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependentSchemas:!0},o5={id:!0,$id:!0,$ref:!0,$schema:!0,$anchor:!0,$vocabulary:!0,$comment:!0,default:!0,enum:!0,const:!0,required:!0,type:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};let l5=typeof self<"u"&&self.location&&self.location.origin!=="null"?new URL(self.location.origin+self.location.pathname+location.search):new URL("https://github.com/cfworker");function Ss(t,e=Object.create(null),n=l5,r=""){if(t&&typeof t=="object"&&!Array.isArray(t)){const a=t.$id||t.id;if(a){const i=new URL(a,n.href);i.hash.length>1?e[i.href]=t:(i.hash="",r===""?n=i:Ss(t,e,n))}}else if(t!==!0&&t!==!1)return e;const s=n.href+(r?"#"+r:"");if(e[s]!==void 0)throw new Error(`Duplicate schema URI "${s}".`);if(e[s]=t,t===!0||t===!1)return e;if(t.__absolute_uri__===void 0&&Object.defineProperty(t,"__absolute_uri__",{enumerable:!1,value:s}),t.$ref&&t.__absolute_ref__===void 0){const a=new URL(t.$ref,n.href);a.hash=a.hash,Object.defineProperty(t,"__absolute_ref__",{enumerable:!1,value:a.href})}if(t.$recursiveRef&&t.__absolute_recursive_ref__===void 0){const a=new URL(t.$recursiveRef,n.href);a.hash=a.hash,Object.defineProperty(t,"__absolute_recursive_ref__",{enumerable:!1,value:a.href})}if(t.$anchor){const a=new URL("#"+t.$anchor,n.href);e[a.href]=t}for(let a in t){if(o5[a])continue;const i=`${r}/${qn(a)}`,o=t[a];if(Array.isArray(o)){if(a5[a]){const l=o.length;for(let u=0;u<l;u++)Ss(o[u],e,n,`${i}/${u}`)}}else if(i5[a])for(let l in o)Ss(o[l],e,n,`${i}/${qn(l)}`);else Ss(o,e,n,i)}return e}const c5=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,u5=[0,31,28,31,30,31,30,31,31,30,31,30,31],d5=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i,h5=/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,f5=/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,m5=/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,p5=/^(?:(?:https?|ftp):\/\/)(?:\S+(?::\S*)?@)?(?:(?!10(?:\.\d{1,3}){3})(?!127(?:\.\d{1,3}){3})(?!169\.254(?:\.\d{1,3}){2})(?!192\.168(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u{00a1}-\u{ffff}0-9]+-?)*[a-z\u{00a1}-\u{ffff}0-9]+)(?:\.(?:[a-z\u{00a1}-\u{ffff}0-9]+-?)*[a-z\u{00a1}-\u{ffff}0-9]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,g5=/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,y5=/^(?:\/(?:[^~/]|~0|~1)*)*$/,v5=/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,_5=/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,w5=t=>{if(t[0]==='"')return!1;const[e,n,...r]=t.split("@");return!e||!n||r.length!==0||e.length>64||n.length>253||e[0]==="."||e.endsWith(".")||e.includes("..")||!/^[a-z0-9.-]+$/i.test(n)||!/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+$/i.test(e)?!1:n.split(".").every(s=>/^[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?$/i.test(s))},x5=/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,b5=/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,S5=t=>t.length>1&&t.length<80&&(/^P\d+([.,]\d+)?W$/.test(t)||/^P[\dYMDTHS]*(\d[.,]\d+)?[YMDHS]$/.test(t)&&/^P([.,\d]+Y)?([.,\d]+M)?([.,\d]+D)?(T([.,\d]+H)?([.,\d]+M)?([.,\d]+S)?)?$/.test(t));function fr(t){return t.test.bind(t)}const ew={date:aE,time:iE.bind(void 0,!1),"date-time":N5,duration:S5,uri:C5,"uri-reference":fr(f5),"uri-template":fr(m5),url:fr(p5),email:w5,hostname:fr(h5),ipv4:fr(x5),ipv6:fr(b5),regex:j5,uuid:fr(g5),"json-pointer":fr(y5),"json-pointer-uri-fragment":fr(v5),"relative-json-pointer":fr(_5)};function k5(t){return t%4===0&&(t%100!==0||t%400===0)}function aE(t){const e=t.match(c5);if(!e)return!1;const n=+e[1],r=+e[2],s=+e[3];return r>=1&&r<=12&&s>=1&&s<=(r==2&&k5(n)?29:u5[r])}function iE(t,e){const n=e.match(d5);if(!n)return!1;const r=+n[1],s=+n[2],a=+n[3],i=!!n[5];return(r<=23&&s<=59&&a<=59||r==23&&s==59&&a==60)&&(!t||i)}const E5=/t|\s/i;function N5(t){const e=t.split(E5);return e.length==2&&aE(e[0])&&iE(!0,e[1])}const T5=/\/|:/,A5=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;function C5(t){return T5.test(t)&&A5.test(t)}const I5=/[^\\]\\Z/;function j5(t){if(I5.test(t))return!1;try{return new RegExp(t,"u"),!0}catch{return!1}}function R5(t){let e=0,n=t.length,r=0,s;for(;r<n;)e++,s=t.charCodeAt(r++),s>=55296&&s<=56319&&r<n&&(s=t.charCodeAt(r),(s&64512)==56320&&r++);return e}function Xe(t,e,n="2019-09",r=Ss(e),s=!0,a=null,i="#",o="#",l=Object.create(null)){if(e===!0)return{valid:!0,errors:[]};if(e===!1)return{valid:!1,errors:[{instanceLocation:i,keyword:"false",keywordLocation:i,error:"False boolean schema."}]};const u=typeof t;let d;switch(u){case"boolean":case"number":case"string":d=u;break;case"object":t===null?d="null":Array.isArray(t)?d="array":d="object";break;default:throw new Error(`Instances of "${u}" type are not supported.`)}const{$ref:h,$recursiveRef:f,$recursiveAnchor:m,type:v,const:w,enum:_,required:y,not:p,anyOf:g,allOf:S,oneOf:N,if:T,then:A,else:x,format:j,properties:R,patternProperties:D,additionalProperties:ye,unevaluatedProperties:Fe,minProperties:G,maxProperties:F,propertyNames:W,dependentRequired:J,dependentSchemas:$,dependencies:M,prefixItems:U,items:re,additionalItems:X,unevaluatedItems:Te,contains:ze,minContains:Ee,maxContains:E,minItems:b,maxItems:L,uniqueItems:C,minimum:Ne,maximum:Pe,exclusiveMinimum:He,exclusiveMaximum:tt,multipleOf:gt,minLength:At,maxLength:We,pattern:Bt,__absolute_ref__:as,__absolute_recursive_ref__:lr}=e,K=[];if(m===!0&&a===null&&(a=e),f==="#"){const pe=a===null?r[lr]:a,oe=`${o}/$recursiveRef`,we=Xe(t,a===null?e:a,n,r,s,pe,i,oe,l);we.valid||K.push({instanceLocation:i,keyword:"$recursiveRef",keywordLocation:oe,error:"A subschema had errors."},...we.errors)}if(h!==void 0){const oe=r[as||h];if(oe===void 0){let q=`Unresolved $ref "${h}".`;throw as&&as!==h&&(q+=`  Absolute URI "${as}".`),q+=`
Known schemas:
- ${Object.keys(r).join(`
- `)}`,new Error(q)}const we=`${o}/$ref`,Y=Xe(t,oe,n,r,s,a,i,we,l);if(Y.valid||K.push({instanceLocation:i,keyword:"$ref",keywordLocation:we,error:"A subschema had errors."},...Y.errors),n==="4"||n==="7")return{valid:K.length===0,errors:K}}if(Array.isArray(v)){let pe=v.length,oe=!1;for(let we=0;we<pe;we++)if(d===v[we]||v[we]==="integer"&&d==="number"&&t%1===0&&t===t){oe=!0;break}oe||K.push({instanceLocation:i,keyword:"type",keywordLocation:`${o}/type`,error:`Instance type "${d}" is invalid. Expected "${v.join('", "')}".`})}else v==="integer"?(d!=="number"||t%1||t!==t)&&K.push({instanceLocation:i,keyword:"type",keywordLocation:`${o}/type`,error:`Instance type "${d}" is invalid. Expected "${v}".`}):v!==void 0&&d!==v&&K.push({instanceLocation:i,keyword:"type",keywordLocation:`${o}/type`,error:`Instance type "${d}" is invalid. Expected "${v}".`});if(w!==void 0&&(d==="object"||d==="array"?ua(t,w)||K.push({instanceLocation:i,keyword:"const",keywordLocation:`${o}/const`,error:`Instance does not match ${JSON.stringify(w)}.`}):t!==w&&K.push({instanceLocation:i,keyword:"const",keywordLocation:`${o}/const`,error:`Instance does not match ${JSON.stringify(w)}.`})),_!==void 0&&(d==="object"||d==="array"?_.some(pe=>ua(t,pe))||K.push({instanceLocation:i,keyword:"enum",keywordLocation:`${o}/enum`,error:`Instance does not match any of ${JSON.stringify(_)}.`}):_.some(pe=>t===pe)||K.push({instanceLocation:i,keyword:"enum",keywordLocation:`${o}/enum`,error:`Instance does not match any of ${JSON.stringify(_)}.`})),p!==void 0){const pe=`${o}/not`;Xe(t,p,n,r,s,a,i,pe).valid&&K.push({instanceLocation:i,keyword:"not",keywordLocation:pe,error:'Instance matched "not" schema.'})}let Tn=[];if(g!==void 0){const pe=`${o}/anyOf`,oe=K.length;let we=!1;for(let Y=0;Y<g.length;Y++){const q=g[Y],ve=Object.create(l),fe=Xe(t,q,n,r,s,m===!0?a:null,i,`${pe}/${Y}`,ve);K.push(...fe.errors),we=we||fe.valid,fe.valid&&Tn.push(ve)}we?K.length=oe:K.splice(oe,0,{instanceLocation:i,keyword:"anyOf",keywordLocation:pe,error:"Instance does not match any subschemas."})}if(S!==void 0){const pe=`${o}/allOf`,oe=K.length;let we=!0;for(let Y=0;Y<S.length;Y++){const q=S[Y],ve=Object.create(l),fe=Xe(t,q,n,r,s,m===!0?a:null,i,`${pe}/${Y}`,ve);K.push(...fe.errors),we=we&&fe.valid,fe.valid&&Tn.push(ve)}we?K.length=oe:K.splice(oe,0,{instanceLocation:i,keyword:"allOf",keywordLocation:pe,error:"Instance does not match every subschema."})}if(N!==void 0){const pe=`${o}/oneOf`,oe=K.length,we=N.filter((Y,q)=>{const ve=Object.create(l),fe=Xe(t,Y,n,r,s,m===!0?a:null,i,`${pe}/${q}`,ve);return K.push(...fe.errors),fe.valid&&Tn.push(ve),fe.valid}).length;we===1?K.length=oe:K.splice(oe,0,{instanceLocation:i,keyword:"oneOf",keywordLocation:pe,error:`Instance does not match exactly one subschema (${we} matches).`})}if((d==="object"||d==="array")&&Object.assign(l,...Tn),T!==void 0){const pe=`${o}/if`;if(Xe(t,T,n,r,s,a,i,pe,l).valid){if(A!==void 0){const we=Xe(t,A,n,r,s,a,i,`${o}/then`,l);we.valid||K.push({instanceLocation:i,keyword:"if",keywordLocation:pe,error:'Instance does not match "then" schema.'},...we.errors)}}else if(x!==void 0){const we=Xe(t,x,n,r,s,a,i,`${o}/else`,l);we.valid||K.push({instanceLocation:i,keyword:"if",keywordLocation:pe,error:'Instance does not match "else" schema.'},...we.errors)}}if(d==="object"){if(y!==void 0)for(const Y of y)Y in t||K.push({instanceLocation:i,keyword:"required",keywordLocation:`${o}/required`,error:`Instance does not have required property "${Y}".`});const pe=Object.keys(t);if(G!==void 0&&pe.length<G&&K.push({instanceLocation:i,keyword:"minProperties",keywordLocation:`${o}/minProperties`,error:`Instance does not have at least ${G} properties.`}),F!==void 0&&pe.length>F&&K.push({instanceLocation:i,keyword:"maxProperties",keywordLocation:`${o}/maxProperties`,error:`Instance does not have at least ${F} properties.`}),W!==void 0){const Y=`${o}/propertyNames`;for(const q in t){const ve=`${i}/${qn(q)}`,fe=Xe(q,W,n,r,s,a,ve,Y);fe.valid||K.push({instanceLocation:i,keyword:"propertyNames",keywordLocation:Y,error:`Property name "${q}" does not match schema.`},...fe.errors)}}if(J!==void 0){const Y=`${o}/dependantRequired`;for(const q in J)if(q in t){const ve=J[q];for(const fe of ve)fe in t||K.push({instanceLocation:i,keyword:"dependentRequired",keywordLocation:Y,error:`Instance has "${q}" but does not have "${fe}".`})}}if($!==void 0)for(const Y in $){const q=`${o}/dependentSchemas`;if(Y in t){const ve=Xe(t,$[Y],n,r,s,a,i,`${q}/${qn(Y)}`,l);ve.valid||K.push({instanceLocation:i,keyword:"dependentSchemas",keywordLocation:q,error:`Instance has "${Y}" but does not match dependant schema.`},...ve.errors)}}if(M!==void 0){const Y=`${o}/dependencies`;for(const q in M)if(q in t){const ve=M[q];if(Array.isArray(ve))for(const fe of ve)fe in t||K.push({instanceLocation:i,keyword:"dependencies",keywordLocation:Y,error:`Instance has "${q}" but does not have "${fe}".`});else{const fe=Xe(t,ve,n,r,s,a,i,`${Y}/${qn(q)}`);fe.valid||K.push({instanceLocation:i,keyword:"dependencies",keywordLocation:Y,error:`Instance has "${q}" but does not match dependant schema.`},...fe.errors)}}}const oe=Object.create(null);let we=!1;if(R!==void 0){const Y=`${o}/properties`;for(const q in R){if(!(q in t))continue;const ve=`${i}/${qn(q)}`,fe=Xe(t[q],R[q],n,r,s,a,ve,`${Y}/${qn(q)}`);if(fe.valid)l[q]=oe[q]=!0;else if(we=s,K.push({instanceLocation:i,keyword:"properties",keywordLocation:Y,error:`Property "${q}" does not match schema.`},...fe.errors),we)break}}if(!we&&D!==void 0){const Y=`${o}/patternProperties`;for(const q in D){const ve=new RegExp(q,"u"),fe=D[q];for(const Qe in t){if(!ve.test(Qe))continue;const Ci=`${i}/${qn(Qe)}`,An=Xe(t[Qe],fe,n,r,s,a,Ci,`${Y}/${qn(q)}`);An.valid?l[Qe]=oe[Qe]=!0:(we=s,K.push({instanceLocation:i,keyword:"patternProperties",keywordLocation:Y,error:`Property "${Qe}" matches pattern "${q}" but does not match associated schema.`},...An.errors))}}}if(!we&&ye!==void 0){const Y=`${o}/additionalProperties`;for(const q in t){if(oe[q])continue;const ve=`${i}/${qn(q)}`,fe=Xe(t[q],ye,n,r,s,a,ve,Y);fe.valid?l[q]=!0:(we=s,K.push({instanceLocation:i,keyword:"additionalProperties",keywordLocation:Y,error:`Property "${q}" does not match additional properties schema.`},...fe.errors))}}else if(!we&&Fe!==void 0){const Y=`${o}/unevaluatedProperties`;for(const q in t)if(!l[q]){const ve=`${i}/${qn(q)}`,fe=Xe(t[q],Fe,n,r,s,a,ve,Y);fe.valid?l[q]=!0:K.push({instanceLocation:i,keyword:"unevaluatedProperties",keywordLocation:Y,error:`Property "${q}" does not match unevaluated properties schema.`},...fe.errors)}}}else if(d==="array"){L!==void 0&&t.length>L&&K.push({instanceLocation:i,keyword:"maxItems",keywordLocation:`${o}/maxItems`,error:`Array has too many items (${t.length} > ${L}).`}),b!==void 0&&t.length<b&&K.push({instanceLocation:i,keyword:"minItems",keywordLocation:`${o}/minItems`,error:`Array has too few items (${t.length} < ${b}).`});const pe=t.length;let oe=0,we=!1;if(U!==void 0){const Y=`${o}/prefixItems`,q=Math.min(U.length,pe);for(;oe<q;oe++){const ve=Xe(t[oe],U[oe],n,r,s,a,`${i}/${oe}`,`${Y}/${oe}`);if(l[oe]=!0,!ve.valid&&(we=s,K.push({instanceLocation:i,keyword:"prefixItems",keywordLocation:Y,error:"Items did not match schema."},...ve.errors),we))break}}if(re!==void 0){const Y=`${o}/items`;if(Array.isArray(re)){const q=Math.min(re.length,pe);for(;oe<q;oe++){const ve=Xe(t[oe],re[oe],n,r,s,a,`${i}/${oe}`,`${Y}/${oe}`);if(l[oe]=!0,!ve.valid&&(we=s,K.push({instanceLocation:i,keyword:"items",keywordLocation:Y,error:"Items did not match schema."},...ve.errors),we))break}}else for(;oe<pe;oe++){const q=Xe(t[oe],re,n,r,s,a,`${i}/${oe}`,Y);if(l[oe]=!0,!q.valid&&(we=s,K.push({instanceLocation:i,keyword:"items",keywordLocation:Y,error:"Items did not match schema."},...q.errors),we))break}if(!we&&X!==void 0){const q=`${o}/additionalItems`;for(;oe<pe;oe++){const ve=Xe(t[oe],X,n,r,s,a,`${i}/${oe}`,q);l[oe]=!0,ve.valid||(we=s,K.push({instanceLocation:i,keyword:"additionalItems",keywordLocation:q,error:"Items did not match additional items schema."},...ve.errors))}}}if(ze!==void 0)if(pe===0&&Ee===void 0)K.push({instanceLocation:i,keyword:"contains",keywordLocation:`${o}/contains`,error:"Array is empty. It must contain at least one item matching the schema."});else if(Ee!==void 0&&pe<Ee)K.push({instanceLocation:i,keyword:"minContains",keywordLocation:`${o}/minContains`,error:`Array has less items (${pe}) than minContains (${Ee}).`});else{const Y=`${o}/contains`,q=K.length;let ve=0;for(let fe=0;fe<pe;fe++){const Qe=Xe(t[fe],ze,n,r,s,a,`${i}/${fe}`,Y);Qe.valid?(l[fe]=!0,ve++):K.push(...Qe.errors)}ve>=(Ee||0)&&(K.length=q),Ee===void 0&&E===void 0&&ve===0?K.splice(q,0,{instanceLocation:i,keyword:"contains",keywordLocation:Y,error:"Array does not contain item matching schema."}):Ee!==void 0&&ve<Ee?K.push({instanceLocation:i,keyword:"minContains",keywordLocation:`${o}/minContains`,error:`Array must contain at least ${Ee} items matching schema. Only ${ve} items were found.`}):E!==void 0&&ve>E&&K.push({instanceLocation:i,keyword:"maxContains",keywordLocation:`${o}/maxContains`,error:`Array may contain at most ${E} items matching schema. ${ve} items were found.`})}if(!we&&Te!==void 0){const Y=`${o}/unevaluatedItems`;for(oe;oe<pe;oe++){if(l[oe])continue;const q=Xe(t[oe],Te,n,r,s,a,`${i}/${oe}`,Y);l[oe]=!0,q.valid||K.push({instanceLocation:i,keyword:"unevaluatedItems",keywordLocation:Y,error:"Items did not match unevaluated items schema."},...q.errors)}}if(C)for(let Y=0;Y<pe;Y++){const q=t[Y],ve=typeof q=="object"&&q!==null;for(let fe=0;fe<pe;fe++){if(Y===fe)continue;const Qe=t[fe];(q===Qe||ve&&(typeof Qe=="object"&&Qe!==null)&&ua(q,Qe))&&(K.push({instanceLocation:i,keyword:"uniqueItems",keywordLocation:`${o}/uniqueItems`,error:`Duplicate items at indexes ${Y} and ${fe}.`}),Y=Number.MAX_SAFE_INTEGER,fe=Number.MAX_SAFE_INTEGER)}}}else if(d==="number"){if(n==="4"?(Ne!==void 0&&(He===!0&&t<=Ne||t<Ne)&&K.push({instanceLocation:i,keyword:"minimum",keywordLocation:`${o}/minimum`,error:`${t} is less than ${He?"or equal to ":""} ${Ne}.`}),Pe!==void 0&&(tt===!0&&t>=Pe||t>Pe)&&K.push({instanceLocation:i,keyword:"maximum",keywordLocation:`${o}/maximum`,error:`${t} is greater than ${tt?"or equal to ":""} ${Pe}.`})):(Ne!==void 0&&t<Ne&&K.push({instanceLocation:i,keyword:"minimum",keywordLocation:`${o}/minimum`,error:`${t} is less than ${Ne}.`}),Pe!==void 0&&t>Pe&&K.push({instanceLocation:i,keyword:"maximum",keywordLocation:`${o}/maximum`,error:`${t} is greater than ${Pe}.`}),He!==void 0&&t<=He&&K.push({instanceLocation:i,keyword:"exclusiveMinimum",keywordLocation:`${o}/exclusiveMinimum`,error:`${t} is less than ${He}.`}),tt!==void 0&&t>=tt&&K.push({instanceLocation:i,keyword:"exclusiveMaximum",keywordLocation:`${o}/exclusiveMaximum`,error:`${t} is greater than or equal to ${tt}.`})),gt!==void 0){const pe=t%gt;Math.abs(0-pe)>=11920929e-14&&Math.abs(gt-pe)>=11920929e-14&&K.push({instanceLocation:i,keyword:"multipleOf",keywordLocation:`${o}/multipleOf`,error:`${t} is not a multiple of ${gt}.`})}}else if(d==="string"){const pe=At===void 0&&We===void 0?0:R5(t);At!==void 0&&pe<At&&K.push({instanceLocation:i,keyword:"minLength",keywordLocation:`${o}/minLength`,error:`String is too short (${pe} < ${At}).`}),We!==void 0&&pe>We&&K.push({instanceLocation:i,keyword:"maxLength",keywordLocation:`${o}/maxLength`,error:`String is too long (${pe} > ${We}).`}),Bt!==void 0&&!new RegExp(Bt,"u").test(t)&&K.push({instanceLocation:i,keyword:"pattern",keywordLocation:`${o}/pattern`,error:"String does not match pattern."}),j!==void 0&&ew[j]&&!ew[j](t)&&K.push({instanceLocation:i,keyword:"format",keywordLocation:`${o}/format`,error:`String does not match format "${j}".`})}return{valid:K.length===0,errors:K}}class O5{constructor(e,n="2019-09",r=!0){k(this,"schema");k(this,"draft");k(this,"shortCircuit");k(this,"lookup");this.schema=e,this.draft=n,this.shortCircuit=r,this.lookup=Ss(e)}validate(e){return Xe(e,this.schema,this.draft,this.lookup,this.shortCircuit)}addSchema(e,n){n&&(e={...e,$id:n}),Ss(e,this.lookup)}}var P5={};je(P5,{Validator:()=>O5,deepCompareStrict:()=>ua,toJsonSchema:()=>br,validatesOnlyStrings:()=>Oo});function br(t){if(ct(t)){const e=Zk(t,!0);if(Tr(e)){const n=$u(e,!0);return Pu(n)}else return Pu(t)}return pt(t)?r5(t):t}function Oo(t){if(!t||typeof t!="object"||Object.keys(t).length===0||Array.isArray(t))return!1;if("type"in t)return typeof t.type=="string"?t.type==="string":Array.isArray(t.type)?t.type.every(e=>e==="string"):!1;if("enum"in t)return Array.isArray(t.enum)&&t.enum.length>0&&t.enum.every(e=>typeof e=="string");if("const"in t)return typeof t.const=="string";if("allOf"in t&&Array.isArray(t.allOf))return t.allOf.some(e=>Oo(e));if("anyOf"in t&&Array.isArray(t.anyOf)||"oneOf"in t&&Array.isArray(t.oneOf)){const e="anyOf"in t?t.anyOf:t.oneOf;return e.length>0&&e.every(n=>Oo(n))}if("not"in t)return!1;if("$ref"in t&&typeof t.$ref=="string"){const e=t.$ref,n=Ss(t);return n[e]?Oo(n[e]):!1}return!1}var $5={};je($5,{Graph:()=>sy});function L5(t,e){if(t!==void 0&&!Io(t))return t;if(Xg(e))try{let n=e.getName();return n=n.startsWith("Runnable")?n.slice(8):n,n}catch{return e.getName()}else return e.name??"UnknownSchema"}function D5(t){return Xg(t.data)?{type:"runnable",data:{id:t.data.lc_id,name:t.data.getName()}}:{type:"schema",data:{...br(t.data.schema),title:t.data.name}}}var sy=class oE{constructor(e){k(this,"nodes",{});k(this,"edges",[]);this.nodes=(e==null?void 0:e.nodes)??this.nodes,this.edges=(e==null?void 0:e.edges)??this.edges}toJSON(){const e={};return Object.values(this.nodes).forEach((n,r)=>{e[n.id]=Io(n.id)?r:n.id}),{nodes:Object.values(this.nodes).map(n=>({id:e[n.id],...D5(n)})),edges:this.edges.map(n=>{const r={source:e[n.source],target:e[n.target]};return typeof n.data<"u"&&(r.data=n.data),typeof n.conditional<"u"&&(r.conditional=n.conditional),r})}}addNode(e,n,r){if(n!==void 0&&this.nodes[n]!==void 0)throw new Error(`Node with id ${n} already exists`);const s=n??rn(),a={id:s,data:e,name:L5(n,e),metadata:r};return this.nodes[s]=a,a}removeNode(e){delete this.nodes[e.id],this.edges=this.edges.filter(n=>n.source!==e.id&&n.target!==e.id)}addEdge(e,n,r,s){if(this.nodes[e.id]===void 0)throw new Error(`Source node ${e.id} not in graph`);if(this.nodes[n.id]===void 0)throw new Error(`Target node ${n.id} not in graph`);const a={source:e.id,target:n.id,data:r,conditional:s};return this.edges.push(a),a}firstNode(){return tw(this)}lastNode(){return nw(this)}extend(e,n=""){let r=n;Object.values(e.nodes).map(u=>u.id).every(Io)&&(r="");const a=u=>r?`${r}:${u}`:u;Object.entries(e.nodes).forEach(([u,d])=>{this.nodes[a(u)]={...d,id:a(u)}});const i=e.edges.map(u=>({...u,source:a(u.source),target:a(u.target)}));this.edges=[...this.edges,...i];const o=e.firstNode(),l=e.lastNode();return[o?{id:a(o.id),data:o.data}:void 0,l?{id:a(l.id),data:l.data}:void 0]}trimFirstNode(){const e=this.firstNode();e&&tw(this,[e.id])&&this.removeNode(e)}trimLastNode(){const e=this.lastNode();e&&nw(this,[e.id])&&this.removeNode(e)}reid(){const e=Object.fromEntries(Object.values(this.nodes).map(s=>[s.id,s.name])),n=new Map;Object.values(e).forEach(s=>{n.set(s,(n.get(s)||0)+1)});const r=s=>{const a=e[s];return Io(s)&&n.get(a)===1?a:s};return new oE({nodes:Object.fromEntries(Object.entries(this.nodes).map(([s,a])=>[r(s),{...a,id:r(s)}])),edges:this.edges.map(s=>({...s,source:r(s.source),target:r(s.target)}))})}drawMermaid(e){const{withStyles:n,curveStyle:r,nodeColors:s={default:"fill:#f2f0ff,line-height:1.2",first:"fill-opacity:0",last:"fill:#bfb6fc"},wrapLabelNWords:a}=e??{},i=this.reid(),o=i.firstNode(),l=i.lastNode();return W4(i.nodes,i.edges,{firstNode:o==null?void 0:o.id,lastNode:l==null?void 0:l.id,withStyles:n,curveStyle:r,nodeColors:s,wrapLabelNWords:a})}async drawMermaidPng(e){const n=this.drawMermaid(e);return V4(n,{backgroundColor:e==null?void 0:e.backgroundColor})}};function tw(t,e=[]){const n=new Set(t.edges.filter(s=>!e.includes(s.source)).map(s=>s.target)),r=[];for(const s of Object.values(t.nodes))!e.includes(s.id)&&!n.has(s.id)&&r.push(s);return r.length===1?r[0]:void 0}function nw(t,e=[]){const n=new Set(t.edges.filter(s=>!e.includes(s.target)).map(s=>s.source)),r=[];for(const s of Object.values(t.nodes))!e.includes(s.id)&&!n.has(s.id)&&r.push(s);return r.length===1?r[0]:void 0}function M5(t){const e=new TextEncoder,n=new ReadableStream({async start(r){for await(const s of t)r.enqueue(e.encode(`event: data
data: ${JSON.stringify(s)}

`));r.enqueue(e.encode(`event: end

`)),r.close()}});return sr.fromReadableStream(n)}function rw(t){return typeof t=="object"&&t!==null&&typeof t[Symbol.iterator]=="function"&&typeof t.next=="function"}const F5=t=>t!=null&&typeof t=="object"&&"next"in t&&typeof t.next=="function";function Km(t){return typeof t=="object"&&t!==null&&typeof t[Symbol.asyncIterator]=="function"}function*sw(t,e){for(;;){const{value:n,done:r}=rr.runWithConfig(Qr(t),e.next.bind(e),!0);if(r)break;yield n}}async function*Jm(t,e){const n=e[Symbol.asyncIterator]();for(;;){const{value:r,done:s}=await rr.runWithConfig(Qr(t),n.next.bind(e),!0);if(s)break;yield r}}function wt(t,e){return t&&!Array.isArray(t)&&!(t instanceof Date)&&typeof t=="object"?t:{[e]:t}}var dt=class extends ci{constructor(){super(...arguments);k(this,"lc_runnable",!0);k(this,"name")}getName(e){const n=this.name??this.constructor.lc_name()??this.constructor.name;return e?`${n}${e}`:n}withRetry(e){return new ay({bound:this,kwargs:{},config:{},maxAttemptNumber:e==null?void 0:e.stopAfterAttempt,...e})}withConfig(e){return new yi({bound:this,config:e,kwargs:{}})}withFallbacks(e){const n=Array.isArray(e)?e:e.fallbacks;return new fE({runnable:this,fallbacks:n})}_getOptionsList(e,n=0){if(Array.isArray(e)&&e.length!==n)throw new Error(`Passed "options" must be an array with the same length as the inputs, but got ${e.length} options for ${n} inputs`);if(Array.isArray(e))return e.map($e);if(n>1&&!Array.isArray(e)&&e.runId){console.warn("Provided runId will be used only for the first element of the batch.");const r=Object.fromEntries(Object.entries(e).filter(([s])=>s!=="runId"));return Array.from({length:n},(s,a)=>$e(a===0?e:r))}return Array.from({length:n},()=>$e(e))}async batch(e,n,r){var l;const s=this._getOptionsList(n??{},e.length),a=((l=s[0])==null?void 0:l.maxConcurrency)??(r==null?void 0:r.maxConcurrency),i=new Nl({maxConcurrency:a,onFailedAttempt:u=>{throw u}}),o=e.map((u,d)=>i.call(async()=>{try{return await this.invoke(u,s[d])}catch(h){if(r!=null&&r.returnExceptions)return h;throw h}}));return Promise.all(o)}async*_streamIterator(e,n){yield this.invoke(e,n)}async stream(e,n){const r=$e(n),s=new Sa({generator:this._streamIterator(e,r),config:r});return await s.setup,sr.fromAsyncGenerator(s)}_separateRunnableConfigFromCallOptions(e){let n;e===void 0?n=$e(e):n=$e({callbacks:e.callbacks,tags:e.tags,metadata:e.metadata,runName:e.runName,configurable:e.configurable,recursionLimit:e.recursionLimit,maxConcurrency:e.maxConcurrency,runId:e.runId,timeout:e.timeout,signal:e.signal});const r={...e};return delete r.callbacks,delete r.tags,delete r.metadata,delete r.runName,delete r.configurable,delete r.recursionLimit,delete r.maxConcurrency,delete r.runId,delete r.timeout,delete r.signal,[n,r]}async _callWithConfig(e,n,r){const s=$e(r),a=await xn(s),i=await(a==null?void 0:a.handleChainStart(this.toJSON(),wt(n,"input"),s.runId,s==null?void 0:s.runType,void 0,void 0,(s==null?void 0:s.runName)??this.getName()));delete s.runId;let o;try{const l=e.call(this,n,s,i);o=await Xr(l,r==null?void 0:r.signal)}catch(l){throw await(i==null?void 0:i.handleChainError(l)),l}return await(i==null?void 0:i.handleChainEnd(wt(o,"output"))),o}async _batchWithConfig(e,n,r,s){var u;const a=this._getOptionsList(r??{},n.length),i=await Promise.all(a.map(xn)),o=await Promise.all(i.map(async(d,h)=>{const f=await(d==null?void 0:d.handleChainStart(this.toJSON(),wt(n[h],"input"),a[h].runId,a[h].runType,void 0,void 0,a[h].runName??this.getName()));return delete a[h].runId,f}));let l;try{const d=e.call(this,n,a,o,s);l=await Xr(d,(u=a==null?void 0:a[0])==null?void 0:u.signal)}catch(d){throw await Promise.all(o.map(h=>h==null?void 0:h.handleChainError(d))),d}return await Promise.all(o.map(d=>d==null?void 0:d.handleChainEnd(wt(l,"output")))),l}_concatOutputChunks(e,n){return Ds(e,n)}async*_transformStreamWithConfig(e,n,r){let s,a=!0,i,o=!0;const l=$e(r),u=await xn(l),d=this;async function*h(){for await(const m of e){if(a)if(s===void 0)s=m;else try{s=d._concatOutputChunks(s,m)}catch{s=void 0,a=!1}yield m}}let f;try{const m=await Ak(n.bind(this),h(),async()=>u==null?void 0:u.handleChainStart(this.toJSON(),{input:""},l.runId,l.runType,void 0,void 0,l.runName??this.getName()),r==null?void 0:r.signal,l);delete l.runId,f=m.setup;const v=f==null?void 0:f.handlers.find(Z$);let w=m.output;v!==void 0&&f!==void 0&&(w=v.tapOutputIterable(f.runId,w));const _=f==null?void 0:f.handlers.find(Pk);_!==void 0&&f!==void 0&&(w=_.tapOutputIterable(f.runId,w));for await(const y of w)if(yield y,o)if(i===void 0)i=y;else try{i=this._concatOutputChunks(i,y)}catch{i=void 0,o=!1}}catch(m){throw await(f==null?void 0:f.handleChainError(m,void 0,void 0,void 0,{inputs:wt(s,"input")})),m}await(f==null?void 0:f.handleChainEnd(i??{},void 0,void 0,void 0,{inputs:wt(s,"input")}))}getGraph(e){const n=new sy,r=n.addNode({name:`${this.getName()}Input`,schema:Y_()}),s=n.addNode(this),a=n.addNode({name:`${this.getName()}Output`,schema:Y_()});return n.addEdge(r,s),n.addEdge(s,a),n}pipe(e){return new Ti({first:this,last:Xn(e)})}pick(e){return this.pipe(new mE(e))}assign(e){return this.pipe(new iy(new Ai({steps:e})))}async*transform(e,n){let r;for await(const s of e)r===void 0?r=s:r=this._concatOutputChunks(r,s);yield*this._streamIterator(r,$e(n))}async*streamLog(e,n,r){const s=new Fm({...r,autoClose:!1,_schemaFormat:"original"}),a=$e(n);yield*this._streamLog(e,s,a)}async*_streamLog(e,n,r){const{callbacks:s}=r;if(s===void 0)r.callbacks=[n];else if(Array.isArray(s))r.callbacks=s.concat([n]);else{const l=s.copy();l.addHandler(n,!0),r.callbacks=l}const a=this.stream(e,r);async function i(){try{const l=await a;for await(const u of l){const d=new Fr({ops:[{op:"add",path:"/streamed_output/-",value:u}]});await n.writer.write(d)}}finally{await n.writer.close()}}const o=i();try{for await(const l of n)yield l}finally{await o}}streamEvents(e,n,r){let s;if(n.version==="v1")s=this._streamEventsV1(e,n,r);else if(n.version==="v2")s=this._streamEventsV2(e,n,r);else throw new Error('Only versions "v1" and "v2" of the schema are currently supported.');return n.encoding==="text/event-stream"?M5(s):sr.fromAsyncGenerator(s)}async*_streamEventsV2(e,n,r){var v;const s=new K$({...r,autoClose:!1}),a=$e(n),i=a.runId??rn();a.runId=i;const o=a.callbacks;if(o===void 0)a.callbacks=[s];else if(Array.isArray(o))a.callbacks=o.concat(s);else{const w=o.copy();w.addHandler(s,!0),a.callbacks=w}const l=new AbortController,u=this;async function d(){let w,_=null;try{n!=null&&n.signal?"any"in AbortSignal?w=AbortSignal.any([l.signal,n.signal]):(w=n.signal,_=()=>{l.abort()},n.signal.addEventListener("abort",_,{once:!0})):w=l.signal;const y=await u.stream(e,{...a,signal:w}),p=s.tapOutputIterable(i,y);for await(const g of p)if(l.signal.aborted)break}finally{await s.finish(),w&&_&&w.removeEventListener("abort",_)}}const h=d();let f=!1,m;try{for await(const w of s){if(!f){w.data.input=e,f=!0,m=w.run_id,yield w;continue}w.run_id===m&&w.event.endsWith("_end")&&(v=w.data)!=null&&v.input&&delete w.data.input,yield w}}finally{l.abort(),await h}}async*_streamEventsV1(e,n,r){let s,a=!1;const i=$e(n),o=i.tags??[],l=i.metadata??{},u=i.runName??this.getName(),d=new Fm({...r,autoClose:!1,_schemaFormat:"streaming_events"}),h=new o4({...r}),f=this._streamLog(e,d,i);for await(const v of f){if(s?s=s.concat(v):s=Qg.fromRunLogPatch(v),s.state===void 0)throw new Error('Internal error: "streamEvents" state is missing. Please open a bug report.');if(!a){a=!0;const p={...s.state},g={run_id:p.id,event:`on_${p.type}_start`,name:u,tags:o,metadata:l,data:{input:e}};h.includeEvent(g,p.type)&&(yield g)}const w=v.ops.filter(p=>p.path.startsWith("/logs/")).map(p=>p.path.split("/")[2]),_=[...new Set(w)];for(const p of _){let g,S={};const N=s.state.logs[p];if(N.end_time===void 0?N.streamed_output.length>0?g="stream":g="start":g="end",g==="start")N.inputs!==void 0&&(S.input=N.inputs);else if(g==="end")N.inputs!==void 0&&(S.input=N.inputs),S.output=N.final_output;else if(g==="stream"){const T=N.streamed_output.length;if(T!==1)throw new Error(`Expected exactly one chunk of streamed output, got ${T} instead. Encountered in: "${N.name}"`);S={chunk:N.streamed_output[0]},N.streamed_output=[]}yield{event:`on_${N.type}_${g}`,name:N.name,run_id:N.id,tags:N.tags,metadata:N.metadata,data:S}}const{state:y}=s;if(y.streamed_output.length>0){const p=y.streamed_output.length;if(p!==1)throw new Error(`Expected exactly one chunk of streamed output, got ${p} instead. Encountered in: "${y.name}"`);const g={chunk:y.streamed_output[0]};y.streamed_output=[];const S={event:`on_${y.type}_stream`,run_id:y.id,tags:o,metadata:l,name:u,data:g};h.includeEvent(S,y.type)&&(yield S)}}const m=s==null?void 0:s.state;if(m!==void 0){const v={event:`on_${m.type}_end`,name:u,run_id:m.id,tags:o,metadata:l,data:{output:m.final_output}};h.includeEvent(v,m.type)&&(yield v)}}static isRunnable(e){return Xg(e)}withListeners({onStart:e,onEnd:n,onError:r}){return new yi({bound:this,config:{},configFactories:[s=>({callbacks:[new Dk({config:s,onStart:e,onEnd:n,onError:r})]})]})}asTool(e){return H5(this,e)}},yi=class lE extends dt{constructor(n){super(n);k(this,"lc_namespace",["langchain_core","runnables"]);k(this,"lc_serializable",!0);k(this,"bound");k(this,"config");k(this,"kwargs");k(this,"configFactories");this.bound=n.bound,this.kwargs=n.kwargs,this.config=n.config,this.configFactories=n.configFactories}static lc_name(){return"RunnableBinding"}getName(n){return this.bound.getName(n)}async _mergeConfig(...n){const r=ju(this.config,...n);return ju(r,...this.configFactories?await Promise.all(this.configFactories.map(async s=>await s(r))):[])}withConfig(n){return new this.constructor({bound:this.bound,kwargs:this.kwargs,config:{...this.config,...n}})}withRetry(n){return new ay({bound:this.bound,kwargs:this.kwargs,config:this.config,maxAttemptNumber:n==null?void 0:n.stopAfterAttempt,...n})}async invoke(n,r){return this.bound.invoke(n,await this._mergeConfig(r,this.kwargs))}async batch(n,r,s){const a=Array.isArray(r)?await Promise.all(r.map(async i=>this._mergeConfig($e(i),this.kwargs))):await this._mergeConfig($e(r),this.kwargs);return this.bound.batch(n,a,s)}_concatOutputChunks(n,r){return this.bound._concatOutputChunks(n,r)}async*_streamIterator(n,r){yield*this.bound._streamIterator(n,await this._mergeConfig($e(r),this.kwargs))}async stream(n,r){return this.bound.stream(n,await this._mergeConfig($e(r),this.kwargs))}async*transform(n,r){yield*this.bound.transform(n,await this._mergeConfig($e(r),this.kwargs))}streamEvents(n,r,s){const a=this,i=async function*(){yield*a.bound.streamEvents(n,{...await a._mergeConfig($e(r),a.kwargs),version:r.version},s)};return sr.fromAsyncGenerator(i())}static isRunnableBinding(n){return n.bound&&dt.isRunnable(n.bound)}withListeners({onStart:n,onEnd:r,onError:s}){return new lE({bound:this.bound,kwargs:this.kwargs,config:this.config,configFactories:[a=>({callbacks:[new Dk({config:a,onStart:n,onEnd:r,onError:s})]})]})}},z5=class cE extends dt{constructor(n){super(n);k(this,"lc_serializable",!0);k(this,"lc_namespace",["langchain_core","runnables"]);k(this,"bound");this.bound=n.bound}static lc_name(){return"RunnableEach"}async invoke(n,r){return this._callWithConfig(this._invoke.bind(this),n,r)}async _invoke(n,r,s){return this.bound.batch(n,Je(r,{callbacks:s==null?void 0:s.getChild()}))}withListeners({onStart:n,onEnd:r,onError:s}){return new cE({bound:this.bound.withListeners({onStart:n,onEnd:r,onError:s})})}},ay=class extends yi{constructor(e){super(e);k(this,"lc_namespace",["langchain_core","runnables"]);k(this,"maxAttemptNumber",3);k(this,"onFailedAttempt",()=>{});this.maxAttemptNumber=e.maxAttemptNumber??this.maxAttemptNumber,this.onFailedAttempt=e.onFailedAttempt??this.onFailedAttempt}static lc_name(){return"RunnableRetry"}_patchConfigForRetry(e,n,r){const s=e>1?`retry:attempt:${e}`:void 0;return Je(n,{callbacks:r==null?void 0:r.getChild(s)})}async _invoke(e,n,r){return zm(s=>super.invoke(e,this._patchConfigForRetry(s,n,r)),{onFailedAttempt:({error:s})=>this.onFailedAttempt(s,e),retries:Math.max(this.maxAttemptNumber-1,0),randomize:!0})}async invoke(e,n){return this._callWithConfig(this._invoke.bind(this),e,n)}async _batch(e,n,r,s){const a={};try{await zm(async i=>{const o=e.map((f,m)=>m).filter(f=>a[f.toString()]===void 0||a[f.toString()]instanceof Error),l=o.map(f=>e[f]),u=o.map(f=>this._patchConfigForRetry(i,n==null?void 0:n[f],r==null?void 0:r[f])),d=await super.batch(l,u,{...s,returnExceptions:!0});let h;for(let f=0;f<d.length;f+=1){const m=d[f],v=o[f];m instanceof Error&&h===void 0&&(h=m,h.input=l[f]),a[v.toString()]=m}if(h)throw h;return d},{onFailedAttempt:({error:i})=>this.onFailedAttempt(i,i.input),retries:Math.max(this.maxAttemptNumber-1,0),randomize:!0})}catch(i){if((s==null?void 0:s.returnExceptions)!==!0)throw i}return Object.keys(a).sort((i,o)=>parseInt(i,10)-parseInt(o,10)).map(i=>a[parseInt(i,10)])}async batch(e,n,r){return this._batchWithConfig(this._batch.bind(this),e,n,r)}},Ti=class uo extends dt{constructor(n){super(n);k(this,"first");k(this,"middle",[]);k(this,"last");k(this,"omitSequenceTags",!1);k(this,"lc_serializable",!0);k(this,"lc_namespace",["langchain_core","runnables"]);this.first=n.first,this.middle=n.middle??this.middle,this.last=n.last,this.name=n.name,this.omitSequenceTags=n.omitSequenceTags??this.omitSequenceTags}static lc_name(){return"RunnableSequence"}get steps(){return[this.first,...this.middle,this.last]}async invoke(n,r){var u;const s=$e(r),a=await xn(s),i=await(a==null?void 0:a.handleChainStart(this.toJSON(),wt(n,"input"),s.runId,void 0,void 0,void 0,s==null?void 0:s.runName));delete s.runId;let o=n,l;try{const d=[this.first,...this.middle];for(let h=0;h<d.length;h+=1){const m=d[h].invoke(o,Je(s,{callbacks:i==null?void 0:i.getChild(this.omitSequenceTags?void 0:`seq:step:${h+1}`)}));o=await Xr(m,r==null?void 0:r.signal)}if((u=r==null?void 0:r.signal)!=null&&u.aborted)throw sl(r.signal);l=await this.last.invoke(o,Je(s,{callbacks:i==null?void 0:i.getChild(this.omitSequenceTags?void 0:`seq:step:${this.steps.length}`)}))}catch(d){throw await(i==null?void 0:i.handleChainError(d)),d}return await(i==null?void 0:i.handleChainEnd(wt(l,"output"))),l}async batch(n,r,s){var u;const a=this._getOptionsList(r??{},n.length),i=await Promise.all(a.map(xn)),o=await Promise.all(i.map(async(d,h)=>{const f=await(d==null?void 0:d.handleChainStart(this.toJSON(),wt(n[h],"input"),a[h].runId,void 0,void 0,void 0,a[h].runName));return delete a[h].runId,f}));let l=n;try{for(let d=0;d<this.steps.length;d+=1){const f=this.steps[d].batch(l,o.map((m,v)=>{const w=m==null?void 0:m.getChild(this.omitSequenceTags?void 0:`seq:step:${d+1}`);return Je(a[v],{callbacks:w})}),s);l=await Xr(f,(u=a[0])==null?void 0:u.signal)}}catch(d){throw await Promise.all(o.map(h=>h==null?void 0:h.handleChainError(d))),d}return await Promise.all(o.map(d=>d==null?void 0:d.handleChainEnd(wt(l,"output")))),l}_concatOutputChunks(n,r){return this.last._concatOutputChunks(n,r)}async*_streamIterator(n,r){var f;const s=await xn(r),{runId:a,...i}=r??{},o=await(s==null?void 0:s.handleChainStart(this.toJSON(),wt(n,"input"),a,void 0,void 0,void 0,i==null?void 0:i.runName)),l=[this.first,...this.middle,this.last];let u=!0,d;async function*h(){yield n}try{let m=l[0].transform(h(),Je(i,{callbacks:o==null?void 0:o.getChild(this.omitSequenceTags?void 0:"seq:step:1")}));for(let v=1;v<l.length;v+=1)m=await l[v].transform(m,Je(i,{callbacks:o==null?void 0:o.getChild(this.omitSequenceTags?void 0:`seq:step:${v+1}`)}));for await(const v of m)if((f=r==null?void 0:r.signal)==null||f.throwIfAborted(),yield v,u)if(d===void 0)d=v;else try{d=this._concatOutputChunks(d,v)}catch{d=void 0,u=!1}}catch(m){throw await(o==null?void 0:o.handleChainError(m)),m}await(o==null?void 0:o.handleChainEnd(wt(d,"output")))}getGraph(n){const r=new sy;let s=null;return this.steps.forEach((a,i)=>{const o=a.getGraph(n);i!==0&&o.trimFirstNode(),i!==this.steps.length-1&&o.trimLastNode(),r.extend(o);const l=o.firstNode();if(!l)throw new Error(`Runnable ${a} has no first node`);s&&r.addEdge(s,l),s=o.lastNode()}),r}pipe(n){return uo.isRunnableSequence(n)?new uo({first:this.first,middle:this.middle.concat([this.last,n.first,...n.middle]),last:n.last,name:this.name??n.name}):new uo({first:this.first,middle:[...this.middle,this.last],last:Xn(n),name:this.name})}static isRunnableSequence(n){return Array.isArray(n.middle)&&dt.isRunnable(n)}static from([n,...r],s){let a={};return typeof s=="string"?a.name=s:s!==void 0&&(a=s),new uo({...a,first:Xn(n),middle:r.slice(0,-1).map(Xn),last:Xn(r[r.length-1])})}},Ai=class uE extends dt{constructor(n){super(n);k(this,"lc_namespace",["langchain_core","runnables"]);k(this,"lc_serializable",!0);k(this,"steps");this.steps={};for(const[r,s]of Object.entries(n.steps))this.steps[r]=Xn(s)}static lc_name(){return"RunnableMap"}getStepsKeys(){return Object.keys(this.steps)}static from(n){return new uE({steps:n})}async invoke(n,r){const s=$e(r),a=await xn(s),i=await(a==null?void 0:a.handleChainStart(this.toJSON(),{input:n},s.runId,void 0,void 0,void 0,s==null?void 0:s.runName));delete s.runId;const o={};try{const l=Object.entries(this.steps).map(async([u,d])=>{o[u]=await d.invoke(n,Je(s,{callbacks:i==null?void 0:i.getChild(`map:key:${u}`)}))});await Xr(Promise.all(l),r==null?void 0:r.signal)}catch(l){throw await(i==null?void 0:i.handleChainError(l)),l}return await(i==null?void 0:i.handleChainEnd(o)),o}async*_transform(n,r,s){const a={...this.steps},i=Jg(n,Object.keys(a).length),o=new Map(Object.entries(a).map(([l,u],d)=>{const h=u.transform(i[d],Je(s,{callbacks:r==null?void 0:r.getChild(`map:key:${l}`)}));return[l,h.next().then(f=>({key:l,gen:h,result:f}))]}));for(;o.size;){const l=Promise.race(o.values()),{key:u,result:d,gen:h}=await Xr(l,s==null?void 0:s.signal);o.delete(u),d.done||(yield{[u]:d.value},o.set(u,h.next().then(f=>({key:u,gen:h,result:f}))))}}transform(n,r){return this._transformStreamWithConfig(n,this._transform.bind(this),r)}async stream(n,r){async function*s(){yield n}const a=$e(r),i=new Sa({generator:this.transform(s(),a),config:a});return await i.setup,sr.fromAsyncGenerator(i)}},U5=class dE extends dt{constructor(n){super(n);k(this,"lc_serializable",!1);k(this,"lc_namespace",["langchain_core","runnables"]);k(this,"func");if(!Kg(n.func))throw new Error("RunnableTraceable requires a function that is wrapped in traceable higher-order function");this.func=n.func}async invoke(n,r){const[s]=this._getOptionsList(r??{},1),a=await xn(s),i=this.func(Je(s,{callbacks:a}),n);return Xr(i,s==null?void 0:s.signal)}async*_streamIterator(n,r){var i,o;const[s]=this._getOptionsList(r??{},1),a=await this.invoke(n,r);if(Km(a)){for await(const l of a)(i=s==null?void 0:s.signal)==null||i.throwIfAborted(),yield l;return}if(F5(a)){for(;;){(o=s==null?void 0:s.signal)==null||o.throwIfAborted();const l=a.next();if(l.done)break;yield l.value}return}yield a}static from(n){return new dE({func:n})}};function B5(t){if(Kg(t))throw new Error("RunnableLambda requires a function that is not wrapped in traceable higher-order function. This shouldn't happen.")}var ss=class hE extends dt{constructor(n){if(Kg(n.func))return U5.from(n.func);super(n);k(this,"lc_namespace",["langchain_core","runnables"]);k(this,"func");B5(n.func),this.func=n.func}static lc_name(){return"RunnableLambda"}static from(n){return new hE({func:n})}async _invoke(n,r,s){return new Promise((a,i)=>{const o=Je(r,{callbacks:s==null?void 0:s.getChild(),recursionLimit:((r==null?void 0:r.recursionLimit)??af)-1});rr.runWithConfig(Qr(o),async()=>{var l,u;try{let d=await this.func(n,{...o});if(d&&dt.isRunnable(d)){if((r==null?void 0:r.recursionLimit)===0)throw new Error("Recursion limit reached.");d=await d.invoke(n,{...o,recursionLimit:(o.recursionLimit??af)-1})}else if(Km(d)){let h;for await(const f of Jm(o,d))if((l=r==null?void 0:r.signal)==null||l.throwIfAborted(),h===void 0)h=f;else try{h=this._concatOutputChunks(h,f)}catch{h=f}d=h}else if(rw(d)){let h;for(const f of sw(o,d))if((u=r==null?void 0:r.signal)==null||u.throwIfAborted(),h===void 0)h=f;else try{h=this._concatOutputChunks(h,f)}catch{h=f}d=h}a(d)}catch(d){i(d)}})})}async invoke(n,r){return this._callWithConfig(this._invoke.bind(this),n,r)}async*_transform(n,r,s){var l,u;let a;for await(const d of n)if(a===void 0)a=d;else try{a=this._concatOutputChunks(a,d)}catch{a=d}const i=Je(s,{callbacks:r==null?void 0:r.getChild(),recursionLimit:((s==null?void 0:s.recursionLimit)??af)-1}),o=await new Promise((d,h)=>{rr.runWithConfig(Qr(i),async()=>{try{const f=await this.func(a,{...i,config:i});d(f)}catch(f){h(f)}})});if(o&&dt.isRunnable(o)){if((s==null?void 0:s.recursionLimit)===0)throw new Error("Recursion limit reached.");const d=await o.stream(a,i);for await(const h of d)yield h}else if(Km(o))for await(const d of Jm(i,o))(l=s==null?void 0:s.signal)==null||l.throwIfAborted(),yield d;else if(rw(o))for(const d of sw(i,o))(u=s==null?void 0:s.signal)==null||u.throwIfAborted(),yield d;else yield o}transform(n,r){return this._transformStreamWithConfig(n,this._transform.bind(this),r)}async stream(n,r){async function*s(){yield n}const a=$e(r),i=new Sa({generator:this.transform(s(),a),config:a});return await i.setup,sr.fromAsyncGenerator(i)}},G5=class extends Ai{},fE=class extends dt{constructor(e){super(e);k(this,"lc_namespace",["langchain_core","runnables"]);k(this,"lc_serializable",!0);k(this,"runnable");k(this,"fallbacks");this.runnable=e.runnable,this.fallbacks=e.fallbacks}static lc_name(){return"RunnableWithFallbacks"}*runnables(){yield this.runnable;for(const e of this.fallbacks)yield e}async invoke(e,n){const r=$e(n),s=await xn(r),{runId:a,...i}=r,o=await(s==null?void 0:s.handleChainStart(this.toJSON(),wt(e,"input"),a,void 0,void 0,void 0,i==null?void 0:i.runName)),l=Je(i,{callbacks:o==null?void 0:o.getChild()});return await rr.runWithConfig(l,async()=>{var h;let d;for(const f of this.runnables()){(h=r==null?void 0:r.signal)==null||h.throwIfAborted();try{const m=await f.invoke(e,l);return await(o==null?void 0:o.handleChainEnd(wt(m,"output"))),m}catch(m){d===void 0&&(d=m)}}throw d===void 0?new Error("No error stored at end of fallback."):(await(o==null?void 0:o.handleChainError(d)),d)})}async*_streamIterator(e,n){var h;const r=$e(n),s=await xn(r),{runId:a,...i}=r,o=await(s==null?void 0:s.handleChainStart(this.toJSON(),wt(e,"input"),a,void 0,void 0,void 0,i==null?void 0:i.runName));let l,u;for(const f of this.runnables()){(h=r==null?void 0:r.signal)==null||h.throwIfAborted();const m=Je(i,{callbacks:o==null?void 0:o.getChild()});try{const v=await f.stream(e,m);u=Jm(m,v);break}catch(v){l===void 0&&(l=v)}}if(u===void 0){const f=l??new Error("No error stored at end of fallback.");throw await(o==null?void 0:o.handleChainError(f)),f}let d;try{for await(const f of u){yield f;try{d=d===void 0?d:this._concatOutputChunks(d,f)}catch{d=void 0}}}catch(f){throw await(o==null?void 0:o.handleChainError(f)),f}await(o==null?void 0:o.handleChainEnd(wt(d,"output")))}async batch(e,n,r){var l;if(r!=null&&r.returnExceptions)throw new Error("Not implemented.");const s=this._getOptionsList(n??{},e.length),a=await Promise.all(s.map(u=>xn(u))),i=await Promise.all(a.map(async(u,d)=>{const h=await(u==null?void 0:u.handleChainStart(this.toJSON(),wt(e[d],"input"),s[d].runId,void 0,void 0,void 0,s[d].runName));return delete s[d].runId,h}));let o;for(const u of this.runnables()){(l=s[0].signal)==null||l.throwIfAborted();try{const d=await u.batch(e,i.map((h,f)=>Je(s[f],{callbacks:h==null?void 0:h.getChild()})),r);return await Promise.all(i.map((h,f)=>h==null?void 0:h.handleChainEnd(wt(d[f],"output")))),d}catch(d){o===void 0&&(o=d)}}throw o?(await Promise.all(i.map(u=>u==null?void 0:u.handleChainError(o))),o):new Error("No error stored at end of fallbacks.")}};function Xn(t){if(typeof t=="function")return new ss({func:t});if(dt.isRunnable(t))return t;if(!Array.isArray(t)&&typeof t=="object"){const e={};for(const[n,r]of Object.entries(t))e[n]=Xn(r);return new Ai({steps:e})}else throw new Error(`Expected a Runnable, function or object.
Instead got an unsupported type.`)}var iy=class extends dt{constructor(e){e instanceof Ai&&(e={mapper:e});super(e);k(this,"lc_namespace",["langchain_core","runnables"]);k(this,"lc_serializable",!0);k(this,"mapper");this.mapper=e.mapper}static lc_name(){return"RunnableAssign"}async invoke(e,n){const r=await this.mapper.invoke(e,n);return{...e,...r}}async*_transform(e,n,r){const s=this.mapper.getStepsKeys(),[a,i]=Jg(e),o=this.mapper.transform(i,Je(r,{callbacks:n==null?void 0:n.getChild()})),l=o.next();for await(const u of a){if(typeof u!="object"||Array.isArray(u))throw new Error(`RunnableAssign can only be used with objects as input, got ${typeof u}`);const d=Object.fromEntries(Object.entries(u).filter(([h])=>!s.includes(h)));Object.keys(d).length>0&&(yield d)}yield(await l).value;for await(const u of o)yield u}transform(e,n){return this._transformStreamWithConfig(e,this._transform.bind(this),n)}async stream(e,n){async function*r(){yield e}const s=$e(n),a=new Sa({generator:this.transform(r(),s),config:s});return await a.setup,sr.fromAsyncGenerator(a)}},mE=class extends dt{constructor(e){(typeof e=="string"||Array.isArray(e))&&(e={keys:e});super(e);k(this,"lc_namespace",["langchain_core","runnables"]);k(this,"lc_serializable",!0);k(this,"keys");this.keys=e.keys}static lc_name(){return"RunnablePick"}async _pick(e){if(typeof this.keys=="string")return e[this.keys];{const n=this.keys.map(r=>[r,e[r]]).filter(r=>r[1]!==void 0);return n.length===0?void 0:Object.fromEntries(n)}}async invoke(e,n){return this._callWithConfig(this._pick.bind(this),e,n)}async*_transform(e){for await(const n of e){const r=await this._pick(n);r!==void 0&&(yield r)}}transform(e,n){return this._transformStreamWithConfig(e,this._transform.bind(this),n)}async stream(e,n){async function*r(){yield e}const s=$e(n),a=new Sa({generator:this.transform(r(),s),config:s});return await a.setup,sr.fromAsyncGenerator(a)}},Ym=class extends yi{constructor(e){const n=Ti.from([ss.from(async r=>{let s;if(To(r))try{s=await Md(this.schema,r.args)}catch{throw new Tu("Received tool input did not match expected schema",JSON.stringify(r.args))}else s=r;return s}).withConfig({runName:`${e.name}:parse_input`}),e.bound]).withConfig({runName:e.name});super({bound:n,config:e.config??{}});k(this,"name");k(this,"description");k(this,"schema");this.name=e.name,this.description=e.description,this.schema=e.schema}static lc_name(){return"RunnableToolLike"}};function H5(t,e){const n=e.name??t.getName(),r=e.description??Fd(e.schema);return ty(e.schema)?new Ym({name:n,description:r,schema:Bd({input:Ud()}).transform(s=>s.input),bound:t}):new Ym({name:n,description:r,schema:e.schema,bound:t})}const Bu=(t,e)=>{const n=[...new Set(e==null?void 0:e.map(s=>{if(typeof s=="string")return s;const a=new s({});if(!("getType"in a)||typeof a.getType!="function")throw new Error("Invalid type provided.");return a.getType()}))],r=t.getType();return n.some(s=>s===r)};function W5(t,e){return Array.isArray(t)?aw(t,e):ss.from(n=>aw(n,t))}function aw(t,e={}){const{includeNames:n,excludeNames:r,includeTypes:s,excludeTypes:a,includeIds:i,excludeIds:o}=e,l=[];for(const u of t)if(!(r&&u.name&&r.includes(u.name))){{if(a&&Bu(u,a))continue;if(o&&u.id&&o.includes(u.id))continue}s||i||n?(n&&u.name&&n.some(d=>d===u.name)||s&&Bu(u,s)||i&&u.id&&i.some(d=>d===u.id))&&l.push(u):l.push(u)}return l}function V5(t){return Array.isArray(t)?iw(t):ss.from(iw)}function iw(t){if(!t.length)return[];const e=[];for(const n of t){const r=n,s=e.pop();if(!s)e.push(r);else if(r.getType()==="tool"||r.getType()!==s.getType())e.push(s,r);else{const a=Au(s),i=Au(r),o=a.concat(i);typeof a.content=="string"&&typeof i.content=="string"&&(o.content=`${a.content}
${i.content}`),e.push(K5(o))}}return e}function q5(t,e){if(Array.isArray(t)){const n=t;if(!e)throw new Error("Options parameter is required when providing messages.");return ow(n,e)}else{const n=t;return ss.from(r=>ow(r,n)).withConfig({runName:"trim_messages"})}}async function ow(t,e){const{maxTokens:n,tokenCounter:r,strategy:s="last",allowPartial:a=!1,endOn:i,startOn:o,includeSystem:l=!1,textSplitter:u}=e;if(o&&s==="first")throw new Error("`startOn` should only be specified if `strategy` is 'last'.");if(l&&s==="first")throw new Error("`includeSystem` should only be specified if `strategy` is 'last'.");let d;"getNumTokens"in r?d=async f=>(await Promise.all(f.map(v=>r.getNumTokens(v.content)))).reduce((v,w)=>v+w,0):d=async f=>r(f);let h=gE;if(u&&("splitText"in u?h=u.splitText:h=async f=>u(f)),s==="first")return pE(t,{maxTokens:n,tokenCounter:d,textSplitter:h,partialStrategy:a?"first":void 0,endOn:i});if(s==="last")return Z5(t,{maxTokens:n,tokenCounter:d,textSplitter:h,allowPartial:a,includeSystem:l,startOn:o,endOn:i});throw new Error(`Unrecognized strategy: '${s}'. Must be one of 'first' or 'last'.`)}async function pE(t,e){const{maxTokens:n,tokenCounter:r,textSplitter:s,partialStrategy:a,endOn:i}=e;let o=[...t],l=0;for(let u=0;u<o.length;u+=1){const d=u>0?o.slice(0,-u):o;if(await r(d)<=n){l=o.length-u;break}}if(l<o.length&&a){let u=!1;if(Array.isArray(o[l].content)){const d=o[l];if(typeof d.content=="string")throw new Error("Expected content to be an array.");const h=d.content.length,f=a==="last"?[...d.content].reverse():d.content;for(let m=1;m<=h;m+=1){const v=a==="first"?f.slice(0,m):f.slice(-m),w=Object.fromEntries(Object.entries(d).filter(([p])=>p!=="type"&&!p.startsWith("lc_"))),_=oy(d.getType(),{...w,content:v}),y=[...o.slice(0,l),_];if(await r(y)<=n)o=y,l+=1,u=!0;else break}u&&a==="last"&&(d.content=[...f].reverse())}if(!u){const d=o[l];let h;if(Array.isArray(d.content)&&d.content.some(f=>typeof f=="string"||f.type==="text")){const f=d.content.find(m=>m.type==="text"&&m.text);h=f==null?void 0:f.text}else typeof d.content=="string"&&(h=d.content);if(h){const f=await s(h),m=f.length;a==="last"&&f.reverse();for(let v=0;v<m-1;v+=1)if(f.pop(),d.content=f.join(""),await r([...o.slice(0,l),d])<=n){a==="last"&&(d.content=[...f].reverse().join("")),o=[...o.slice(0,l),d],l+=1;break}}}}if(i){const u=Array.isArray(i)?i:[i];for(;l>0&&!Bu(o[l-1],u);)l-=1}return o.slice(0,l)}async function Z5(t,e){var d;const{allowPartial:n=!1,includeSystem:r=!1,endOn:s,startOn:a,...i}=e;let o=t.map(h=>{const f=Object.fromEntries(Object.entries(h).filter(([m])=>m!=="type"&&!m.startsWith("lc_")));return oy(h.getType(),f,Ag(h))});if(s){const h=Array.isArray(s)?s:[s];for(;o.length>0&&!Bu(o[o.length-1],h);)o=o.slice(0,-1)}const l=r&&((d=o[0])==null?void 0:d.getType())==="system";let u=l?o.slice(0,1).concat(o.slice(1).reverse()):o.reverse();return u=await pE(u,{...i,partialStrategy:n?"last":void 0,endOn:a}),l?[u[0],...u.slice(1).reverse()]:u.reverse()}const lw={human:{message:Or,messageChunk:bl},ai:{message:hn,messageChunk:Rr},system:{message:Yr,messageChunk:Ls},developer:{message:Yr,messageChunk:Ls},tool:{message:Ir,messageChunk:_l},function:{message:Ed,messageChunk:xl},generic:{message:ba,messageChunk:wl},remove:{message:Nu,messageChunk:Nu}};function oy(t,e,n){var a;let r,s;switch(t){case"human":n?r=new bl(e):s=new Or(e);break;case"ai":if(n){let i={...e};"tool_calls"in i&&(i={...i,tool_call_chunks:(a=i.tool_calls)==null?void 0:a.map(o=>({...o,type:"tool_call_chunk",index:void 0,args:JSON.stringify(o.args)}))}),r=new Rr(i)}else s=new hn(e);break;case"system":n?r=new Ls(e):s=new Yr(e);break;case"developer":n?r=new Ls({...e,additional_kwargs:{...e.additional_kwargs,__openai_role__:"developer"}}):s=new Yr({...e,additional_kwargs:{...e.additional_kwargs,__openai_role__:"developer"}});break;case"tool":if("tool_call_id"in e)n?r=new _l(e):s=new Ir(e);else throw new Error("Can not convert ToolMessage to ToolMessageChunk if 'tool_call_id' field is not defined.");break;case"function":if(n)r=new xl(e);else{if(!e.name)throw new Error("FunctionMessage must have a 'name' field");s=new Ed(e)}break;case"generic":if("role"in e)n?r=new wl(e):s=new ba(e);else throw new Error("Can not convert ChatMessage to ChatMessageChunk if 'role' field is not defined.");break;default:throw new Error(`Unrecognized message type ${t}`)}if(n&&r)return r;if(s)return s;throw new Error(`Unrecognized message type ${t}`)}function K5(t){const e=t.getType();let n;const r=Object.fromEntries(Object.entries(t).filter(([s])=>!["type","tool_call_chunks"].includes(s)&&!s.startsWith("lc_")));if(e in lw&&(n=oy(e,r)),!n)throw new Error(`Unrecognized message chunk class ${e}. Supported classes are ${Object.keys(lw)}`);return n}function gE(t){const e=t.split(`
`);return Promise.resolve([...e.slice(0,-1).map(n=>`${n}
`),e[e.length-1]])}const J5=["tool_call","tool_call_chunk","invalid_tool_call","server_tool_call","server_tool_call_chunk","server_tool_call_result"],Y5=["image","video","audio","text-plain","file"],Q5=["text","reasoning",...J5,...Y5];var X5={};je(X5,{AIMessage:()=>hn,AIMessageChunk:()=>Rr,BaseMessage:()=>rs,BaseMessageChunk:()=>Gs,ChatMessage:()=>ba,ChatMessageChunk:()=>wl,FunctionMessage:()=>Ed,FunctionMessageChunk:()=>xl,HumanMessage:()=>Or,HumanMessageChunk:()=>bl,KNOWN_BLOCK_TYPES:()=>Q5,RemoveMessage:()=>Nu,SystemMessage:()=>Yr,SystemMessageChunk:()=>Ls,ToolMessage:()=>Ir,ToolMessageChunk:()=>_l,_isMessageFieldWithRole:()=>AS,_mergeDicts:()=>Ut,_mergeLists:()=>vl,_mergeObj:()=>NS,_mergeStatus:()=>ES,coerceMessageLikeToMessage:()=>Ao,convertToChunk:()=>Au,convertToOpenAIImageBlock:()=>gS,convertToProviderContentBlock:()=>kg,defaultTextSplitter:()=>gE,defaultToolCallParser:()=>Ig,filterMessages:()=>W5,getBufferString:()=>Rg,iife:()=>DS,isAIMessage:()=>kd,isAIMessageChunk:()=>Nm,isBase64ContentBlock:()=>Sg,isBaseMessage:()=>xs,isBaseMessageChunk:()=>Ag,isChatMessage:()=>u2,isChatMessageChunk:()=>d2,isDataContentBlock:()=>Cr,isDirectToolOutput:()=>Cg,isFunctionMessage:()=>h2,isFunctionMessageChunk:()=>f2,isHumanMessage:()=>m2,isHumanMessageChunk:()=>p2,isIDContentBlock:()=>pS,isMessage:()=>yS,isOpenAIToolCallArray:()=>e2,isPlainTextContentBlock:()=>EI,isSystemMessage:()=>g2,isSystemMessageChunk:()=>y2,isToolMessage:()=>RS,isToolMessageChunk:()=>OS,isURLContentBlock:()=>bg,mapChatMessagesToStoredMessages:()=>S2,mapStoredMessageToChatMessage:()=>Og,mapStoredMessagesToChatMessages:()=>b2,mergeContent:()=>Jr,mergeMessageRuns:()=>V5,mergeResponseMetadata:()=>CS,mergeUsageMetadata:()=>jS,parseBase64DataUrl:()=>Xo,parseMimeType:()=>km,trimMessages:()=>q5});const da=t=>t();function Tl(t){return t?!!(/^o\d/.test(t??"")||t.startsWith("gpt-5")&&!t.startsWith("gpt-5-chat")):!1}function e3(t){return t.role!=="system"&&t.role!=="developer"&&t.role!=="assistant"&&t.role!=="user"&&t.role!=="function"&&t.role!=="tool"&&console.warn(`Unknown message role: ${t.role}`),t.role}function Al(t){const e=t._getType();switch(e){case"system":return"system";case"ai":return"assistant";case"human":return"user";case"function":return"function";case"tool":return"tool";case"generic":if(!ba.isInstance(t))throw new Error("Invalid generic chat message");return e3(t);default:throw new Error(`Unknown message type: ${e}`)}}function t3(t){const{azureOpenAIApiDeploymentName:e,azureOpenAIApiInstanceName:n,azureOpenAIApiKey:r,azureOpenAIBasePath:s,baseURL:a,azureADTokenProvider:i,azureOpenAIEndpoint:o}=t;if((r||i)&&s&&e)return`${s}/${e}`;if((r||i)&&o&&e)return`${o}/openai/deployments/${e}`;if(r||i){if(!n)throw new Error("azureOpenAIApiInstanceName is required when using azureOpenAIApiKey");if(!e)throw new Error("azureOpenAIApiDeploymentName is a required parameter when using azureOpenAIApiKey");return`https://${n}.openai.azure.com/openai/deployments/${e}`}return a}function cw(t){return typeof Headers<"u"&&t!==null&&typeof t=="object"&&Object.prototype.toString.call(t)==="[object Headers]"}function n3(t){const e=da(()=>{if(cw(t))return t;if(Array.isArray(t))return new Headers(t);if(typeof t=="object"&&t!==null&&"values"in t&&cw(t.values))return t.values;if(typeof t=="object"&&t!==null){const n=Object.entries(t).filter(([,r])=>typeof r=="string").map(([r,s])=>[r,s]);return new Headers(n)}return new Headers});return Object.fromEntries(e.entries())}function r3(){let t=Pg();return(t==="node"||t==="deno")&&(t=`(${t}/${process.version}; ${process.platform}; ${process.arch})`),t}function s3(t,e=!1,n="1.0.0"){const r=n3(t),s=r3(),a=`langchainjs${e?"-azure":""}-openai`;return{...r,"User-Agent":r["User-Agent"]?`${a}/${n} (${s})${r["User-Agent"]}`:`${a}/${n} (${s})`}}function ly(t){return t!==void 0&&Array.isArray(t.lc_namespace)}function cy(t){return t!==void 0&&dt.isRunnable(t)&&"lc_name"in t.constructor&&typeof t.constructor.lc_name=="function"&&t.constructor.lc_name()==="RunnableToolLike"}function uy(t){return!!t&&typeof t=="object"&&"name"in t&&"schema"in t&&(xr(t.schema)||t.schema!=null&&typeof t.schema=="object"&&"type"in t.schema&&typeof t.schema.type=="string"&&["null","boolean","object","array","number","string"].includes(t.schema.type))}function Gd(t){return uy(t)||cy(t)||ly(t)}var a3={};je(a3,{convertToOpenAIFunction:()=>yE,convertToOpenAITool:()=>vE,isLangChainTool:()=>Gd,isRunnableToolLike:()=>cy,isStructuredTool:()=>ly,isStructuredToolParams:()=>uy});function yE(t,e){const n=typeof e=="number"?void 0:e;return{name:t.name,description:t.description,parameters:br(t.schema),...(n==null?void 0:n.strict)!==void 0?{strict:n.strict}:{}}}function vE(t,e){const n=typeof e=="number"?void 0:e;let r;return Gd(t)?r={type:"function",function:yE(t)}:r=t,(n==null?void 0:n.strict)!==void 0&&(r.function.strict=n.strict),r}var i3={};je(i3,{extendInteropZodObject:()=>D4,getInteropZodDefaultGetter:()=>F4,getInteropZodObjectShape:()=>Um,getSchemaDescription:()=>Fd,interopParse:()=>P4,interopParseAsync:()=>Md,interopSafeParse:()=>O4,interopSafeParseAsync:()=>qk,interopZodObjectMakeFieldsOptional:()=>B4,interopZodObjectPartial:()=>M4,interopZodObjectPassthrough:()=>Bm,interopZodObjectStrict:()=>$u,interopZodTransformInputSchema:()=>Zk,isInteropZodError:()=>Kk,isInteropZodLiteral:()=>R4,isInteropZodObject:()=>L4,isInteropZodSchema:()=>xr,isShapelessZodSchema:()=>$4,isSimpleStringZodSchema:()=>ty,isZodArrayV4:()=>zd,isZodLiteralV3:()=>Wk,isZodLiteralV4:()=>Vk,isZodObjectV3:()=>ny,isZodObjectV4:()=>Tr,isZodSchema:()=>j4,isZodSchemaV3:()=>pt,isZodSchemaV4:()=>ct});function o3(t,e){let n;return Gd(t)?n=vE(t):n=t,(e==null?void 0:e.strict)!==void 0&&(n.function.strict=e.strict),n}function l3(t){return t.anyOf!==void 0&&Array.isArray(t.anyOf)}function c3(t){const e=["namespace functions {",""];for(const n of t)n.description&&e.push(`// ${n.description}`),Object.keys(n.parameters.properties??{}).length>0?(e.push(`type ${n.name} = (_: {`),e.push(_E(n.parameters,0)),e.push("}) => any;")):e.push(`type ${n.name} = () => any;`),e.push("");return e.push("} // namespace functions"),e.join(`
`)}function _E(t,e){var r;const n=[];for(const[s,a]of Object.entries(t.properties??{}))a.description&&e<2&&n.push(`// ${a.description}`),(r=t.required)!=null&&r.includes(s)?n.push(`${s}: ${Gu(a,e)},`):n.push(`${s}?: ${Gu(a,e)},`);return n.map(s=>" ".repeat(e)+s).join(`
`)}function Gu(t,e){if(l3(t))return t.anyOf.map(n=>Gu(n,e)).join(" | ");switch(t.type){case"string":return t.enum?t.enum.map(n=>`"${n}"`).join(" | "):"string";case"number":return t.enum?t.enum.map(n=>`${n}`).join(" | "):"number";case"integer":return t.enum?t.enum.map(n=>`${n}`).join(" | "):"number";case"boolean":return"boolean";case"null":return"null";case"object":return["{",_E(t,e+2),"}"].join(`
`);case"array":return t.items?`${Gu(t.items,e)}[]`:"any[]";default:return""}}function wE(t){if(t)return t==="any"||t==="required"?"required":t==="auto"?"auto":t==="none"?"none":typeof t=="string"?{type:"function",function:{name:t}}:t}function dy(t){return"type"in t&&t.type!=="function"}function u3(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type!=="function"}function Hu(t){return typeof t=="object"&&t!==null&&"metadata"in t&&typeof t.metadata=="object"&&t.metadata!==null&&"customTool"in t.metadata&&typeof t.metadata.customTool=="object"&&t.metadata.customTool!==null}function xE(t){return"type"in t&&t.type==="custom"&&"custom"in t&&typeof t.custom=="object"&&t.custom!==null}function d3(t){if(t.type==="custom_tool_call")return{...t,type:"tool_call",call_id:t.id,id:t.call_id,name:t.name,isCustomTool:!0,args:{input:t.input}}}function h3(t){return t.type==="tool_call"&&"isCustomTool"in t&&t.isCustomTool===!0}function f3(t){const e=()=>{if(t.custom.format){if(t.custom.format.type==="grammar")return{type:"grammar",definition:t.custom.format.grammar.definition,syntax:t.custom.format.grammar.syntax};if(t.custom.format.type==="text")return{type:"text"}}};return{type:"custom",name:t.custom.name,description:t.custom.description,format:e()}}function m3(t){const e=()=>{if(t.format){if(t.format.type==="grammar")return{type:"grammar",grammar:{definition:t.format.definition,syntax:t.format.syntax}};if(t.format.type==="text")return{type:"text"}}};return{type:"custom",custom:{name:t.name,description:t.description,format:e()}}}const p3=Symbol("Let zodToJsonSchema decide on which parser to use"),uw={name:void 0,$refStrategy:"root",effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",nullableStrategy:"from-target",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},g3=t=>typeof t=="string"?{...uw,basePath:["#"],definitions:{},name:t}:{...uw,basePath:["#"],definitions:{},...t},Qm=t=>"_def"in t?t._def:t;function y3(t){if(!t)return!0;for(const e in t)return!1;return!0}const v3=t=>{const e=g3(t),n=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,currentPath:n,propertyPath:void 0,seenRefs:new Set,seen:new Map(Object.entries(e.definitions).map(([r,s])=>[Qm(s),{def:Qm(s),path:[...e.basePath,e.definitionPath,r],jsonSchema:void 0}]))}};function bE(t,e,n,r){r!=null&&r.errorMessages&&n&&(t.errorMessage={...t.errorMessage,[e]:n})}function Be(t,e,n,r,s){t[e]=n,bE(t,e,r,s)}function _3(){return{}}function w3(t,e){var r,s;const n={type:"array"};return((s=(r=t.type)==null?void 0:r._def)==null?void 0:s.typeName)!==P.ZodAny&&(n.items=De(t.type._def,{...e,currentPath:[...e.currentPath,"items"]})),t.minLength&&Be(n,"minItems",t.minLength.value,t.minLength.message,e),t.maxLength&&Be(n,"maxItems",t.maxLength.value,t.maxLength.message,e),t.exactLength&&(Be(n,"minItems",t.exactLength.value,t.exactLength.message,e),Be(n,"maxItems",t.exactLength.value,t.exactLength.message,e)),n}function x3(t,e){const n={type:"integer",format:"int64"};if(!t.checks)return n;for(const r of t.checks)switch(r.kind){case"min":e.target==="jsonSchema7"?r.inclusive?Be(n,"minimum",r.value,r.message,e):Be(n,"exclusiveMinimum",r.value,r.message,e):(r.inclusive||(n.exclusiveMinimum=!0),Be(n,"minimum",r.value,r.message,e));break;case"max":e.target==="jsonSchema7"?r.inclusive?Be(n,"maximum",r.value,r.message,e):Be(n,"exclusiveMaximum",r.value,r.message,e):(r.inclusive||(n.exclusiveMaximum=!0),Be(n,"maximum",r.value,r.message,e));break;case"multipleOf":Be(n,"multipleOf",r.value,r.message,e);break}return n}function b3(){return{type:"boolean"}}function S3(t,e){return De(t.type._def,e)}const k3=(t,e)=>De(t.innerType._def,e);function SE(t,e,n){const r=n??e.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((s,a)=>SE(t,e,s))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return E3(t,e)}}const E3=(t,e)=>{const n={type:"integer",format:"unix-time"};if(e.target==="openApi3")return n;for(const r of t.checks)switch(r.kind){case"min":Be(n,"minimum",r.value,r.message,e);break;case"max":Be(n,"maximum",r.value,r.message,e);break}return n};function N3(t,e){return{...De(t.innerType._def,e),default:t.defaultValue()}}function T3(t,e,n){return e.effectStrategy==="input"?De(t.schema._def,e,n):{}}function A3(t){return{type:"string",enum:[...t.values]}}const C3=t=>"type"in t&&t.type==="string"?!1:"allOf"in t;function I3(t,e){const n=[De(t.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),De(t.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(a=>!!a);let r=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const s=[];return n.forEach(a=>{if(C3(a))s.push(...a.allOf),a.unevaluatedProperties===void 0&&(r=void 0);else{let i=a;if("additionalProperties"in a&&a.additionalProperties===!1){const{additionalProperties:o,...l}=a;i=l}else r=void 0;s.push(i)}}),s.length?{allOf:s,...r}:void 0}function j3(t,e){const n=typeof t.value;return n!=="bigint"&&n!=="number"&&n!=="boolean"&&n!=="string"?{type:Array.isArray(t.value)?"array":"object"}:e.target==="openApi3"?{type:n==="bigint"?"integer":n,enum:[t.value]}:{type:n==="bigint"?"integer":n,const:t.value}}let df;const Ws={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(df===void 0&&(df=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),df),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/};function kE(t,e){const n={type:"string"};function r(s){return e.patternStrategy==="escape"?R3(s):s}if(t.checks)for(const s of t.checks)switch(s.kind){case"min":Be(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,s.value):s.value,s.message,e);break;case"max":Be(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,s.value):s.value,s.message,e);break;case"email":switch(e.emailStrategy){case"format:email":Hn(n,"email",s.message,e);break;case"format:idn-email":Hn(n,"idn-email",s.message,e);break;case"pattern:zod":Wn(n,Ws.email,s.message,e);break}break;case"url":Hn(n,"uri",s.message,e);break;case"uuid":Hn(n,"uuid",s.message,e);break;case"regex":Wn(n,s.regex,s.message,e);break;case"cuid":Wn(n,Ws.cuid,s.message,e);break;case"cuid2":Wn(n,Ws.cuid2,s.message,e);break;case"startsWith":Wn(n,RegExp(`^${r(s.value)}`),s.message,e);break;case"endsWith":Wn(n,RegExp(`${r(s.value)}$`),s.message,e);break;case"datetime":Hn(n,"date-time",s.message,e);break;case"date":Hn(n,"date",s.message,e);break;case"time":Hn(n,"time",s.message,e);break;case"duration":Hn(n,"duration",s.message,e);break;case"length":Be(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,s.value):s.value,s.message,e),Be(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,s.value):s.value,s.message,e);break;case"includes":{Wn(n,RegExp(r(s.value)),s.message,e);break}case"ip":{s.version!=="v6"&&Hn(n,"ipv4",s.message,e),s.version!=="v4"&&Hn(n,"ipv6",s.message,e);break}case"emoji":Wn(n,Ws.emoji,s.message,e);break;case"ulid":{Wn(n,Ws.ulid,s.message,e);break}case"base64":{switch(e.base64Strategy){case"format:binary":{Hn(n,"binary",s.message,e);break}case"contentEncoding:base64":{Be(n,"contentEncoding","base64",s.message,e);break}case"pattern:zod":{Wn(n,Ws.base64,s.message,e);break}}break}case"nanoid":Wn(n,Ws.nanoid,s.message,e)}return n}const R3=t=>Array.from(t).map(e=>/[a-zA-Z0-9]/.test(e)?e:`\\${e}`).join(""),Hn=(t,e,n,r)=>{var s;t.format||(s=t.anyOf)!=null&&s.some(a=>a.format)?(t.anyOf||(t.anyOf=[]),t.format&&(t.anyOf.push({format:t.format,...t.errorMessage&&r.errorMessages&&{errorMessage:{format:t.errorMessage.format}}}),delete t.format,t.errorMessage&&(delete t.errorMessage.format,Object.keys(t.errorMessage).length===0&&delete t.errorMessage)),t.anyOf.push({format:e,...n&&r.errorMessages&&{errorMessage:{format:n}}})):Be(t,"format",e,n,r)},Wn=(t,e,n,r)=>{var s;t.pattern||(s=t.allOf)!=null&&s.some(a=>a.pattern)?(t.allOf||(t.allOf=[]),t.pattern&&(t.allOf.push({pattern:t.pattern,...t.errorMessage&&r.errorMessages&&{errorMessage:{pattern:t.errorMessage.pattern}}}),delete t.pattern,t.errorMessage&&(delete t.errorMessage.pattern,Object.keys(t.errorMessage).length===0&&delete t.errorMessage)),t.allOf.push({pattern:dw(e,r),...n&&r.errorMessages&&{errorMessage:{pattern:n}}})):Be(t,"pattern",dw(e,r),n,r)},dw=(t,e)=>{var u;const n=typeof t=="function"?t():t;if(!e.applyRegexFlags||!n.flags)return n.source;const r={i:n.flags.includes("i"),m:n.flags.includes("m"),s:n.flags.includes("s")},s=r.i?n.source.toLowerCase():n.source;let a="",i=!1,o=!1,l=!1;for(let d=0;d<s.length;d++){if(i){a+=s[d],i=!1;continue}if(r.i){if(o){if(s[d].match(/[a-z]/)){l?(a+=s[d],a+=`${s[d-2]}-${s[d]}`.toUpperCase(),l=!1):s[d+1]==="-"&&((u=s[d+2])!=null&&u.match(/[a-z]/))?(a+=s[d],l=!0):a+=`${s[d]}${s[d].toUpperCase()}`;continue}}else if(s[d].match(/[a-z]/)){a+=`[${s[d]}${s[d].toUpperCase()}]`;continue}}if(r.m){if(s[d]==="^"){a+=`(^|(?<=[\r
]))`;continue}else if(s[d]==="$"){a+=`($|(?=[\r
]))`;continue}}if(r.s&&s[d]==="."){a+=o?`${s[d]}\r
`:`[${s[d]}\r
]`;continue}a+=s[d],s[d]==="\\"?i=!0:o&&s[d]==="]"?o=!1:!o&&s[d]==="["&&(o=!0)}try{const d=new RegExp(a)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),n.source}return a};function EE(t,e){var r,s,a,i;if(e.target==="openApi3"&&((r=t.keyType)==null?void 0:r._def.typeName)===P.ZodEnum)return{type:"object",required:t.keyType._def.values,properties:t.keyType._def.values.reduce((o,l)=>({...o,[l]:De(t.valueType._def,{...e,currentPath:[...e.currentPath,"properties",l]})??{}}),{}),additionalProperties:!1};const n={type:"object",additionalProperties:De(t.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??{}};if(e.target==="openApi3")return n;if(((s=t.keyType)==null?void 0:s._def.typeName)===P.ZodString&&((a=t.keyType._def.checks)!=null&&a.length)){const o=Object.entries(kE(t.keyType._def,e)).reduce((l,[u,d])=>u==="type"?l:{...l,[u]:d},{});return{...n,propertyNames:o}}else if(((i=t.keyType)==null?void 0:i._def.typeName)===P.ZodEnum)return{...n,propertyNames:{enum:t.keyType._def.values}};return n}function O3(t,e){if(e.mapStrategy==="record")return EE(t,e);const n=De(t.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||{},r=De(t.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[n,r],minItems:2,maxItems:2}}}function P3(t){const e=t.values,r=Object.keys(t.values).filter(a=>typeof e[e[a]]!="number").map(a=>e[a]),s=Array.from(new Set(r.map(a=>typeof a)));return{type:s.length===1?s[0]==="string"?"string":"number":["string","number"],enum:r}}function $3(){return{not:{}}}function L3(t){return t.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const Wu={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function D3(t,e){if(e.target==="openApi3")return hw(t,e);const n=t.options instanceof Map?Array.from(t.options.values()):t.options;if(n.every(r=>r._def.typeName in Wu&&(!r._def.checks||!r._def.checks.length))){const r=n.reduce((s,a)=>{const i=Wu[a._def.typeName];return i&&!s.includes(i)?[...s,i]:s},[]);return{type:r.length>1?r:r[0]}}else if(n.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=n.reduce((s,a)=>{const i=typeof a._def.value;switch(i){case"string":case"number":case"boolean":return[...s,i];case"bigint":return[...s,"integer"];case"object":if(a._def.value===null)return[...s,"null"];case"symbol":case"undefined":case"function":default:return s}},[]);if(r.length===n.length){const s=r.filter((a,i,o)=>o.indexOf(a)===i);return{type:s.length>1?s:s[0],enum:n.reduce((a,i)=>a.includes(i._def.value)?a:[...a,i._def.value],[])}}}else if(n.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:n.reduce((r,s)=>[...r,...s._def.values.filter(a=>!r.includes(a))],[])};return hw(t,e)}const hw=(t,e)=>{const n=(t.options instanceof Map?Array.from(t.options.values()):t.options).map((r,s)=>De(r._def,{...e,currentPath:[...e.currentPath,"anyOf",`${s}`]})).filter(r=>!!r&&(!e.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return n.length?{anyOf:n}:void 0};function M3(t,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(t.innerType._def.typeName)&&(!t.innerType._def.checks||!t.innerType._def.checks.length))return e.target==="openApi3"||e.nullableStrategy==="property"?{type:Wu[t.innerType._def.typeName],nullable:!0}:{type:[Wu[t.innerType._def.typeName],"null"]};if(e.target==="openApi3"){const r=De(t.innerType._def,{...e,currentPath:[...e.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const n=De(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return n&&{anyOf:[n,{type:"null"}]}}function F3(t,e){const n={type:"number"};if(!t.checks)return n;for(const r of t.checks)switch(r.kind){case"int":n.type="integer",bE(n,"type",r.message,e);break;case"min":e.target==="jsonSchema7"?r.inclusive?Be(n,"minimum",r.value,r.message,e):Be(n,"exclusiveMinimum",r.value,r.message,e):(r.inclusive||(n.exclusiveMinimum=!0),Be(n,"minimum",r.value,r.message,e));break;case"max":e.target==="jsonSchema7"?r.inclusive?Be(n,"maximum",r.value,r.message,e):Be(n,"exclusiveMaximum",r.value,r.message,e):(r.inclusive||(n.exclusiveMaximum=!0),Be(n,"maximum",r.value,r.message,e));break;case"multipleOf":Be(n,"multipleOf",r.value,r.message,e);break}return n}function z3(t,e){return e.removeAdditionalStrategy==="strict"?t.catchall._def.typeName==="ZodNever"?t.unknownKeys!=="strict":De(t.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0:t.catchall._def.typeName==="ZodNever"?t.unknownKeys==="passthrough":De(t.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0}function U3(t,e){const n={type:"object",...Object.entries(t.shape()).reduce((r,[s,a])=>{var l;if(a===void 0||a._def===void 0)return r;const i=[...e.currentPath,"properties",s],o=De(a._def,{...e,currentPath:i,propertyPath:i});if(o===void 0)return r;if(e.openaiStrictMode&&a.isOptional()&&!a.isNullable()&&typeof((l=a._def)==null?void 0:l.defaultValue)>"u")throw new Error(`Zod field at \`${i.join("/")}\` uses \`.optional()\` without \`.nullable()\` which is not supported by the API. See: https://platform.openai.com/docs/guides/structured-outputs?api-mode=responses#all-fields-must-be-required`);return{properties:{...r.properties,[s]:o},required:a.isOptional()&&!e.openaiStrictMode?r.required:[...r.required,s]}},{properties:{},required:[]}),additionalProperties:z3(t,e)};return n.required.length||delete n.required,n}const B3=(t,e)=>{if(e.propertyPath&&e.currentPath.slice(0,e.propertyPath.length).toString()===e.propertyPath.toString())return De(t.innerType._def,{...e,currentPath:e.currentPath});const n=De(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return n?{anyOf:[{not:{}},n]}:{}},G3=(t,e)=>{if(e.pipeStrategy==="input")return De(t.in._def,e);if(e.pipeStrategy==="output")return De(t.out._def,e);const n=De(t.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),r=De(t.out._def,{...e,currentPath:[...e.currentPath,"allOf",n?"1":"0"]});return{allOf:[n,r].filter(s=>s!==void 0)}};function H3(t,e){return De(t.type._def,e)}function W3(t,e){const r={type:"array",uniqueItems:!0,items:De(t.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return t.minSize&&Be(r,"minItems",t.minSize.value,t.minSize.message,e),t.maxSize&&Be(r,"maxItems",t.maxSize.value,t.maxSize.message,e),r}function V3(t,e){return t.rest?{type:"array",minItems:t.items.length,items:t.items.map((n,r)=>De(n._def,{...e,currentPath:[...e.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[]),additionalItems:De(t.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:t.items.length,maxItems:t.items.length,items:t.items.map((n,r)=>De(n._def,{...e,currentPath:[...e.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[])}}function q3(){return{not:{}}}function Z3(){return{}}const K3=(t,e)=>De(t.innerType._def,e);function De(t,e,n=!1){var i;const r=e.seen.get(t);if(e.override){const o=(i=e.override)==null?void 0:i.call(e,t,e,r,n);if(o!==p3)return o}if(r&&!n){const o=J3(r,e);if(o!==void 0)return"$ref"in o&&e.seenRefs.add(o.$ref),o}const s={def:t,path:e.currentPath,jsonSchema:void 0};e.seen.set(t,s);const a=Q3(t,t.typeName,e,n);return a&&X3(t,e,a),s.jsonSchema=a,a}const J3=(t,e)=>{switch(e.$refStrategy){case"root":return{$ref:t.path.join("/")};case"extract-to-root":const n=t.path.slice(e.basePath.length+1).join("_");return n!==e.name&&e.nameStrategy==="duplicate-ref"&&(e.definitions[n]=t.def),{$ref:[...e.basePath,e.definitionPath,n].join("/")};case"relative":return{$ref:Y3(e.currentPath,t.path)};case"none":case"seen":return t.path.length<e.currentPath.length&&t.path.every((r,s)=>e.currentPath[s]===r)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),{}):e.$refStrategy==="seen"?{}:void 0}},Y3=(t,e)=>{let n=0;for(;n<t.length&&n<e.length&&t[n]===e[n];n++);return[(t.length-n).toString(),...e.slice(n)].join("/")},Q3=(t,e,n,r)=>{switch(e){case P.ZodString:return kE(t,n);case P.ZodNumber:return F3(t,n);case P.ZodObject:return U3(t,n);case P.ZodBigInt:return x3(t,n);case P.ZodBoolean:return b3();case P.ZodDate:return SE(t,n);case P.ZodUndefined:return q3();case P.ZodNull:return L3(n);case P.ZodArray:return w3(t,n);case P.ZodUnion:case P.ZodDiscriminatedUnion:return D3(t,n);case P.ZodIntersection:return I3(t,n);case P.ZodTuple:return V3(t,n);case P.ZodRecord:return EE(t,n);case P.ZodLiteral:return j3(t,n);case P.ZodEnum:return A3(t);case P.ZodNativeEnum:return P3(t);case P.ZodNullable:return M3(t,n);case P.ZodOptional:return B3(t,n);case P.ZodMap:return O3(t,n);case P.ZodSet:return W3(t,n);case P.ZodLazy:return De(t.getter()._def,n);case P.ZodPromise:return H3(t,n);case P.ZodNaN:case P.ZodNever:return $3();case P.ZodEffects:return T3(t,n,r);case P.ZodAny:return _3();case P.ZodUnknown:return Z3();case P.ZodDefault:return N3(t,n);case P.ZodBranded:return S3(t,n);case P.ZodReadonly:return K3(t,n);case P.ZodCatch:return k3(t,n);case P.ZodPipeline:return G3(t,n);case P.ZodFunction:case P.ZodVoid:case P.ZodSymbol:return;default:return(s=>{})()}},X3=(t,e,n)=>(t.description&&(n.description=t.description,e.markdownDescription&&(n.markdownDescription=t.description)),n),eD=(t,e)=>{const n=v3(e),r=typeof e=="string"?e:(e==null?void 0:e.nameStrategy)==="title"||e==null?void 0:e.name,s=De(t._def,r===void 0?n:{...n,currentPath:[...n.basePath,n.definitionPath,r]},!1)??{},a=typeof e=="object"&&e.name!==void 0&&e.nameStrategy==="title"?e.name:void 0;a!==void 0&&(s.title=a);const i=(()=>{if(y3(n.definitions))return;const l={},u=new Set;for(let d=0;d<500;d++){const h=Object.entries(n.definitions).filter(([f])=>!u.has(f));if(h.length===0)break;for(const[f,m]of h)l[f]=De(Qm(m),{...n,currentPath:[...n.basePath,n.definitionPath,f]},!0)??{},u.add(f)}return l})(),o=r===void 0?i?{...s,[n.definitionPath]:i}:s:n.nameStrategy==="duplicate-ref"?{...s,...i||n.seenRefs.size?{[n.definitionPath]:{...i,...n.seenRefs.size?{[r]:s}:void 0}}:void 0}:{$ref:[...n.$refStrategy==="relative"?[]:n.basePath,n.definitionPath,r].join("/"),[n.definitionPath]:{...i,[r]:s}};return n.target==="jsonSchema7"?o.$schema="http://json-schema.org/draft-07/schema#":n.target==="jsonSchema2019-09"&&(o.$schema="https://json-schema.org/draft/2019-09/schema#"),o};function tD(t){if(t.type!=="object")throw new Error(`Root schema must have type: 'object' but got type: ${t.type?`'${t.type}'`:"undefined"}`);const e=structuredClone(t);return Lr(e,[],e)}function Xm(t){if(typeof t=="boolean")return!1;if(t.type==="null")return!0;for(const e of t.oneOf??[])if(Xm(e))return!0;for(const e of t.anyOf??[])if(Xm(e))return!0;return!1}function Lr(t,e,n){if(typeof t=="boolean")throw new TypeError(`Expected object schema but got boolean; path=${e.join("/")}`);if(!Js(t))throw new TypeError(`Expected ${JSON.stringify(t)} to be an object; path=${e.join("/")}`);const r=t.$defs;if(Js(r))for(const[f,m]of Object.entries(r))Lr(m,[...e,"$defs",f],n);const s=t.definitions;if(Js(s))for(const[f,m]of Object.entries(s))Lr(m,[...e,"definitions",f],n);t.type==="object"&&!("additionalProperties"in t)&&(t.additionalProperties=!1);const i=t.required??[],o=t.properties;if(Js(o)){for(const[f,m]of Object.entries(o))if(!Xm(m)&&!i.includes(f))throw new Error(`Zod field at \`${[...e,"properties",f].join("/")}\` uses \`.optional()\` without \`.nullable()\` which is not supported by the API. See: https://platform.openai.com/docs/guides/structured-outputs?api-mode=responses#all-fields-must-be-required`);t.required=Object.keys(o),t.properties=Object.fromEntries(Object.entries(o).map(([f,m])=>[f,Lr(m,[...e,"properties",f],n)]))}const l=t.items;Js(l)&&(t.items=Lr(l,[...e,"items"],n));const u=t.anyOf;Array.isArray(u)&&(t.anyOf=u.map((f,m)=>Lr(f,[...e,"anyOf",String(m)],n)));const d=t.allOf;if(Array.isArray(d))if(d.length===1){const f=Lr(d[0],[...e,"allOf","0"],n);Object.assign(t,f),delete t.allOf}else t.allOf=d.map((f,m)=>Lr(f,[...e,"allOf",String(m)],n));t.default===null&&delete t.default;const h=t.$ref;if(h&&rD(t,1)){if(typeof h!="string")throw new TypeError(`Received non-string $ref - ${h}; path=${e.join("/")}`);const f=nD(n,h);if(typeof f=="boolean")throw new Error(`Expected \`$ref: ${h}\` to resolve to an object schema but got boolean`);if(!Js(f))throw new Error(`Expected \`$ref: ${h}\` to resolve to an object but got ${JSON.stringify(f)}`);return Object.assign(t,{...f,...t}),delete t.$ref,Lr(t,e,n)}return t}function nD(t,e){if(!e.startsWith("#/"))throw new Error(`Unexpected $ref format ${JSON.stringify(e)}; Does not start with #/`);const n=e.slice(2).split("/");let r=t;for(const s of n){if(!Js(r))throw new Error(`encountered non-object entry while resolving ${e} - ${JSON.stringify(r)}`);const a=r[s];if(a===void 0)throw new Error(`Key ${s} not found while resolving ${e}`);r=a}return r}function Js(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}function rD(t,e){let n=0;for(const r in t)if(n++,n>e)return!0;return!1}function sD(t,e){return eD(t,{openaiStrictMode:!0,name:e.name,nameStrategy:"duplicate-ref",$refStrategy:"extract-to-root",nullableStrategy:"property"})}function aD(t){return tD(Pu(t,{target:"draft-7"}))}function iD(t){return"_zod"in t}function oD(t,e,n){return eI({type:"json_schema",json_schema:{...n,name:e,strict:!0,schema:iD(t)?aD(t):sD(t,{name:e})}},r=>t.parse(JSON.parse(r)))}const fw=["jsonSchema","functionCalling","jsonMode"];function lD(t,e){if(typeof e<"u"&&!fw.includes(e))throw new Error(`Invalid method: ${e}. Supported methods are: ${fw.join(", ")}`);const n=!t.startsWith("gpt-3")&&!t.startsWith("gpt-4-")&&t!=="gpt-4";if(n&&!e)return"jsonSchema";if(!n&&e==="jsonSchema")throw new Error(`JSON Schema is not supported for model "${t}". Please use a different method, e.g. "functionCalling" or "jsonMode".`);return e??"functionCalling"}function cD(t,e){const n={...t};return Object.defineProperties(n,{$brand:{value:"auto-parseable-response-format",enumerable:!1},$parseRaw:{value:e,enumerable:!1}}),n}function uD(t,e,n){if(pt(t))return oD(t,e,n);if(ct(t))return cD({type:"json_schema",json_schema:{...n,name:e,strict:!0,schema:Pu(t,{cycles:"ref",reused:"ref",override(r){r.jsonSchema.title=e}})}},r=>Dd(t,JSON.parse(r)));throw new Error("Unsupported schema response format")}function dD(t,e){if(e&&typeof e=="object"&&"images"in e&&Array.isArray(e.images)){const n=e.images.filter(r=>{var s;return typeof((s=r==null?void 0:r.image_url)==null?void 0:s.url)=="string"}).map(r=>({type:"image",url:r.image_url.url}));return[{type:"text",text:t},...n]}return t}const hD={"gpt-4.1-nano":{maxInputTokens:1047576,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:32768,reasoningOutput:!1,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"text-embedding-3-small":{maxInputTokens:8191,imageInputs:!1,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:1536,reasoningOutput:!1,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!1,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"gpt-4":{maxInputTokens:8192,imageInputs:!1,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:8192,reasoningOutput:!1,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"o1-pro":{maxInputTokens:2e5,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:1e5,reasoningOutput:!0,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"gpt-4o-2024-05-13":{maxInputTokens:128e3,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:4096,reasoningOutput:!1,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"gpt-4o-2024-08-06":{maxInputTokens:128e3,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:16384,reasoningOutput:!1,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"gpt-4.1-mini":{maxInputTokens:1047576,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:32768,reasoningOutput:!1,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"o3-deep-research":{maxInputTokens:2e5,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:1e5,reasoningOutput:!0,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"gpt-3.5-turbo":{maxInputTokens:16385,imageInputs:!1,audioInputs:!1,pdfInputs:!1,videoInputs:!1,maxOutputTokens:4096,reasoningOutput:!1,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!1,structuredOutput:!1,imageUrlInputs:!1,pdfToolMessage:!1,imageToolMessage:!1,toolChoice:!0},"text-embedding-3-large":{maxInputTokens:8191,imageInputs:!1,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:3072,reasoningOutput:!1,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!1,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"gpt-4-turbo":{maxInputTokens:128e3,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:4096,reasoningOutput:!1,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"o1-preview":{maxInputTokens:128e3,imageInputs:!1,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:32768,reasoningOutput:!0,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!1,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"o3-mini":{maxInputTokens:2e5,imageInputs:!1,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:1e5,reasoningOutput:!0,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"codex-mini-latest":{maxInputTokens:2e5,imageInputs:!1,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:1e5,reasoningOutput:!0,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"gpt-5-nano":{maxInputTokens:4e5,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:128e3,reasoningOutput:!0,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"gpt-5-codex":{maxInputTokens:4e5,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:128e3,reasoningOutput:!0,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"gpt-4o":{maxInputTokens:128e3,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:16384,reasoningOutput:!1,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"gpt-4.1":{maxInputTokens:1047576,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:32768,reasoningOutput:!1,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"o4-mini":{maxInputTokens:2e5,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:1e5,reasoningOutput:!0,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},o1:{maxInputTokens:2e5,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:1e5,reasoningOutput:!0,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"gpt-5-mini":{maxInputTokens:4e5,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:128e3,reasoningOutput:!0,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"o1-mini":{maxInputTokens:128e3,imageInputs:!1,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:65536,reasoningOutput:!0,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!1,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"text-embedding-ada-002":{maxInputTokens:8192,imageInputs:!1,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:1536,reasoningOutput:!1,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!1,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"o3-pro":{maxInputTokens:2e5,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:1e5,reasoningOutput:!0,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"gpt-4o-2024-11-20":{maxInputTokens:128e3,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:16384,reasoningOutput:!1,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},o3:{maxInputTokens:2e5,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:1e5,reasoningOutput:!0,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"o4-mini-deep-research":{maxInputTokens:2e5,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:1e5,reasoningOutput:!0,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"gpt-5-chat-latest":{maxInputTokens:4e5,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:128e3,reasoningOutput:!0,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!1,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"gpt-4o-mini":{maxInputTokens:128e3,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:16384,reasoningOutput:!1,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"gpt-5":{maxInputTokens:4e5,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:128e3,reasoningOutput:!0,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0},"gpt-5-pro":{maxInputTokens:4e5,imageInputs:!0,audioInputs:!1,pdfInputs:!0,videoInputs:!1,maxOutputTokens:272e3,reasoningOutput:!0,imageOutputs:!1,audioOutputs:!1,videoOutputs:!1,toolCalling:!0,structuredOutput:!0,imageUrlInputs:!0,pdfToolMessage:!0,imageToolMessage:!0,toolChoice:!0}};var fD=hD,mD={};je(mD,{BasePromptValue:()=>Hd,ChatPromptValue:()=>TE,ImagePromptValue:()=>pD,StringPromptValue:()=>NE});var Hd=class extends ci{},NE=class extends Hd{constructor(e){super({value:e});k(this,"lc_namespace",["langchain_core","prompt_values"]);k(this,"lc_serializable",!0);k(this,"value");this.value=e}static lc_name(){return"StringPromptValue"}toString(){return this.value}toChatMessages(){return[new Or(this.value)]}},TE=class extends Hd{constructor(e){Array.isArray(e)&&(e={messages:e});super(e);k(this,"lc_namespace",["langchain_core","prompt_values"]);k(this,"lc_serializable",!0);k(this,"messages");this.messages=e.messages}static lc_name(){return"ChatPromptValue"}toString(){return Rg(this.messages)}toChatMessages(){return this.messages}},pD=class extends Hd{constructor(e){"imageUrl"in e||(e={imageUrl:e});super(e);k(this,"lc_namespace",["langchain_core","prompt_values"]);k(this,"lc_serializable",!0);k(this,"imageUrl");k(this,"value");this.imageUrl=e.imageUrl}static lc_name(){return"ImagePromptValue"}toString(){return this.imageUrl.url}toChatMessages(){return[new Or({content:[{type:"image_url",image_url:{detail:this.imageUrl.detail,url:this.imageUrl.url}}]})]}},se="0123456789abcdef".split(""),gD=[-2147483648,8388608,32768,128],Vn=[24,16,8,0],_c=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],St=[];function ar(t,e){e?(St[0]=St[16]=St[1]=St[2]=St[3]=St[4]=St[5]=St[6]=St[7]=St[8]=St[9]=St[10]=St[11]=St[12]=St[13]=St[14]=St[15]=0,this.blocks=St):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=t}ar.prototype.update=function(t){if(!this.finalized){var e,n=typeof t;if(n!=="string"){if(n==="object"){if(t===null)throw new Error(ERROR);if(ARRAY_BUFFER&&t.constructor===ArrayBuffer)t=new Uint8Array(t);else if(!Array.isArray(t)&&(!ARRAY_BUFFER||!ArrayBuffer.isView(t)))throw new Error(ERROR)}else throw new Error(ERROR);e=!0}for(var r,s=0,a,i=t.length,o=this.blocks;s<i;){if(this.hashed&&(this.hashed=!1,o[0]=this.block,this.block=o[16]=o[1]=o[2]=o[3]=o[4]=o[5]=o[6]=o[7]=o[8]=o[9]=o[10]=o[11]=o[12]=o[13]=o[14]=o[15]=0),e)for(a=this.start;s<i&&a<64;++s)o[a>>>2]|=t[s]<<Vn[a++&3];else for(a=this.start;s<i&&a<64;++s)r=t.charCodeAt(s),r<128?o[a>>>2]|=r<<Vn[a++&3]:r<2048?(o[a>>>2]|=(192|r>>>6)<<Vn[a++&3],o[a>>>2]|=(128|r&63)<<Vn[a++&3]):r<55296||r>=57344?(o[a>>>2]|=(224|r>>>12)<<Vn[a++&3],o[a>>>2]|=(128|r>>>6&63)<<Vn[a++&3],o[a>>>2]|=(128|r&63)<<Vn[a++&3]):(r=65536+((r&1023)<<10|t.charCodeAt(++s)&1023),o[a>>>2]|=(240|r>>>18)<<Vn[a++&3],o[a>>>2]|=(128|r>>>12&63)<<Vn[a++&3],o[a>>>2]|=(128|r>>>6&63)<<Vn[a++&3],o[a>>>2]|=(128|r&63)<<Vn[a++&3]);this.lastByteIndex=a,this.bytes+=a-this.start,a>=64?(this.block=o[16],this.start=a-64,this.hash(),this.hashed=!0):this.start=a}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}};ar.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var t=this.blocks,e=this.lastByteIndex;t[16]=this.block,t[e>>>2]|=gD[e&3],this.block=t[16],e>=56&&(this.hashed||this.hash(),t[0]=this.block,t[16]=t[1]=t[2]=t[3]=t[4]=t[5]=t[6]=t[7]=t[8]=t[9]=t[10]=t[11]=t[12]=t[13]=t[14]=t[15]=0),t[14]=this.hBytes<<3|this.bytes>>>29,t[15]=this.bytes<<3,this.hash()}};ar.prototype.hash=function(){var t=this.h0,e=this.h1,n=this.h2,r=this.h3,s=this.h4,a=this.h5,i=this.h6,o=this.h7,l=this.blocks,u,d,h,f,m,v,w,_,y,p,g;for(u=16;u<64;++u)m=l[u-15],d=(m>>>7|m<<25)^(m>>>18|m<<14)^m>>>3,m=l[u-2],h=(m>>>17|m<<15)^(m>>>19|m<<13)^m>>>10,l[u]=l[u-16]+d+l[u-7]+h<<0;for(g=e&n,u=0;u<64;u+=4)this.first?(this.is224?(_=300032,m=l[0]-1413257819,o=m-150054599<<0,r=m+24177077<<0):(_=704751109,m=l[0]-210244248,o=m-1521486534<<0,r=m+143694565<<0),this.first=!1):(d=(t>>>2|t<<30)^(t>>>13|t<<19)^(t>>>22|t<<10),h=(s>>>6|s<<26)^(s>>>11|s<<21)^(s>>>25|s<<7),_=t&e,f=_^t&n^g,w=s&a^~s&i,m=o+h+w+_c[u]+l[u],v=d+f,o=r+m<<0,r=m+v<<0),d=(r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10),h=(o>>>6|o<<26)^(o>>>11|o<<21)^(o>>>25|o<<7),y=r&t,f=y^r&e^_,w=i&o^~i&s,m=a+h+w+_c[u+1]+l[u+1],v=d+f,i=n+m<<0,n=m+v<<0,d=(n>>>2|n<<30)^(n>>>13|n<<19)^(n>>>22|n<<10),h=(i>>>6|i<<26)^(i>>>11|i<<21)^(i>>>25|i<<7),p=n&r,f=p^n&t^y,w=a&i^~a&o,m=s+h+w+_c[u+2]+l[u+2],v=d+f,a=e+m<<0,e=m+v<<0,d=(e>>>2|e<<30)^(e>>>13|e<<19)^(e>>>22|e<<10),h=(a>>>6|a<<26)^(a>>>11|a<<21)^(a>>>25|a<<7),g=e&n,f=g^e&r^p,w=a&i^~a&o,m=s+h+w+_c[u+3]+l[u+3],v=d+f,s=t+m<<0,t=m+v<<0,this.chromeBugWorkAround=!0;this.h0=this.h0+t<<0,this.h1=this.h1+e<<0,this.h2=this.h2+n<<0,this.h3=this.h3+r<<0,this.h4=this.h4+s<<0,this.h5=this.h5+a<<0,this.h6=this.h6+i<<0,this.h7=this.h7+o<<0};ar.prototype.hex=function(){this.finalize();var t=this.h0,e=this.h1,n=this.h2,r=this.h3,s=this.h4,a=this.h5,i=this.h6,o=this.h7,l=se[t>>>28&15]+se[t>>>24&15]+se[t>>>20&15]+se[t>>>16&15]+se[t>>>12&15]+se[t>>>8&15]+se[t>>>4&15]+se[t&15]+se[e>>>28&15]+se[e>>>24&15]+se[e>>>20&15]+se[e>>>16&15]+se[e>>>12&15]+se[e>>>8&15]+se[e>>>4&15]+se[e&15]+se[n>>>28&15]+se[n>>>24&15]+se[n>>>20&15]+se[n>>>16&15]+se[n>>>12&15]+se[n>>>8&15]+se[n>>>4&15]+se[n&15]+se[r>>>28&15]+se[r>>>24&15]+se[r>>>20&15]+se[r>>>16&15]+se[r>>>12&15]+se[r>>>8&15]+se[r>>>4&15]+se[r&15]+se[s>>>28&15]+se[s>>>24&15]+se[s>>>20&15]+se[s>>>16&15]+se[s>>>12&15]+se[s>>>8&15]+se[s>>>4&15]+se[s&15]+se[a>>>28&15]+se[a>>>24&15]+se[a>>>20&15]+se[a>>>16&15]+se[a>>>12&15]+se[a>>>8&15]+se[a>>>4&15]+se[a&15]+se[i>>>28&15]+se[i>>>24&15]+se[i>>>20&15]+se[i>>>16&15]+se[i>>>12&15]+se[i>>>8&15]+se[i>>>4&15]+se[i&15];return this.is224||(l+=se[o>>>28&15]+se[o>>>24&15]+se[o>>>20&15]+se[o>>>16&15]+se[o>>>12&15]+se[o>>>8&15]+se[o>>>4&15]+se[o&15]),l};ar.prototype.toString=ar.prototype.hex;ar.prototype.digest=function(){this.finalize();var t=this.h0,e=this.h1,n=this.h2,r=this.h3,s=this.h4,a=this.h5,i=this.h6,o=this.h7,l=[t>>>24&255,t>>>16&255,t>>>8&255,t&255,e>>>24&255,e>>>16&255,e>>>8&255,e&255,n>>>24&255,n>>>16&255,n>>>8&255,n&255,r>>>24&255,r>>>16&255,r>>>8&255,r&255,s>>>24&255,s>>>16&255,s>>>8&255,s&255,a>>>24&255,a>>>16&255,a>>>8&255,a&255,i>>>24&255,i>>>16&255,i>>>8&255,i&255];return this.is224||l.push(o>>>24&255,o>>>16&255,o>>>8&255,o&255),l};ar.prototype.array=ar.prototype.digest;ar.prototype.arrayBuffer=function(){this.finalize();var t=new ArrayBuffer(this.is224?28:32),e=new DataView(t);return e.setUint32(0,this.h0),e.setUint32(4,this.h1),e.setUint32(8,this.h2),e.setUint32(12,this.h3),e.setUint32(16,this.h4),e.setUint32(20,this.h5),e.setUint32(24,this.h6),this.is224||e.setUint32(28,this.h7),t};const AE=(...t)=>new ar(!1,!0).update(t.join("")).hex();var yD={};je(yD,{sha256:()=>AE});var vD={};je(vD,{BaseCache:()=>IE,InMemoryCache:()=>jE,defaultHashKeyEncoder:()=>CE,deserializeStoredGeneration:()=>_D,serializeGeneration:()=>wD});const CE=(...t)=>AE(t.join("_"));function _D(t){return t.message!==void 0?{text:t.text,message:Og(t.message)}:{text:t.text}}function wD(t){const e={text:t.text};return t.message!==void 0&&(e.message=t.message.toDict()),e}var IE=class{constructor(){k(this,"keyEncoder",CE)}makeDefaultKeyEncoder(t){this.keyEncoder=t}};const xD=new Map;var jE=class RE extends IE{constructor(n){super();k(this,"cache");this.cache=n??new Map}lookup(n,r){return Promise.resolve(this.cache.get(this.keyEncoder(n,r))??null)}async update(n,r,s){this.cache.set(this.keyEncoder(n,r),s)}static global(){return new RE(xD)}},Wd={};Wd.byteLength=kD;Wd.toByteArray=ND;Wd.fromByteArray=CD;var vr=[],jn=[],bD=typeof Uint8Array<"u"?Uint8Array:Array,hf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var Aa=0,SD=hf.length;Aa<SD;++Aa)vr[Aa]=hf[Aa],jn[hf.charCodeAt(Aa)]=Aa;jn[45]=62;jn[95]=63;function OE(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");n===-1&&(n=e);var r=n===e?0:4-n%4;return[n,r]}function kD(t){var e=OE(t),n=e[0],r=e[1];return(n+r)*3/4-r}function ED(t,e,n){return(e+n)*3/4-n}function ND(t){var e,n=OE(t),r=n[0],s=n[1],a=new bD(ED(t,r,s)),i=0,o=s>0?r-4:r,l;for(l=0;l<o;l+=4)e=jn[t.charCodeAt(l)]<<18|jn[t.charCodeAt(l+1)]<<12|jn[t.charCodeAt(l+2)]<<6|jn[t.charCodeAt(l+3)],a[i++]=e>>16&255,a[i++]=e>>8&255,a[i++]=e&255;return s===2&&(e=jn[t.charCodeAt(l)]<<2|jn[t.charCodeAt(l+1)]>>4,a[i++]=e&255),s===1&&(e=jn[t.charCodeAt(l)]<<10|jn[t.charCodeAt(l+1)]<<4|jn[t.charCodeAt(l+2)]>>2,a[i++]=e>>8&255,a[i++]=e&255),a}function TD(t){return vr[t>>18&63]+vr[t>>12&63]+vr[t>>6&63]+vr[t&63]}function AD(t,e,n){for(var r,s=[],a=e;a<n;a+=3)r=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(t[a+2]&255),s.push(TD(r));return s.join("")}function CD(t){for(var e,n=t.length,r=n%3,s=[],a=16383,i=0,o=n-r;i<o;i+=a)s.push(AD(t,i,i+a>o?o:i+a));return r===1?(e=t[n-1],s.push(vr[e>>2]+vr[e<<4&63]+"==")):r===2&&(e=(t[n-2]<<8)+t[n-1],s.push(vr[e>>10]+vr[e>>4&63]+vr[e<<2&63]+"=")),s.join("")}var ID=Object.defineProperty,jD=(t,e,n)=>e in t?ID(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,RD=(t,e,n)=>(jD(t,e+"",n),n);function OD(t,e){let n=Array.from({length:t.length},(r,s)=>({start:s,end:s+1}));for(;n.length>1;){let r=null;for(let s=0;s<n.length-1;s++){const a=t.slice(n[s].start,n[s+1].end),i=e.get(a.join(","));i!=null&&(r==null||i<r[0])&&(r=[i,s])}if(r!=null){const s=r[1];n[s]={start:n[s].start,end:n[s+1].end},n.splice(s+1,1)}else break}return n}function PD(t,e){return t.length===1?[e.get(t.join(","))]:OD(t,e).map(n=>e.get(t.slice(n.start,n.end).join(","))).filter(n=>n!=null)}function $D(t){return t.replace(/[\\^$*+?.()|[\]{}]/g,"\\$&")}var ep=class{constructor(t,e){k(this,"specialTokens");k(this,"inverseSpecialTokens");k(this,"patStr");k(this,"textEncoder",new TextEncoder);k(this,"textDecoder",new TextDecoder("utf-8"));k(this,"rankMap",new Map);k(this,"textMap",new Map);this.patStr=t.pat_str;const n=t.bpe_ranks.split(`
`).filter(Boolean).reduce((r,s)=>{const[a,i,...o]=s.split(" "),l=Number.parseInt(i,10);return o.forEach((u,d)=>r[u]=l+d),r},{});for(const[r,s]of Object.entries(n)){const a=Wd.toByteArray(r);this.rankMap.set(a.join(","),s),this.textMap.set(s,a)}this.specialTokens={...t.special_tokens,...e},this.inverseSpecialTokens=Object.entries(this.specialTokens).reduce((r,[s,a])=>(r[a]=this.textEncoder.encode(s),r),{})}encode(t,e=[],n="all"){const r=new RegExp(this.patStr,"ug"),s=ep.specialTokenRegex(Object.keys(this.specialTokens)),a=[],i=new Set(e==="all"?Object.keys(this.specialTokens):e),o=new Set(n==="all"?Object.keys(this.specialTokens).filter(u=>!i.has(u)):n);if(o.size>0){const u=ep.specialTokenRegex([...o]),d=t.match(u);if(d!=null)throw new Error(`The text contains a special token that is not allowed: ${d[0]}`)}let l=0;for(;;){let u=null,d=l;for(;s.lastIndex=d,u=s.exec(t),!(u==null||i.has(u[0]));)d=u.index+1;const h=(u==null?void 0:u.index)??t.length;for(const m of t.substring(l,h).matchAll(r)){const v=this.textEncoder.encode(m[0]),w=this.rankMap.get(v.join(","));if(w!=null){a.push(w);continue}a.push(...PD(v,this.rankMap))}if(u==null)break;let f=this.specialTokens[u[0]];a.push(f),l=u.index+u[0].length}return a}decode(t){const e=[];let n=0;for(let a=0;a<t.length;++a){const i=t[a],o=this.textMap.get(i)??this.inverseSpecialTokens[i];o!=null&&(e.push(o),n+=o.length)}const r=new Uint8Array(n);let s=0;for(const a of e)r.set(a,s),s+=a.length;return this.textDecoder.decode(r)}},PE=ep;RD(PE,"specialTokenRegex",t=>new RegExp(t.map(e=>$D(e)).join("|"),"g"));function LD(t){switch(t){case"gpt2":return"gpt2";case"code-cushman-001":case"code-cushman-002":case"code-davinci-001":case"code-davinci-002":case"cushman-codex":case"davinci-codex":case"davinci-002":case"text-davinci-002":case"text-davinci-003":return"p50k_base";case"code-davinci-edit-001":case"text-davinci-edit-001":return"p50k_edit";case"ada":case"babbage":case"babbage-002":case"code-search-ada-code-001":case"code-search-babbage-code-001":case"curie":case"davinci":case"text-ada-001":case"text-babbage-001":case"text-curie-001":case"text-davinci-001":case"text-search-ada-doc-001":case"text-search-babbage-doc-001":case"text-search-curie-doc-001":case"text-search-davinci-doc-001":case"text-similarity-ada-001":case"text-similarity-babbage-001":case"text-similarity-curie-001":case"text-similarity-davinci-001":return"r50k_base";case"gpt-3.5-turbo-instruct-0914":case"gpt-3.5-turbo-instruct":case"gpt-3.5-turbo-16k-0613":case"gpt-3.5-turbo-16k":case"gpt-3.5-turbo-0613":case"gpt-3.5-turbo-0301":case"gpt-3.5-turbo":case"gpt-4-32k-0613":case"gpt-4-32k-0314":case"gpt-4-32k":case"gpt-4-0613":case"gpt-4-0314":case"gpt-4":case"gpt-3.5-turbo-1106":case"gpt-35-turbo":case"gpt-4-1106-preview":case"gpt-4-vision-preview":case"gpt-3.5-turbo-0125":case"gpt-4-turbo":case"gpt-4-turbo-2024-04-09":case"gpt-4-turbo-preview":case"gpt-4-0125-preview":case"text-embedding-ada-002":case"text-embedding-3-small":case"text-embedding-3-large":return"cl100k_base";case"gpt-4o":case"gpt-4o-2024-05-13":case"gpt-4o-2024-08-06":case"gpt-4o-2024-11-20":case"gpt-4o-mini-2024-07-18":case"gpt-4o-mini":case"gpt-4o-search-preview":case"gpt-4o-search-preview-2025-03-11":case"gpt-4o-mini-search-preview":case"gpt-4o-mini-search-preview-2025-03-11":case"gpt-4o-audio-preview":case"gpt-4o-audio-preview-2024-12-17":case"gpt-4o-audio-preview-2024-10-01":case"gpt-4o-mini-audio-preview":case"gpt-4o-mini-audio-preview-2024-12-17":case"o1":case"o1-2024-12-17":case"o1-mini":case"o1-mini-2024-09-12":case"o1-preview":case"o1-preview-2024-09-12":case"o1-pro":case"o1-pro-2025-03-19":case"o3":case"o3-2025-04-16":case"o3-mini":case"o3-mini-2025-01-31":case"o4-mini":case"o4-mini-2025-04-16":case"chatgpt-4o-latest":case"gpt-4o-realtime":case"gpt-4o-realtime-preview-2024-10-01":case"gpt-4o-realtime-preview-2024-12-17":case"gpt-4o-mini-realtime-preview":case"gpt-4o-mini-realtime-preview-2024-12-17":case"gpt-4.1":case"gpt-4.1-2025-04-14":case"gpt-4.1-mini":case"gpt-4.1-mini-2025-04-14":case"gpt-4.1-nano":case"gpt-4.1-nano-2025-04-14":case"gpt-4.5-preview":case"gpt-4.5-preview-2025-02-27":case"gpt-5":case"gpt-5-2025-08-07":case"gpt-5-nano":case"gpt-5-nano-2025-08-07":case"gpt-5-mini":case"gpt-5-mini-2025-08-07":case"gpt-5-chat-latest":return"o200k_base";default:throw new Error("Unknown model")}}var DD={};je(DD,{encodingForModel:()=>hy,getEncoding:()=>$E});const wc={},MD=new Nl({});async function $E(t){return t in wc||(wc[t]=MD.fetch(`https://tiktoken.pages.dev/js/${t}.json`).then(e=>e.json()).then(e=>new PE(e)).catch(e=>{throw delete wc[t],e})),await wc[t]}async function hy(t){return $E(LD(t))}var FD={};je(FD,{BaseLangChain:()=>my,BaseLanguageModel:()=>py,calculateMaxTokens:()=>UD,getEmbeddingContextSize:()=>zD,getModelContextSize:()=>LE,getModelNameForTiktoken:()=>Vd,isOpenAITool:()=>fy});const Vd=t=>t.startsWith("gpt-5")?"gpt-5":t.startsWith("gpt-3.5-turbo-16k")?"gpt-3.5-turbo-16k":t.startsWith("gpt-3.5-turbo-")?"gpt-3.5-turbo":t.startsWith("gpt-4-32k")?"gpt-4-32k":t.startsWith("gpt-4-")?"gpt-4":t.startsWith("gpt-4o")?"gpt-4o":t,zD=t=>{switch(t){case"text-embedding-ada-002":return 8191;default:return 2046}},LE=t=>{switch(Vd(t)){case"gpt-5":case"gpt-5-turbo":case"gpt-5-turbo-preview":return 4e5;case"gpt-4o":case"gpt-4o-mini":case"gpt-4o-2024-05-13":case"gpt-4o-2024-08-06":return 128e3;case"gpt-4-turbo":case"gpt-4-turbo-preview":case"gpt-4-turbo-2024-04-09":case"gpt-4-0125-preview":case"gpt-4-1106-preview":return 128e3;case"gpt-4-32k":case"gpt-4-32k-0314":case"gpt-4-32k-0613":return 32768;case"gpt-4":case"gpt-4-0314":case"gpt-4-0613":return 8192;case"gpt-3.5-turbo-16k":case"gpt-3.5-turbo-16k-0613":return 16384;case"gpt-3.5-turbo":case"gpt-3.5-turbo-0301":case"gpt-3.5-turbo-0613":case"gpt-3.5-turbo-1106":case"gpt-3.5-turbo-0125":return 4096;case"text-davinci-003":case"text-davinci-002":return 4097;case"text-davinci-001":return 2049;case"text-curie-001":case"text-babbage-001":case"text-ada-001":return 2048;case"code-davinci-002":case"code-davinci-001":return 8e3;case"code-cushman-001":return 2048;case"claude-3-5-sonnet-20241022":case"claude-3-5-sonnet-20240620":case"claude-3-opus-20240229":case"claude-3-sonnet-20240229":case"claude-3-haiku-20240307":case"claude-2.1":return 2e5;case"claude-2.0":case"claude-instant-1.2":return 1e5;case"gemini-1.5-pro":case"gemini-1.5-pro-latest":case"gemini-1.5-flash":case"gemini-1.5-flash-latest":return 1e6;case"gemini-pro":case"gemini-pro-vision":return 32768;default:return 4097}};function fy(t){return typeof t!="object"||!t?!1:!!("type"in t&&t.type==="function"&&"function"in t&&typeof t.function=="object"&&t.function&&"name"in t.function&&"parameters"in t.function)}const UD=async({prompt:t,modelName:e})=>{let n;try{n=(await hy(Vd(e))).encode(t).length}catch{console.warn("Failed to calculate number of tokens, falling back to approximate count"),n=Math.ceil(t.length/4)}return LE(e)-n},BD=()=>!1;var my=class extends dt{constructor(e){super(e);k(this,"verbose");k(this,"callbacks");k(this,"tags");k(this,"metadata");this.verbose=e.verbose??BD(),this.callbacks=e.callbacks,this.tags=e.tags??[],this.metadata=e.metadata??{}}get lc_attributes(){return{callbacks:void 0,verbose:void 0}}},py=class extends my{constructor({callbacks:e,callbackManager:n,...r}){const{cache:s,...a}=r;super({callbacks:e??n,...a});k(this,"caller");k(this,"cache");k(this,"_encoding");typeof s=="object"?this.cache=s:s?this.cache=jE.global():this.cache=void 0,this.caller=new Nl(r??{})}get callKeys(){return["stop","timeout","signal","tags","metadata","callbacks"]}async getNumTokens(e){let n;typeof e=="string"?n=e:n=e.map(s=>typeof s=="string"?s:s.type==="text"&&"text"in s?s.text:"").join("");let r=Math.ceil(n.length/4);if(!this._encoding)try{this._encoding=await hy("modelName"in this?Vd(this.modelName):"gpt2")}catch(s){console.warn("Failed to calculate number of tokens, falling back to approximate count",s)}if(this._encoding)try{r=this._encoding.encode(n).length}catch(s){console.warn("Failed to calculate number of tokens, falling back to approximate count",s)}return r}static _convertInputToPromptValue(e){return typeof e=="string"?new NE(e):Array.isArray(e)?new TE(e.map(Ao)):e}_identifyingParams(){return{}}_getSerializedCacheKeyParametersForCall({config:e,...n}){const r={...this._identifyingParams(),...n,_type:this._llmType(),_model:this._modelType()};return Object.entries(r).filter(([i,o])=>o!==void 0).map(([i,o])=>`${i}:${JSON.stringify(o)}`).sort().join(",")}serialize(){return{...this._identifyingParams(),_type:this._llmType(),_model:this._modelType()}}static async deserialize(e){throw new Error("Use .toJSON() instead")}get profile(){return{}}},vi=class extends dt{constructor(e){super(e);k(this,"lc_namespace",["langchain_core","runnables"]);k(this,"lc_serializable",!0);k(this,"func");e&&(this.func=e.func)}static lc_name(){return"RunnablePassthrough"}async invoke(e,n){const r=$e(n);return this.func&&await this.func(e,r),this._callWithConfig(s=>Promise.resolve(s),e,r)}async*transform(e,n){const r=$e(n);let s,a=!0;for await(const i of this._transformStreamWithConfig(e,o=>o,r))if(yield i,a)if(s===void 0)s=i;else try{s=Ds(s,i)}catch{s=void 0,a=!1}this.func&&s!==void 0&&await this.func(s,r)}static assign(e){return new iy(new Ai({steps:e}))}};const GD=t=>t();function ff(t){const e=t.constructor;return new e({...t,content:t.contentBlocks,response_metadata:{...t.response_metadata,output_version:"v1"}})}var HD={};je(HD,{BaseChatModel:()=>gy,SimpleChatModel:()=>WD});function mf(t){const e=[];for(const n of t){let r=n;if(Array.isArray(n.content))for(let s=0;s<n.content.length;s++){const a=n.content[s];(bg(a)||Sg(a))&&r===n&&(r=new n.constructor({...r,content:[...n.content.slice(0,s),gS(a),...n.content.slice(s+1)]}))}e.push(r)}return e}var gy=class Ys extends py{constructor(n){super(n);k(this,"lc_namespace",["langchain","chat_models",this._llmType()]);k(this,"disableStreaming",!1);k(this,"outputVersion");this.outputVersion=GD(()=>{const r=n.outputVersion??Nr("LC_OUTPUT_VERSION");return r&&["v0","v1"].includes(r)?r:"v0"})}get callKeys(){return[...super.callKeys,"outputVersion"]}_separateRunnableConfigFromCallOptionsCompat(n){const[r,s]=super._separateRunnableConfigFromCallOptions(n);return s.signal=r.signal,[r,s]}async invoke(n,r){const s=Ys._convertInputToPromptValue(n);return(await this.generatePrompt([s],r,r==null?void 0:r.callbacks)).generations[0][0].message}async*_streamResponseChunks(n,r,s){throw new Error("Not implemented.")}async*_streamIterator(n,r){var s;if(this._streamResponseChunks===Ys.prototype._streamResponseChunks||this.disableStreaming)yield this.invoke(n,r);else{const i=Ys._convertInputToPromptValue(n).toChatMessages(),[o,l]=this._separateRunnableConfigFromCallOptionsCompat(r),u={...o.metadata,...this.getLsParams(l)},d=await dn.configure(o.callbacks,this.callbacks,o.tags,this.tags,u,this.metadata,{verbose:this.verbose}),h={options:l,invocation_params:this==null?void 0:this.invocationParams(l),batch_size:1},f=l.outputVersion??this.outputVersion,m=await(d==null?void 0:d.handleChatModelStart(this.toJSON(),[mf(i)],o.runId,void 0,h,void 0,void 0,o.runName));let v,w;try{for await(const _ of this._streamResponseChunks(i,l,m==null?void 0:m[0])){if(_.message.id==null){const y=(s=m==null?void 0:m.at(0))==null?void 0:s.runId;y!=null&&_.message._updateId(`run-${y}`)}_.message.response_metadata={..._.generationInfo,..._.message.response_metadata},f==="v1"?yield ff(_.message):yield _.message,v?v=v.concat(_):v=_,Nm(_.message)&&_.message.usage_metadata!==void 0&&(w={tokenUsage:{promptTokens:_.message.usage_metadata.input_tokens,completionTokens:_.message.usage_metadata.output_tokens,totalTokens:_.message.usage_metadata.total_tokens}})}}catch(_){throw await Promise.all((m??[]).map(y=>y==null?void 0:y.handleLLMError(_))),_}await Promise.all((m??[]).map(_=>_==null?void 0:_.handleLLMEnd({generations:[[v]],llmOutput:w})))}}getLsParams(n){const r=this.getName().startsWith("Chat")?this.getName().replace("Chat",""):this.getName();return{ls_model_type:"chat",ls_stop:n.stop,ls_provider:r}}async _generateUncached(n,r,s,a){var m,v;const i=n.map(w=>w.map(Ao));let o;if(a!==void 0&&a.length===i.length)o=a;else{const w={...s.metadata,...this.getLsParams(r)},_=await dn.configure(s.callbacks,this.callbacks,s.tags,this.tags,w,this.metadata,{verbose:this.verbose}),y={options:r,invocation_params:this==null?void 0:this.invocationParams(r),batch_size:1};o=await(_==null?void 0:_.handleChatModelStart(this.toJSON(),i.map(mf),s.runId,void 0,y,void 0,void 0,s.runName))}const l=r.outputVersion??this.outputVersion,u=[],d=[];if(!!(o!=null&&o[0].handlers.find(Lg))&&!this.disableStreaming&&i.length===1&&this._streamResponseChunks!==Ys.prototype._streamResponseChunks)try{const w=await this._streamResponseChunks(i[0],r,o==null?void 0:o[0]);let _,y;for await(const p of w){if(p.message.id==null){const g=(m=o==null?void 0:o.at(0))==null?void 0:m.runId;g!=null&&p.message._updateId(`run-${g}`)}_===void 0?_=p:_=Ds(_,p),Nm(p.message)&&p.message.usage_metadata!==void 0&&(y={tokenUsage:{promptTokens:p.message.usage_metadata.input_tokens,completionTokens:p.message.usage_metadata.output_tokens,totalTokens:p.message.usage_metadata.total_tokens}})}if(_===void 0)throw new Error("Received empty response from chat model call.");u.push([_]),await(o==null?void 0:o[0].handleLLMEnd({generations:u,llmOutput:y}))}catch(w){throw await(o==null?void 0:o[0].handleLLMError(w)),w}else{const w=await Promise.allSettled(i.map(async(_,y)=>{const p=await this._generate(_,{...r,promptIndex:y},o==null?void 0:o[y]);if(l==="v1")for(const g of p.generations)g.message=ff(g.message);return p}));await Promise.all(w.map(async(_,y)=>{var p,g,S;if(_.status==="fulfilled"){const N=_.value;for(const T of N.generations){if(T.message.id==null){const A=(p=o==null?void 0:o.at(0))==null?void 0:p.runId;A!=null&&T.message._updateId(`run-${A}`)}T.message.response_metadata={...T.generationInfo,...T.message.response_metadata}}return N.generations.length===1&&(N.generations[0].message.response_metadata={...N.llmOutput,...N.generations[0].message.response_metadata}),u[y]=N.generations,d[y]=N.llmOutput,(g=o==null?void 0:o[y])==null?void 0:g.handleLLMEnd({generations:[N.generations],llmOutput:N.llmOutput})}else return await((S=o==null?void 0:o[y])==null?void 0:S.handleLLMError(_.reason)),Promise.reject(_.reason)}))}const f={generations:u,llmOutput:d.length?(v=this._combineLLMOutput)==null?void 0:v.call(this,...d):void 0};return Object.defineProperty(f,il,{value:o?{runIds:o==null?void 0:o.map(w=>w.runId)}:void 0,configurable:!0}),f}async _generateCached({messages:n,cache:r,llmStringKey:s,parsedOptions:a,handledOptions:i}){const o=n.map(p=>p.map(Ao)),l={...i.metadata,...this.getLsParams(a)},u=await dn.configure(i.callbacks,this.callbacks,i.tags,this.tags,l,this.metadata,{verbose:this.verbose}),d={options:a,invocation_params:this==null?void 0:this.invocationParams(a),batch_size:1},h=await(u==null?void 0:u.handleChatModelStart(this.toJSON(),o.map(mf),i.runId,void 0,d,void 0,void 0,i.runName)),f=[],v=(await Promise.allSettled(o.map(async(p,g)=>{const S=Ys._convertInputToPromptValue(p).toString(),N=await r.lookup(S,s);return N==null&&f.push(g),N}))).map((p,g)=>({result:p,runManager:h==null?void 0:h[g]})).filter(({result:p})=>p.status==="fulfilled"&&p.value!=null||p.status==="rejected"),w=a.outputVersion??this.outputVersion,_=[];await Promise.all(v.map(async({result:p,runManager:g},S)=>{if(p.status==="fulfilled"){const N=p.value;return _[S]=N.map(T=>("message"in T&&xs(T.message)&&kd(T.message)&&(T.message.usage_metadata={input_tokens:0,output_tokens:0,total_tokens:0},w==="v1"&&(T.message=ff(T.message))),T.generationInfo={...T.generationInfo,tokenUsage:{}},T)),N.length&&await(g==null?void 0:g.handleLLMNewToken(N[0].text)),g==null?void 0:g.handleLLMEnd({generations:[N]},void 0,void 0,void 0,{cached:!0})}else return await(g==null?void 0:g.handleLLMError(p.reason,void 0,void 0,void 0,{cached:!0})),Promise.reject(p.reason)}));const y={generations:_,missingPromptIndices:f,startedRunManagers:h};return Object.defineProperty(y,il,{value:h?{runIds:h==null?void 0:h.map(p=>p.runId)}:void 0,configurable:!0}),y}async generate(n,r,s){let a;Array.isArray(r)?a={stop:r}:a=r;const i=n.map(w=>w.map(Ao)),[o,l]=this._separateRunnableConfigFromCallOptionsCompat(a);if(o.callbacks=o.callbacks??s,!this.cache)return this._generateUncached(i,l,o);const{cache:u}=this,d=this._getSerializedCacheKeyParametersForCall(l),{generations:h,missingPromptIndices:f,startedRunManagers:m}=await this._generateCached({messages:i,cache:u,llmStringKey:d,parsedOptions:l,handledOptions:o});let v={};if(f.length>0){const w=await this._generateUncached(f.map(_=>i[_]),l,o,m!==void 0?f.map(_=>m==null?void 0:m[_]):void 0);await Promise.all(w.generations.map(async(_,y)=>{const p=f[y];h[p]=_;const g=Ys._convertInputToPromptValue(i[p]).toString();return u.update(g,d,_)})),v=w.llmOutput??{}}return{generations:h,llmOutput:v}}invocationParams(n){return{}}_modelType(){return"base_chat_model"}async generatePrompt(n,r,s){const a=n.map(i=>i.toChatMessages());return this.generate(a,r,s)}withStructuredOutput(n,r){if(typeof this.bindTools!="function")throw new Error('Chat model must implement ".bindTools()" to use withStructuredOutput.');if(r!=null&&r.strict)throw new Error('"strict" mode is not supported for this model by default.');const s=n,a=r==null?void 0:r.name,i=Fd(s)??"A function available to call.",o=r==null?void 0:r.method,l=r==null?void 0:r.includeRaw;if(o==="jsonMode")throw new Error('Base withStructuredOutput implementation only supports "functionCalling" as a method.');let u=a??"extract",d;xr(s)?d=[{type:"function",function:{name:u,description:i,parameters:br(s)}}]:("name"in s&&(u=s.name),d=[{type:"function",function:{name:u,description:i,parameters:s}}]);const h=this.bindTools(d),f=ss.from(_=>{if(!Rr.isInstance(_))throw new Error("Input is not an AIMessageChunk.");if(!_.tool_calls||_.tool_calls.length===0)throw new Error("No tool calls found in the response.");const y=_.tool_calls.find(p=>p.name===u);if(!y)throw new Error(`No tool call found with name ${u}.`);return y.args});if(!l)return h.pipe(f).withConfig({runName:"StructuredOutput"});const m=vi.assign({parsed:(_,y)=>f.invoke(_.raw,y)}),v=vi.assign({parsed:()=>null}),w=m.withFallbacks({fallbacks:[v]});return Ti.from([{raw:h},w]).withConfig({runName:"StructuredOutputRunnable"})}},WD=class extends gy{async _generate(t,e,n){const r=await this._call(t,e,n),s=new hn(r);if(typeof s.content!="string")throw new Error("Cannot generate with a simple chat model when output is not a string.");return{generations:[{text:s.content,message:s}]}}},VD=class extends dt{constructor(e){super(e);k(this,"lc_namespace",["langchain_core","runnables"]);k(this,"lc_serializable",!0);k(this,"runnables");this.runnables=e.runnables}static lc_name(){return"RouterRunnable"}async invoke(e,n){const{key:r,input:s}=e,a=this.runnables[r];if(a===void 0)throw new Error(`No runnable associated with key "${r}".`);return a.invoke(s,$e(n))}async batch(e,n,r){var f;const s=e.map(m=>m.key),a=e.map(m=>m.input);if(s.find(m=>this.runnables[m]===void 0)!==void 0)throw new Error("One or more keys do not have a corresponding runnable.");const o=s.map(m=>this.runnables[m]),l=this._getOptionsList(n??{},e.length),u=((f=l[0])==null?void 0:f.maxConcurrency)??(r==null?void 0:r.maxConcurrency),d=u&&u>0?u:e.length,h=[];for(let m=0;m<a.length;m+=d){const v=a.slice(m,m+d).map((_,y)=>o[y].invoke(_,l[y])),w=await Promise.all(v);h.push(w)}return h.flat()}async stream(e,n){const{key:r,input:s}=e,a=this.runnables[r];if(a===void 0)throw new Error(`No runnable associated with key "${r}".`);return a.stream(s,n)}},qD=class extends dt{constructor(e){super(e);k(this,"lc_namespace",["langchain_core","runnables"]);k(this,"lc_serializable",!0);k(this,"default");k(this,"branches");this.branches=e.branches,this.default=e.default}static lc_name(){return"RunnableBranch"}static from(e){if(e.length<1)throw new Error("RunnableBranch requires at least one branch");const r=e.slice(0,-1).map(([a,i])=>[Xn(a),Xn(i)]),s=Xn(e[e.length-1]);return new this({branches:r,default:s})}async _invoke(e,n,r){let s;for(let a=0;a<this.branches.length;a+=1){const[i,o]=this.branches[a];if(await i.invoke(e,Je(n,{callbacks:r==null?void 0:r.getChild(`condition:${a+1}`)}))){s=await o.invoke(e,Je(n,{callbacks:r==null?void 0:r.getChild(`branch:${a+1}`)}));break}}return s||(s=await this.default.invoke(e,Je(n,{callbacks:r==null?void 0:r.getChild("branch:default")}))),s}async invoke(e,n={}){return this._callWithConfig(this._invoke,e,n)}async*_streamIterator(e,n){const r=await xn(n),s=await(r==null?void 0:r.handleChainStart(this.toJSON(),wt(e,"input"),n==null?void 0:n.runId,void 0,void 0,void 0,n==null?void 0:n.runName));let a,i=!0,o;try{for(let l=0;l<this.branches.length;l+=1){const[u,d]=this.branches[l];if(await u.invoke(e,Je(n,{callbacks:s==null?void 0:s.getChild(`condition:${l+1}`)}))){o=await d.stream(e,Je(n,{callbacks:s==null?void 0:s.getChild(`branch:${l+1}`)}));for await(const f of o)if(yield f,i)if(a===void 0)a=f;else try{a=Ds(a,f)}catch{a=void 0,i=!1}break}}if(o===void 0){o=await this.default.stream(e,Je(n,{callbacks:s==null?void 0:s.getChild("branch:default")}));for await(const l of o)if(yield l,i)if(a===void 0)a=l;else try{a=Ds(a,l)}catch{a=void 0,i=!1}}}catch(l){throw await(s==null?void 0:s.handleChainError(l)),l}await(s==null?void 0:s.handleChainEnd(a??{}))}},ZD=class extends yi{constructor(e){let n=ss.from((i,o)=>this._enterHistory(i,o??{})).withConfig({runName:"loadHistory"});const r=e.historyMessagesKey??e.inputMessagesKey;r&&(n=vi.assign({[r]:n}).withConfig({runName:"insertHistory"}));const s=n.pipe(e.runnable.withListeners({onEnd:(i,o)=>this._exitHistory(i,o??{})})).withConfig({runName:"RunnableWithMessageHistory"}),a=e.config??{};super({...e,config:a,bound:s});k(this,"runnable");k(this,"inputMessagesKey");k(this,"outputMessagesKey");k(this,"historyMessagesKey");k(this,"getMessageHistory");this.runnable=e.runnable,this.getMessageHistory=e.getMessageHistory,this.inputMessagesKey=e.inputMessagesKey,this.outputMessagesKey=e.outputMessagesKey,this.historyMessagesKey=e.historyMessagesKey}_getInputMessages(e){let n;if(typeof e=="object"&&!Array.isArray(e)&&!xs(e)){let r;this.inputMessagesKey?r=this.inputMessagesKey:Object.keys(e).length===1?r=Object.keys(e)[0]:r="input",Array.isArray(e[r])&&Array.isArray(e[r][0])?n=e[r][0]:n=e[r]}else n=e;if(typeof n=="string")return[new Or(n)];if(Array.isArray(n))return n;if(xs(n))return[n];throw new Error(`Expected a string, BaseMessage, or array of BaseMessages.
Got ${JSON.stringify(n,null,2)}`)}_getOutputMessages(e){let n;if(!Array.isArray(e)&&!xs(e)&&typeof e!="string"){let r;this.outputMessagesKey!==void 0?r=this.outputMessagesKey:Object.keys(e).length===1?r=Object.keys(e)[0]:r="output",e.generations!==void 0?n=e.generations[0][0].message:n=e[r]}else n=e;if(typeof n=="string")return[new hn(n)];if(Array.isArray(n))return n;if(xs(n))return[n];throw new Error(`Expected a string, BaseMessage, or array of BaseMessages. Received: ${JSON.stringify(n,null,2)}`)}async _enterHistory(e,n){var a;const s=await((a=n==null?void 0:n.configurable)==null?void 0:a.messageHistory).getMessages();return this.historyMessagesKey===void 0?s.concat(this._getInputMessages(e)):s}async _exitHistory(e,n){var l;const r=(l=n.configurable)==null?void 0:l.messageHistory;let s;Array.isArray(e.inputs)&&Array.isArray(e.inputs[0])?s=e.inputs[0]:s=e.inputs;let a=this._getInputMessages(s);if(this.historyMessagesKey===void 0){const u=await r.getMessages();a=a.slice(u.length)}const i=e.outputs;if(!i)throw new Error(`Output values from 'Run' undefined. Run: ${JSON.stringify(e,null,2)}`);const o=this._getOutputMessages(i);await r.addMessages([...a,...o])}async _mergeConfig(...e){const n=await super._mergeConfig(...e);if(!n.configurable||!n.configurable.sessionId){const s={[this.inputMessagesKey??"input"]:"foo"},a={configurable:{sessionId:"123"}};throw new Error(`sessionId is required. Pass it in as part of the config argument to .invoke() or .stream()
eg. chain.invoke(${JSON.stringify(s)}, ${JSON.stringify(a)})`)}const{sessionId:r}=n.configurable;return n.configurable.messageHistory=await this.getMessageHistory(r),n}},KD={};je(KD,{RouterRunnable:()=>VD,Runnable:()=>dt,RunnableAssign:()=>iy,RunnableBinding:()=>yi,RunnableBranch:()=>qD,RunnableEach:()=>z5,RunnableLambda:()=>ss,RunnableMap:()=>Ai,RunnableParallel:()=>G5,RunnablePassthrough:()=>vi,RunnablePick:()=>mE,RunnableRetry:()=>ay,RunnableSequence:()=>Ti,RunnableToolLike:()=>Ym,RunnableWithFallbacks:()=>fE,RunnableWithMessageHistory:()=>ZD,_coerceToRunnable:()=>Xn,ensureConfig:()=>$e,getCallbackManagerForConfig:()=>xn,mergeConfigs:()=>ju,patchConfig:()=>Je,pickRunnableConfigKeys:()=>Qr,raceWithSignal:()=>Xr});var DE=class extends dt{parseResultWithPrompt(t,e,n){return this.parseResult(t,n)}_baseMessageToString(t){return typeof t.content=="string"?t.content:this._baseMessageContentToString(t.content)}_baseMessageContentToString(t){return JSON.stringify(t)}async invoke(t,e){return typeof t=="string"?this._callWithConfig(async(n,r)=>this.parseResult([{text:n}],r==null?void 0:r.callbacks),t,{...e,runType:"parser"}):this._callWithConfig(async(n,r)=>this.parseResult([{message:n,text:this._baseMessageToString(n)}],r==null?void 0:r.callbacks),t,{...e,runType:"parser"})}},qd=class extends DE{parseResult(t,e){return this.parse(t[0].text,e)}async parseWithPrompt(t,e,n){return this.parse(t,n)}_type(){throw new Error("_type not implemented")}},Wr=class extends Error{constructor(e,n,r,s=!1){super(e);k(this,"llmOutput");k(this,"observation");k(this,"sendToLLM");if(this.llmOutput=n,this.observation=r,this.sendToLLM=s,s&&(r===void 0||n===void 0))throw new Error("Arguments 'observation' & 'llmOutput' are required if 'sendToLlm' is true");LS(this,"OUTPUT_PARSING_FAILURE")}},Cl=class extends qd{async*_transform(t){for await(const e of t)typeof e=="string"?yield this.parseResult([{text:e}]):yield this.parseResult([{message:e,text:this._baseMessageToString(e)}])}async*transform(t,e){yield*this._transformStreamWithConfig(t,this._transform.bind(this),{...e,runType:"parser"})}},Zd=class extends Cl{constructor(e){super(e);k(this,"diff",!1);this.diff=(e==null?void 0:e.diff)??this.diff}async*_transform(e){let n,r;for await(const s of e){if(typeof s!="string"&&typeof s.content!="string")throw new Error("Cannot handle non-string output.");let a;if(Ag(s)){if(typeof s.content!="string")throw new Error("Cannot handle non-string message output.");a=new hi({message:s,text:s.content})}else if(xs(s)){if(typeof s.content!="string")throw new Error("Cannot handle non-string message output.");a=new hi({message:Au(s),text:s.content})}else a=new di({text:s});r===void 0?r=a:r=r.concat(a);const i=await this.parsePartialResult([r]);i!=null&&!ua(i,n)&&(this.diff?yield this._diff(n,i):yield i,n=i)}}getFormatInstructions(){return""}},JD={};je(JD,{applyPatch:()=>ui,compare:()=>Yg});var tp=class extends Zd{constructor(){super(...arguments);k(this,"lc_namespace",["langchain_core","output_parsers"]);k(this,"lc_serializable",!0)}static lc_name(){return"JsonOutputParser"}_concatOutputChunks(e,n){return this.diff?super._concatOutputChunks(e,n):n}_diff(e,n){if(n)return e?Yg(e,n):[{op:"replace",path:"",value:n}]}async parsePartialResult(e){return Em(e[0].text)}async parse(e){return Em(e,JSON.parse)}getFormatInstructions(){return""}},YD=class extends Cl{constructor(){super(...arguments);k(this,"lc_namespace",["langchain_core","output_parsers","bytes"]);k(this,"lc_serializable",!0);k(this,"textEncoder",new TextEncoder)}static lc_name(){return"BytesOutputParser"}parse(e){return Promise.resolve(this.textEncoder.encode(e))}getFormatInstructions(){return""}},Il=class extends Cl{constructor(){super(...arguments);k(this,"re")}async*_transform(e){let n="";for await(const r of e)if(typeof r=="string"?n+=r:n+=r.content,this.re){const s=[...n.matchAll(this.re)];if(s.length>1){let a=0;for(const i of s.slice(0,-1))yield[i[1]],a+=(i.index??0)+i[0].length;n=n.slice(a)}}else{const s=await this.parse(n);if(s.length>1){for(const a of s.slice(0,-1))yield[a];n=s[s.length-1]}}for(const r of await this.parse(n))yield[r]}},QD=class extends Il{constructor(){super(...arguments);k(this,"lc_namespace",["langchain_core","output_parsers","list"]);k(this,"lc_serializable",!0)}static lc_name(){return"CommaSeparatedListOutputParser"}async parse(e){try{return e.trim().split(",").map(n=>n.trim())}catch{throw new Wr(`Could not parse output: ${e}`,e)}}getFormatInstructions(){return"Your response should be a list of comma separated values, eg: `foo, bar, baz`"}},XD=class extends Il{constructor({length:e,separator:n}){super(...arguments);k(this,"lc_namespace",["langchain_core","output_parsers","list"]);k(this,"length");k(this,"separator");this.length=e,this.separator=n||","}async parse(e){try{const n=e.trim().split(this.separator).map(r=>r.trim());if(this.length!==void 0&&n.length!==this.length)throw new Wr(`Incorrect number of items. Expected ${this.length}, got ${n.length}.`);return n}catch(n){throw Object.getPrototypeOf(n)===Wr.prototype?n:new Wr(`Could not parse output: ${e}`)}}getFormatInstructions(){return`Your response should be a list of ${this.length===void 0?"":`${this.length} `}items separated by "${this.separator}" (eg: \`foo${this.separator} bar${this.separator} baz\`)`}},eM=class extends Il{constructor(){super(...arguments);k(this,"lc_namespace",["langchain_core","output_parsers","list"]);k(this,"lc_serializable",!0);k(this,"re",/\d+\.\s([^\n]+)/g)}static lc_name(){return"NumberedListOutputParser"}getFormatInstructions(){return`Your response should be a numbered list with each item on a new line. For example: 

1. foo

2. bar

3. baz`}async parse(e){return[...e.matchAll(this.re)??[]].map(n=>n[1])}},tM=class extends Il{constructor(){super(...arguments);k(this,"lc_namespace",["langchain_core","output_parsers","list"]);k(this,"lc_serializable",!0);k(this,"re",/^\s*[-*]\s([^\n]+)$/gm)}static lc_name(){return"NumberedListOutputParser"}getFormatInstructions(){return`Your response should be a numbered list with each item on a new line. For example: 

1. foo

2. bar

3. baz`}async parse(e){return[...e.matchAll(this.re)??[]].map(n=>n[1])}},ME=class extends Cl{constructor(){super(...arguments);k(this,"lc_namespace",["langchain_core","output_parsers","string"]);k(this,"lc_serializable",!0)}static lc_name(){return"StrOutputParser"}parse(e){return Promise.resolve(e)}getFormatInstructions(){return""}_textContentToString(e){return e.text}_imageUrlContentToString(e){throw new Error('Cannot coerce a multimodal "image_url" message part into a string.')}_messageContentToString(e){switch(e.type){case"text":case"text_delta":if("text"in e)return this._textContentToString(e);break;case"image_url":if("image_url"in e)return this._imageUrlContentToString(e);break;default:throw new Error(`Cannot coerce "${e.type}" message part into a string.`)}throw new Error(`Invalid content type: ${e.type}`)}_baseMessageContentToString(e){return e.reduce((n,r)=>n+this._messageContentToString(r),"")}},Vu=class extends qd{constructor(e){super(e);k(this,"lc_namespace",["langchain","output_parsers","structured"]);this.schema=e}static lc_name(){return"StructuredOutputParser"}toJSON(){return this.toJSONNotImplemented()}static fromZodSchema(e){return new this(e)}static fromNamesAndDescriptions(e){const n=Bd(Object.fromEntries(Object.entries(e).map(([r,s])=>[r,Ud().describe(s)])));return new this(n)}getFormatInstructions(){return`You must format your output as a JSON value that adheres to a given "JSON Schema" instance.

"JSON Schema" is a declarative language that allows you to annotate and validate JSON documents.

For example, the example "JSON Schema" instance {{"properties": {{"foo": {{"description": "a list of test words", "type": "array", "items": {{"type": "string"}}}}}}, "required": ["foo"]}}
would match an object with one required property, "foo". The "type" property specifies "foo" must be an "array", and the "description" property semantically describes it as "a list of test words". The items within "foo" must be strings.
Thus, the object {{"foo": ["bar", "baz"]}} is a well-formatted instance of this example "JSON Schema". The object {{"properties": {{"foo": ["bar", "baz"]}}}} is not well-formatted.

Your output will be parsed and type-checked according to the provided schema instance, so make sure all fields in your output match the schema exactly and there are no trailing commas!

Here is the JSON Schema instance your output must adhere to. Include the enclosing markdown codeblock:
\`\`\`json
${JSON.stringify(br(this.schema))}
\`\`\`
`}async parse(e){var n,r;try{const s=e.trim(),i=(((n=s.match(/^```(?:json)?\s*([\s\S]*?)```/))==null?void 0:n[1])||((r=s.match(/```json\s*([\s\S]*?)```/))==null?void 0:r[1])||s).replace(/"([^"\\]*(\\.[^"\\]*)*)"/g,(o,l)=>`"${l.replace(/\n/g,"\\n")}"`).replace(/\n/g,"");return await Md(this.schema,JSON.parse(i))}catch(s){throw new Wr(`Failed to parse. Text: "${e}". Error: ${s}`,e)}}},FE=class extends Vu{static lc_name(){return"JsonMarkdownStructuredOutputParser"}getFormatInstructions(t){const e=(t==null?void 0:t.interpolationDepth)??1;if(e<1)throw new Error("f string interpolation depth must be at least 1");return`Return a markdown code snippet with a JSON object formatted to look like:
\`\`\`json
${this._schemaToInstruction(br(this.schema)).replaceAll("{","{".repeat(e)).replaceAll("}","}".repeat(e))}
\`\`\``}_schemaToInstruction(t,e=2){const n=t;if("type"in n){let r=!1,s;if(Array.isArray(n.type)){const o=n.type.findIndex(l=>l==="null");o!==-1&&(r=!0,n.type.splice(o,1)),s=n.type.join(" | ")}else s=n.type;if(n.type==="object"&&n.properties){const o=n.description?` // ${n.description}`:"";return`{
${Object.entries(n.properties).map(([u,d])=>{var f;const h=(f=n.required)!=null&&f.includes(u)?"":" (optional)";return`${" ".repeat(e)}"${u}": ${this._schemaToInstruction(d,e+2)}${h}`}).join(`
`)}
${" ".repeat(e-2)}}${o}`}if(n.type==="array"&&n.items){const o=n.description?` // ${n.description}`:"";return`array[
${" ".repeat(e)}${this._schemaToInstruction(n.items,e+2)}
${" ".repeat(e-2)}] ${o}`}const a=r?" (nullable)":"",i=n.description?` // ${n.description}`:"";return`${s}${i}${a}`}if("anyOf"in n)return n.anyOf.map(r=>this._schemaToInstruction(r,e)).join(`
${" ".repeat(e-2)}`);throw new Error("unsupported schema type")}static fromZodSchema(t){return new this(t)}static fromNamesAndDescriptions(t){const e=Bd(Object.fromEntries(Object.entries(t).map(([n,r])=>[n,Ud().describe(r)])));return new this(e)}},nM=class extends qd{constructor({inputSchema:e}){super(...arguments);k(this,"structuredInputParser");this.structuredInputParser=new FE(e)}async parse(e){let n;try{n=await this.structuredInputParser.parse(e)}catch(r){throw new Wr(`Failed to parse. Text: "${e}". Error: ${r}`,e)}return this.outputProcessor(n)}getFormatInstructions(){return this.structuredInputParser.getFormatInstructions()}};const rM=function(){const t={};t.parser=function(E,b){return new n(E,b)},t.SAXParser=n,t.SAXStream=u,t.createStream=l,t.MAX_BUFFER_LENGTH=64*1024;const e=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];t.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function n(E,b){if(!(this instanceof n))return new n(E,b);var L=this;s(L),L.q=L.c="",L.bufferCheckPosition=t.MAX_BUFFER_LENGTH,L.opt=b||{},L.opt.lowercase=L.opt.lowercase||L.opt.lowercasetags,L.looseCase=L.opt.lowercase?"toLowerCase":"toUpperCase",L.tags=[],L.closed=L.closedRoot=L.sawRoot=!1,L.tag=L.error=null,L.strict=!!E,L.noscript=!!(E||L.opt.noscript),L.state=x.BEGIN,L.strictEntities=L.opt.strictEntities,L.ENTITIES=L.strictEntities?Object.create(t.XML_ENTITIES):Object.create(t.ENTITIES),L.attribList=[],L.opt.xmlns&&(L.ns=Object.create(v)),L.trackPosition=L.opt.position!==!1,L.trackPosition&&(L.position=L.line=L.column=0),R(L,"onready")}Object.create||(Object.create=function(E){function b(){}b.prototype=E;var L=new b;return L}),Object.keys||(Object.keys=function(E){var b=[];for(var L in E)E.hasOwnProperty(L)&&b.push(L);return b});function r(E){for(var b=Math.max(t.MAX_BUFFER_LENGTH,10),L=0,C=0,Ne=e.length;C<Ne;C++){var Pe=E[e[C]].length;if(Pe>b)switch(e[C]){case"textNode":ye(E);break;case"cdata":D(E,"oncdata",E.cdata),E.cdata="";break;case"script":D(E,"onscript",E.script),E.script="";break;default:G(E,"Max buffer length exceeded: "+e[C])}L=Math.max(L,Pe)}var He=t.MAX_BUFFER_LENGTH-L;E.bufferCheckPosition=He+E.position}function s(E){for(var b=0,L=e.length;b<L;b++)E[e[b]]=""}function a(E){ye(E),E.cdata!==""&&(D(E,"oncdata",E.cdata),E.cdata=""),E.script!==""&&(D(E,"onscript",E.script),E.script="")}n.prototype={end:function(){F(this)},write:Ee,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){a(this)}};var i=ReadableStream;i||(i=function(){});var o=t.EVENTS.filter(function(E){return E!=="error"&&E!=="end"});function l(E,b){return new u(E,b)}function u(E,b){if(!(this instanceof u))return new u(E,b);i.apply(this),this._parser=new n(E,b),this.writable=!0,this.readable=!0;var L=this;this._parser.onend=function(){L.emit("end")},this._parser.onerror=function(C){L.emit("error",C),L._parser.error=null},this._decoder=null,o.forEach(function(C){Object.defineProperty(L,"on"+C,{get:function(){return L._parser["on"+C]},set:function(Ne){if(!Ne)return L.removeAllListeners(C),L._parser["on"+C]=Ne,Ne;L.on(C,Ne)},enumerable:!0,configurable:!1})})}u.prototype=Object.create(i.prototype,{constructor:{value:u}}),u.prototype.write=function(E){return this._parser.write(E.toString()),this.emit("data",E),!0},u.prototype.end=function(E){return E&&E.length&&this.write(E),this._parser.end(),!0},u.prototype.on=function(E,b){var L=this;return!L._parser["on"+E]&&o.indexOf(E)!==-1&&(L._parser["on"+E]=function(){var C=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);C.splice(0,0,E),L.emit.apply(L,C)}),i.prototype.on.call(L,E,b)};var d="[CDATA[",h="DOCTYPE",f="http://www.w3.org/XML/1998/namespace",m="http://www.w3.org/2000/xmlns/",v={xml:f,xmlns:m},w=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,_=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,y=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,p=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function g(E){return E===" "||E===`
`||E==="\r"||E==="	"}function S(E){return E==='"'||E==="'"}function N(E){return E===">"||g(E)}function T(E,b){return E.test(b)}function A(E,b){return!T(E,b)}var x=0;t.STATE={BEGIN:x++,BEGIN_WHITESPACE:x++,TEXT:x++,TEXT_ENTITY:x++,OPEN_WAKA:x++,SGML_DECL:x++,SGML_DECL_QUOTED:x++,DOCTYPE:x++,DOCTYPE_QUOTED:x++,DOCTYPE_DTD:x++,DOCTYPE_DTD_QUOTED:x++,COMMENT_STARTING:x++,COMMENT:x++,COMMENT_ENDING:x++,COMMENT_ENDED:x++,CDATA:x++,CDATA_ENDING:x++,CDATA_ENDING_2:x++,PROC_INST:x++,PROC_INST_BODY:x++,PROC_INST_ENDING:x++,OPEN_TAG:x++,OPEN_TAG_SLASH:x++,ATTRIB:x++,ATTRIB_NAME:x++,ATTRIB_NAME_SAW_WHITE:x++,ATTRIB_VALUE:x++,ATTRIB_VALUE_QUOTED:x++,ATTRIB_VALUE_CLOSED:x++,ATTRIB_VALUE_UNQUOTED:x++,ATTRIB_VALUE_ENTITY_Q:x++,ATTRIB_VALUE_ENTITY_U:x++,CLOSE_TAG:x++,CLOSE_TAG_SAW_WHITE:x++,SCRIPT:x++,SCRIPT_ENDING:x++},t.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},t.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(t.ENTITIES).forEach(function(E){var b=t.ENTITIES[E],L=typeof b=="number"?String.fromCharCode(b):b;t.ENTITIES[E]=L});for(var j in t.STATE)t.STATE[t.STATE[j]]=j;x=t.STATE;function R(E,b,L){E[b]&&E[b](L)}function D(E,b,L){E.textNode&&ye(E),R(E,b,L)}function ye(E){E.textNode=Fe(E.opt,E.textNode),E.textNode&&R(E,"ontext",E.textNode),E.textNode=""}function Fe(E,b){return E.trim&&(b=b.trim()),E.normalize&&(b=b.replace(/\s+/g," ")),b}function G(E,b){return ye(E),E.trackPosition&&(b+=`
Line: `+E.line+`
Column: `+E.column+`
Char: `+E.c),b=new Error(b),E.error=b,R(E,"onerror",b),E}function F(E){return E.sawRoot&&!E.closedRoot&&W(E,"Unclosed root tag"),E.state!==x.BEGIN&&E.state!==x.BEGIN_WHITESPACE&&E.state!==x.TEXT&&G(E,"Unexpected end"),ye(E),E.c="",E.closed=!0,R(E,"onend"),n.call(E,E.strict,E.opt),E}function W(E,b){if(typeof E!="object"||!(E instanceof n))throw new Error("bad call to strictFail");E.strict&&G(E,b)}function J(E){E.strict||(E.tagName=E.tagName[E.looseCase]());var b=E.tags[E.tags.length-1]||E,L=E.tag={name:E.tagName,attributes:{}};E.opt.xmlns&&(L.ns=b.ns),E.attribList.length=0,D(E,"onopentagstart",L)}function $(E,b){var L=E.indexOf(":"),C=L<0?["",E]:E.split(":"),Ne=C[0],Pe=C[1];return b&&E==="xmlns"&&(Ne="xmlns",Pe=""),{prefix:Ne,local:Pe}}function M(E){if(E.strict||(E.attribName=E.attribName[E.looseCase]()),E.attribList.indexOf(E.attribName)!==-1||E.tag.attributes.hasOwnProperty(E.attribName)){E.attribName=E.attribValue="";return}if(E.opt.xmlns){var b=$(E.attribName,!0),L=b.prefix,C=b.local;if(L==="xmlns")if(C==="xml"&&E.attribValue!==f)W(E,"xml: prefix must be bound to "+f+`
Actual: `+E.attribValue);else if(C==="xmlns"&&E.attribValue!==m)W(E,"xmlns: prefix must be bound to "+m+`
Actual: `+E.attribValue);else{var Ne=E.tag,Pe=E.tags[E.tags.length-1]||E;Ne.ns===Pe.ns&&(Ne.ns=Object.create(Pe.ns)),Ne.ns[C]=E.attribValue}E.attribList.push([E.attribName,E.attribValue])}else E.tag.attributes[E.attribName]=E.attribValue,D(E,"onattribute",{name:E.attribName,value:E.attribValue});E.attribName=E.attribValue=""}function U(E,b){if(E.opt.xmlns){var L=E.tag,C=$(E.tagName);L.prefix=C.prefix,L.local=C.local,L.uri=L.ns[C.prefix]||"",L.prefix&&!L.uri&&(W(E,"Unbound namespace prefix: "+JSON.stringify(E.tagName)),L.uri=C.prefix);var Ne=E.tags[E.tags.length-1]||E;L.ns&&Ne.ns!==L.ns&&Object.keys(L.ns).forEach(function(Tn){D(E,"onopennamespace",{prefix:Tn,uri:L.ns[Tn]})});for(var Pe=0,He=E.attribList.length;Pe<He;Pe++){var tt=E.attribList[Pe],gt=tt[0],At=tt[1],We=$(gt,!0),Bt=We.prefix,as=We.local,lr=Bt===""?"":L.ns[Bt]||"",K={name:gt,value:At,prefix:Bt,local:as,uri:lr};Bt&&Bt!=="xmlns"&&!lr&&(W(E,"Unbound namespace prefix: "+JSON.stringify(Bt)),K.uri=Bt),E.tag.attributes[gt]=K,D(E,"onattribute",K)}E.attribList.length=0}E.tag.isSelfClosing=!!b,E.sawRoot=!0,E.tags.push(E.tag),D(E,"onopentag",E.tag),b||(!E.noscript&&E.tagName.toLowerCase()==="script"?E.state=x.SCRIPT:E.state=x.TEXT,E.tag=null,E.tagName=""),E.attribName=E.attribValue="",E.attribList.length=0}function re(E){if(!E.tagName){W(E,"Weird empty close tag."),E.textNode+="</>",E.state=x.TEXT;return}if(E.script){if(E.tagName!=="script"){E.script+="</"+E.tagName+">",E.tagName="",E.state=x.SCRIPT;return}D(E,"onscript",E.script),E.script=""}var b=E.tags.length,L=E.tagName;E.strict||(L=L[E.looseCase]());for(var C=L;b--;){var Ne=E.tags[b];if(Ne.name!==C)W(E,"Unexpected close tag");else break}if(b<0){W(E,"Unmatched closing tag: "+E.tagName),E.textNode+="</"+E.tagName+">",E.state=x.TEXT;return}E.tagName=L;for(var Pe=E.tags.length;Pe-- >b;){var He=E.tag=E.tags.pop();E.tagName=E.tag.name,D(E,"onclosetag",E.tagName);var tt={};for(var gt in He.ns)tt[gt]=He.ns[gt];var At=E.tags[E.tags.length-1]||E;E.opt.xmlns&&He.ns!==At.ns&&Object.keys(He.ns).forEach(function(We){var Bt=He.ns[We];D(E,"onclosenamespace",{prefix:We,uri:Bt})})}b===0&&(E.closedRoot=!0),E.tagName=E.attribValue=E.attribName="",E.attribList.length=0,E.state=x.TEXT}function X(E){var b=E.entity,L=b.toLowerCase(),C,Ne="";return E.ENTITIES[b]?E.ENTITIES[b]:E.ENTITIES[L]?E.ENTITIES[L]:(b=L,b.charAt(0)==="#"&&(b.charAt(1)==="x"?(b=b.slice(2),C=parseInt(b,16),Ne=C.toString(16)):(b=b.slice(1),C=parseInt(b,10),Ne=C.toString(10))),b=b.replace(/^0+/,""),isNaN(C)||Ne.toLowerCase()!==b?(W(E,"Invalid character entity"),"&"+E.entity+";"):String.fromCodePoint(C))}function Te(E,b){b==="<"?(E.state=x.OPEN_WAKA,E.startTagPosition=E.position):g(b)||(W(E,"Non-whitespace before first tag."),E.textNode=b,E.state=x.TEXT)}function ze(E,b){var L="";return b<E.length&&(L=E.charAt(b)),L}function Ee(E){var b=this;if(this.error)throw this.error;if(b.closed)return G(b,"Cannot write after close. Assign an onready handler.");if(E===null)return F(b);typeof E=="object"&&(E=E.toString());for(var L=0,C="";C=ze(E,L++),b.c=C,!!C;)switch(b.trackPosition&&(b.position++,C===`
`?(b.line++,b.column=0):b.column++),b.state){case x.BEGIN:if(b.state=x.BEGIN_WHITESPACE,C==="\uFEFF")continue;Te(b,C);continue;case x.BEGIN_WHITESPACE:Te(b,C);continue;case x.TEXT:if(b.sawRoot&&!b.closedRoot){for(var Ne=L-1;C&&C!=="<"&&C!=="&";)C=ze(E,L++),C&&b.trackPosition&&(b.position++,C===`
`?(b.line++,b.column=0):b.column++);b.textNode+=E.substring(Ne,L-1)}C==="<"&&!(b.sawRoot&&b.closedRoot&&!b.strict)?(b.state=x.OPEN_WAKA,b.startTagPosition=b.position):(!g(C)&&(!b.sawRoot||b.closedRoot)&&W(b,"Text data outside of root node."),C==="&"?b.state=x.TEXT_ENTITY:b.textNode+=C);continue;case x.SCRIPT:C==="<"?b.state=x.SCRIPT_ENDING:b.script+=C;continue;case x.SCRIPT_ENDING:C==="/"?b.state=x.CLOSE_TAG:(b.script+="<"+C,b.state=x.SCRIPT);continue;case x.OPEN_WAKA:if(C==="!")b.state=x.SGML_DECL,b.sgmlDecl="";else if(!g(C))if(T(w,C))b.state=x.OPEN_TAG,b.tagName=C;else if(C==="/")b.state=x.CLOSE_TAG,b.tagName="";else if(C==="?")b.state=x.PROC_INST,b.procInstName=b.procInstBody="";else{if(W(b,"Unencoded <"),b.startTagPosition+1<b.position){var Pe=b.position-b.startTagPosition;C=new Array(Pe).join(" ")+C}b.textNode+="<"+C,b.state=x.TEXT}continue;case x.SGML_DECL:(b.sgmlDecl+C).toUpperCase()===d?(D(b,"onopencdata"),b.state=x.CDATA,b.sgmlDecl="",b.cdata=""):b.sgmlDecl+C==="--"?(b.state=x.COMMENT,b.comment="",b.sgmlDecl=""):(b.sgmlDecl+C).toUpperCase()===h?(b.state=x.DOCTYPE,(b.doctype||b.sawRoot)&&W(b,"Inappropriately located doctype declaration"),b.doctype="",b.sgmlDecl=""):C===">"?(D(b,"onsgmldeclaration",b.sgmlDecl),b.sgmlDecl="",b.state=x.TEXT):(S(C)&&(b.state=x.SGML_DECL_QUOTED),b.sgmlDecl+=C);continue;case x.SGML_DECL_QUOTED:C===b.q&&(b.state=x.SGML_DECL,b.q=""),b.sgmlDecl+=C;continue;case x.DOCTYPE:C===">"?(b.state=x.TEXT,D(b,"ondoctype",b.doctype),b.doctype=!0):(b.doctype+=C,C==="["?b.state=x.DOCTYPE_DTD:S(C)&&(b.state=x.DOCTYPE_QUOTED,b.q=C));continue;case x.DOCTYPE_QUOTED:b.doctype+=C,C===b.q&&(b.q="",b.state=x.DOCTYPE);continue;case x.DOCTYPE_DTD:b.doctype+=C,C==="]"?b.state=x.DOCTYPE:S(C)&&(b.state=x.DOCTYPE_DTD_QUOTED,b.q=C);continue;case x.DOCTYPE_DTD_QUOTED:b.doctype+=C,C===b.q&&(b.state=x.DOCTYPE_DTD,b.q="");continue;case x.COMMENT:C==="-"?b.state=x.COMMENT_ENDING:b.comment+=C;continue;case x.COMMENT_ENDING:C==="-"?(b.state=x.COMMENT_ENDED,b.comment=Fe(b.opt,b.comment),b.comment&&D(b,"oncomment",b.comment),b.comment=""):(b.comment+="-"+C,b.state=x.COMMENT);continue;case x.COMMENT_ENDED:C!==">"?(W(b,"Malformed comment"),b.comment+="--"+C,b.state=x.COMMENT):b.state=x.TEXT;continue;case x.CDATA:C==="]"?b.state=x.CDATA_ENDING:b.cdata+=C;continue;case x.CDATA_ENDING:C==="]"?b.state=x.CDATA_ENDING_2:(b.cdata+="]"+C,b.state=x.CDATA);continue;case x.CDATA_ENDING_2:C===">"?(b.cdata&&D(b,"oncdata",b.cdata),D(b,"onclosecdata"),b.cdata="",b.state=x.TEXT):C==="]"?b.cdata+="]":(b.cdata+="]]"+C,b.state=x.CDATA);continue;case x.PROC_INST:C==="?"?b.state=x.PROC_INST_ENDING:g(C)?b.state=x.PROC_INST_BODY:b.procInstName+=C;continue;case x.PROC_INST_BODY:if(!b.procInstBody&&g(C))continue;C==="?"?b.state=x.PROC_INST_ENDING:b.procInstBody+=C;continue;case x.PROC_INST_ENDING:C===">"?(D(b,"onprocessinginstruction",{name:b.procInstName,body:b.procInstBody}),b.procInstName=b.procInstBody="",b.state=x.TEXT):(b.procInstBody+="?"+C,b.state=x.PROC_INST_BODY);continue;case x.OPEN_TAG:T(_,C)?b.tagName+=C:(J(b),C===">"?U(b):C==="/"?b.state=x.OPEN_TAG_SLASH:(g(C)||W(b,"Invalid character in tag name"),b.state=x.ATTRIB));continue;case x.OPEN_TAG_SLASH:C===">"?(U(b,!0),re(b)):(W(b,"Forward-slash in opening tag not followed by >"),b.state=x.ATTRIB);continue;case x.ATTRIB:if(g(C))continue;C===">"?U(b):C==="/"?b.state=x.OPEN_TAG_SLASH:T(w,C)?(b.attribName=C,b.attribValue="",b.state=x.ATTRIB_NAME):W(b,"Invalid attribute name");continue;case x.ATTRIB_NAME:C==="="?b.state=x.ATTRIB_VALUE:C===">"?(W(b,"Attribute without value"),b.attribValue=b.attribName,M(b),U(b)):g(C)?b.state=x.ATTRIB_NAME_SAW_WHITE:T(_,C)?b.attribName+=C:W(b,"Invalid attribute name");continue;case x.ATTRIB_NAME_SAW_WHITE:if(C==="=")b.state=x.ATTRIB_VALUE;else{if(g(C))continue;W(b,"Attribute without value"),b.tag.attributes[b.attribName]="",b.attribValue="",D(b,"onattribute",{name:b.attribName,value:""}),b.attribName="",C===">"?U(b):T(w,C)?(b.attribName=C,b.state=x.ATTRIB_NAME):(W(b,"Invalid attribute name"),b.state=x.ATTRIB)}continue;case x.ATTRIB_VALUE:if(g(C))continue;S(C)?(b.q=C,b.state=x.ATTRIB_VALUE_QUOTED):(W(b,"Unquoted attribute value"),b.state=x.ATTRIB_VALUE_UNQUOTED,b.attribValue=C);continue;case x.ATTRIB_VALUE_QUOTED:if(C!==b.q){C==="&"?b.state=x.ATTRIB_VALUE_ENTITY_Q:b.attribValue+=C;continue}M(b),b.q="",b.state=x.ATTRIB_VALUE_CLOSED;continue;case x.ATTRIB_VALUE_CLOSED:g(C)?b.state=x.ATTRIB:C===">"?U(b):C==="/"?b.state=x.OPEN_TAG_SLASH:T(w,C)?(W(b,"No whitespace between attributes"),b.attribName=C,b.attribValue="",b.state=x.ATTRIB_NAME):W(b,"Invalid attribute name");continue;case x.ATTRIB_VALUE_UNQUOTED:if(!N(C)){C==="&"?b.state=x.ATTRIB_VALUE_ENTITY_U:b.attribValue+=C;continue}M(b),C===">"?U(b):b.state=x.ATTRIB;continue;case x.CLOSE_TAG:if(b.tagName)C===">"?re(b):T(_,C)?b.tagName+=C:b.script?(b.script+="</"+b.tagName,b.tagName="",b.state=x.SCRIPT):(g(C)||W(b,"Invalid tagname in closing tag"),b.state=x.CLOSE_TAG_SAW_WHITE);else{if(g(C))continue;A(w,C)?b.script?(b.script+="</"+C,b.state=x.SCRIPT):W(b,"Invalid tagname in closing tag."):b.tagName=C}continue;case x.CLOSE_TAG_SAW_WHITE:if(g(C))continue;C===">"?re(b):W(b,"Invalid characters in closing tag");continue;case x.TEXT_ENTITY:case x.ATTRIB_VALUE_ENTITY_Q:case x.ATTRIB_VALUE_ENTITY_U:var He,tt;switch(b.state){case x.TEXT_ENTITY:He=x.TEXT,tt="textNode";break;case x.ATTRIB_VALUE_ENTITY_Q:He=x.ATTRIB_VALUE_QUOTED,tt="attribValue";break;case x.ATTRIB_VALUE_ENTITY_U:He=x.ATTRIB_VALUE_UNQUOTED,tt="attribValue";break}if(C===";")if(b.opt.unparsedEntities){var gt=X(b);b.entity="",b.state=He,b.write(gt)}else b[tt]+=X(b),b.entity="",b.state=He;else T(b.entity.length?p:y,C)?b.entity+=C:(W(b,"Invalid character in entity name"),b[tt]+="&"+b.entity+C,b.entity="",b.state=He);continue;default:throw new Error(b,"Unknown state: "+b.state)}return b.position>=b.bufferCheckPosition&&r(b),b}/*! http://mths.be/fromcodepoint v0.1.0 by @mathias */return String.fromCodePoint||function(){var E=String.fromCharCode,b=Math.floor,L=function(){var C=16384,Ne=[],Pe,He,tt=-1,gt=arguments.length;if(!gt)return"";for(var At="";++tt<gt;){var We=Number(arguments[tt]);if(!isFinite(We)||We<0||We>1114111||b(We)!==We)throw RangeError("Invalid code point: "+We);We<=65535?Ne.push(We):(We-=65536,Pe=(We>>10)+55296,He=We%1024+56320,Ne.push(Pe,He)),(tt+1===gt||Ne.length>C)&&(At+=E.apply(null,Ne),Ne.length=0)}return At};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:L,configurable:!0,writable:!0}):String.fromCodePoint=L}(),t},sM=rM(),np=`The output should be formatted as a XML file.
1. Output should conform to the tags below. 
2. If tags are not given, make them on your own.
3. Remember to always open and close all the tags.

As an example, for the tags ["foo", "bar", "baz"]:
1. String "<foo>
   <bar>
      <baz></baz>
   </bar>
</foo>" is a well-formatted instance of the schema. 
2. String "<foo>
   <bar>
   </foo>" is a badly-formatted instance.
3. String "<foo>
   <tag>
   </tag>
</foo>" is a badly-formatted instance.

Here are the output tags:
\`\`\`
{tags}
\`\`\``;var aM=class extends Zd{constructor(e){super(e);k(this,"tags");k(this,"lc_namespace",["langchain_core","output_parsers"]);k(this,"lc_serializable",!0);this.tags=e==null?void 0:e.tags}static lc_name(){return"XMLOutputParser"}_diff(e,n){if(n)return e?Yg(e,n):[{op:"replace",path:"",value:n}]}async parsePartialResult(e){return rp(e[0].text)}async parse(e){return rp(e)}getFormatInstructions(){var n;return!!(this.tags&&this.tags.length>0)?np.replace("{tags}",((n=this.tags)==null?void 0:n.join(", "))??""):np}};const iM=t=>t.split(`
`).map(e=>e.replace(/^\s+/,"")).join(`
`).trim(),zE=t=>{if(Object.keys(t).length===0)return{};const e={};return t.children.length>0?(e[t.name]=t.children.map(zE),e):(e[t.name]=t.text??void 0,e)};function rp(t){const e=iM(t),n=sM.parser(!0);let r={};const s=[];n.onopentag=o=>{const l={name:o.name,attributes:o.attributes,children:[],text:"",isSelfClosing:o.isSelfClosing};s.length>0?s[s.length-1].children.push(l):r=l,o.isSelfClosing||s.push(l)},n.onclosetag=()=>{if(s.length>0){const o=s.pop();s.length===0&&o&&(r=o)}},n.ontext=o=>{if(s.length>0){const l=s[s.length-1];l.text+=o}},n.onattribute=o=>{if(s.length>0){const l=s[s.length-1];l.attributes[o.name]=o.value}};const a=/```(xml)?(.*)```/s.exec(e),i=a?a[2]:e;return n.write(i).close(),r&&r.name==="?xml"&&(r=r.children[0]),zE(r)}var oM={};je(oM,{AsymmetricStructuredOutputParser:()=>nM,BaseCumulativeTransformOutputParser:()=>Zd,BaseLLMOutputParser:()=>DE,BaseOutputParser:()=>qd,BaseTransformOutputParser:()=>Cl,BytesOutputParser:()=>YD,CommaSeparatedListOutputParser:()=>QD,CustomListOutputParser:()=>XD,JsonMarkdownStructuredOutputParser:()=>FE,JsonOutputParser:()=>tp,ListOutputParser:()=>Il,MarkdownListOutputParser:()=>tM,NumberedListOutputParser:()=>eM,OutputParserException:()=>Wr,StringOutputParser:()=>ME,StructuredOutputParser:()=>Vu,XMLOutputParser:()=>aM,XML_FORMAT_INSTRUCTIONS:()=>np,parseJsonMarkdown:()=>Em,parsePartialJson:()=>Sd,parseXMLMarkdown:()=>rp});function Kd(t,e){if(t.function===void 0)return;let n;if(e!=null&&e.partial)try{n=Sd(t.function.arguments??"{}")}catch{return}else try{n=JSON.parse(t.function.arguments)}catch(s){throw new Wr([`Function "${t.function.name}" arguments:`,"",t.function.arguments,"","are not valid JSON.",`Error: ${s.message}`].join(`
`))}const r={name:t.function.name,args:n,type:"tool_call"};return e!=null&&e.returnId&&(r.id=t.id),r}function UE(t){if(t.id===void 0)throw new Error('All OpenAI tool calls must have an "id" field.');return{id:t.id,type:"function",function:{name:t.name,arguments:JSON.stringify(t.args)}}}function qu(t,e){var n,r;return{name:(n=t.function)==null?void 0:n.name,args:(r=t.function)==null?void 0:r.arguments,id:t.id,error:e,type:"invalid_tool_call"}}var BE=class extends Zd{constructor(e){super(e);k(this,"returnId",!1);k(this,"lc_namespace",["langchain","output_parsers","openai_tools"]);k(this,"lc_serializable",!0);this.returnId=(e==null?void 0:e.returnId)??this.returnId}static lc_name(){return"JsonOutputToolsParser"}_diff(){throw new Error("Not supported.")}async parse(){throw new Error("Not implemented.")}async parseResult(e){return await this.parsePartialResult(e,!1)}async parsePartialResult(e,n=!0){var i;const r=e[0].message;let s;if(kd(r)&&((i=r.tool_calls)!=null&&i.length)?s=r.tool_calls.map(o=>{const{id:l,...u}=o;return this.returnId?{id:l,...u}:u}):r.additional_kwargs.tool_calls!==void 0&&(s=JSON.parse(JSON.stringify(r.additional_kwargs.tool_calls)).map(l=>Kd(l,{returnId:this.returnId,partial:n}))),!s)return[];const a=[];for(const o of s)if(o!==void 0){const l={type:o.name,args:o.args,id:o.id};a.push(l)}return a}},sp=class extends BE{constructor(e){super(e);k(this,"lc_namespace",["langchain","output_parsers","openai_tools"]);k(this,"lc_serializable",!0);k(this,"returnId",!1);k(this,"keyName");k(this,"returnSingle",!1);k(this,"zodSchema");this.keyName=e.keyName,this.returnSingle=e.returnSingle??this.returnSingle,this.zodSchema=e.zodSchema}static lc_name(){return"JsonOutputKeyToolsParser"}async _validateResult(e){var r;if(this.zodSchema===void 0)return e;const n=await qk(this.zodSchema,e);if(n.success)return n.data;throw new Wr(`Failed to parse. Text: "${JSON.stringify(e,null,2)}". Error: ${JSON.stringify((r=n.error)==null?void 0:r.issues)}`,JSON.stringify(e,null,2))}async parsePartialResult(e){const r=(await super.parsePartialResult(e)).filter(a=>a.type===this.keyName);let s=r;if(r.length)return this.returnId||(s=r.map(a=>a.args)),this.returnSingle?s[0]:s}async parseResult(e){const r=(await super.parsePartialResult(e,!1)).filter(i=>i.type===this.keyName);let s=r;return r.length?(this.returnId||(s=r.map(i=>i.args)),this.returnSingle?this._validateResult(s[0]):await Promise.all(s.map(i=>this._validateResult(i)))):void 0}},lM={};je(lM,{JsonOutputKeyToolsParser:()=>sp,JsonOutputToolsParser:()=>BE,convertLangChainToolCallToOpenAI:()=>UE,makeInvalidToolCall:()=>qu,parseToolCall:()=>Kd});var yy=class extends gy{constructor(e){var r,s,a,i;super(e??{});k(this,"temperature");k(this,"topP");k(this,"frequencyPenalty");k(this,"presencePenalty");k(this,"n");k(this,"logitBias");k(this,"model","gpt-3.5-turbo");k(this,"modelKwargs");k(this,"stop");k(this,"stopSequences");k(this,"user");k(this,"timeout");k(this,"streaming",!1);k(this,"streamUsage",!0);k(this,"maxTokens");k(this,"logprobs");k(this,"topLogprobs");k(this,"apiKey");k(this,"organization");k(this,"__includeRawResponse");k(this,"client");k(this,"clientConfig");k(this,"supportsStrictToolCalling");k(this,"audio");k(this,"modalities");k(this,"reasoning");k(this,"zdrEnabled");k(this,"service_tier");k(this,"promptCacheKey");k(this,"verbosity");k(this,"defaultOptions");k(this,"lc_serializable",!0);const n=typeof((r=e==null?void 0:e.configuration)==null?void 0:r.apiKey)=="string"||typeof((s=e==null?void 0:e.configuration)==null?void 0:s.apiKey)=="function"?(a=e==null?void 0:e.configuration)==null?void 0:a.apiKey:void 0;this.apiKey=(e==null?void 0:e.apiKey)??n??Nr("OPENAI_API_KEY"),this.organization=((i=e==null?void 0:e.configuration)==null?void 0:i.organization)??Nr("OPENAI_ORGANIZATION"),this.model=(e==null?void 0:e.model)??(e==null?void 0:e.modelName)??this.model,this.modelKwargs=(e==null?void 0:e.modelKwargs)??{},this.timeout=e==null?void 0:e.timeout,this.temperature=(e==null?void 0:e.temperature)??this.temperature,this.topP=(e==null?void 0:e.topP)??this.topP,this.frequencyPenalty=(e==null?void 0:e.frequencyPenalty)??this.frequencyPenalty,this.presencePenalty=(e==null?void 0:e.presencePenalty)??this.presencePenalty,this.logprobs=e==null?void 0:e.logprobs,this.topLogprobs=e==null?void 0:e.topLogprobs,this.n=(e==null?void 0:e.n)??this.n,this.logitBias=e==null?void 0:e.logitBias,this.stop=(e==null?void 0:e.stopSequences)??(e==null?void 0:e.stop),this.stopSequences=this.stop,this.user=e==null?void 0:e.user,this.__includeRawResponse=e==null?void 0:e.__includeRawResponse,this.audio=e==null?void 0:e.audio,this.modalities=e==null?void 0:e.modalities,this.reasoning=e==null?void 0:e.reasoning,this.maxTokens=(e==null?void 0:e.maxCompletionTokens)??(e==null?void 0:e.maxTokens),this.promptCacheKey=(e==null?void 0:e.promptCacheKey)??this.promptCacheKey,this.verbosity=(e==null?void 0:e.verbosity)??this.verbosity,this.disableStreaming=(e==null?void 0:e.disableStreaming)===!0,this.streaming=(e==null?void 0:e.streaming)===!0,this.disableStreaming&&(this.streaming=!1),(e==null?void 0:e.streaming)===!1&&(this.disableStreaming=!0),this.streamUsage=(e==null?void 0:e.streamUsage)??this.streamUsage,this.disableStreaming&&(this.streamUsage=!1),this.clientConfig={apiKey:this.apiKey,organization:this.organization,dangerouslyAllowBrowser:!0,...e==null?void 0:e.configuration},(e==null?void 0:e.supportsStrictToolCalling)!==void 0&&(this.supportsStrictToolCalling=e.supportsStrictToolCalling),(e==null?void 0:e.service_tier)!==void 0&&(this.service_tier=e.service_tier),this.zdrEnabled=(e==null?void 0:e.zdrEnabled)??!1}_llmType(){return"openai"}static lc_name(){return"ChatOpenAI"}get callKeys(){return[...super.callKeys,"options","function_call","functions","tools","tool_choice","promptIndex","response_format","seed","reasoning","service_tier"]}get lc_secrets(){return{apiKey:"OPENAI_API_KEY",organization:"OPENAI_ORGANIZATION"}}get lc_aliases(){return{apiKey:"openai_api_key",modelName:"model"}}get lc_serializable_keys(){return["configuration","logprobs","topLogprobs","prefixMessages","supportsStrictToolCalling","modalities","audio","temperature","maxTokens","topP","frequencyPenalty","presencePenalty","n","logitBias","user","streaming","streamUsage","model","modelName","modelKwargs","stop","stopSequences","timeout","apiKey","cache","maxConcurrency","maxRetries","verbose","callbacks","tags","metadata","disableStreaming","zdrEnabled","reasoning","promptCacheKey","verbosity"]}getLsParams(e){const n=this.invocationParams(e);return{ls_provider:"openai",ls_model_name:this.model,ls_model_type:"chat",ls_temperature:n.temperature??void 0,ls_max_tokens:n.max_tokens??void 0,ls_stop:e.stop}}_identifyingParams(){return{model_name:this.model,...this.invocationParams(),...this.clientConfig}}identifyingParams(){return this._identifyingParams()}_getReasoningParams(e){if(!Tl(this.model))return;let n;return this.reasoning!==void 0&&(n={...n,...this.reasoning}),(e==null?void 0:e.reasoning)!==void 0&&(n={...n,...e.reasoning}),n}_getResponseFormat(e){return e&&e.type==="json_schema"&&e.json_schema.schema&&xr(e.json_schema.schema)?uD(e.json_schema.schema,e.json_schema.name,{description:e.json_schema.description}):e}_combineCallOptions(e){return{...this.defaultOptions,...e??{}}}_getClientOptions(e){if(!this.client){const r={baseURL:this.clientConfig.baseURL},s=t3(r),a={...this.clientConfig,baseURL:s,timeout:this.timeout,maxRetries:0};a.baseURL||delete a.baseURL,a.defaultHeaders=s3(a.defaultHeaders),this.client=new Ae(a)}return{...this.clientConfig,...e}}_convertChatOpenAIToolToCompletionsTool(e,n){return Hu(e)?m3(e.metadata.customTool):fy(e)?(n==null?void 0:n.strict)!==void 0?{...e,function:{...e.function,strict:n.strict}}:e:o3(e,n)}bindTools(e,n){let r;return(n==null?void 0:n.strict)!==void 0?r=n.strict:this.supportsStrictToolCalling!==void 0&&(r=this.supportsStrictToolCalling),this.withConfig({tools:e.map(s=>dy(s)||Hu(s)?s:this._convertChatOpenAIToolToCompletionsTool(s,{strict:r})),...n})}async stream(e,n){return super.stream(e,this._combineCallOptions(n))}async invoke(e,n){return super.invoke(e,this._combineCallOptions(n))}_combineLLMOutput(...e){return e.reduce((n,r)=>(r&&r.tokenUsage&&(n.tokenUsage.completionTokens+=r.tokenUsage.completionTokens??0,n.tokenUsage.promptTokens+=r.tokenUsage.promptTokens??0,n.tokenUsage.totalTokens+=r.tokenUsage.totalTokens??0),n),{tokenUsage:{completionTokens:0,promptTokens:0,totalTokens:0}})}async getNumTokensFromMessages(e){let n=0,r=0,s=0;this.model==="gpt-3.5-turbo-0301"?(r=4,s=-1):(r=3,s=1);const a=await Promise.all(e.map(async i=>{var f,m,v,w,_,y;const o=await this.getNumTokens(i.content),l=await this.getNumTokens(Al(i)),u=i.name!==void 0?s+await this.getNumTokens(i.name):0;let d=o+r+l+u;const h=i;if(h._getType()==="function"&&(d-=2),(f=h.additional_kwargs)!=null&&f.function_call&&(d+=3),(m=h==null?void 0:h.additional_kwargs.function_call)!=null&&m.name&&(d+=await this.getNumTokens((v=h.additional_kwargs.function_call)==null?void 0:v.name)),(w=h.additional_kwargs.function_call)!=null&&w.arguments)try{d+=await this.getNumTokens(JSON.stringify(JSON.parse((_=h.additional_kwargs.function_call)==null?void 0:_.arguments)))}catch(p){console.error("Error parsing function arguments",p,JSON.stringify(h.additional_kwargs.function_call)),d+=await this.getNumTokens((y=h.additional_kwargs.function_call)==null?void 0:y.arguments)}return n+=d,d}));return n+=3,{totalCount:n,countPerMessage:a}}async _getNumTokensFromGenerations(e){return(await Promise.all(e.map(async r=>{var s;return(s=r.message.additional_kwargs)!=null&&s.function_call?(await this.getNumTokensFromMessages([r.message])).countPerMessage[0]:await this.getNumTokens(r.message.content)}))).reduce((r,s)=>r+s,0)}async _getEstimatedTokenCountFromPrompt(e,n,r){let s=(await this.getNumTokensFromMessages(e)).totalCount;if(n&&r!=="auto"){const a=c3(n);s+=await this.getNumTokens(a),s+=9}return n&&e.find(a=>a._getType()==="system")&&(s-=4),r==="none"?s+=1:typeof r=="object"&&(s+=await this.getNumTokens(r.name)+4),s}get profile(){return fD[this.model]??{}}_getStructuredOutputMethod(e){const n={...e};if(!this.model.startsWith("gpt-3")&&!this.model.startsWith("gpt-4-")&&this.model!=="gpt-4"){if((n==null?void 0:n.method)===void 0)return"jsonSchema"}else n.method==="jsonSchema"&&console.warn(`[WARNING]: JSON Schema is not supported for model "${this.model}". Falling back to tool calling.`);return n.method}withStructuredOutput(e,n){let r,s;const{schema:a,name:i,includeRaw:o}={...n,schema:e};if((n==null?void 0:n.strict)!==void 0&&n.method==="jsonMode")throw new Error("Argument `strict` is only supported for `method` = 'function_calling'");const l=lD(this.model,n==null?void 0:n.method);if(l==="jsonMode"){xr(a)?s=Vu.fromZodSchema(a):s=new tp;const f=br(a);r=this.withConfig({outputVersion:"v0",response_format:{type:"json_object"},ls_structured_output_format:{kwargs:{method:"json_mode"},schema:{title:i??"extract",...f}}})}else if(l==="jsonSchema"){const f={name:i??"extract",description:Fd(a),schema:a,strict:n==null?void 0:n.strict},m=br(f.schema);if(r=this.withConfig({outputVersion:"v0",response_format:{type:"json_schema",json_schema:f},ls_structured_output_format:{kwargs:{method:"json_schema"},schema:{title:f.name,description:f.description,...m}}}),xr(a)){const v=Vu.fromZodSchema(a);s=ss.from(w=>"parsed"in w.additional_kwargs?w.additional_kwargs.parsed:v)}else s=new tp}else{let f=i??"extract";if(xr(a)){const m=br(a);r=this.withConfig({outputVersion:"v0",tools:[{type:"function",function:{name:f,description:m.description,parameters:m}}],tool_choice:{type:"function",function:{name:f}},ls_structured_output_format:{kwargs:{method:"function_calling"},schema:{title:f,...m}},...(n==null?void 0:n.strict)!==void 0?{strict:n.strict}:{}}),s=new sp({returnSingle:!0,keyName:f,zodSchema:a})}else{let m;typeof a.name=="string"&&typeof a.parameters=="object"&&a.parameters!=null?(m=a,f=a.name):(f=a.title??f,m={name:f,description:a.description??"",parameters:a});const v=br(a);r=this.withConfig({outputVersion:"v0",tools:[{type:"function",function:m}],tool_choice:{type:"function",function:{name:f}},ls_structured_output_format:{kwargs:{method:"function_calling"},schema:{title:f,...v}},...(n==null?void 0:n.strict)!==void 0?{strict:n.strict}:{}}),s=new sp({returnSingle:!0,keyName:f})}}if(!o)return r.pipe(s);const u=vi.assign({parsed:(f,m)=>s.invoke(f.raw,m)}),d=vi.assign({parsed:()=>null}),h=u.withFallbacks({fallbacks:[d]});return Ti.from([{raw:r},h])}};const GE={providerName:"ChatOpenAI",fromStandardTextBlock(t){return{type:"text",text:t.text}},fromStandardImageBlock(t){var e,n;if(t.source_type==="url")return{type:"image_url",image_url:{url:t.url,...(e=t.metadata)!=null&&e.detail?{detail:t.metadata.detail}:{}}};if(t.source_type==="base64")return{type:"image_url",image_url:{url:`data:${t.mime_type??""};base64,${t.data}`,...(n=t.metadata)!=null&&n.detail?{detail:t.metadata.detail}:{}}};throw new Error(`Image content blocks with source_type ${t.source_type} are not supported for ChatOpenAI`)},fromStandardAudioBlock(t){if(t.source_type==="url"){const e=Xo({dataUrl:t.url});if(!e)throw new Error(`URL audio blocks with source_type ${t.source_type} must be formatted as a data URL for ChatOpenAI`);const n=e.mime_type||t.mime_type||"";let r;try{r=km(n)}catch{throw new Error(`Audio blocks with source_type ${t.source_type} must have mime type of audio/wav or audio/mp3`)}if(r.type!=="audio"||r.subtype!=="wav"&&r.subtype!=="mp3")throw new Error(`Audio blocks with source_type ${t.source_type} must have mime type of audio/wav or audio/mp3`);return{type:"input_audio",input_audio:{format:r.subtype,data:e.data}}}if(t.source_type==="base64"){let e;try{e=km(t.mime_type??"")}catch{throw new Error(`Audio blocks with source_type ${t.source_type} must have mime type of audio/wav or audio/mp3`)}if(e.type!=="audio"||e.subtype!=="wav"&&e.subtype!=="mp3")throw new Error(`Audio blocks with source_type ${t.source_type} must have mime type of audio/wav or audio/mp3`);return{type:"input_audio",input_audio:{format:e.subtype,data:t.data}}}throw new Error(`Audio content blocks with source_type ${t.source_type} are not supported for ChatOpenAI`)},fromStandardFileBlock(t){var e,n,r,s,a,i,o,l,u,d;if(t.source_type==="url"){if(!Xo({dataUrl:t.url}))throw new Error(`URL file blocks with source_type ${t.source_type} must be formatted as a data URL for ChatOpenAI`);return{type:"file",file:{file_data:t.url,...(e=t.metadata)!=null&&e.filename||(n=t.metadata)!=null&&n.name?{filename:((r=t.metadata)==null?void 0:r.filename)||((s=t.metadata)==null?void 0:s.name)}:{}}}}if(t.source_type==="base64")return{type:"file",file:{file_data:`data:${t.mime_type??""};base64,${t.data}`,...(a=t.metadata)!=null&&a.filename||(i=t.metadata)!=null&&i.name||(o=t.metadata)!=null&&o.title?{filename:((l=t.metadata)==null?void 0:l.filename)||((u=t.metadata)==null?void 0:u.name)||((d=t.metadata)==null?void 0:d.title)}:{}}};if(t.source_type==="id")return{type:"file",file:{file_id:t.id}};throw new Error(`File content blocks with source_type ${t.source_type} are not supported for ChatOpenAI`)}},cM=({message:t,rawResponse:e,includeRawResponse:n})=>{var s,a;const r=t.tool_calls;switch(t.role){case"assistant":{const i=[],o=[];for(const h of r??[])try{i.push(Kd(h,{returnId:!0}))}catch(f){o.push(qu(h,f.message))}const l={function_call:t.function_call,tool_calls:r};n!==void 0&&(l.__raw_response=e);const u={model_provider:"openai",model_name:e.model,...e.system_fingerprint?{usage:{...e.usage},system_fingerprint:e.system_fingerprint}:{}};t.audio&&(l.audio=t.audio);const d=dD(t.content||"",(a=(s=e.choices)==null?void 0:s[0])==null?void 0:a.message);return new hn({content:d,tool_calls:i,invalid_tool_calls:o,additional_kwargs:l,response_metadata:u,id:e.id})}default:return new ba(t.content||"",t.role??"unknown")}},uM=({delta:t,rawResponse:e,includeRawResponse:n,defaultRole:r})=>{var l,u;const s=t.role??r,a=t.content??"";let i;t.function_call?i={function_call:t.function_call}:t.tool_calls?i={tool_calls:t.tool_calls}:i={},n&&(i.__raw_response=e),t.audio&&(i.audio={...t.audio,index:e.choices[0].index});const o={model_provider:"openai",usage:{...e.usage}};if(s==="user")return new bl({content:a,response_metadata:o});if(s==="assistant"){const d=[];if(Array.isArray(t.tool_calls))for(const h of t.tool_calls)d.push({name:(l=h.function)==null?void 0:l.name,args:(u=h.function)==null?void 0:u.arguments,id:h.id,index:h.index,type:"tool_call_chunk"});return new Rr({content:a,tool_call_chunks:d,additional_kwargs:i,id:e.id,response_metadata:o})}else return s==="system"?new Ls({content:a,response_metadata:o}):s==="developer"?new Ls({content:a,response_metadata:o,additional_kwargs:{__openai_role__:"developer"}}):s==="function"?new xl({content:a,additional_kwargs:i,name:t.name,response_metadata:o}):s==="tool"?new _l({content:a,additional_kwargs:i,tool_call_id:t.tool_call_id,response_metadata:o}):new wl({content:a,role:s,response_metadata:o})},dM=t=>{if(t.type==="image"){if(t.url)return{type:"image_url",image_url:{url:t.url}};if(t.data)return{type:"image_url",image_url:{url:`data:${t.mimeType};base64,${t.data}`}}}if(t.type==="audio"&&t.data){const e=DS(()=>{const[,n]=t.mimeType.split("/");return n==="wav"||n==="mp3"?n:"wav"});return{type:"input_audio",input_audio:{data:t.data.toString(),format:e}}}if(t.type==="file"){if(t.data)return{type:"file",file:{file_data:t.data.toString()}};if(t.fileId)return{type:"file",file:{file_id:t.fileId}}}},hM=({message:t,model:e})=>{let n=Al(t);if(n==="system"&&Tl(e)&&(n="developer"),n==="developer")return{role:"developer",content:t.contentBlocks.filter(s=>s.type==="text")};if(n==="system")return{role:"system",content:t.contentBlocks.filter(s=>s.type==="text")};if(n==="assistant")return{role:"assistant",content:t.contentBlocks.filter(s=>s.type==="text")};if(n==="tool"&&Ir.isInstance(t))return{role:"tool",tool_call_id:t.tool_call_id,content:t.contentBlocks.filter(s=>s.type==="text")};if(n==="function")return{role:"function",name:t.name??"",content:t.contentBlocks.filter(s=>s.type==="text").join("")};function*r(s){for(const a of s){a.type==="text"&&(yield{type:"text",text:a.text});const i=dM(a);i&&(yield i)}}return{role:"user",content:Array.from(r(t.contentBlocks))}},mw=({messages:t,model:e})=>t.flatMap(n=>{var i,o;if("output_version"in n.response_metadata&&((i=n.response_metadata)==null?void 0:i.output_version)==="v1")return hM({message:n});let r=Al(n);r==="system"&&Tl(e)&&(r="developer");const s=typeof n.content=="string"?n.content:n.content.map(l=>Cr(l)?kg(l,GE):l),a={role:r,content:s};if(n.name!=null&&(a.name=n.name),n.additional_kwargs.function_call!=null&&(a.function_call=n.additional_kwargs.function_call,a.content=""),hn.isInstance(n)&&((o=n.tool_calls)!=null&&o.length)?(a.tool_calls=n.tool_calls.map(UE),a.content=""):(n.additional_kwargs.tool_calls!=null&&(a.tool_calls=n.additional_kwargs.tool_calls),Ir.isInstance(n)&&n.tool_call_id!=null&&(a.tool_call_id=n.tool_call_id)),n.additional_kwargs.audio&&typeof n.additional_kwargs.audio=="object"&&"id"in n.additional_kwargs.audio){const l={role:"assistant",audio:{id:n.additional_kwargs.audio.id}};return[a,l]}return a});var fM=class extends yy{invocationParams(t,e){var i;let n;(t==null?void 0:t.strict)!==void 0?n=t.strict:this.supportsStrictToolCalling!==void 0&&(n=this.supportsStrictToolCalling);let r={};(t==null?void 0:t.stream_options)!==void 0?r={stream_options:t.stream_options}:this.streamUsage&&(this.streaming||e!=null&&e.streaming)&&(r={stream_options:{include_usage:!0}});const s={model:this.model,temperature:this.temperature,top_p:this.topP,frequency_penalty:this.frequencyPenalty,presence_penalty:this.presencePenalty,logprobs:this.logprobs,top_logprobs:this.topLogprobs,n:this.n,logit_bias:this.logitBias,stop:(t==null?void 0:t.stop)??this.stopSequences,user:this.user,stream:this.streaming,functions:t==null?void 0:t.functions,function_call:t==null?void 0:t.function_call,tools:(i=t==null?void 0:t.tools)!=null&&i.length?t.tools.map(o=>this._convertChatOpenAIToolToCompletionsTool(o,{strict:n})):void 0,tool_choice:wE(t==null?void 0:t.tool_choice),response_format:this._getResponseFormat(t==null?void 0:t.response_format),seed:t==null?void 0:t.seed,...r,parallel_tool_calls:t==null?void 0:t.parallel_tool_calls,...this.audio||t!=null&&t.audio?{audio:this.audio||(t==null?void 0:t.audio)}:{},...this.modalities||t!=null&&t.modalities?{modalities:this.modalities||(t==null?void 0:t.modalities)}:{},...this.modelKwargs,prompt_cache_key:(t==null?void 0:t.promptCacheKey)??this.promptCacheKey,verbosity:(t==null?void 0:t.verbosity)??this.verbosity};(t==null?void 0:t.prediction)!==void 0&&(s.prediction=t.prediction),this.service_tier!==void 0&&(s.service_tier=this.service_tier),(t==null?void 0:t.service_tier)!==void 0&&(s.service_tier=t.service_tier);const a=this._getReasoningParams(t);return a!==void 0&&a.effort!==void 0&&(s.reasoning_effort=a.effort),Tl(s.model)?s.max_completion_tokens=this.maxTokens===-1?void 0:this.maxTokens:s.max_tokens=this.maxTokens===-1?void 0:this.maxTokens,s}async _generate(t,e,n){var i,o;const r={},s=this.invocationParams(e),a=mw({messages:t,model:this.model});if(s.stream){const l=this._streamResponseChunks(t,e,n),u={};for await(const w of l){w.message.response_metadata={...w.generationInfo,...w.message.response_metadata};const _=((i=w.generationInfo)==null?void 0:i.completion)??0;u[_]===void 0?u[_]=w:u[_]=u[_].concat(w)}const d=Object.entries(u).sort(([w],[_])=>parseInt(w,10)-parseInt(_,10)).map(([w,_])=>_),{functions:h,function_call:f}=this.invocationParams(e),m=await this._getEstimatedTokenCountFromPrompt(t,h,f),v=await this._getNumTokensFromGenerations(d);return r.input_tokens=m,r.output_tokens=v,r.total_tokens=m+v,{generations:d,llmOutput:{estimatedTokenUsage:{promptTokens:r.input_tokens,completionTokens:r.output_tokens,totalTokens:r.total_tokens}}}}else{const l=await this.completionWithRetry({...s,stream:!1,messages:a},{signal:e==null?void 0:e.signal,...e==null?void 0:e.options}),{completion_tokens:u,prompt_tokens:d,total_tokens:h,prompt_tokens_details:f,completion_tokens_details:m}=(l==null?void 0:l.usage)??{};u&&(r.output_tokens=(r.output_tokens??0)+u),d&&(r.input_tokens=(r.input_tokens??0)+d),h&&(r.total_tokens=(r.total_tokens??0)+h),((f==null?void 0:f.audio_tokens)!==null||(f==null?void 0:f.cached_tokens)!==null)&&(r.input_token_details={...(f==null?void 0:f.audio_tokens)!==null&&{audio:f==null?void 0:f.audio_tokens},...(f==null?void 0:f.cached_tokens)!==null&&{cache_read:f==null?void 0:f.cached_tokens}}),((m==null?void 0:m.audio_tokens)!==null||(m==null?void 0:m.reasoning_tokens)!==null)&&(r.output_token_details={...(m==null?void 0:m.audio_tokens)!==null&&{audio:m==null?void 0:m.audio_tokens},...(m==null?void 0:m.reasoning_tokens)!==null&&{reasoning:m==null?void 0:m.reasoning_tokens}});const v=[];for(const w of(l==null?void 0:l.choices)??[]){const y={text:((o=w.message)==null?void 0:o.content)??"",message:this._convertCompletionsMessageToBaseMessage(w.message??{role:"assistant"},l)};y.generationInfo={...w.finish_reason?{finish_reason:w.finish_reason}:{},...w.logprobs?{logprobs:w.logprobs}:{}},kd(y.message)&&(y.message.usage_metadata=r),y.message=new hn(Object.fromEntries(Object.entries(y.message).filter(([p])=>!p.startsWith("lc_")))),v.push(y)}return{generations:v,llmOutput:{tokenUsage:{promptTokens:r.input_tokens,completionTokens:r.output_tokens,totalTokens:r.total_tokens}}}}}async*_streamResponseChunks(t,e,n){var l,u,d,h,f,m,v,w,_,y;const r=mw({messages:t,model:this.model}),s={...this.invocationParams(e,{streaming:!0}),messages:r,stream:!0};let a;const i=await this.completionWithRetry(s,e);let o;for await(const p of i){const g=(l=p==null?void 0:p.choices)==null?void 0:l[0];if(p.usage&&(o=p.usage),!g)continue;const{delta:S}=g;if(!S)continue;const N=this._convertCompletionsDeltaToBaseMessageChunk(S,p,a);a=S.role??a;const T={prompt:e.promptIndex??0,completion:g.index??0};if(typeof N.content!="string"){console.log("[WARNING]: Received non-string content from OpenAI. This is currently not supported.");continue}const A={...T};g.finish_reason!=null&&(A.finish_reason=g.finish_reason,A.system_fingerprint=p.system_fingerprint,A.model_name=p.model,A.service_tier=p.service_tier),this.logprobs&&(A.logprobs=g.logprobs);const x=new hi({message:N,text:N.content,generationInfo:A});yield x,await(n==null?void 0:n.handleLLMNewToken(x.text??"",T,void 0,void 0,void 0,{chunk:x}))}if(o){const p={...((u=o.prompt_tokens_details)==null?void 0:u.audio_tokens)!==null&&{audio:(d=o.prompt_tokens_details)==null?void 0:d.audio_tokens},...((h=o.prompt_tokens_details)==null?void 0:h.cached_tokens)!==null&&{cache_read:(f=o.prompt_tokens_details)==null?void 0:f.cached_tokens}},g={...((m=o.completion_tokens_details)==null?void 0:m.audio_tokens)!==null&&{audio:(v=o.completion_tokens_details)==null?void 0:v.audio_tokens},...((w=o.completion_tokens_details)==null?void 0:w.reasoning_tokens)!==null&&{reasoning:(_=o.completion_tokens_details)==null?void 0:_.reasoning_tokens}};yield new hi({message:new Rr({content:"",response_metadata:{usage:{...o}},usage_metadata:{input_tokens:o.prompt_tokens,output_tokens:o.completion_tokens,total_tokens:o.total_tokens,...Object.keys(p).length>0&&{input_token_details:p},...Object.keys(g).length>0&&{output_token_details:g}}}),text:""})}if((y=e.signal)!=null&&y.aborted)throw new Error("AbortError")}async completionWithRetry(t,e){const n=this._getClientOptions(e),r=t.response_format&&t.response_format.type==="json_schema";return this.caller.call(async()=>{try{return r&&!t.stream?await this.client.chat.completions.parse(t,n):await this.client.chat.completions.create(t,n)}catch(s){throw mS(s)}})}_convertCompletionsDeltaToBaseMessageChunk(t,e,n){return uM({delta:t,rawResponse:e,includeRawResponse:this.__includeRawResponse,defaultRole:n})}_convertCompletionsMessageToBaseMessage(t,e){return cM({message:t,rawResponse:e,includeRawResponse:this.__includeRawResponse})}};const Ka="__openai_function_call_ids__",HE=t=>{var r,s,a,i;const e={...((r=t==null?void 0:t.input_tokens_details)==null?void 0:r.cached_tokens)!=null&&{cache_read:(s=t==null?void 0:t.input_tokens_details)==null?void 0:s.cached_tokens}},n={...((a=t==null?void 0:t.output_tokens_details)==null?void 0:a.reasoning_tokens)!=null&&{reasoning:(i=t==null?void 0:t.output_tokens_details)==null?void 0:i.reasoning_tokens}};return{input_tokens:(t==null?void 0:t.input_tokens)??0,output_tokens:(t==null?void 0:t.output_tokens)??0,total_tokens:(t==null?void 0:t.total_tokens)??0,input_token_details:e,output_token_details:n}},WE=t=>{if(t.error){const o=new Error(t.error.message);throw o.name=t.error.code,o}let e;const n=[],r=[],s=[],a={model_provider:"openai",model:t.model,created_at:t.created_at,id:t.id,incomplete_details:t.incomplete_details,metadata:t.metadata,object:t.object,status:t.status,user:t.user,service_tier:t.service_tier,model_name:t.model},i={};for(const o of t.output)if(o.type==="message")e=o.id,n.push(...o.content.flatMap(l=>l.type==="output_text"?("parsed"in l&&l.parsed!=null&&(i.parsed=l.parsed),{type:"text",text:l.text,annotations:l.annotations}):l.type==="refusal"?(i.refusal=l.refusal,[]):l));else if(o.type==="function_call"){const l={function:{name:o.name,arguments:o.arguments},id:o.call_id};try{r.push(Kd(l,{returnId:!0}))}catch(u){let d;typeof u=="object"&&u!=null&&"message"in u&&typeof u.message=="string"&&(d=u.message),s.push(qu(l,d))}i[Ka]??(i[Ka]={}),o.id&&(i[Ka][o.call_id]=o.id)}else if(o.type==="reasoning")i.reasoning=o;else if(o.type==="custom_tool_call"){const l=d3(o);l?r.push(l):s.push(qu(o,"Malformed custom tool call"))}else i.tool_outputs??(i.tool_outputs=[]),i.tool_outputs.push(o);return new hn({id:e,content:n,tool_calls:r,invalid_tool_calls:s,usage_metadata:HE(t.usage),additional_kwargs:i,response_metadata:a})},mM=t=>{const e=(t.summary.length>1?t.summary.reduce((n,r)=>{const s=n[n.length-1];return s.index===r.index?s.text+=r.text:n.push(r),n},[{...t.summary[0]}]):t.summary).map(n=>Object.fromEntries(Object.entries(n).filter(([r])=>r!=="index")));return{...t,summary:e}},pM=t=>{var l,u;const e=[];let n={},r;const s=[],a={model_provider:"openai"},i={};let o;if(t.type==="response.output_text.delta")e.push({type:"text",text:t.delta,index:t.content_index});else if(t.type==="response.output_text.annotation.added")e.push({type:"text",text:"",annotations:[t.annotation],index:t.content_index});else if(t.type==="response.output_item.added"&&t.item.type==="message")o=t.item.id;else if(t.type==="response.output_item.added"&&t.item.type==="function_call")s.push({type:"tool_call_chunk",name:t.item.name,args:t.item.arguments,id:t.item.call_id,index:t.output_index}),i[Ka]={[t.item.call_id]:t.item.id};else if(t.type==="response.output_item.done"&&["web_search_call","file_search_call","computer_call","code_interpreter_call","mcp_call","mcp_list_tools","mcp_approval_request","image_generation_call","custom_tool_call"].includes(t.item.type))i.tool_outputs=[t.item];else if(t.type==="response.created")a.id=t.response.id,a.model_name=t.response.model,a.model=t.response.model;else if(t.type==="response.completed"){const d=WE(t.response);r=HE(t.response.usage),((u=(l=t.response.text)==null?void 0:l.format)==null?void 0:u.type)==="json_schema"&&(i.parsed??(i.parsed=JSON.parse(d.text)));for(const[h,f]of Object.entries(t.response))h!=="id"&&(a[h]=f)}else if(t.type==="response.function_call_arguments.delta"||t.type==="response.custom_tool_call_input.delta")s.push({type:"tool_call_chunk",args:t.delta,index:t.output_index});else if(t.type==="response.web_search_call.completed"||t.type==="response.file_search_call.completed")n={tool_outputs:{id:t.item_id,type:t.type.replace("response.","").replace(".completed",""),status:"completed"}};else if(t.type==="response.refusal.done")i.refusal=t.refusal;else if(t.type==="response.output_item.added"&&"item"in t&&t.item.type==="reasoning"){const d=t.item.summary?t.item.summary.map((h,f)=>({...h,index:f})):void 0;i.reasoning={id:t.item.id,type:t.item.type,...d?{summary:d}:{}}}else if(t.type==="response.reasoning_summary_part.added")i.reasoning={type:"reasoning",summary:[{...t.part,index:t.summary_index}]};else if(t.type==="response.reasoning_summary_text.delta")i.reasoning={type:"reasoning",summary:[{text:t.delta,type:"summary_text",index:t.summary_index}]};else return t.type==="response.image_generation_call.partial_image",null;return new hi({text:e.map(d=>d.text).join(""),message:new Rr({id:o,content:e,tool_call_chunks:s,usage_metadata:r,additional_kwargs:i,response_metadata:a}),generationInfo:n})},gM=t=>{var r;const e=hn.isInstance(t)&&((r=t.response_metadata)==null?void 0:r.model_provider)==="openai";function*n(){const s=da(()=>{try{const p=Al(t);return p==="system"||p==="developer"||p==="assistant"||p==="user"?p:"assistant"}catch{return"assistant"}});let a;const i=new Set,o=new Set,l=new Map,u=new Map;function*d(){if(!a)return;const p=a.content;(typeof p=="string"&&p.length>0||Array.isArray(p)&&p.length>0)&&(yield a),a=void 0}const h=p=>{a||(a={type:"message",role:s,content:[]}),typeof a.content=="string"?a.content=a.content.length>0?[{type:"input_text",text:a.content},...p]:[...p]:a.content.push(...p)},f=p=>{if(typeof p=="string")return p;try{return JSON.stringify(p??{})}catch{return"{}"}},m=p=>{const g=da(()=>{var N;const S=(N=p.metadata)==null?void 0:N.detail;return S==="low"||S==="high"||S==="auto"?S:"auto"});if(p.fileId)return{type:"input_image",detail:g,file_id:p.fileId};if(p.url)return{type:"input_image",detail:g,image_url:p.url};if(p.data){const S=typeof p.data=="string"?p.data:Buffer.from(p.data).toString("base64"),N=p.mimeType??"image/png";return{type:"input_image",detail:g,image_url:`data:${N};base64,${S}`}}},v=p=>{var S,N,T;const g=((S=p.metadata)==null?void 0:S.filename)??((N=p.metadata)==null?void 0:N.name)??((T=p.metadata)==null?void 0:T.title);if(p.fileId&&typeof g=="string")return{type:"input_file",file_id:p.fileId,...g?{filename:g}:{}};if(p.url&&typeof g=="string")return{type:"input_file",file_url:p.url,...g?{filename:g}:{}};if(p.data&&typeof g=="string"){const A=typeof p.data=="string"?p.data:Buffer.from(p.data).toString("base64");return{type:"input_file",file_data:`data:${p.mimeType??"application/octet-stream"};base64,${A}`,...g?{filename:g}:{}}}},w=p=>{const g=da(()=>{if(Array.isArray(p.summary)){const T=p.summary,A=(T==null?void 0:T.map(x=>x==null?void 0:x.text).filter(x=>typeof x=="string"))??[];if(A.length>0)return A}return p.reasoning?[p.reasoning]:[]}),S=g.length>0?g.map(T=>({type:"summary_text",text:T})):[{type:"summary_text",text:""}],N={type:"reasoning",id:p.id??"",summary:S};return p.reasoning&&(N.content=[{type:"reasoning_text",text:p.reasoning}]),N},_=p=>({type:"function_call",name:p.name??"",call_id:p.id??"",arguments:f(p.args)}),y=p=>{const g=f(p.output),S=p.status==="success"?"completed":p.status==="error"?"incomplete":void 0;return{type:"function_call_output",call_id:p.toolCallId??"",output:g,...S?{status:S}:{}}};for(const p of t.contentBlocks)if(p.type==="text")h([{type:"input_text",text:p.text}]);else if(p.type!=="invalid_tool_call"){if(p.type==="reasoning")yield*d(),yield w(p);else if(p.type==="tool_call"){yield*d();const g=p.id??"";g&&(i.add(g),l.delete(g)),yield _(p)}else if(p.type==="tool_call_chunk"){if(p.id){const g=l.get(p.id)??{name:p.name,args:[]};p.name&&(g.name=p.name),p.args&&g.args.push(p.args),l.set(p.id,g)}}else if(p.type==="server_tool_call"){yield*d();const g=p.id??"";g&&(o.add(g),u.delete(g)),yield _(p)}else if(p.type==="server_tool_call_chunk"){if(p.id){const g=u.get(p.id)??{name:p.name,args:[]};p.name&&(g.name=p.name),p.args&&g.args.push(p.args),u.set(p.id,g)}}else if(p.type==="server_tool_call_result")yield*d(),yield y(p);else if(p.type!=="audio")if(p.type==="file"){const g=v(p);g&&h([g])}else if(p.type==="image"){const g=m(p);g&&h([g])}else if(p.type==="video"){const g=v(p);g&&h([g])}else p.type==="text-plain"?p.text&&h([{type:"input_text",text:p.text}]):p.type==="non_standard"&&e&&(yield*d(),yield p.value)}yield*d();for(const[p,g]of l){if(!p||i.has(p))continue;const S=g.args.join("");!g.name&&!S||(yield{type:"function_call",call_id:p,name:g.name??"",arguments:S})}for(const[p,g]of u){if(!p||o.has(p))continue;const S=g.args.join("");!g.name&&!S||(yield{type:"function_call",call_id:p,name:g.name??"",arguments:S})}}return Array.from(n())},pw=({messages:t,zdrEnabled:e,model:n})=>t.flatMap(r=>{var o,l,u,d;const s=r.response_metadata;if((s==null?void 0:s.output_version)==="v1")return gM(r);const a=r.additional_kwargs;let i=Al(r);if(i==="system"&&Tl(n)&&(i="developer"),i==="function")throw new Error("Function messages are not supported in Responses API");if(i==="tool"){const h=r;return(a==null?void 0:a.type)==="computer_call_output"?{type:"computer_call_output",output:(()=>{if(typeof h.content=="string")return{type:"computer_screenshot",image_url:h.content};if(Array.isArray(h.content)){const m=h.content.find(w=>w.type==="computer_screenshot");if(m)return m;const v=h.content.find(w=>w.type==="image_url");if(v)return{type:"computer_screenshot",image_url:typeof v.image_url=="string"?v.image_url:v.image_url.url}}throw new Error("Invalid computer call output")})(),call_id:h.tool_call_id}:(o=h.additional_kwargs)!=null&&o.customTool?{type:"custom_tool_call_output",call_id:h.tool_call_id,output:h.content}:{type:"function_call_output",call_id:h.tool_call_id,id:(l=h.id)!=null&&l.startsWith("fc_")?h.id:void 0,output:typeof h.content!="string"?JSON.stringify(h.content):h.content}}if(i==="assistant"){if(!e&&(s==null?void 0:s.output)!=null&&Array.isArray(s==null?void 0:s.output)&&(s==null?void 0:s.output.length)>0&&(s!=null&&s.output.every(_=>"type"in _)))return s==null?void 0:s.output;const h=[];if(a!=null&&a.reasoning&&!e){const _=mM(a.reasoning);h.push(_)}let{content:f}=r;a!=null&&a.refusal&&(typeof f=="string"&&(f=[{type:"output_text",text:f,annotations:[]}]),f=[...f,{type:"refusal",refusal:a.refusal}]),(typeof f=="string"||f.length>0)&&h.push({type:"message",role:"assistant",...r.id&&!e&&r.id.startsWith("msg_")?{id:r.id}:{},content:da(()=>typeof f=="string"?f:f.flatMap(_=>_.type==="text"?{type:"output_text",text:_.text,annotations:_.annotations??[]}:_.type==="output_text"||_.type==="refusal"?_:[]))});const m=a==null?void 0:a[Ka];hn.isInstance(r)&&((u=r.tool_calls)!=null&&u.length)?h.push(...r.tool_calls.map(_=>h3(_)?{type:"custom_tool_call",id:_.call_id,call_id:_.id??"",input:_.args.input,name:_.name}:{type:"function_call",name:_.name,arguments:JSON.stringify(_.args),call_id:_.id,...e?{}:{id:m==null?void 0:m[_.id]}})):a!=null&&a.tool_calls&&h.push(...a.tool_calls.map(_=>({type:"function_call",name:_.function.name,call_id:_.id,arguments:_.function.arguments,...e?{}:{id:m==null?void 0:m[_.id]}})));const v=(d=s==null?void 0:s.output)!=null&&d.length?s==null?void 0:s.output:a.tool_outputs,w=["computer_call","mcp_call","code_interpreter_call","image_generation_call"];if(v!=null){const _=v,y=_==null?void 0:_.filter(p=>w.includes(p.type));y.length>0&&h.push(...y)}return h}if(i==="user"||i==="system"||i==="developer"){if(typeof r.content=="string")return{type:"message",role:i,content:r.content};const h=[],f=r.content.flatMap(m=>{if(m.type==="mcp_approval_response"&&h.push({type:"mcp_approval_response",approval_request_id:m.approval_request_id,approve:m.approve}),Cr(m))return kg(m,GE);if(m.type==="text")return{type:"input_text",text:m.text};if(m.type==="image_url"){const v=da(()=>{if(typeof m.image_url=="string")return m.image_url;if(typeof m.image_url=="object"&&m.image_url!==null&&"url"in m.image_url)return m.image_url.url}),w=da(()=>{if(typeof m.image_url=="string")return"auto";if(typeof m.image_url=="object"&&m.image_url!==null&&"detail"in m.image_url)return m.image_url.detail});return{type:"input_image",image_url:v,detail:w}}return m.type==="input_text"||m.type==="input_image"||m.type==="input_file"?m:[]});return f.length>0&&h.push({type:"message",role:i,content:f}),h}return console.warn(`Unsupported role found when converting to OpenAI Responses API: ${i}`),[]});var yM=class extends yy{invocationParams(t){var s;let e;(t==null?void 0:t.strict)!==void 0?e=t.strict:this.supportsStrictToolCalling!==void 0&&(e=this.supportsStrictToolCalling);const n={model:this.model,temperature:this.temperature,top_p:this.topP,user:this.user,stream:this.streaming,previous_response_id:t==null?void 0:t.previous_response_id,truncation:t==null?void 0:t.truncation,include:t==null?void 0:t.include,tools:(s=t==null?void 0:t.tools)!=null&&s.length?this._reduceChatOpenAITools(t.tools,{stream:this.streaming,strict:e}):void 0,tool_choice:u3(t==null?void 0:t.tool_choice)?t==null?void 0:t.tool_choice:(()=>{const a=wE(t==null?void 0:t.tool_choice);if(typeof a=="object"&&"type"in a){if(a.type==="function")return{type:"function",name:a.function.name};if(a.type==="allowed_tools")return{type:"allowed_tools",mode:a.allowed_tools.mode,tools:a.allowed_tools.tools};if(a.type==="custom")return{type:"custom",name:a.custom.name}}})(),text:(()=>{if(t!=null&&t.text)return t.text;const a=this._getResponseFormat(t==null?void 0:t.response_format);return(a==null?void 0:a.type)==="json_schema"?a.json_schema.schema!=null?{format:{type:"json_schema",schema:a.json_schema.schema,description:a.json_schema.description,name:a.json_schema.name,strict:a.json_schema.strict},verbosity:t==null?void 0:t.verbosity}:void 0:{format:a,verbosity:t==null?void 0:t.verbosity}})(),parallel_tool_calls:t==null?void 0:t.parallel_tool_calls,max_output_tokens:this.maxTokens===-1?void 0:this.maxTokens,prompt_cache_key:(t==null?void 0:t.promptCacheKey)??this.promptCacheKey,...this.zdrEnabled?{store:!1}:{},...this.modelKwargs},r=this._getReasoningParams(t);return r!==void 0&&(n.reasoning=r),n}async _generate(t,e){var r;const n=this.invocationParams(e);if(n.stream){const s=this._streamResponseChunks(t,e);let a;for await(const i of s)i.message.response_metadata={...i.generationInfo,...i.message.response_metadata},a=(a==null?void 0:a.concat(i))??i;return{generations:a?[a]:[],llmOutput:{estimatedTokenUsage:(r=a==null?void 0:a.message)==null?void 0:r.usage_metadata}}}else{const s=await this.completionWithRetry({input:pw({messages:t,zdrEnabled:this.zdrEnabled??!1,model:this.model}),...n,stream:!1},{signal:e==null?void 0:e.signal,...e==null?void 0:e.options});return{generations:[{text:s.output_text,message:WE(s)}],llmOutput:{id:s.id,estimatedTokenUsage:s.usage?{promptTokens:s.usage.input_tokens,completionTokens:s.usage.output_tokens,totalTokens:s.usage.total_tokens}:void 0}}}}async*_streamResponseChunks(t,e,n){const r=await this.completionWithRetry({...this.invocationParams(e),input:pw({messages:t,zdrEnabled:this.zdrEnabled??!1,model:this.model}),stream:!0},e);for await(const s of r){const a=pM(s);a!=null&&(yield a,await(n==null?void 0:n.handleLLMNewToken(a.text||"",{prompt:e.promptIndex??0,completion:0},void 0,void 0,void 0,{chunk:a})))}}async completionWithRetry(t,e){return this.caller.call(async()=>{var r,s;const n=this._getClientOptions(e);try{return((s=(r=t.text)==null?void 0:r.format)==null?void 0:s.type)==="json_schema"&&!t.stream?await this.client.responses.parse(t,n):await this.client.responses.create(t,n)}catch(a){throw mS(a)}})}_reduceChatOpenAITools(t,e){const n=[];for(const r of t)if(dy(r))r.type==="image_generation"&&(e!=null&&e.stream)&&(r.partial_images=1),n.push(r);else if(Hu(r)){const s=r.metadata.customTool;n.push({type:"custom",name:s.name,description:s.description,format:s.format})}else fy(r)?n.push({type:"function",name:r.function.name,parameters:r.function.parameters,description:r.function.description,strict:(e==null?void 0:e.strict)??null}):xE(r)&&n.push(f3(r));return n}},vM=class VE extends yy{constructor(n){super(n);k(this,"useResponsesApi",!1);k(this,"responses");k(this,"completions");this.fields=n,this.useResponsesApi=(n==null?void 0:n.useResponsesApi)??!1,this.responses=(n==null?void 0:n.responses)??new yM(n),this.completions=(n==null?void 0:n.completions)??new fM(n)}get lc_serializable_keys(){return[...super.lc_serializable_keys,"useResponsesApi"]}get callKeys(){return[...super.callKeys,"useResponsesApi"]}_useResponsesApi(n){var i,o,l,u,d;const r=(i=n==null?void 0:n.tools)==null?void 0:i.some(dy),s=(n==null?void 0:n.previous_response_id)!=null||(n==null?void 0:n.text)!=null||(n==null?void 0:n.truncation)!=null||(n==null?void 0:n.include)!=null||((o=n==null?void 0:n.reasoning)==null?void 0:o.summary)!=null||((l=this.reasoning)==null?void 0:l.summary)!=null,a=((u=n==null?void 0:n.tools)==null?void 0:u.some(xE))||((d=n==null?void 0:n.tools)==null?void 0:d.some(Hu));return this.useResponsesApi||r||s||a}getLsParams(n){const r=this._combineCallOptions(n);return this._useResponsesApi(n)?this.responses.getLsParams(r):this.completions.getLsParams(r)}invocationParams(n){const r=this._combineCallOptions(n);return this._useResponsesApi(n)?this.responses.invocationParams(r):this.completions.invocationParams(r)}async _generate(n,r,s){return this._useResponsesApi(r)?this.responses._generate(n,r):this.completions._generate(n,r,s)}async*_streamResponseChunks(n,r,s){if(this._useResponsesApi(r)){yield*this.responses._streamResponseChunks(n,this._combineCallOptions(r),s);return}yield*this.completions._streamResponseChunks(n,this._combineCallOptions(r),s)}withConfig(n){const r=new VE(this.fields);return r.defaultOptions={...this.defaultOptions,...n},r}},_M={};je(_M,{BaseLLM:()=>qE,LLM:()=>wM});var qE=class ho extends py{constructor(){super(...arguments);k(this,"lc_namespace",["langchain","llms",this._llmType()])}async invoke(n,r){const s=ho._convertInputToPromptValue(n);return(await this.generatePrompt([s],r,r==null?void 0:r.callbacks)).generations[0][0].text}async*_streamResponseChunks(n,r,s){throw new Error("Not implemented.")}_separateRunnableConfigFromCallOptionsCompat(n){const[r,s]=super._separateRunnableConfigFromCallOptions(n);return s.signal=r.signal,[r,s]}async*_streamIterator(n,r){if(this._streamResponseChunks===ho.prototype._streamResponseChunks)yield this.invoke(n,r);else{const s=ho._convertInputToPromptValue(n),[a,i]=this._separateRunnableConfigFromCallOptionsCompat(r),o=await dn.configure(a.callbacks,this.callbacks,a.tags,this.tags,a.metadata,this.metadata,{verbose:this.verbose}),l={options:i,invocation_params:this==null?void 0:this.invocationParams(i),batch_size:1},u=await(o==null?void 0:o.handleLLMStart(this.toJSON(),[s.toString()],a.runId,void 0,l,void 0,void 0,a.runName));let d=new di({text:""});try{for await(const h of this._streamResponseChunks(s.toString(),i,u==null?void 0:u[0]))d?d=d.concat(h):d=h,typeof h.text=="string"&&(yield h.text)}catch(h){throw await Promise.all((u??[]).map(f=>f==null?void 0:f.handleLLMError(h))),h}await Promise.all((u??[]).map(h=>h==null?void 0:h.handleLLMEnd({generations:[[d]]})))}}async generatePrompt(n,r,s){const a=n.map(i=>i.toString());return this.generate(a,r,s)}invocationParams(n){return{}}_flattenLLMResult(n){const r=[];for(let s=0;s<n.generations.length;s+=1){const a=n.generations[s];if(s===0)r.push({generations:[a],llmOutput:n.llmOutput});else{const i=n.llmOutput?{...n.llmOutput,tokenUsage:{}}:void 0;r.push({generations:[a],llmOutput:i})}}return r}async _generateUncached(n,r,s,a){let i;if(a!==void 0&&a.length===n.length)i=a;else{const d=await dn.configure(s.callbacks,this.callbacks,s.tags,this.tags,s.metadata,this.metadata,{verbose:this.verbose}),h={options:r,invocation_params:this==null?void 0:this.invocationParams(r),batch_size:n.length};i=await(d==null?void 0:d.handleLLMStart(this.toJSON(),n,s.runId,void 0,h,void 0,void 0,s==null?void 0:s.runName))}const o=!!(i!=null&&i[0].handlers.find(Lg));let l;if(o&&n.length===1&&this._streamResponseChunks!==ho.prototype._streamResponseChunks)try{const d=await this._streamResponseChunks(n[0],r,i==null?void 0:i[0]);let h;for await(const f of d)h===void 0?h=f:h=Ds(h,f);if(h===void 0)throw new Error("Received empty response from chat model call.");l={generations:[[h]],llmOutput:{}},await(i==null?void 0:i[0].handleLLMEnd(l))}catch(d){throw await(i==null?void 0:i[0].handleLLMError(d)),d}else{try{l=await this._generate(n,r,i==null?void 0:i[0])}catch(h){throw await Promise.all((i??[]).map(f=>f==null?void 0:f.handleLLMError(h))),h}const d=this._flattenLLMResult(l);await Promise.all((i??[]).map((h,f)=>h==null?void 0:h.handleLLMEnd(d[f])))}const u=(i==null?void 0:i.map(d=>d.runId))||void 0;return Object.defineProperty(l,il,{value:u?{runIds:u}:void 0,configurable:!0}),l}async _generateCached({prompts:n,cache:r,llmStringKey:s,parsedOptions:a,handledOptions:i,runId:o}){const l=await dn.configure(i.callbacks,this.callbacks,i.tags,this.tags,i.metadata,this.metadata,{verbose:this.verbose}),u={options:a,invocation_params:this==null?void 0:this.invocationParams(a),batch_size:n.length},d=await(l==null?void 0:l.handleLLMStart(this.toJSON(),n,o,void 0,u,void 0,void 0,i==null?void 0:i.runName)),h=[],m=(await Promise.allSettled(n.map(async(_,y)=>{const p=await r.lookup(_,s);return p==null&&h.push(y),p}))).map((_,y)=>({result:_,runManager:d==null?void 0:d[y]})).filter(({result:_})=>_.status==="fulfilled"&&_.value!=null||_.status==="rejected"),v=[];await Promise.all(m.map(async({result:_,runManager:y},p)=>{if(_.status==="fulfilled"){const g=_.value;return v[p]=g.map(S=>(S.generationInfo={...S.generationInfo,tokenUsage:{}},S)),g.length&&await(y==null?void 0:y.handleLLMNewToken(g[0].text)),y==null?void 0:y.handleLLMEnd({generations:[g]},void 0,void 0,void 0,{cached:!0})}else return await(y==null?void 0:y.handleLLMError(_.reason,void 0,void 0,void 0,{cached:!0})),Promise.reject(_.reason)}));const w={generations:v,missingPromptIndices:h,startedRunManagers:d};return Object.defineProperty(w,il,{value:d?{runIds:d==null?void 0:d.map(_=>_.runId)}:void 0,configurable:!0}),w}async generate(n,r,s){if(!Array.isArray(n))throw new Error("Argument 'prompts' is expected to be a string[]");let a;Array.isArray(r)?a={stop:r}:a=r;const[i,o]=this._separateRunnableConfigFromCallOptionsCompat(a);if(i.callbacks=i.callbacks??s,!this.cache)return this._generateUncached(n,o,i);const{cache:l}=this,u=this._getSerializedCacheKeyParametersForCall(o),{generations:d,missingPromptIndices:h,startedRunManagers:f}=await this._generateCached({prompts:n,cache:l,llmStringKey:u,parsedOptions:o,handledOptions:i,runId:i.runId});let m={};if(h.length>0){const v=await this._generateUncached(h.map(w=>n[w]),o,i,f!==void 0?h.map(w=>f==null?void 0:f[w]):void 0);await Promise.all(v.generations.map(async(w,_)=>{const y=h[_];return d[y]=w,l.update(n[y],u,w)})),m=v.llmOutput??{}}return{generations:d,llmOutput:m}}_identifyingParams(){return{}}_modelType(){return"base_llm"}},wM=class extends qE{async _generate(t,e,n){return{generations:await Promise.all(t.map((s,a)=>this._call(s,{...e,promptIndex:a},n).then(i=>[{text:i}])))}}},xM={};je(xM,{chunkArray:()=>bM});const bM=(t,e)=>t.reduce((n,r,s)=>{const a=Math.floor(s/e),i=n[a]||[];return n[a]=i.concat([r]),n},[]);var SM={};je(SM,{Embeddings:()=>kM});var kM=class{constructor(t){k(this,"caller");this.caller=new Nl(t??{})}},EM={};je(EM,{BaseToolkit:()=>NM,DynamicStructuredTool:()=>JE,DynamicTool:()=>KE,StructuredTool:()=>vy,Tool:()=>ZE,ToolInputParsingException:()=>Tu,isLangChainTool:()=>Gd,isRunnableToolLike:()=>cy,isStructuredTool:()=>ly,isStructuredToolParams:()=>uy,tool:()=>TM});var vy=class extends my{constructor(e){super(e??{});k(this,"returnDirect",!1);k(this,"verboseParsingErrors",!1);k(this,"responseFormat","content");k(this,"defaultConfig");this.verboseParsingErrors=(e==null?void 0:e.verboseParsingErrors)??this.verboseParsingErrors,this.responseFormat=(e==null?void 0:e.responseFormat)??this.responseFormat,this.defaultConfig=(e==null?void 0:e.defaultConfig)??this.defaultConfig,this.metadata=(e==null?void 0:e.metadata)??this.metadata}get lc_namespace(){return["langchain","tools"]}async invoke(e,n){let r,s=$e(ju(this.defaultConfig,n));return To(e)?(r=e.args,s={...s,toolCall:e}):r=e,this.call(r,s)}async call(e,n,r){const s=To(e)?e.args:e;let a;if(xr(this.schema))try{a=await Md(this.schema,s)}catch(v){let w="Received tool input did not match expected schema";throw this.verboseParsingErrors&&(w=`${w}
Details: ${v.message}`),Kk(v)&&(w=`${w}

${v4(v)}`),new Tu(w,JSON.stringify(e))}else{const v=Xe(s,this.schema);if(!v.valid){let w="Received tool input did not match expected schema";throw this.verboseParsingErrors&&(w=`${w}
Details: ${v.errors.map(_=>`${_.keywordLocation}: ${_.error}`).join(`
`)}`),new Tu(w,JSON.stringify(e))}a=s}const i=Od(n),o=dn.configure(i.callbacks,this.callbacks,i.tags||r,this.tags,i.metadata,this.metadata,{verbose:this.verbose}),l=await(o==null?void 0:o.handleToolStart(this.toJSON(),typeof e=="string"?e:JSON.stringify(e),i.runId,void 0,void 0,void 0,i.runName));delete i.runId;let u;try{u=await this._call(a,l,i)}catch(v){throw await(l==null?void 0:l.handleToolError(v)),v}let d,h;if(this.responseFormat==="content_and_artifact")if(Array.isArray(u)&&u.length===2)[d,h]=u;else throw new Error(`Tool response format is "content_and_artifact" but the output was not a two-tuple.
Result: ${JSON.stringify(u)}`);else d=u;let f;To(e)&&(f=e.id),!f&&v2(i)&&(f=i.toolCall.id);const m=AM({content:d,artifact:h,toolCallId:f,name:this.name,metadata:this.metadata});return await(l==null?void 0:l.handleToolEnd(m)),m}},ZE=class extends vy{constructor(e){super(e);k(this,"schema",Bd({input:Ud().optional()}).transform(e=>e.input))}call(e,n){const r=typeof e=="string"||e==null?{input:e}:e;return super.call(r,n)}},KE=class extends ZE{constructor(e){super(e);k(this,"name");k(this,"description");k(this,"func");this.name=e.name,this.description=e.description,this.func=e.func,this.returnDirect=e.returnDirect??this.returnDirect}static lc_name(){return"DynamicTool"}async call(e,n){const r=Od(n);return r.runName===void 0&&(r.runName=this.name),super.call(e,r)}async _call(e,n,r){return this.func(e,n,r)}},JE=class extends vy{constructor(e){super(e);k(this,"name");k(this,"description");k(this,"func");k(this,"schema");this.name=e.name,this.description=e.description,this.func=e.func,this.returnDirect=e.returnDirect??this.returnDirect,this.schema=e.schema}static lc_name(){return"DynamicStructuredTool"}async call(e,n,r){const s=Od(n);return s.runName===void 0&&(s.runName=this.name),super.call(e,s,r)}_call(e,n,r){return this.func(e,n,r)}},NM=class{getTools(){return this.tools}};function TM(t,e){var i;const n=ty(e.schema),r=Oo(e.schema);if(!e.schema||n||r)return new KE({...e,description:e.description??((i=e.schema)==null?void 0:i.description)??`${e.name} tool`,func:async(o,l,u)=>new Promise((d,h)=>{const f=Je(u,{callbacks:l==null?void 0:l.getChild()});rr.runWithConfig(Qr(f),async()=>{try{d(t(o,f))}catch(m){h(m)}})})});const s=e.schema,a=e.description??e.schema.description??`${e.name} tool`;return new JE({...e,description:a,schema:s,func:async(o,l,u)=>new Promise((d,h)=>{let f;const m=()=>{u!=null&&u.signal&&f&&u.signal.removeEventListener("abort",f)};u!=null&&u.signal&&(f=()=>{m(),h(sl(u.signal))},u.signal.addEventListener("abort",f));const v=Je(u,{callbacks:l==null?void 0:l.getChild()});rr.runWithConfig(Qr(v),async()=>{var w;try{const _=await t(o,v);if((w=u==null?void 0:u.signal)!=null&&w.aborted){m();return}m(),d(_)}catch(_){m(),h(_)}})})})}function AM(t){const{content:e,artifact:n,toolCallId:r,metadata:s}=t;return r&&!Cg(e)?typeof e=="string"||Array.isArray(e)&&e.every(a=>typeof a=="object")?new Ir({status:"success",content:e,artifact:n,tool_call_id:r,name:t.name,metadata:s}):new Ir({status:"success",content:CM(e),artifact:n,tool_call_id:r,name:t.name,metadata:s}):e}function CM(t){try{return JSON.stringify(t,null,2)??""}catch{return`${t}`}}function YE(t){try{localStorage.setItem("openai_api_key",t),console.log("OpenAI API key stored successfully")}catch(e){throw console.error("Failed to store OpenAI API key:",e),new Error("Could not store OpenAI API key in localStorage")}}function Zu(){try{const t=localStorage.getItem("openai_api_key");if(t)return t}catch{console.warn("Could not access localStorage for OpenAI API key")}return null}const IM=()=>{const t=Zu();if(!t)throw new Error("OpenAI API key not configured. ");return t},jM=(t="gpt-4o-mini",e=.7)=>{const n=IM();return typeof window<"u",new vM({modelName:t,temperature:e,apiKey:n})};async function Hs(t,e,n="gpt-4o-mini",r=.7){const s=jM(n,r),a=new ME,i=[];e&&i.push(new Yr(e)),i.push(new Or(t));const o=Ti.from([s,a]);try{return await o.invoke(i)}catch(l){throw new Error(`LangChain error: ${l.message||"Unknown error"}`)}}async function QE(t,e,n="gpt-4o-mini",r=.7){const s=await Hs(t,e,n,r);try{return JSON.parse(s)}catch{const a=s.match(/```json\n([\s\S]*?)\n```/)||s.match(/```\n([\s\S]*?)\n```/);if(a)return JSON.parse(a[1]);throw new Error("Could not parse JSON from LangChain response")}}const RM=Object.freeze(Object.defineProperty({__proto__:null,callLangChain:Hs,callLangChainJSON:QE,getOpenAIApiKey:Zu,setOpenAIApiKey:YE},Symbol.toStringTag,{value:"Module"}));async function OM(t){console.log("[RepoAnalysis] Starting repository analysis...");const e={currentStep:Z.ANALYSIS,repoAnalyses:new Map};if(!t.discoveredRepos||t.discoveredRepos.length===0)return e.errors=new Map([["analysis","No repositories to analyze"]]),e;const n=xt(),r=new Map;let s=0;for(const a of t.discoveredRepos)try{s++,e.progress={current:s,total:t.discoveredRepos.length,currentRepo:a.fullName,currentAgent:"RepoAnalysis"},console.log(`[RepoAnalysis] Analyzing ${a.fullName} (${s}/${t.discoveredRepos.length})`);const[i,o]=a.fullName.split("/"),l=a.defaultBranch||"main",[u,d,h]=await Promise.all([ra(i,o,"README.md",l,n||void 0).catch(()=>null),ra(i,o,"package.json",l,n||void 0).catch(()=>null),Ft(i,o,"",l,n||void 0).catch(()=>[])]);let f=null;if(d)try{f=JSON.parse(d)}catch{console.warn(`[RepoAnalysis] Failed to parse package.json for ${a.fullName}`)}const m=[],v=[],w=[];if(f){if(f.dependencies){const T=Object.keys(f.dependencies);T.includes("react")&&v.push("React"),T.includes("vue")&&v.push("Vue"),T.includes("angular")&&v.push("Angular"),T.includes("next")&&v.push("Next.js"),T.includes("express")&&v.push("Express"),T.includes("fastify")&&v.push("Fastify")}m.push(f.language||"JavaScript")}const _=new Set;h.forEach(T=>{var A;if(T.type==="file"){const x=(A=T.name.split(".").pop())==null?void 0:A.toLowerCase();x&&_.add(x)}}),(_.has("ts")||_.has("tsx"))&&m.push("TypeScript"),(_.has("js")||_.has("jsx"))&&m.push("JavaScript"),_.has("py")&&m.push("Python"),_.has("java")&&m.push("Java"),_.has("go")&&m.push("Go"),_.has("rs")&&m.push("Rust"),h.forEach(T=>{T.type==="file"&&!T.name.startsWith(".")&&w.push(T.name)});let y="",p=[],g=[...m,...v],S="moderate";try{const T=`Analyze this GitHub repository and provide insights:

Repository: ${a.fullName}
Description: ${a.description||"No description"}
Language: ${a.language||m.join(", ")||"Unknown"}
Has README: ${u?"Yes":"No"}
Has package.json: ${f?"Yes":"No"}
Main files: ${w.slice(0,10).join(", ")}

${f?`Package.json dependencies: ${Object.keys(f.dependencies||{}).slice(0,20).join(", ")}`:""}

Provide:
1. A brief summary (2-3 sentences) of what this repository does
2. 3-5 key features or capabilities
3. The primary tech stack
4. Complexity level (simple/moderate/complex)

Format as JSON:
{
  "summary": "...",
  "keyFeatures": ["...", "..."],
  "techStack": ["...", "..."],
  "complexity": "simple|moderate|complex"
}`,A=await Hs(T,"You are a technical analyst. Provide concise, accurate analysis of code repositories.","gpt-4o-mini",.3);try{const x=JSON.parse(A);y=x.summary||"",p=x.keyFeatures||[],x.techStack&&(g=[...new Set([...g,...x.techStack])]),S=x.complexity||"moderate"}catch{y=A.split(`
`)[0]||`A ${a.language||"software"} project`}}catch{console.warn(`[RepoAnalysis] AI analysis failed for ${a.fullName}, using fallback`),y=a.description||`A ${a.language||"software"} project`,p=v.length>0?v:["General purpose"]}if(!S||S==="moderate"){const T=h.length,A=h.some(j=>j.name.includes("test")||j.name.includes("spec")),x=h.some(j=>j.name.includes("config")||j.name.includes(".json")||j.name.includes(".yaml"));T<10&&!A&&!x?S="simple":T>50||A&&x&&f?S="complex":S="moderate"}const N={repo:a,structure:{languages:[...new Set(m)],frameworks:[...new Set(v)],hasReadme:!!u,hasPackageJson:!!f,hasConfigFiles:h.some(T=>T.name.includes("config")),mainFiles:w.slice(0,20)},summary:y||a.description||`A ${a.language||"software"} project`,keyFeatures:p.length>0?p:["General purpose application"],techStack:[...new Set(g)],complexity:S};r.set(a.fullName,N)}catch(i){console.error(`[RepoAnalysis] Error analyzing ${a.fullName}:`,i);const o=`analysis_${a.fullName}`;e.errors||(e.errors=new Map),e.errors.set(o,i.message||"Analysis failed")}return e.repoAnalyses=r,e.completedSteps=new Set([...t.completedSteps||[],Z.ANALYSIS]),e.progress={current:t.discoveredRepos.length,total:t.discoveredRepos.length,currentAgent:"RepoAnalysis"},console.log(`[RepoAnalysis] Completed analysis for ${r.size} repositories`),e}async function PM(t,e){console.log(`[QualityAnalyzer] Analyzing quality for ${t.fullName}...`);const n=xt(),r=[];try{const s=await $M(t,n);r.push({id:"readme",label:"README Quality",score:s,weight:.15,description:"Presence and quality of README documentation"});const a=await LM(t,n);r.push({id:"organization",label:"Code Organization",score:a,weight:.2,description:"Folder structure and file organization"});const i=await DM(t,n);r.push({id:"testing",label:"Testing",score:i,weight:.15,description:"Test files and CI/CD setup"});const o=await MM(t,n);r.push({id:"documentation",label:"Documentation",score:o,weight:.15,description:"Overall documentation coverage"});const l=await FM(t,n);r.push({id:"configuration",label:"Configuration",score:l,weight:.1,description:"Presence of essential config files"});const u=await zM(t,n);r.push({id:"license",label:"License & Legal",score:u,weight:.1,description:"License file and legal compliance"});const d=await UM(t,n,e);r.push({id:"code-quality",label:"Code Quality",score:d,weight:.15,description:"Code structure and best practices"});const h=Math.round(r.reduce((f,m)=>f+m.score*m.weight,0));return{repoName:t.fullName,overallScore:Math.min(100,Math.max(0,h)),metrics:r}}catch(s){return console.error(`[QualityAnalyzer] Error analyzing ${t.fullName}:`,s),{repoName:t.fullName,overallScore:0,metrics:[{id:"error",label:"Analysis Error",score:0,weight:1,description:s.message||"Failed to analyze repository"}]}}}async function $M(t,e){try{const r=(await Ft(t.owner,t.name,"",t.defaultBranch,e)).find(i=>i.name.toLowerCase().startsWith("readme")&&i.type==="file");if(!r)return 0;const s=r.size||0;let a=20;return s>500&&(a+=20),s>2e3&&(a+=20),s>5e3&&(a+=20),s>1e4&&(a+=20),Math.min(100,a)}catch{return 0}}async function LM(t,e){try{const n=await Ft(t.owner,t.name,"",t.defaultBranch,e),r=n.filter(h=>h.type==="dir"),s=n.filter(h=>h.type==="file");let a=0;const i=r.some(h=>h.name.toLowerCase()==="src"),o=r.some(h=>h.name.toLowerCase()==="lib"||h.name.toLowerCase()==="libs"),l=r.some(h=>h.name.toLowerCase().includes("test")),u=r.some(h=>h.name.toLowerCase().includes("doc"));return i&&(a+=25),o&&(a+=15),l&&(a+=20),u&&(a+=15),s.length<10?a+=15:s.length<20&&(a+=10),s.some(h=>h.name.match(/^(package\.json|tsconfig\.json|\.gitignore|\.eslintrc|\.prettierrc)/i))&&(a+=10),Math.min(100,a)}catch{return 50}}async function DM(t,e){try{const n=await Ft(t.owner,t.name,"",t.defaultBranch,e),r=[],s=async(u="")=>{const d=await Ft(t.owner,t.name,u,t.defaultBranch,e);for(const h of d)(h.type==="file"||h.type==="dir"&&(h.name.includes("test")||h.name.includes("spec")))&&r.push(h.path)};await s(),await s("tests"),await s("test"),await s("__tests__"),await s("spec");let a=0;return r.filter(u=>u.match(/(test|spec)\.(js|ts|jsx|tsx|py|java|go|rs)$/i)).length>0&&(a+=40),n.some(u=>u.name.match(/^(\.github\/workflows|\.gitlab-ci|\.travis|\.circleci|Jenkinsfile)/i))&&(a+=30),n.some(u=>u.name.match(/(jest|mocha|pytest|junit|vitest)\.config/i))&&(a+=30),Math.min(100,a)}catch{return 0}}async function MM(t,e){try{const n=await Ft(t.owner,t.name,"",t.defaultBranch,e);let r=0;n.some(u=>u.name.toLowerCase().startsWith("readme"))&&(r+=30),n.some(u=>u.type==="dir"&&u.name.toLowerCase().includes("doc"))&&(r+=25);const i=n.some(u=>u.name.toLowerCase().startsWith("contributing")),o=n.some(u=>u.name.toLowerCase().startsWith("license")),l=n.some(u=>u.name.toLowerCase().startsWith("changelog"));return i&&(r+=15),o&&(r+=15),l&&(r+=15),Math.min(100,r)}catch{return 0}}async function FM(t,e){try{const r=(await Ft(t.owner,t.name,"",t.defaultBranch,e)).filter(i=>i.type==="file").map(i=>i.name.toLowerCase());let s=0;const a=[{pattern:/^\.gitignore$/,points:20},{pattern:/^(package\.json|requirements\.txt|pom\.xml|build\.gradle|cargo\.toml)$/,points:20},{pattern:/^(tsconfig|jsconfig|webpack|vite|rollup)\./,points:15},{pattern:/^(\.eslintrc|\.prettierrc|\.editorconfig)$/,points:15},{pattern:/^(dockerfile|docker-compose|\.dockerignore)$/i,points:10},{pattern:/^(\.env\.example|\.env\.template)$/,points:10},{pattern:/^(\.github\/workflows\/)/,points:10}];for(const i of a)r.some(o=>i.pattern.test(o))&&(s+=i.points);return Math.min(100,s)}catch{return 50}}async function zM(t,e){try{return(await Ft(t.owner,t.name,"",t.defaultBranch,e)).some(s=>s.name.toLowerCase().startsWith("license"))?100:0}catch{return 0}}async function UM(t,e,n){try{let r=50;return n&&(n.complexity==="simple"?r+=20:n.complexity==="moderate"&&(r+=10),n.techStack&&n.techStack.length>0&&(r+=15),n.keyFeatures&&n.keyFeatures.length>3&&(r+=15)),(await Ft(t.owner,t.name,"",t.defaultBranch,e)).some(i=>i.name.match(/(tsconfig|\.ts$|\.tsx$)/i))&&(r+=20),Math.min(100,r)}catch{return 50}}function BM(t,e,n){const r=[];if(e){const s=e.overallScore,a=GM(s);r.push(`![Quality Score](https://img.shields.io/badge/quality-${s}%2F100-${a}?style=for-the-badge)`)}if(r.push("![Documentation](https://img.shields.io/badge/docs-pending-yellow?style=for-the-badge&logo=readthedocs)"),t.language){const s=HM(t.language);r.push(`![Language](https://img.shields.io/badge/language-${encodeURIComponent(t.language)}-${s}?style=for-the-badge&logo=${WM(t.language)})`)}if(r.push("![License](https://img.shields.io/badge/license-MIT-blue?style=for-the-badge)"),t.private?r.push("![Status](https://img.shields.io/badge/status-private-red?style=for-the-badge)"):r.push("![Status](https://img.shields.io/badge/status-public-green?style=for-the-badge)"),t.lastPushedAt){const s=new Date(t.lastPushedAt),a=Math.floor((Date.now()-s.getTime())/(1e3*60*60*24)),i=a<30?"green":a<90?"yellow":"red";r.push(`![Last Updated](https://img.shields.io/badge/updated-${a}%20days%20ago-${i}?style=for-the-badge)`)}return r.join(" ")}function GM(t){return t>=80?"brightgreen":t>=60?"green":t>=40?"yellow":t>=20?"orange":"red"}function HM(t){return{JavaScript:"F7DF1E",TypeScript:"3178C6",Python:"3776AB",Java:"ED8B00","C++":"00599C",Go:"00ADD8",Rust:"000000",Ruby:"CC342D",PHP:"777BB4",Swift:"FA7343",Kotlin:"7F52FF",Dart:"0175C2",HTML:"E34F26",CSS:"1572B6",Shell:"89E051"}[t]||"gray"}function WM(t){return{JavaScript:"javascript",TypeScript:"typescript",Python:"python",Java:"java","C++":"cplusplus",Go:"go",Rust:"rust",Ruby:"ruby",PHP:"php",Swift:"swift",Kotlin:"kotlin",Dart:"dart",HTML:"html5",CSS:"css3",Shell:"gnu-bash"}[t]||"code"}async function VM(t){console.log("[QualityAnalyzer] Starting quality analysis...");const e={currentStep:Z.QUALITY,qualityReports:new Map,badges:new Map};if(!t.repoAnalyses||t.repoAnalyses.size===0)return console.warn("[QualityAnalyzer] No repository analyses available, skipping"),e;const n=new Map,r=new Map;let s=0;const a=t.repoAnalyses.size;for(const[i,o]of t.repoAnalyses.entries())try{s++,e.progress={current:s,total:a,currentRepo:i,currentAgent:"QualityAnalyzer"},console.log(`[QualityAnalyzer] Analyzing quality for ${i} (${s}/${a})`);const l=await PM(o.repo,o);n.set(i,l);const u=BM(o.repo,l);r.set(i,u),console.log(`[QualityAnalyzer] Quality score for ${i}: ${l.overallScore}/100`)}catch(l){console.error(`[QualityAnalyzer] Error analyzing ${i}:`,l);const u=`quality_${i}`;e.errors||(e.errors=new Map),e.errors.set(u,l.message||"Quality analysis failed")}return e.qualityReports=n,e.badges=r,e.completedSteps=new Set([...t.completedSteps||[],Z.QUALITY]),e.progress={current:a,total:a,currentAgent:"QualityAnalyzer"},console.log(`[QualityAnalyzer] Completed quality analysis for ${n.size} repositories`),e}async function qM(t,e){console.log(`[RefactorProposal] Generating proposal for ${t.fullName}...`);const n=xt();try{const r=await XE(t,n);return await ZM(t,r,e)}catch(r){return console.error("[RefactorProposal] Error generating proposal:",r),{repoName:t.fullName,highLevelSummary:"Unable to generate refactor proposal due to analysis error.",recommendedStructure:[],moves:[],warnings:[r.message||"Analysis failed"]}}}async function XE(t,e,n="",r=0,s=3){if(r>s)return[];try{const a=await Ft(t.owner,t.name,n,t.defaultBranch,e),i=[];for(const o of a){const l=n?`${n}/${o.name}`:o.name,u={path:l,type:o.type,size:o.size};o.type==="dir"&&r<s&&(u.children=await XE(t,e,l,r+1,s)),i.push(u)}return i}catch(a){return console.warn(`[RefactorProposal] Error analyzing path ${n}:`,a),[]}}async function ZM(t,e,n){const r=JSON.stringify(e,null,2),s=n?JSON.stringify(n,null,2):"N/A",a=`Analyze this GitHub repository structure and generate an intelligent refactor proposal.

Repository: ${t.fullName}
${t.description?`Description: ${t.description}`:""}

Current Structure:
${r}

${n?`Repository Analysis:
${s}`:""}

Generate a refactor proposal that:
1. Improves code organization and maintainability
2. Follows best practices for the detected tech stack
3. Groups related files logically
4. Separates concerns (src, tests, docs, config)
5. Makes the repository more intuitive for new contributors

Return a JSON object with this structure:
{
  "highLevelSummary": "Brief summary of the refactoring goals",
  "recommendedStructure": [
    {
      "folder": "src/components",
      "description": "Purpose of this folder"
    }
  ],
  "moves": [
    {
      "fromPath": "old/path/file.js",
      "toPath": "new/path/file.js",
      "reason": "Why this move improves organization"
    }
  ],
  "warnings": ["Any warnings about breaking changes or risks"]
}

Focus on:
- Moving files to appropriate folders (src/, lib/, tests/, docs/, etc.)
- Grouping related functionality
- Separating configuration from code
- Improving discoverability
- Following language/framework conventions

Be specific and actionable. Limit to 10-15 moves maximum.`,i=`You are an expert software architect specializing in repository structure and code organization. 
Generate practical, actionable refactoring proposals that improve maintainability without breaking functionality.`;try{const o=await QE(a,i,"gpt-4o-mini",.7);return{repoName:t.fullName,highLevelSummary:o.highLevelSummary||"Repository structure refactoring proposal",recommendedStructure:Array.isArray(o.recommendedStructure)?o.recommendedStructure:[],moves:Array.isArray(o.moves)?o.moves:[],warnings:Array.isArray(o.warnings)?o.warnings:[]}}catch{return KM(t,e)}}function KM(t,e){const n=[],r=[],s=e.filter(u=>u.type==="file"),a=e.filter(u=>u.type==="dir"),i=a.some(u=>u.path.toLowerCase()==="src");a.some(u=>u.path.toLowerCase()==="lib"||u.path.toLowerCase()==="libs");const o=a.some(u=>u.path.toLowerCase().includes("test"));return!i&&s.length>5&&(r.push({folder:"src",description:"Main source code directory"}),s.forEach(u=>{u.path.match(/\.(js|ts|jsx|tsx|py|java|go|rs|rb|php)$/i)&&!u.path.includes("test")&&!u.path.includes("spec")&&n.push({fromPath:u.path,toPath:`src/${u.path}`,reason:"Organize source code into src/ directory"})})),o||r.push({folder:"tests",description:"Test files directory"}),a.some(u=>u.path.toLowerCase().includes("doc"))||r.push({folder:"docs",description:"Documentation directory"}),{repoName:t.fullName,highLevelSummary:n.length>0?`Proposed ${n.length} file moves to improve organization and follow best practices.`:"Repository structure is already well-organized.",recommendedStructure:r,moves:n.slice(0,15),warnings:n.length>0?["Review moves carefully before applying"]:[]}}async function JM(t){console.log("[RefactorProposal] Starting refactor proposal generation...");const e={currentStep:Z.REFACTOR,refactorProposals:new Map};if(!t.repoAnalyses||t.repoAnalyses.size===0)return console.warn("[RefactorProposal] No repository analyses available, skipping"),e;const n=new Map;let r=0;const s=t.repoAnalyses.size;for(const[a,i]of t.repoAnalyses.entries())try{r++,e.progress={current:r,total:s,currentRepo:a,currentAgent:"RefactorProposal"},console.log(`[RefactorProposal] Generating proposal for ${a} (${r}/${s})`);const o=await qM(i.repo,i);n.set(a,o),console.log(`[RefactorProposal] Generated ${o.moves.length} moves for ${a}`)}catch(o){console.error(`[RefactorProposal] Error generating proposal for ${a}:`,o);const l=`refactor_${a}`;e.errors||(e.errors=new Map),e.errors.set(l,o.message||"Refactor proposal generation failed")}return e.refactorProposals=n,e.completedSteps=new Set([...t.completedSteps||[],Z.REFACTOR]),e.progress={current:s,total:s,currentAgent:"RefactorProposal"},console.log(`[RefactorProposal] Completed proposals for ${n.size} repositories`),e}async function YM(t){console.log("[DocsPlanner] Starting documentation planning...");const e={currentStep:Z.PLANNING,documentationPlans:new Map};if(!t.repoAnalyses||t.repoAnalyses.size===0)return e.errors=new Map([["planning","No repository analyses available"]]),e;const n=new Map;let r=0;const s=t.repoAnalyses.size;for(const[a,i]of t.repoAnalyses.entries())try{r++,e.progress={current:r,total:s,currentRepo:a,currentAgent:"DocsPlanner"},console.log(`[DocsPlanner] Planning docs for ${a} (${r}/${s})`);const o=`Create a documentation plan for this repository:

Repository: ${a}
Summary: ${i.summary}
Key Features: ${i.keyFeatures.join(", ")}
Tech Stack: ${i.techStack.join(", ")}
Complexity: ${i.complexity}
Has README: ${i.structure.hasReadme}
Has package.json: ${i.structure.hasPackageJson}
Main Files: ${i.structure.mainFiles.slice(0,10).join(", ")}

Create a comprehensive documentation plan with sections. Consider:
- Overview/Introduction
- Features and capabilities
- Setup/Installation instructions
- API documentation (if applicable)
- Architecture/Structure
- Examples/Usage

Return JSON format:
{
  "sections": [
    {
      "title": "Section Title",
      "type": "overview|features|setup|api|architecture|examples",
      "priority": 1-10,
      "estimatedTokens": 500
    }
  ],
  "estimatedLength": 5000,
  "focusAreas": ["area1", "area2"],
  "style": "technical|user-friendly|comprehensive"
}`;let l;try{const u=await Hs(o,"You are a documentation planning expert. Create detailed, structured documentation plans.","gpt-4o-mini",.4),d=JSON.parse(u);l={repo:i.repo,sections:d.sections.map(h=>({title:h.title,type:h.type||"overview",priority:h.priority||5,estimatedTokens:h.estimatedTokens||500})),estimatedLength:d.estimatedLength||5e3,focusAreas:d.focusAreas||i.keyFeatures,style:d.style||"comprehensive"}}catch{console.warn(`[DocsPlanner] AI planning failed for ${a}, using default plan`),l={repo:i.repo,sections:[{title:"Overview",type:"overview",priority:10,estimatedTokens:300},{title:"Features",type:"features",priority:9,estimatedTokens:500},{title:"Setup",type:"setup",priority:8,estimatedTokens:400},{title:"Architecture",type:"architecture",priority:7,estimatedTokens:600},{title:"Examples",type:"examples",priority:6,estimatedTokens:400}],estimatedLength:3e3,focusAreas:i.keyFeatures,style:"comprehensive"}}l.sections.sort((u,d)=>d.priority-u.priority),n.set(a,l)}catch(o){console.error(`[DocsPlanner] Error planning for ${a}:`,o);const l=`planning_${a}`;e.errors||(e.errors=new Map),e.errors.set(l,o.message||"Planning failed")}return e.documentationPlans=n,e.completedSteps=new Set([...t.completedSteps||[],Z.PLANNING]),e.progress={current:s,total:s,currentAgent:"DocsPlanner"},console.log(`[DocsPlanner] Completed planning for ${n.size} repositories`),e}async function QM(t,e,n={}){var i;const r=((i=t.sections)==null?void 0:i.sort((o,l)=>o.order-l.order))||[];let s="";s=`${t.title}

`;const a=[];if(r.forEach(o=>{let l="";const u=o.type.toLowerCase(),d=o.props||{};switch(u){case"hero":d.title?(l=`A hero section featuring "${d.title}"`,d.subtitle&&(l+=` with the message "${d.subtitle}"`)):l="A hero section";break;case"features":d.title?(l=`A features section titled "${d.title}"`,d.items&&Array.isArray(d.items)&&(l+=` highlighting ${d.items.length} key feature${d.items.length!==1?"s":""}`)):l="A features section";break;case"pricing":d.title?(l=`A pricing section titled "${d.title}"`,d.tiers&&Array.isArray(d.tiers)&&(l+=` with ${d.tiers.length} pricing tier${d.tiers.length!==1?"s":""}`)):l="A pricing section";break;case"testimonials":d.title?(l=`A testimonials section titled "${d.title}"`,d.items&&Array.isArray(d.items)&&(l+=` featuring ${d.items.length} testimonial${d.items.length!==1?"s":""}`)):l="A testimonials section";break;case"faq":d.title?(l=`An FAQ section titled "${d.title}"`,d.items&&Array.isArray(d.items)&&(l+=` with ${d.items.length} question${d.items.length!==1?"s":""} and answer${d.items.length!==1?"s":""}`)):l="An FAQ section";break;case"gallery":d.title?(l=`A gallery section titled "${d.title}"`,d.items&&Array.isArray(d.items)&&(l+=` showcasing ${d.items.length} item${d.items.length!==1?"s":""}`)):l="A gallery section";break;case"contact":if(d.title){if(l=`A contact section titled "${d.title}"`,d.email||d.phone||d.address){const h=[];d.email&&h.push("email"),d.phone&&h.push("phone"),d.address&&h.push("address"),l+=` with contact information (${h.join(", ")})`}}else l="A contact section";break;case"about":d.title?(l=`An about section titled "${d.title}"`,d.content&&(l+=" with detailed content")):l="An about section";break;case"cta":d.title?(l=`A call-to-action section titled "${d.title}"`,d.ctaLabel&&(l+=` with a "${d.ctaLabel}" button`)):l="A call-to-action section";break;case"footer":d.companyName?(l=`A footer section for ${d.companyName}`,d.links&&Array.isArray(d.links)&&(l+=` with ${d.links.length} link${d.links.length!==1?"s":""}`)):l="A footer section";break;case"navbar":l="A navigation bar";break;default:l=`A ${o.type} section`}a.push(l)}),a.length===0)s+=`This is the ${t.title} page located at ${t.path}. The page is part of the ${e.name} project.

`,s+="Currently, this page does not have any sections configured.";else{s+=`This is the ${t.title} page located at ${t.path}. The page is part of the ${e.name} project.

`,s+=`This page contains the following content:

`,a.forEach((l,u)=>{s+=`${u+1}. ${l}.
`}),s+=`
Together, these sections create a ${t.title.toLowerCase()} page that `;const o=t.title.toLowerCase();o.includes("home")||t.path==="/"?s+=`serves as the main landing page for the website, introducing visitors to ${e.name} and providing key information and navigation options.`:o.includes("about")?s+=`provides information about ${e.name}, including background details and key information about the organization or service.`:o.includes("contact")?s+=`allows visitors to get in touch with ${e.name} through various contact methods.`:o.includes("pricing")||o.includes("plan")?s+=`displays pricing information and options for ${e.name}'s products or services.`:o.includes("service")?s+=`showcases the services or offerings provided by ${e.name}.`:o.includes("portfolio")||o.includes("gallery")||o.includes("work")?s+=`displays a collection of work, projects, or visual content for ${e.name}.`:o.includes("blog")||o.includes("article")?s+=`features blog posts, articles, or news content related to ${e.name}.`:s+=`provides relevant information and content related to ${t.title.toLowerCase()} for ${e.name}.`}return s}async function XM(t,e,n,r,s,a){const i=[];if(n){const l=n.split(`
`).filter(u=>u.trim().length>0).slice(0,5).join(" ");l.length>0&&i.push(`Project Description: ${l.substring(0,500)}`)}if(r&&(r.description&&i.push(`Package Description: ${r.description}`),r.name&&i.push(`Project Name: ${r.name}`),r.scripts)){const o=Object.keys(r.scripts).join(", ");i.push(`Available Scripts: ${o}`)}if(s&&s.pages){const o=s.pages.map(u=>u.title).join(", ");i.push(`Pages: ${o}`);const l=[];if(s.pages.forEach(u=>{u.sections&&Array.isArray(u.sections)&&u.sections.forEach(d=>{d.type&&l.push(d.type)})}),l.length>0){const u=[...new Set(l)];i.push(`Site Features: ${u.join(", ")} sections`)}}try{const o="You are a technical documentation expert. Analyze the provided information about a website or web application and write a clear, comprehensive explanation of what the site does, its purpose, and its main features. Write in a professional but accessible tone.",l=`Based on the following information about the website "${t}" (${e}/${t}), write a comprehensive explanation of what this site does:

${i.join(`

`)}

Please provide:
1. A clear explanation of the site's purpose and what it does
2. The main features and functionality
3. Who the target audience might be
4. What users can accomplish with this site

Write 2-4 paragraphs that clearly explain what this site does.`;return await Hs(l,o,"gpt-4o-mini",.7)}catch{return eF(t,e,i,a)}}function eF(t,e,n,r){let s=`## What This Site Does

`;if(s+=`The **${t}** website is a web application developed by ${e}. `,r&&r.length>0){const a=r.map(i=>i.title.toLowerCase());a.some(i=>i.includes("home")||i.includes("landing"))&&(s+="This site serves as a digital presence with a landing page that introduces visitors to the project. "),a.some(i=>i.includes("about"))&&(s+="It includes an About page that provides information about the organization or project. "),a.some(i=>i.includes("contact"))&&(s+="Visitors can get in touch through a dedicated Contact page. "),a.some(i=>i.includes("service")||i.includes("feature"))&&(s+="The site showcases services or features offered by the project. "),a.some(i=>i.includes("product")||i.includes("shop")||i.includes("store"))&&(s+="It includes e-commerce functionality with product listings and shopping capabilities. "),a.some(i=>i.includes("blog")||i.includes("article"))&&(s+="The site features a blog or article section for content publishing. "),a.some(i=>i.includes("portfolio")||i.includes("gallery"))&&(s+="It displays a portfolio or gallery showcasing work, projects, or visual content. "),a.some(i=>i.includes("pricing")||i.includes("plan"))&&(s+="Pricing information and plans are available for users to review. "),a.some(i=>i.includes("dashboard"))&&(s+="The site includes a dashboard with analytics, data visualization, and user management features. "),s+=`

`,s+=`**Main Pages:** The site consists of ${r.length} main page${r.length!==1?"s":""}: ${r.map(i=>i.title).join(", ")}. `,s+="Each page serves a specific purpose in providing information and functionality to visitors."}else s+="Based on the repository structure, this appears to be a web application with various features and functionality. ",s+="The site likely provides information, services, or tools related to the project's purpose.";if(n.length>0){s+=`

**Technical Details:** `;const a=n.filter(i=>!i.includes("Pages:")&&!i.includes("Site Features:"));a.length>0&&(s+=a.join(". ")+".")}return s}async function eN(t,e={}){var w,_,y;const n=dd(t);if(!n)throw new Error("Invalid GitHub URL. Please use format: https://github.com/owner/repo or owner/repo");const{owner:r,repo:s,branch:a="main"}=n,i=xt();let o="";o=`# Documentation for ${r}/${s}

`,o+=`**Repository:** ${r}/${s}  
`,o+=`**Branch:** ${a}  
`,o+=`**Generated:** ${new Date().toISOString()}

`,o+=`---

`;let l=null;try{l=await ra(r,s,"README.md",a,i||void 0)}catch{}l&&(o+=`## Project Overview

`,o+=`${l}

`,o+=`---

`);let u=null;try{const p=await ra(r,s,"package.json",a,i||void 0);if(p){if(u=JSON.parse(p),o+=`## Project Configuration

`,o+=`**Name:** ${u.name||s}

`,u.description&&(o+=`**Description:** ${u.description}

`),u.version&&(o+=`**Version:** ${u.version}

`),u.scripts&&(o+=`**Available Scripts:**

`,Object.entries(u.scripts).forEach(([g,S])=>{o+=`- \`${g}\`: ${S}
`}),o+=`
`),u.dependencies){const g=Object.keys(u.dependencies).length;o+=`**Dependencies:** ${g} packages

`}o+=`---

`}}catch{}const d=["project.json","export/project.json","src/project.json"];let h=null;for(const p of d)try{const g=await ra(r,s,p,a,i||void 0);if(g)try{h=JSON.parse(g);break}catch{}}catch{}let f="",m=null,v=null;h&&(m={id:"",user_id:"",name:h.name||s,description:h.description||"",theme:h.theme||{primary:"#3b82f6",secondary:"#8b5cf6",background:"#ffffff",text:"#1f2937",fontFamily:"Inter, sans-serif"},pages:((w=h.pages)==null?void 0:w.map(p=>({id:p.id||"",project_id:"",path:p.path,title:p.title,order:p.order||0,sections:p.sections||[]})))||[]},v=m.pages||[]);try{f=await XM(s,r,l,u,h,v),o+=`## What This Site Does

`,o+=`${f}

`,o+=`---

`}catch(p){console.warn("Could not generate AI explanation:",p.message)}if(h){o+=`## Site Structure

`,o+=`This project contains ${((_=h.pages)==null?void 0:_.length)||0} page${((y=h.pages)==null?void 0:y.length)!==1?"s":""}:

`;for(const p of m.pages.sort((g,S)=>g.order-S.order)){const g=await QM(p,m,e);o+=`${g}

`}}else{o+=`## Site Structure Analysis

`;try{const p=["app","pages","src/pages","src/app","components","src/components"],g=[],S=[];for(const T of p)try{const A=await Ft(r,s,T,a,i||void 0);for(const x of A)if(x.type==="file"&&(x.name.endsWith(".tsx")||x.name.endsWith(".jsx")||x.name.endsWith(".ts")||x.name.endsWith(".js")))T.includes("page")||x.name.includes("page")||x.path.includes("/page")?g.push(x.path):T.includes("component")&&S.push(x.path);else if(x.type==="dir")try{const j=await Ft(r,s,x.path,a,i||void 0);for(const R of j)R.type==="file"&&(R.name.endsWith(".tsx")||R.name.endsWith(".jsx"))&&(R.path.includes("page")||R.name==="page.tsx"||R.name==="page.jsx"?g.push(R.path):S.push(R.path))}catch{}}catch{}if(g.length>0&&(o+=`### Pages Found (${g.length})

`,g.forEach(T=>{o+=`- **${T}**
`}),o+=`
`),S.length>0){o+=`### Components Found (${S.length})

`;const T={};S.forEach(A=>{const x=A.split("/").slice(0,-1).join("/")||"root";T[x]||(T[x]=[]),T[x].push(A.split("/").pop()||A)}),Object.entries(T).forEach(([A,x])=>{o+=`**${A||"root"}:**
`,x.forEach(j=>{o+=`- ${j}
`}),o+=`
`})}const N=["next.config.js","next.config.ts","tailwind.config.js","tailwind.config.ts","tsconfig.json"];o+=`### Configuration Files

`;for(const T of N)try{await ra(r,s,T,a,i||void 0)&&(o+=`**${T}** - Found and analyzed

`)}catch{}}catch(p){o+=`Unable to analyze repository structure: ${p.message}

`,o+=`This may be due to:
`,o+=`- Repository is private (requires GitHub token)
`,o+=`- Rate limiting (try again later or use a GitHub token)
`,o+=`- Invalid repository URL

`}}try{const p=await Ft(r,s,"",a,i||void 0);p.length>0&&(o+=`## Repository Structure

`,o+=`**Root Directory Contents:**

`,p.slice(0,20).forEach(g=>{const S=g.type==="dir"?"":"";o+=`${S} ${g.name}
`}),p.length>20&&(o+=`
... and ${p.length-20} more items
`),o+=`
`)}catch{}return o}function tF(t,e="documentation.md"){const n=new Blob([t],{type:"text/markdown"}),r=URL.createObjectURL(n),s=document.createElement("a");s.href=r,s.download=e,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(r)}async function nF(t,e,n,r,s={},a){switch(e){case"markdown":return rF(n,r);case"markdown_mermaid":return await sF(n,r,t,a);case"mdx":return await iF(n,r);case"openapi":return await oF(n,r,t,a);case"html":return lF(n,r);default:return r}}function rF(t,e){return`${Jd(t)}

${e}`}async function sF(t,e,n,r){var i,o,l,u,d;const s=Jd(t);let a="";try{const h=dd(n);if(h){const{owner:f,repo:m,branch:v="main"}=h,w=xt();let _="";try{_=`Repository structure: ${(await Ft(f,m,"",v,w||void 0)).filter(A=>A.type==="dir").map(A=>A.name).slice(0,10).join(", ")}`}catch{}const y=r?`Tech Stack: ${((i=r.techStack)==null?void 0:i.join(", "))||"Unknown"}
Frameworks: ${((l=(o=r.structure)==null?void 0:o.frameworks)==null?void 0:l.join(", "))||"Unknown"}
Languages: ${((d=(u=r.structure)==null?void 0:u.languages)==null?void 0:d.join(", "))||"Unknown"}`:"",p=`Based on this repository documentation and structure, generate a detailed Mermaid diagram for a ${t} section.

${y}
${_}

Repository Documentation:
${e.substring(0,2e3)}

Generate a Mermaid diagram that accurately represents:
${t==="ARCHITECTURE"?"The system architecture, component relationships, and data flow":t==="API"?"API endpoints, request/response flow, and data models":t==="COMPONENTS"?"Component hierarchy, props flow, and component relationships":"The structure and relationships"}

Return ONLY the Mermaid diagram code (without markdown code fences). Make it detailed and accurate based on the repository structure.`;a=`
\`\`\`mermaid
${(await Hs(p,"You are an expert at creating Mermaid diagrams for software documentation. Generate accurate, detailed diagrams based on repository structure.","gpt-4o-mini",.4)).replace(/```mermaid\n?/g,"").replace(/```\n?/g,"").trim()}
\`\`\`

`}}catch(h){console.warn("[FormatGenerator] Failed to generate Mermaid diagram, using fallback:",h),a=aF(t)}return`${s}

${a}${e}`}function aF(t){switch(t){case"ARCHITECTURE":return`
\`\`\`mermaid
graph TB
    A[Application] --> B[Components]
    A --> C[Services]
    A --> D[Utilities]
    B --> E[UI Components]
    C --> F[API Layer]
    D --> G[Helpers]
\`\`\`

`;case"API":return`
\`\`\`mermaid
sequenceDiagram
    participant Client
    participant API
    participant Database
    
    Client->>API: Request
    API->>Database: Query
    Database-->>API: Response
    API-->>Client: Result
\`\`\`

`;case"COMPONENTS":return`
\`\`\`mermaid
graph LR
    A[Component] --> B[Props]
    A --> C[State]
    A --> D[Methods]
    B --> E[Inputs]
    C --> F[Data]
\`\`\`

`;default:return""}}async function iF(t,e,n,r){const s=Jd(t),a=`import { CodeBlock, Callout, Tabs, TabItem, Card, Grid } from '@mdx/components';
import { Info, Warning, CheckCircle, AlertCircle } from 'lucide-react';

export const meta = {
  title: '${Yd(t)}',
  description: '${t} documentation',
};

`;let i=e;return i=i.replace(/```(\w+)?\n([\s\S]*?)```/g,(o,l,u)=>`<CodeBlock language="${l||"text"}" showLineNumbers>
${u.trim()}
</CodeBlock>`),i=i.replace(/^> (.+)$/gm,(o,l)=>`<Callout type="info">
${l.trim()}
</Callout>`),(t==="API"||t==="COMPONENTS")&&(i=`
<Tabs>
  <TabItem label="Overview" value="overview">
${i.split(`
`).slice(0,20).join(`
`)}
  </TabItem>
  <TabItem label="Examples" value="examples">
    <Card>
      <h3>Usage Examples</h3>
      <p>See the code examples below for practical usage.</p>
    </Card>
  </TabItem>
  <TabItem label="Reference" value="reference">
${i}
  </TabItem>
</Tabs>

`),t==="COMPONENTS"&&(i=`<Grid cols={2}>
  <Card>
    <h3>Component Overview</h3>
    ${i.substring(0,500)}
  </Card>
  <Card>
    <h3>Props & Usage</h3>
    ${i.substring(500)}
  </Card>
</Grid>`),`${a}${s}

${i}`}async function oF(t,e,n,r){var d,h,f;if(t!=="API")return`# ${Yd(t)}

This section does not contain API documentation.`;const s=dd(n);if(!s)return`# API Reference

Invalid repository URL.`;const{owner:a,repo:i,branch:o="main"}=s,l=xt();let u=[];try{const m=await Ft(a,i,"",o,l||void 0),v=["api","routes","endpoints","controllers","handlers"];for(const w of m)if(w.type==="dir"&&v.some(_=>w.name.toLowerCase().includes(_)))try{const _=await Ft(a,i,w.path,o,l||void 0);u.push(..._.filter(y=>y.type==="file"&&(y.name.endsWith(".ts")||y.name.endsWith(".js"))).map(y=>y.path))}catch{}}catch{}try{const m=u.length>0?`

Found potential API files: ${u.slice(0,5).join(", ")}`:"",v=r?`
Tech Stack: ${((d=r.techStack)==null?void 0:d.join(", "))||"Unknown"}
Frameworks: ${((f=(h=r.structure)==null?void 0:h.frameworks)==null?void 0:f.join(", "))||"Unknown"}`:"",w=`Analyze this repository documentation and generate a complete OpenAPI 3.0 specification.

Repository: ${a}/${i}
${v}
${m}

Documentation:
${e.substring(0,3e3)}

Generate a complete OpenAPI 3.0 YAML specification with:
- Info section with proper title, version, and description
- Servers array (infer from documentation or use common patterns)
- Paths section with actual endpoints extracted from the documentation
- Request/response schemas
- Parameters, request bodies, and responses
- Proper HTTP methods (GET, POST, PUT, DELETE, etc.)

Return ONLY valid OpenAPI 3.0 YAML. Be specific and detailed. Include at least 3-5 endpoints if possible.`;let y=(await Hs(w,"You are an expert at creating OpenAPI specifications. Generate complete, valid OpenAPI 3.0 YAML with detailed endpoints, schemas, and examples.","gpt-4o-mini",.5)).replace(/```yaml\n?/g,"").replace(/```\n?/g,"").trim();return y.startsWith("openapi:")||(y=`openapi: 3.0.0
${y}`),y}catch(m){return console.warn("[FormatGenerator] Failed to generate OpenAPI spec:",m),`openapi: 3.0.0
info:
  title: ${i} API
  version: 1.0.0
  description: Auto-generated API documentation for ${a}/${i}
servers:
  - url: https://api.example.com
    description: Production server
  - url: https://api-staging.example.com
    description: Staging server
paths:
  /api/v1/health:
    get:
      summary: Health check endpoint
      responses:
        '200':
          description: Service is healthy
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "ok"
components:
  schemas:
    Error:
      type: object
      properties:
        message:
          type: string
        code:
          type: integer
`}}function lF(t,e){const n=Jd(t);return`
<style>
.doc-html-content * { 
    margin: 0; 
    padding: 0; 
    box-sizing: border-box; 
}
.doc-html-content {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif; 
    line-height: 1.8; 
    color: #1a1a1a;
    background: white;
    border-radius: 16px;
    overflow: hidden;
}
.doc-html-content .header {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 40px;
    text-align: center;
    margin: -40px -40px 40px -40px;
}
.doc-html-content .header h1 {
    font-size: 2.5em;
    margin-bottom: 10px;
    font-weight: 700;
}
.doc-html-content .header p {
    opacity: 0.9;
    font-size: 1.1em;
}
.doc-html-content .content {
    padding: 0;
}
.doc-html-content h1 { 
    color: #667eea; 
    font-size: 2em;
    margin: 30px 0 20px 0;
    border-bottom: 3px solid #667eea;
    padding-bottom: 10px;
}
.doc-html-content h2 { 
    color: #764ba2; 
    font-size: 1.6em;
    margin: 25px 0 15px 0;
}
.doc-html-content h3 { 
    color: #555; 
    font-size: 1.3em;
    margin: 20px 0 10px 0;
}
.doc-html-content p {
    margin: 15px 0;
    color: #333;
}
.doc-html-content code { 
    background: #f4f4f4; 
    padding: 3px 8px; 
    border-radius: 4px; 
    font-family: 'Monaco', 'Courier New', monospace;
    font-size: 0.9em;
    color: #e83e8c;
}
.doc-html-content pre { 
    background: #1e1e1e; 
    color: #d4d4d4;
    padding: 20px; 
    border-radius: 8px; 
    overflow-x: auto;
    margin: 20px 0;
    border-left: 4px solid #667eea;
}
.doc-html-content pre code {
    background: transparent;
    color: #d4d4d4;
    padding: 0;
}
.doc-html-content blockquote { 
    border-left: 4px solid #667eea; 
    padding-left: 20px; 
    margin-left: 0;
    margin: 20px 0;
    padding: 15px 20px;
    background: #f8f9fa;
    border-radius: 4px;
    font-style: italic;
}
.doc-html-content ul, 
.doc-html-content ol {
    margin: 15px 0;
    padding-left: 30px;
}
.doc-html-content li {
    margin: 8px 0;
}
.doc-html-content a {
    color: #667eea;
    text-decoration: none;
    border-bottom: 1px solid transparent;
    transition: border-color 0.3s;
}
.doc-html-content a:hover {
    border-bottom-color: #667eea;
}
.doc-html-content .footer {
    background: #f8f9fa;
    padding: 20px 40px;
    text-align: center;
    color: #666;
    font-size: 0.9em;
    margin: 40px -40px -40px -40px;
}
.doc-html-content table {
    width: 100%;
    border-collapse: collapse;
    margin: 20px 0;
}
.doc-html-content th, 
.doc-html-content td {
    padding: 12px;
    text-align: left;
    border-bottom: 1px solid #ddd;
}
.doc-html-content th {
    background: #667eea;
    color: white;
    font-weight: 600;
}
.doc-html-content tr:hover {
    background: #f8f9fa;
}
</style>
<div class="doc-html-content">
    <div class="header">
        <h1>${Yd(t)}</h1>
        <p>Comprehensive Documentation</p>
    </div>
    <div class="content">
        ${cF(`${n}

${e}`)}
    </div>
    <div class="footer">
        <p>Generated on ${new Date().toLocaleDateString()}  Auto-generated documentation</p>
    </div>
</div>`}function cF(t){let e=t;return e=e.replace(/^#### (.*$)/gim,"<h4>$1</h4>"),e=e.replace(/^### (.*$)/gim,"<h3>$1</h3>"),e=e.replace(/^## (.*$)/gim,"<h2>$1</h2>"),e=e.replace(/^# (.*$)/gim,"<h1>$1</h1>"),e=e.replace(/```(\w+)?\n([\s\S]*?)```/gim,(r,s,a)=>`<pre><code class="language-${s||"text"}">${uF(a.trim())}</code></pre>`),e=e.replace(/`([^`]+)`/gim,"<code>$1</code>"),e=e.replace(/\*\*\*(.*?)\*\*\*/gim,"<strong><em>$1</em></strong>"),e=e.replace(/\*\*(.*?)\*\*/gim,"<strong>$1</strong>"),e=e.replace(/\*(.*?)\*/gim,"<em>$1</em>"),e=e.replace(/\[([^\]]+)\]\(([^)]+)\)/gim,'<a href="$2" target="_blank" rel="noopener">$1</a>'),e=e.replace(/^> (.+)$/gim,"<blockquote>$1</blockquote>"),e=e.replace(/^\- (.+)$/gim,"<li>$1</li>"),e=e.replace(/^(\d+)\. (.+)$/gim,"<li>$2</li>"),e=e.replace(/^---$/gim,"<hr>"),e=e.split(/\n\n+/).map(r=>(r=r.trim(),r?r.startsWith("<")&&(r.startsWith("<h")||r.startsWith("<pre")||r.startsWith("<ul")||r.startsWith("<ol")||r.startsWith("<blockquote"))?r:`<p>${r}</p>`:"")).join(`

`),e=e.replace(/(<li>.*<\/li>\n?)+/g,r=>`<ul>${r}</ul>`),e}function uF(t){const e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return t.replace(/[&<>"']/g,n=>e[n])}function Jd(t){return`# ${Yd(t)}`}function Yd(t){switch(t){case"README":return"README";case"ARCHITECTURE":return"Architecture";case"API":return"API Reference";case"COMPONENTS":return"Components";case"TESTING_CI":return"Testing & CI/CD";case"CHANGELOG":return"Changelog";default:return"Documentation"}}async function dF(t){var u;console.log("[DocsWriter] Starting documentation generation...");const e={currentStep:Z.WRITING,generatedDocs:new Map};if(!t.documentationPlans||t.documentationPlans.size===0)return e.errors=new Map([["writing","No documentation plans available"]]),e;const n=t.selectedOutputFormats||["markdown"],r=t.selectedSectionTypes||["README"],s=t.selectedLanguage||"en",a=new Map,i=new Map;let o=0;const l=t.documentationPlans.size;for(const[d,h]of t.documentationPlans.entries())try{o++,e.progress={current:o,total:l,currentRepo:d,currentAgent:"DocsWriter"},console.log(`[DocsWriter] Generating docs for ${d} (${o}/${l})`),console.log(`[DocsWriter] Formats: ${n.join(", ")}, Sections: ${r.join(", ")}`);const f=h.repo.htmlUrl||`${h.repo.owner}/${h.repo.name}`,m=await eN(f,{format:"markdown",includeCode:!0,includeProps:!0,includeExamples:!0,depth:h.style==="comprehensive"?"comprehensive":h.style==="technical"?"detailed":"basic"}),v=[],w=(u=t.repoAnalyses)==null?void 0:u.get(d);for(const p of r){const g=await fF(p,f,m,w,h,s);for(const S of n)try{const N=await nF(f,S,p,g,{includeCode:!0,includeProps:!0,includeExamples:!0,depth:h.style==="comprehensive"?"comprehensive":"detailed"},w),T={id:`${p}_${S}_${Date.now()}`,type:p,format:S,title:`${hF(p)} (${S})`};S==="openapi"?T.openapiYaml=N:S==="html"?T.html=N:T.markdown=N,v.push(T)}catch(N){console.error(`[DocsWriter] Error generating ${S} for ${p}:`,N)}}const _={repoName:h.repo.name,owner:h.repo.owner,sections:v,createdAt:new Date().toISOString()};i.set(d,_);const y=v.find(p=>p.markdown);if(y!=null&&y.markdown)a.set(d,y.markdown);else if(v.length>0){const p=v[0],g=p.markdown||p.html||p.openapiYaml||"";a.set(d,g)}}catch(f){console.error(`[DocsWriter] Error generating docs for ${d}:`,f);const m=`writing_${d}`;e.errors||(e.errors=new Map),e.errors.set(m,f.message||"Documentation generation failed")}return e.generatedDocs=a,e.generatedDocsFull=i,e.completedSteps=new Set([...t.completedSteps||[],Z.WRITING]),e.progress={current:l,total:l,currentAgent:"DocsWriter"},console.log(`[DocsWriter] Completed generation for ${a.size} repositories`),e}function hF(t){switch(t){case"README":return"README";case"ARCHITECTURE":return"Architecture";case"API":return"API Reference";case"COMPONENTS":return"Components";case"TESTING_CI":return"Testing & CI/CD";case"CHANGELOG":return"Changelog";default:return"Documentation"}}async function fF(t,e,n,r,s,a="en"){var h,f,m,v,w,_;s.repo.name;const i=`${s.repo.owner}/${s.repo.name}`,o=r?`
Repository Analysis:
- Summary: ${r.summary}
- Key Features: ${r.keyFeatures.join(", ")}
- Tech Stack: ${r.techStack.join(", ")}
- Frameworks: ${((f=(h=r.structure)==null?void 0:h.frameworks)==null?void 0:f.join(", "))||"Unknown"}
- Languages: ${((v=(m=r.structure)==null?void 0:m.languages)==null?void 0:v.join(", "))||"Unknown"}
- Complexity: ${r.complexity}
- Main Files: ${((_=(w=r.structure)==null?void 0:w.mainFiles)==null?void 0:_.slice(0,10).join(", "))||"Unknown"}
`:"",l={en:"English",fr:"French",de:"German",it:"Italian",es:"Spanish"},u=a!=="en"?`

IMPORTANT: Generate all content in ${l[a]}. All text, descriptions, and explanations must be in ${l[a]}.`:"";let d="";switch(t){case"README":d=`Generate a comprehensive README.md for the repository "${i}".
${u}

${o}

Base Documentation:
${n.substring(0,2e3)}

Create a README that includes:
1. **Project Title and Description** - Clear, concise overview
2. **Features** - Key capabilities and highlights
3. **Installation/Setup** - Step-by-step setup instructions
4. **Usage** - How to use the project with examples
5. **Configuration** - Any configuration needed
6. **Contributing** - Guidelines for contributors
7. **License** - License information if available

Make it welcoming, clear, and comprehensive. Focus on helping new users understand and use the project.`;break;case"ARCHITECTURE":d=`Generate an Architecture documentation section for "${i}".
${u}

${o}

Base Documentation:
${n.substring(0,2e3)}

Create an Architecture document that includes:
1. **System Overview** - High-level architecture description
2. **Component Structure** - Breakdown of major components/modules
3. **Data Flow** - How data moves through the system
4. **Technology Stack** - Detailed tech stack explanation
5. **Directory Structure** - Key directories and their purposes
6. **Design Patterns** - Patterns and principles used
7. **Dependencies** - Key dependencies and their roles

Focus on technical depth, diagrams descriptions, and system design.`;break;case"API":d=`Generate an API Reference documentation for "${i}".
${u}

${o}

Base Documentation:
${n.substring(0,2e3)}

Create an API Reference that includes:
1. **API Overview** - Introduction to the API
2. **Authentication** - How to authenticate (if applicable)
3. **Base URL** - API endpoint base URL
4. **Endpoints** - Detailed endpoint documentation with:
   - HTTP Method (GET, POST, PUT, DELETE, etc.)
   - Endpoint path
   - Request parameters
   - Request body schema
   - Response schema
   - Example requests/responses
5. **Error Handling** - Error codes and messages
6. **Rate Limiting** - Rate limits if applicable

Focus on practical API usage with code examples.`;break;case"COMPONENTS":d=`Generate a Components documentation section for "${i}".
${u}

${o}

Base Documentation:
${n.substring(0,2e3)}

Create a Components document that includes:
1. **Component Overview** - Introduction to the component system
2. **Component List** - List of major components/modules
3. **Component Details** - For each component:
   - Purpose and responsibility
   - Props/Parameters
   - Usage examples
   - Dependencies
4. **Component Hierarchy** - How components relate to each other
5. **Props/Configuration** - Detailed prop/parameter documentation

Focus on reusability, props, and usage patterns.`;break;case"TESTING_CI":d=`Generate a Testing & CI/CD documentation section for "${i}".
${u}

${o}

Base Documentation:
${n.substring(0,2e3)}

Create a Testing & CI/CD document that includes:
1. **Testing Strategy** - Overview of testing approach
2. **Test Setup** - How to set up and run tests
3. **Test Types** - Unit tests, integration tests, e2e tests
4. **CI/CD Pipeline** - Continuous integration/deployment setup
5. **Running Tests** - Commands and instructions
6. **Coverage** - Test coverage information
7. **Deployment** - Deployment process and environments

Focus on practical testing and deployment workflows.`;break;case"CHANGELOG":d=`Generate a Changelog documentation for "${i}".
${u}

${o}

Base Documentation:
${n.substring(0,2e3)}

Create a Changelog that includes:
1. **Version History** - List of versions with dates
2. **Change Categories** - Added, Changed, Deprecated, Removed, Fixed, Security
3. **Recent Changes** - Most recent version changes in detail
4. **Migration Guides** - Breaking changes and migration steps
5. **Release Notes** - Summary of major releases

Format it as a standard changelog with version numbers and dates.`;break;default:return n}try{const y=a!=="en"?`You are an expert technical writer. Generate comprehensive, accurate ${t} documentation in ${l[a]} based on the repository information provided. Be specific, include examples, and make it practical for developers. All content must be in ${l[a]}.`:`You are an expert technical writer. Generate comprehensive, accurate ${t} documentation based on the repository information provided. Be specific, include examples, and make it practical for developers.`;return await Hs(d,y,"gpt-4o-mini",.5)}catch{return console.warn(`[DocsWriter] Failed to generate section-specific content for ${t}, using base markdown`),n}}async function mF(t){var h,f;console.log("[GitOps] Starting Git operations...");const e={currentStep:Z.GITOPS,commitResults:new Map};if(!t.generatedDocs||t.generatedDocs.size===0)return e.errors=new Map([["gitops","No generated documentation to commit"]]),e;const n=xt();if(!n)return e.errors=new Map([["gitops","GitHub token required for commits"]]),e;const r=t.options||{},s=r.commitMessage||"docs: Add auto-generated documentation",a=r.branch||"main";if(!(r.autoCommit!==!1))return console.log("[GitOps] Auto-commit disabled, skipping Git operations"),e.completedSteps=new Set([...t.completedSteps||[],Z.GITOPS]),e;const o=new Map;let l=0;const u=t.generatedDocs.size;for(const[m,v]of t.generatedDocs.entries())try{l++,e.progress={current:l,total:u,currentRepo:m,currentAgent:"GitOps"},console.log(`[GitOps] Committing docs to ${m} (${l}/${u})`);const w=(h=t.discoveredRepos)==null?void 0:h.find(g=>g.fullName===m);if(!w)throw new Error("Repository not found");const[_,y]=m.split("/"),p=await cm(_,y,"DOCUMENTATION.md",v,s,a,n);o.set(m,{repo:w,success:!0,commitSha:p.commit.sha,commitUrl:p.commit.html_url}),console.log(`[GitOps] Successfully committed to ${m}: ${p.commit.html_url}`)}catch(w){console.error(`[GitOps] Error committing to ${m}:`,w);const _=(f=t.discoveredRepos)==null?void 0:f.find(y=>y.fullName===m);o.set(m,{repo:_,success:!1,error:w.message||"Commit failed"})}e.commitResults=o,e.completedSteps=new Set([...t.completedSteps||[],Z.GITOPS]),e.progress={current:u,total:u,currentAgent:"GitOps"};const d=Array.from(o.values()).filter(m=>m.success).length;return console.log(`[GitOps] Completed: ${d}/${u} successful commits`),e}const pF=[{from:Z.DISCOVERY,to:Z.ANALYSIS},{from:Z.ANALYSIS,to:Z.QUALITY},{from:Z.QUALITY,to:Z.REFACTOR},{from:Z.REFACTOR,to:Z.PLANNING},{from:Z.PLANNING,to:Z.WRITING},{from:Z.WRITING,to:Z.GITOPS},{from:Z.GITOPS,to:Z.COMPLETE}],gF=new Map([[Z.DISCOVERY,{name:"RepoDiscovery",execute:yC,shouldRun:t=>{var r,s;const e=((r=t.completedSteps)==null?void 0:r.has(Z.DISCOVERY))||!1,n=t.selectedRepos&&t.selectedRepos.length>0;return console.log("[Manager] DISCOVERY shouldRun check:",{hasCompleted:e,hasRepos:n,selectedReposCount:((s=t.selectedRepos)==null?void 0:s.length)||0}),!e&&n}}],[Z.ANALYSIS,{name:"RepoAnalysis",execute:OM,shouldRun:t=>{var e,n;return((e=t.completedSteps)==null?void 0:e.has(Z.DISCOVERY))&&!((n=t.completedSteps)!=null&&n.has(Z.ANALYSIS))&&!!t.discoveredRepos&&t.discoveredRepos.length>0}}],[Z.QUALITY,{name:"QualityAnalyzer",execute:VM,shouldRun:t=>{var e,n;return((e=t.completedSteps)==null?void 0:e.has(Z.ANALYSIS))&&!((n=t.completedSteps)!=null&&n.has(Z.QUALITY))&&!!t.repoAnalyses&&t.repoAnalyses.size>0}}],[Z.REFACTOR,{name:"RefactorProposal",execute:JM,shouldRun:t=>{var e,n;return((e=t.completedSteps)==null?void 0:e.has(Z.QUALITY))&&!((n=t.completedSteps)!=null&&n.has(Z.REFACTOR))&&!!t.repoAnalyses&&t.repoAnalyses.size>0}}],[Z.PLANNING,{name:"DocsPlanner",execute:YM,shouldRun:t=>{var e,n;return((e=t.completedSteps)==null?void 0:e.has(Z.REFACTOR))&&!((n=t.completedSteps)!=null&&n.has(Z.PLANNING))&&!!t.repoAnalyses&&t.repoAnalyses.size>0}}],[Z.WRITING,{name:"DocsWriter",execute:dF,shouldRun:t=>{var e,n;return((e=t.completedSteps)==null?void 0:e.has(Z.PLANNING))&&!((n=t.completedSteps)!=null&&n.has(Z.WRITING))&&!!t.documentationPlans&&t.documentationPlans.size>0}}],[Z.GITOPS,{name:"GitOps",execute:mF,shouldRun:t=>{var e,n;return((e=t.completedSteps)==null?void 0:e.has(Z.WRITING))&&!((n=t.completedSteps)!=null&&n.has(Z.GITOPS))&&!!t.generatedDocs&&t.generatedDocs.size>0}}]]);function yF(t,e){const n=pF.find(r=>r.from===t);return!n||n.condition&&!n.condition(e)?null:n.to}class vF{constructor(e,n,r){this.state={...e},this.onStateUpdate=n,this.onProgress=r}updateState(e){this.state={...this.state,...e,completedSteps:new Set([...this.state.completedSteps||[],...e.completedSteps||[]]),errors:new Map([...this.state.errors||[],...e.errors||[]])},this.onStateUpdate&&this.onStateUpdate(this.state),this.onProgress&&e.progress&&this.onProgress(e.progress)}async executeStep(e){const n=gF.get(e);if(!n)throw new Error(`No agent node found for step: ${e}`);if(n.shouldRun&&!n.shouldRun(this.state))return console.log(`[Manager] Skipping ${n.name} - conditions not met`),console.log("[Manager] State check:",{completedSteps:Array.from(this.state.completedSteps||[]),hasDiscoveredRepos:!!this.state.discoveredRepos&&this.state.discoveredRepos.length>0,hasRepoAnalyses:!!this.state.repoAnalyses&&this.state.repoAnalyses.size>0}),!1;console.log(`[Manager] Executing ${n.name}...`);const r=await n.execute(this.state);return this.updateState(r),!0}async run(){var a,i;console.log("[Manager] Starting agent workflow..."),console.log("[Manager] Initial state:",{selectedRepos:((a=this.state.selectedRepos)==null?void 0:a.length)||0,completedSteps:Array.from(this.state.completedSteps||[])}),this.updateState({currentStep:Z.DISCOVERY});let e=Z.DISCOVERY,n=null,r=0;const s=20;for(;e&&e!==Z.COMPLETE&&r<s;)try{r++,n=e,console.log(`[Manager] === Iteration ${r}: Executing step ${e} ===`),console.log("[Manager] State before step:",{completedSteps:Array.from(this.state.completedSteps||[]),hasDiscoveredRepos:!!this.state.discoveredRepos&&this.state.discoveredRepos.length>0,hasRepoAnalyses:!!this.state.repoAnalyses&&this.state.repoAnalyses.size>0});const o=await this.executeStep(e);console.log(`[Manager] Step ${e} executed: ${o}`),console.log("[Manager] State after step:",{completedSteps:Array.from(this.state.completedSteps||[]),hasDiscoveredRepos:!!this.state.discoveredRepos&&this.state.discoveredRepos.length>0,hasRepoAnalyses:!!this.state.repoAnalyses&&this.state.repoAnalyses.size>0});const l=yF(e,this.state);if(console.log(`[Manager] Next step from ${e}:`,l),o&&l){if(l===e){console.warn(`[Manager] Workflow stuck at ${e}, breaking`);break}e=l,this.updateState({currentStep:e})}else if(o){console.log(`[Manager] No next step from ${e}, completing workflow`);break}else{if(console.error(`[Manager] Step ${e} was skipped! This may indicate a problem.`),console.error("[Manager] Current state:",{completedSteps:Array.from(this.state.completedSteps||[]),selectedRepos:((i=this.state.selectedRepos)==null?void 0:i.length)||0}),e===Z.DISCOVERY)throw new Error("DISCOVERY step was skipped - this should never happen on first run. Check that selectedRepos are provided.");if(l&&l!==e)console.log(`[Manager] Attempting to continue to ${l} despite skip`),e=l,this.updateState({currentStep:e});else{console.warn(`[Manager] Cannot proceed from ${e}, breaking`);break}}}catch(o){console.error(`[Manager] Error in step ${e}:`,o);const l=`manager_${e}`;this.updateState({errors:new Map([[l,o.message||"Workflow error"]])});break}return r>=s&&(console.error("[Manager] Workflow exceeded max iterations, stopping"),this.updateState({errors:new Map([["manager","Workflow exceeded maximum iterations"]])})),this.updateState({currentStep:Z.COMPLETE,completedSteps:new Set([...this.state.completedSteps||[],Z.COMPLETE])}),console.log("[Manager] Workflow completed"),this.state}getState(){return{...this.state}}reset(e){this.state={...this.state,...e,currentStep:void 0,completedSteps:new Set,errors:new Map}}}function _F({selectedRepos:t,selectedOutputFormats:e=["markdown"],selectedSectionTypes:n=["README"],selectedLanguage:r="en",onReposChange:s,onComplete:a}){const[i,o]=V.useState(!1),[l,u]=V.useState(null),[d,h]=V.useState(""),[f,m]=V.useState(!1),[v,w]=V.useState(null),[_]=V.useState(()=>localStorage.getItem("selectedLanguage")||r),y=xa(_),p=async()=>{if(t.length===0){h(y("pleaseSelectAtLeastOneRepository"));return}h(""),o(!0),h(""),u(null);const x={selectedRepos:t,selectedOutputFormats:e,selectedSectionTypes:n,selectedLanguage:_,options:{commitMessage:"docs: Add auto-generated documentation",branch:"main",autoCommit:!1},completedSteps:new Set};try{const j=new vF(x,D=>{u(D)},D=>{});w(j);const R=await j.run();u(R),a(R)}catch(j){h(j.message||"Workflow failed"),console.error("Agent workflow error:",j)}finally{o(!1)}},g=async()=>{if(!l||!v){h(y("noWorkflowState"));return}if(!l.generatedDocs||l.generatedDocs.size===0){h(y("noDocumentationToCommit"));return}m(!0),h("");try{const x={...l,options:{...l.options,autoCommit:!0}};v.reset(x),await v.executeStep(Z.GITOPS);const j=v.getState();u(j),a(j)}catch(x){h(x.message||y("commitFailed")),console.error("Commit error:",x)}finally{m(!1)}},S=x=>{var j,R;return l?l.currentStep===x?"running":(j=l.completedSteps)!=null&&j.has(x)?"completed":(R=l.errors)!=null&&R.has(`manager_${x}`)?"error":"pending":"pending"},N=(x,j)=>{switch(j){case"completed":return c.jsx(ys,{className:"w-5 h-5 text-green-600"});case"running":return c.jsx(Pc,{className:"w-5 h-5 text-orange-600 animate-spin"});case"error":return c.jsx(J0,{className:"w-5 h-5 text-red-600"});default:return c.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-gray-300"})}},T=x=>{switch(x){case Z.DISCOVERY:return y("repositoryDiscovery");case Z.ANALYSIS:return y("repositoryAnalysis");case Z.QUALITY:return y("qualityAnalysis");case Z.REFACTOR:return y("refactorProposal");case Z.PLANNING:return y("documentationPlanning");case Z.WRITING:return y("documentationWriting");case Z.GITOPS:return y("gitOperations");case Z.COMPLETE:return y("complete");default:return x}},A=[Z.DISCOVERY,Z.ANALYSIS,Z.QUALITY,Z.REFACTOR,Z.PLANNING,Z.WRITING,Z.GITOPS];return c.jsxs("div",{className:"bg-white/90 backdrop-blur-sm rounded-xl p-6 border border-white/50 shadow-lg",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsxs("div",{children:[c.jsxs("h3",{className:"text-lg font-bold text-gray-900 flex items-center gap-2",children:[c.jsx(Nt,{className:"w-5 h-5 text-red-600"}),y("agentWorkflow")]}),c.jsx("p",{className:"text-sm text-gray-600 mt-1",children:y("automatedPipeline")})]}),c.jsx("button",{onClick:p,disabled:i||t.length===0,className:"px-6 py-3 bg-gradient-to-r from-red-600 to-orange-600 text-white rounded-xl hover:from-red-700 hover:to-orange-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed font-semibold shadow-lg hover:shadow-xl flex items-center gap-2",children:i?c.jsxs(c.Fragment,{children:[c.jsx(Pc,{className:"w-5 h-5 animate-spin"}),c.jsx("span",{children:y("running")})]}):c.jsxs(c.Fragment,{children:[c.jsx(eC,{className:"w-5 h-5"}),c.jsx("span",{children:y("runWorkflow")})]})})]}),c.jsx("div",{className:"mb-6 p-4 bg-gradient-to-br from-orange-50 to-red-50 rounded-xl border border-orange-200/50",children:c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsxs("h4",{className:"text-xs font-bold text-gray-700 mb-2 flex items-center gap-1",children:[c.jsx(zr,{className:"w-3.5 h-3.5 text-orange-600"}),y("outputFormats")]}),c.jsx("div",{className:"flex flex-wrap gap-1.5",children:e.map(x=>c.jsx("span",{className:"px-2 py-0.5 bg-orange-100 text-orange-700 rounded-full text-xs font-medium",children:x==="markdown"?"MD":x==="markdown_mermaid"?"MD+Mermaid":x==="mdx"?"MDX":x==="openapi"?"OpenAPI":"HTML"},x))})]}),c.jsxs("div",{children:[c.jsxs("h4",{className:"text-xs font-bold text-gray-700 mb-2 flex items-center gap-1",children:[c.jsx(zr,{className:"w-3.5 h-3.5 text-orange-600"}),y("sectionTypes")]}),c.jsx("div",{className:"flex flex-wrap gap-1.5",children:n.map(x=>c.jsx("span",{className:"px-2 py-0.5 bg-orange-100 text-orange-700 rounded-full text-xs font-medium",children:x},x))})]})]})}),d&&c.jsx("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg text-red-700",children:d}),c.jsx("div",{className:"space-y-4",children:A.map((x,j)=>{var ye,Fe;const R=S(x),D=j===A.length-1;return c.jsxs("div",{className:"flex items-start gap-4",children:[c.jsxs("div",{className:"flex flex-col items-center",children:[N(x,R),!D&&c.jsx("div",{className:`w-0.5 h-12 mt-2 ${R==="completed"?"bg-green-600":"bg-gray-200"}`})]}),c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("h4",{className:"font-semibold text-gray-900",children:T(x)}),(l==null?void 0:l.progress)&&l.progress.currentAgent===x.replace("_","")&&c.jsxs("span",{className:"text-xs text-gray-500",children:[l.progress.current,"/",l.progress.total,l.progress.currentRepo&&c.jsx("span",{className:"ml-2 text-red-600",children:l.progress.currentRepo.split("/")[1]})]})]}),R==="running"&&((ye=l==null?void 0:l.progress)==null?void 0:ye.currentRepo)&&c.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[y("processing")," ",l.progress.currentRepo]}),R==="completed"&&c.jsx("p",{className:"text-sm text-green-600 mt-1",children:y("completed")}),R==="error"&&c.jsxs("p",{className:"text-sm text-red-600 mt-1",children:[y("error")," ",(Fe=l==null?void 0:l.errors)==null?void 0:Fe.get(`manager_${x}`)]})]})]},x)})}),((l==null?void 0:l.currentStep)===Z.COMPLETE||(l==null?void 0:l.qualityReports)||(l==null?void 0:l.refactorProposals)||(l==null?void 0:l.badges)||(l==null?void 0:l.generatedDocsFull))&&c.jsxs("div",{className:"mt-6 space-y-4",children:[c.jsxs("div",{className:"p-4 bg-gradient-to-r from-orange-50 via-red-50 to-orange-50 border border-orange-200 rounded-lg",children:[c.jsxs("h4",{className:"font-bold text-gray-900 mb-3 flex items-center gap-2",children:[c.jsx(Nt,{className:"w-5 h-5 text-orange-600"}),y("generatedFeatures")]}),c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-xs",children:[l.qualityReports&&l.qualityReports.size>0&&c.jsxs("div",{className:"flex items-center gap-1.5 px-2 py-1 bg-blue-100 text-blue-700 rounded",children:[c.jsx(gu,{className:"w-3.5 h-3.5"}),c.jsx("span",{children:y("qualityScores")})]}),l.refactorProposals&&l.refactorProposals.size>0&&c.jsxs("div",{className:"flex items-center gap-1.5 px-2 py-1 bg-purple-100 text-purple-700 rounded",children:[c.jsx(q0,{className:"w-3.5 h-3.5"}),c.jsx("span",{children:y("refactorProposals")})]}),l.badges&&l.badges.size>0&&c.jsxs("div",{className:"flex items-center gap-1.5 px-2 py-1 bg-yellow-100 text-yellow-700 rounded",children:[c.jsx(W0,{className:"w-3.5 h-3.5"}),c.jsx("span",{children:y("badges")})]}),l.generatedDocsFull&&l.generatedDocsFull.size>0&&c.jsxs("div",{className:"flex items-center gap-1.5 px-2 py-1 bg-red-100 text-red-700 rounded",children:[c.jsx(bo,{className:"w-3.5 h-3.5"}),c.jsx("span",{children:y("pdfExport")})]})]})]}),(l==null?void 0:l.currentStep)===Z.COMPLETE&&c.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:[c.jsxs("h4",{className:"font-semibold text-green-900 mb-2 flex items-center gap-2",children:[c.jsx(ys,{className:"w-5 h-5"}),y("workflowComplete")]}),c.jsxs("div",{className:"space-y-2 text-sm text-green-800",children:[l.generatedDocs&&c.jsxs("p",{children:[y("generatedDocumentationFor")," ",l.generatedDocs.size," ",l.generatedDocs.size!==1?y("repositories"):y("repository")]}),l.commitResults&&l.commitResults.size>0?c.jsxs("p",{children:[y("committedTo")," ",Array.from(l.commitResults.values()).filter(x=>x.success).length," ",Array.from(l.commitResults.values()).filter(x=>x.success).length!==1?y("repositories"):y("repository")]}):l.generatedDocs&&l.generatedDocs.size>0&&c.jsx("p",{className:"text-amber-700 font-medium",children:y("reviewAndCommit")})]})]}),(l==null?void 0:l.generatedDocs)&&l.generatedDocs.size>0&&(!l.commitResults||l.commitResults.size===0)&&c.jsx("button",{onClick:g,disabled:f,className:"w-full flex items-center justify-center gap-3 px-6 py-4 bg-gradient-to-r from-green-600 via-emerald-600 to-teal-600 text-white rounded-xl hover:from-green-700 hover:via-emerald-700 hover:to-teal-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed font-semibold shadow-lg hover:shadow-xl",children:f?c.jsxs(c.Fragment,{children:[c.jsx(Pc,{className:"w-5 h-5 animate-spin"}),c.jsx("span",{children:y("committing")})]}):c.jsxs(c.Fragment,{children:[c.jsx(Yo,{className:"w-5 h-5"}),c.jsx("span",{children:y("commitToRepos")})]})}),l.commitResults&&l.commitResults.size>0&&c.jsxs("div",{className:"p-4 bg-orange-50 border border-orange-200 rounded-lg",children:[c.jsxs("h4",{className:"font-semibold text-orange-900 mb-2 flex items-center gap-2",children:[c.jsx(Yo,{className:"w-5 h-5"}),"Commit Results"]}),c.jsx("div",{className:"space-y-2 text-sm",children:Array.from(l.commitResults.values()).map(x=>c.jsxs("div",{className:`p-2 rounded ${x.success?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"font-medium",children:x.repo.name}),x.success?c.jsx(ys,{className:"w-4 h-4"}):c.jsx(J0,{className:"w-4 h-4"})]}),x.success&&x.commitUrl&&c.jsx("a",{href:x.commitUrl,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-orange-600 hover:underline mt-1 block",children:"View commit "}),!x.success&&x.error&&c.jsx("p",{className:"text-xs mt-1",children:x.error})]},x.repo.fullName))})]}),l.qualityReports&&l.qualityReports.size>0&&c.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[c.jsxs("h4",{className:"font-semibold text-blue-900 mb-3 flex items-center gap-2",children:[c.jsx(gu,{className:"w-5 h-5"}),"Repository Quality Scores"]}),c.jsx("div",{className:"space-y-3",children:Array.from(l.qualityReports.entries()).map(([x,j])=>{const R=j.overallScore,D=R>=80?"text-green-600":R>=60?"text-blue-600":R>=40?"text-yellow-600":"text-red-600";return c.jsxs("div",{className:"bg-white rounded-lg p-3 border border-blue-100",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx("span",{className:"font-semibold text-gray-900",children:x.split("/")[1]}),c.jsxs("span",{className:`text-2xl font-bold ${D}`,children:[R,"/100"]})]}),c.jsx("div",{className:"space-y-1.5",children:j.metrics&&j.metrics.map(ye=>c.jsxs("div",{className:"flex items-center justify-between text-xs",children:[c.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[c.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2",children:c.jsx("div",{className:`h-2 rounded-full ${ye.score>=80?"bg-green-500":ye.score>=60?"bg-blue-500":ye.score>=40?"bg-yellow-500":"bg-red-500"}`,style:{width:`${ye.score}%`}})}),c.jsx("span",{className:"text-gray-700 font-medium min-w-[80px]",children:ye.label})]}),c.jsxs("span",{className:"text-gray-600 min-w-[40px] text-right",children:[ye.score,"/100"]})]},ye.id))})]},x)})})]}),l.refactorProposals&&l.refactorProposals.size>0&&c.jsxs("div",{className:"p-4 bg-purple-50 border border-purple-200 rounded-lg",children:[c.jsxs("h4",{className:"font-semibold text-purple-900 mb-3 flex items-center gap-2",children:[c.jsx(q0,{className:"w-5 h-5"}),"Folder Structure Refactor Proposals"]}),c.jsx("div",{className:"space-y-3",children:Array.from(l.refactorProposals.entries()).map(([x,j])=>c.jsxs("div",{className:"bg-white rounded-lg p-3 border border-purple-100",children:[c.jsx("div",{className:"font-semibold text-gray-900 mb-2",children:x.split("/")[1]}),c.jsx("p",{className:"text-sm text-gray-700 mb-3",children:j.highLevelSummary}),j.recommendedStructure&&j.recommendedStructure.length>0&&c.jsxs("div",{className:"mb-3",children:[c.jsx("h5",{className:"text-xs font-semibold text-gray-700 mb-1.5",children:"Recommended Structure:"}),c.jsx("ul",{className:"text-xs text-gray-600 space-y-1 ml-4 list-disc",children:j.recommendedStructure.map((R,D)=>c.jsxs("li",{children:[c.jsx("span",{className:"font-mono text-purple-600",children:R.folder})," - ",R.description]},D))})]}),j.moves&&j.moves.length>0&&c.jsxs("div",{children:[c.jsxs("h5",{className:"text-xs font-semibold text-gray-700 mb-1.5",children:["Proposed Moves (",j.moves.length,"):"]}),c.jsxs("div",{className:"space-y-1 max-h-40 overflow-y-auto",children:[j.moves.slice(0,5).map((R,D)=>c.jsx("div",{className:"text-xs bg-gray-50 p-2 rounded border border-gray-200",children:c.jsxs("div",{className:"flex items-start gap-2",children:[c.jsx(MA,{className:"w-3 h-3 text-purple-600 mt-0.5 flex-shrink-0"}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("div",{className:"font-mono text-purple-700 truncate",children:R.fromPath}),c.jsx("div",{className:"font-mono text-green-700 truncate",children:R.toPath}),c.jsx("div",{className:"text-gray-600 mt-0.5",children:R.reason})]})]})},D)),j.moves.length>5&&c.jsxs("p",{className:"text-xs text-gray-500 italic",children:["+ ",j.moves.length-5," more moves..."]})]})]}),j.warnings&&j.warnings.length>0&&c.jsxs("div",{className:"mt-2 p-2 bg-yellow-50 border border-yellow-200 rounded text-xs text-yellow-800",children:[c.jsx("strong",{children:" Warnings:"})," ",j.warnings.join(", ")]})]},x))})]}),l.badges&&l.badges.size>0&&c.jsxs("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[c.jsxs("h4",{className:"font-semibold text-yellow-900 mb-3 flex items-center gap-2",children:[c.jsx(W0,{className:"w-5 h-5"}),"Generated Repository Badges"]}),c.jsx("div",{className:"space-y-3",children:Array.from(l.badges.entries()).map(([x,j])=>c.jsxs("div",{className:"bg-white rounded-lg p-3 border border-yellow-100",children:[c.jsx("div",{className:"font-semibold text-gray-900 mb-2",children:x.split("/")[1]}),c.jsx("div",{className:"bg-gray-900 text-gray-100 rounded p-3 font-mono text-xs overflow-x-auto mb-2",children:c.jsx("pre",{className:"whitespace-pre-wrap",children:j})}),c.jsxs("button",{onClick:()=>{navigator.clipboard.writeText(j),alert("Badge markdown copied to clipboard!")},className:"flex items-center gap-2 px-3 py-1.5 bg-yellow-600 text-white rounded hover:bg-yellow-700 transition-colors text-sm font-medium",children:[c.jsx(VA,{className:"w-4 h-4"}),"Copy Badge Markdown"]})]},x))})]}),l.generatedDocsFull&&l.generatedDocsFull.size>0&&c.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:[c.jsxs("h4",{className:"font-semibold text-red-900 mb-3 flex items-center gap-2",children:[c.jsx(bo,{className:"w-5 h-5"}),"PDF Export"]}),c.jsx("div",{className:"space-y-2",children:Array.from(l.generatedDocsFull.entries()).map(([x,j])=>c.jsxs("div",{className:"bg-white rounded-lg p-3 border border-red-100",children:[c.jsx("div",{className:"font-semibold text-gray-900 mb-2",children:x.split("/")[1]}),c.jsx("div",{className:"flex flex-wrap gap-2",children:j.sections.map(R=>c.jsxs("button",{onClick:async()=>{try{const{exportToPDF:D,downloadPDF:ye}=await Pb(async()=>{const{exportToPDF:G,downloadPDF:F}=await import("./pdf-exporter-M1iVyzVj.js");return{exportToPDF:G,downloadPDF:F}},[]),Fe=await D(R);ye(Fe,`${x.split("/")[1]}_${R.type}_${R.format}.pdf`)}catch(D){alert(`PDF export failed: ${D.message}`)}},className:"flex items-center gap-1.5 px-3 py-1.5 bg-red-600 text-white rounded hover:bg-red-700 transition-colors text-xs font-medium",children:[c.jsx(bo,{className:"w-3.5 h-3.5"}),R.type," (",R.format,")"]},R.id))})]},x))})]})]})]})}function wF({onBack:t}){const[e,n]=V.useState(""),[r,s]=V.useState(""),[a,i]=V.useState(new Map),[o,l]=V.useState(new Map),[u,d]=V.useState("markdown"),[h,f]=V.useState("README"),[m,v]=V.useState(!1),[w,_]=V.useState(""),[y,p]=V.useState("single"),[g,S]=V.useState([]),[N,T]=V.useState(!1),[A,x]=V.useState("gpt-4o-mini"),[j,R]=V.useState(xt()||""),[D,ye]=V.useState(!1),[Fe,G]=V.useState(!1),[F,W]=V.useState(Zu()||""),[J,$]=V.useState(!1),[M,U]=V.useState(!1),[re,X]=V.useState(!1),[Te,ze]=V.useState(xt()||""),[Ee,E]=V.useState(Zu()||""),[b,L]=V.useState(null),[C,Ne]=V.useState(!1),[Pe,He]=V.useState(""),[tt,gt]=V.useState("main"),[At,We]=V.useState("combined"),[Bt,as]=V.useState(!1),[lr,K]=V.useState(!0),[Tn,pe]=V.useState(!0),[oe,we]=V.useState(!1),[Y,q]=V.useState(!1),[ve,fe]=V.useState(!1),[Qe,Ci]=V.useState(["markdown"]),[An,_y]=V.useState(["README"]),[Ii,tN]=V.useState(()=>localStorage.getItem("selectedLanguage")||"en");V.useEffect(()=>{localStorage.setItem("selectedLanguage",Ii)},[Ii]);const me=xa(Ii),[cr,wy]=V.useState(new Set),[Cn,xy]=V.useState(!1),ji=V.useRef(null),Ri=V.useRef(new Map);V.useEffect(()=>{const O=()=>{const he=window.scrollY||document.documentElement.scrollTop;we(he>300)};return window.addEventListener("scroll",O),()=>window.removeEventListener("scroll",O)},[]);const nN=()=>{window.scrollTo({top:0,behavior:"smooth"})};V.useEffect(()=>{const O=localStorage.getItem("autoFollowRepos"),he=localStorage.getItem("autoFollowEnabled");O&&wy(new Set(JSON.parse(O))),he==="true"&&xy(!0)},[]),V.useEffect(()=>{localStorage.setItem("autoFollowRepos",JSON.stringify(Array.from(cr)))},[cr]),V.useEffect(()=>{localStorage.setItem("autoFollowEnabled",Cn.toString())},[Cn]);const by=async()=>{if(!Cn||cr.size===0)return;const O=xt();if(!O){console.warn("GitHub token required for auto-follow");return}for(const he of cr)try{const[xe,at]=he.split("/"),Ve=await X0(xe,at,"main",O),Ze=Ri.current.get(he);if(Ve&&Ve!==Ze){const Qt=await pC(xe,at,Ve,O);if(Qt&&(Qt.isMerge||Qt.message.toLowerCase().includes("merge"))){console.log(`New merge detected for ${he}, regenerating documentation...`);const Pi=g.find(is=>is.fullName===he);if(Pi)try{const is=await eN(Pi.htmlUrl,{format:"markdown",includeCode:!0,includeProps:!0,includeExamples:!0,depth:"detailed"});i(eh=>{const Py=new Map(eh);return Py.set(he,is),Py}),await cm(xe,Pi.name,"DOCUMENTATION.md",is,"Auto-update: Documentation regenerated after merge to main","main",O),console.log(`Documentation auto-updated for ${he}`)}catch(is){console.error(`Failed to auto-update documentation for ${he}:`,is)}}Ri.current.set(he,Ve)}}catch(xe){console.error(`Error checking updates for ${he}:`,xe)}};V.useEffect(()=>{if(Cn&&cr.size>0)return by(),ji.current=setInterval(()=>{by()},5*60*1e3),()=>{ji.current&&clearInterval(ji.current)};ji.current&&clearInterval(ji.current)},[Cn,cr,g]),V.useEffect(()=>{const O=async()=>{const he=xt();if(he){for(const xe of g)if(cr.has(xe.fullName)&&!Ri.current.has(xe.fullName))try{const[at,Ve]=xe.fullName.split("/"),Ze=await X0(at,Ve,"main",he);Ze&&Ri.current.set(xe.fullName,Ze)}catch(at){console.error(`Failed to get initial commit SHA for ${xe.fullName}:`,at)}}};g.length>0&&Cn&&O()},[g,cr,Cn]);const jl=(O,he,xe)=>{const at=o.get(O);if(at){const Ve=at.sections.find(Ze=>Ze.format===he&&Ze.type===xe);if(Ve){const Ze=Ve.markdown||Ve.html||Ve.openapiYaml||"";s(Ze)}else{const Ze=at.sections.find(Qt=>Qt.format===he)||at.sections.find(Qt=>Qt.type===xe)||at.sections[0];if(Ze){const Qt=Ze.markdown||Ze.html||Ze.openapiYaml||"";s(Qt)}}}else{const Ve=a.get(O);Ve&&s(Ve)}},Qd=()=>{if(y==="multi"&&g.length>0)return g;if(y==="single"&&e.trim()){const O=dd(e.trim());if(O)return[{id:Date.now(),name:O.repo,fullName:`${O.owner}/${O.repo}`,owner:O.owner,private:!1,htmlUrl:`https://github.com/${O.owner}/${O.repo}`,defaultBranch:O.branch||"main"}]}return[]},rN=async()=>{if(g.length===0){_("No repositories selected");return}if(!Pe.trim()){_("Please provide a commit message");return}v(!0),_(""),L(null);try{const O=xt();if(!O)throw new Error("GitHub token is required for committing files");const he=[];for(let Ve=0;Ve<g.length;Ve++){const Ze=g[Ve];L({current:Ve+1,total:g.length,repo:Ze.fullName});try{const Qt=a.get(Ze.fullName);if(!Qt)throw new Error("Documentation not found for this repository. Please generate documentation first.");const[Pi,is]=Ze.fullName.split("/"),eh=await cm(Pi,is,"DOCUMENTATION.md",Qt,Pe,tt,O);he.push({repo:Ze.fullName,success:!0,commitUrl:eh.commit.html_url})}catch(Qt){he.push({repo:Ze.fullName,success:!1,error:Qt.message})}}const xe=he.filter(Ve=>Ve.success).length,at=he.filter(Ve=>!Ve.success).length;if(at===0)_(""),alert(`Successfully committed documentation to ${xe} repository${xe!==1?"ies":""}!`),Ne(!1);else{const Ve=he.filter(Ze=>!Ze.success).map(Ze=>`${Ze.repo}: ${Ze.error}`).join(`
`);_(`Failed to commit to ${at} repository${at!==1?"ies":""}:
${Ve}`)}}catch(O){_(O.message||"Failed to commit documentation"),console.error("Commit error:",O)}finally{v(!1),L(null)}},sN=()=>{if(!r)return;const O=e,he=O?`documentation-${O.split("/").pop()||"source"}.md`:"documentation.md";tF(r,he)},Oi=r?Math.round(r.length/4):0,Rl=r?r.split(/\s+/).filter(O=>O.length>0).length:0,Xd=r?r.split(`
`).length:0,Sy=r?r.length:0,aN=Xd>0?(Rl/Xd).toFixed(1):"0",ky=Rl>0?Math.ceil(Rl/200):0,iN=(Sy/1024).toFixed(2),Ey=r?(r.match(/^##+\s/gm)||[]).length:0,Ny=r?(r.match(/```[\s\S]*?```/g)||[]).length:0,Ty=r?(r.match(/\[([^\]]+)\]\(([^)]+)\)/g)||[]).length:0,Ay=r?(r.match(/^#+\s/gm)||[]).length:0,Cy={"gpt-4o-mini":{input:.15,output:.6},"gpt-4o":{input:2.5,output:10},"gpt-4o-2024-08-06":{input:2.5,output:10},"gpt-4-turbo":{input:10,output:30},"gpt-4-turbo-preview":{input:10,output:30},"gpt-4":{input:30,output:60},"gpt-3.5-turbo":{input:.5,output:1.5},"o1-preview":{input:15,output:60},"o1-mini":{input:3,output:12}},Iy=Cy[A]||Cy["gpt-4o-mini"],jy=Math.round(Oi*.3),Ry=Math.round(Oi*.7),Oy=r?jy/1e6*Iy.input+Ry/1e6*Iy.output:0;return c.jsxs("div",{className:"min-h-screen flex flex-col bg-gradient-to-br from-slate-50 via-orange-50/30 to-red-50/30",children:[c.jsx("header",{className:"bg-white/70 backdrop-blur-xl border-b border-white/20 shadow-lg shadow-black/5 flex-shrink-0 sticky top-0 z-50",children:c.jsx("div",{className:"px-8 py-5",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-5",children:[c.jsx("button",{onClick:t,className:"p-2.5 hover:bg-gradient-to-br hover:from-orange-50 hover:to-red-50 rounded-xl transition-all duration-300 group shadow-sm hover:shadow-md",children:c.jsx(jb,{className:"w-5 h-5 text-slate-600 group-hover:text-orange-600 group-hover:-translate-x-1 transition-all"})}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-2.5 bg-gradient-to-br from-orange-500 to-red-600 rounded-xl shadow-lg shadow-orange-500/30",children:c.jsx(Nt,{className:"w-6 h-6 text-white"})}),c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-extrabold bg-gradient-to-r from-orange-600 via-red-600 to-pink-600 bg-clip-text text-transparent",children:me("documentationWriter")}),c.jsx("p",{className:"text-sm text-slate-500 mt-0.5 font-medium",children:me("aiPoweredGeneration")})]})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("select",{value:Ii,onChange:O=>tN(O.target.value),className:"px-3 py-2 text-sm font-semibold rounded-xl bg-white/80 backdrop-blur-sm text-slate-700 hover:bg-white border border-slate-200 hover:border-orange-300 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all duration-300 shadow-sm hover:shadow-md cursor-pointer",title:"Translate page",children:[c.jsx("option",{value:"en",children:" EN"}),c.jsx("option",{value:"fr",children:" FR"}),c.jsx("option",{value:"de",children:" DE"}),c.jsx("option",{value:"it",children:" IT"}),c.jsx("option",{value:"es",children:" ES"})]}),c.jsxs("button",{onClick:()=>K(!lr),className:"p-2.5 hover:bg-gradient-to-br hover:from-orange-50 hover:to-red-50 rounded-xl transition-all duration-300 shadow-sm hover:shadow-md relative group",title:me(lr?"hideAiAssistant":"showAiAssistant"),children:[c.jsx(XA,{className:`w-5 h-5 transition-colors ${lr?"text-orange-600":"text-slate-400"}`}),lr&&c.jsx("span",{className:"absolute -top-1 -right-1 w-2.5 h-2.5 bg-green-500 rounded-full border-2 border-white animate-pulse"})]}),c.jsx("button",{onClick:()=>as(!Bt),className:"p-2.5 hover:bg-gradient-to-br hover:from-orange-50 hover:to-red-50 rounded-xl transition-all duration-300 shadow-sm hover:shadow-md",children:c.jsx(sC,{className:"w-5 h-5 text-slate-600"})})]})]})})}),c.jsxs("div",{className:"flex-1 flex min-h-0",children:[lr&&c.jsx("aside",{className:"w-80 sticky top-0 self-start h-screen bg-white/60 backdrop-blur-xl border-r border-white/30 shadow-2xl shadow-black/5 overflow-hidden flex flex-col transition-all duration-300 flex-shrink-0",children:c.jsx(dC,{documentation:r,onUpdateDocumentation:s,model:A})}),c.jsxs("main",{className:"flex-1 flex flex-col overflow-hidden bg-gradient-to-br from-slate-50 via-orange-50/20 to-red-50/20",children:[c.jsxs("div",{className:"bg-white/40 backdrop-blur-xl border-b border-white/30 shadow-lg shadow-black/5 flex-shrink-0",children:[c.jsx("div",{className:"p-4 border-b border-white/20",children:c.jsxs("button",{onClick:()=>pe(!Tn),className:"w-full flex items-center justify-between group hover:bg-white/30 rounded-lg p-2 transition-all duration-300",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-1.5 bg-gradient-to-br from-orange-500 to-red-600 rounded-lg shadow-md",children:c.jsx(Qs,{className:"w-4 h-4 text-white"})}),c.jsxs("div",{className:"text-left",children:[c.jsx("h3",{className:"text-sm font-bold text-slate-700 group-hover:text-slate-900 transition-colors",children:me("sourceSelection")}),c.jsx("p",{className:"text-xs text-slate-500",children:me(Tn?"clickToCollapse":"clickToExpand")})]})]}),c.jsx("div",{className:"p-1.5 rounded-lg bg-white/50 group-hover:bg-white/80 transition-all duration-300",children:Tn?c.jsx(GA,{className:"w-5 h-5 text-slate-600 group-hover:text-slate-900 transition-colors"}):c.jsx(BA,{className:"w-5 h-5 text-slate-600 group-hover:text-slate-900 transition-colors"})})]})}),c.jsx("div",{className:`overflow-hidden transition-all duration-300 ease-in-out ${Tn?"max-h-[2000px] opacity-100":"max-h-0 opacity-0"}`,children:c.jsx("div",{className:"p-4",children:c.jsx("div",{className:"max-w-4xl mx-auto",children:c.jsx("div",{children:c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"bg-gradient-to-br from-white/90 to-orange-50/50 backdrop-blur-sm rounded-xl p-3 border border-white/50 shadow-lg shadow-orange-500/10",children:[c.jsxs("label",{className:"block text-xs font-bold text-slate-700 mb-2 flex items-center gap-1.5",children:[c.jsx(lm,{className:"w-3 h-3 text-orange-500"}),"Mode"]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsxs("button",{onClick:()=>{p("single"),S([]),i(new Map),We("combined")},className:`flex-1 flex items-center justify-center gap-2 px-3 py-2 rounded-lg font-bold text-xs transition-all duration-300 ${y==="single"?"bg-gradient-to-r from-orange-500 to-red-600 text-white shadow-lg shadow-orange-500/40 scale-105 transform":"bg-white text-slate-700 hover:bg-orange-50 hover:shadow-md border border-slate-200 hover:border-orange-300"}`,children:[c.jsx(_r,{className:"w-3.5 h-3.5"}),c.jsx("span",{children:me("singleRepo")})]}),c.jsxs("button",{onClick:()=>{p("multi"),n(""),s(""),i(new Map),We("combined")},className:`flex-1 flex items-center justify-center gap-2 px-3 py-2 rounded-lg font-bold text-xs transition-all duration-300 ${y==="multi"?"bg-gradient-to-r from-orange-500 to-red-600 text-white shadow-lg shadow-orange-500/40 scale-105 transform":"bg-white text-slate-700 hover:bg-orange-50 hover:shadow-md border border-slate-200 hover:border-orange-300"}`,children:[c.jsx(ws,{className:"w-3.5 h-3.5"}),c.jsx("span",{children:me("multiRepo")})]})]})]}),y==="single"?c.jsxs("div",{className:"bg-white/90 backdrop-blur-sm rounded-xl p-3 border border-white/50 shadow-lg shadow-orange-500/10",children:[c.jsxs("label",{className:"block text-xs font-bold text-slate-700 mb-2 flex items-center gap-1.5",children:[c.jsx(_r,{className:"w-3 h-3 text-orange-500"}),me("githubUrl")]}),c.jsx("input",{type:"text",value:e,onChange:O=>n(O.target.value),placeholder:me("ownerRepoOrGithub"),className:"w-full px-3 py-2 text-sm border-2 border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-400 transition-all bg-white/50 backdrop-blur-sm text-slate-700 placeholder:text-slate-400 font-medium shadow-sm hover:shadow-md"})]}):c.jsxs("div",{className:"bg-white/90 backdrop-blur-sm rounded-xl p-3 border border-white/50 shadow-lg shadow-orange-500/10",children:[c.jsxs("label",{className:"block text-xs font-bold text-slate-700 mb-2 flex items-center gap-1.5",children:[c.jsx(ws,{className:"w-3 h-3 text-orange-500"}),me("selectRepos")]}),c.jsx("button",{onClick:()=>T(!0),className:"w-full px-3 py-2.5 border-2 border-dashed border-slate-300 rounded-lg hover:border-orange-400 hover:bg-gradient-to-br hover:from-orange-50 hover:to-red-50 transition-all text-left group shadow-sm hover:shadow-md",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"p-1.5 bg-orange-100 rounded-lg group-hover:bg-orange-200 transition-colors",children:c.jsx(ws,{className:"w-4 h-4 text-orange-600"})}),c.jsx("span",{className:"text-xs text-slate-700 font-medium",children:g.length>0?`${g.length} repo${g.length!==1?"s":""}`:me("selectRepos")})]}),c.jsx(lm,{className:"w-4 h-4 text-slate-400 group-hover:text-orange-500 transition-colors"})]})}),g.length>0&&c.jsx("div",{className:"space-y-1.5 mt-2 max-h-32 overflow-y-auto",children:g.map(O=>{const he=cr.has(O.fullName);return c.jsxs("div",{className:"flex items-center justify-between px-2.5 py-1.5 bg-gradient-to-r from-orange-50/80 to-red-50/80 backdrop-blur-sm border border-orange-200/50 rounded-lg shadow-sm hover:shadow-md transition-all",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(_r,{className:"w-3 h-3 text-orange-600"}),c.jsx("span",{className:"text-xs text-slate-700 font-bold truncate max-w-[120px]",children:O.name}),he&&c.jsxs("span",{className:"px-1.5 py-0.5 bg-gradient-to-r from-green-100 to-emerald-100 text-green-700 rounded-full text-[10px] font-bold flex items-center gap-1 border border-green-200",children:[c.jsx(V0,{className:"w-2.5 h-2.5"}),"Auto"]})]}),c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("button",{onClick:()=>{const xe=new Set(cr);he?(xe.delete(O.fullName),Ri.current.delete(O.fullName)):xe.add(O.fullName),wy(xe)},className:`p-1 rounded transition-all duration-300 ${he?"bg-gradient-to-br from-green-100 to-emerald-100 text-green-700 hover:from-green-200 hover:to-emerald-200":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,title:me(he?"disableAutoUpdate":"enableAutoUpdate"),children:he?c.jsx(V0,{className:"w-3 h-3"}):c.jsx(zA,{className:"w-3 h-3"})}),c.jsx("button",{onClick:()=>S(g.filter(xe=>xe.id!==O.id)),className:"p-1 text-red-500 hover:text-red-700 hover:bg-red-50 rounded transition-all duration-300",children:c.jsx(So,{className:"w-3 h-3"})})]})]},O.id)})}),g.length>0&&c.jsx("div",{className:"mt-3 p-3 bg-gradient-to-br from-green-50/80 to-emerald-50/80 backdrop-blur-sm border border-green-200/50 rounded-xl shadow-md shadow-green-500/10",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:`p-1 rounded-lg ${Cn?"bg-green-100 animate-pulse":"bg-slate-100"}`,children:c.jsx(tC,{className:`w-3.5 h-3.5 ${Cn?"text-green-600 animate-spin":"text-slate-400"}`})}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs font-bold text-slate-700 cursor-pointer block",children:"Auto-Update"}),c.jsx("p",{className:"text-[10px] text-slate-600",children:"Auto-regenerate on push/merge"})]})]}),c.jsx("button",{onClick:()=>xy(!Cn),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-all duration-300 shadow-md ${Cn?"bg-gradient-to-r from-green-500 to-emerald-600":"bg-slate-300"}`,children:c.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow-sm transition-transform duration-300 ${Cn?"translate-x-6":"translate-x-1"}`})})]})}),g.length>0&&c.jsx("div",{className:"mt-3 p-3 bg-gradient-to-br from-red-50/80 to-orange-50/80 backdrop-blur-sm border border-red-200/50 rounded-xl shadow-md",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:`p-1.5 rounded-lg ${Y?"bg-red-100":"bg-slate-100"}`,children:c.jsx(Nt,{className:`w-4 h-4 ${Y?"text-red-600":"text-slate-400"}`})}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs font-bold text-slate-700 cursor-pointer block",children:"Agent Workflow"}),c.jsx("p",{className:"text-[10px] text-slate-600",children:"Use AI agents for automated pipeline"})]})]}),c.jsx("button",{onClick:()=>q(!Y),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-all duration-300 shadow-md ${Y?"bg-gradient-to-r from-red-500 to-orange-600":"bg-slate-300"}`,children:c.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow-sm transition-transform duration-300 ${Y?"translate-x-6":"translate-x-1"}`})})]})}),c.jsxs("div",{className:"mt-3 p-2.5 bg-gradient-to-br from-orange-50/80 via-red-50/80 to-orange-50/80 backdrop-blur-sm border border-orange-200/50 rounded-xl shadow-md",children:[o.size>0&&c.jsxs("div",{className:"mb-2 p-1.5 bg-amber-50 border border-amber-200 rounded text-[9px] text-amber-700 flex items-center justify-between",children:[c.jsxs("span",{children:[" ",me("formatsLocked")]}),c.jsx("button",{type:"button",onClick:()=>{l(new Map),i(new Map),s(""),We("combined")},className:"ml-2 px-2 py-0.5 bg-amber-600 text-white rounded hover:bg-amber-700 transition-colors text-[8px] font-semibold",title:me("clearDocumentation"),children:me("clear")})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[c.jsxs("div",{children:[c.jsxs("label",{className:"block text-[10px] font-bold text-slate-700 mb-1.5 flex items-center gap-1",children:[c.jsx(zr,{className:"w-2.5 h-2.5 text-orange-500"}),me("formats")]}),c.jsx("div",{className:"flex flex-wrap gap-1",children:["markdown","markdown_mermaid","mdx","openapi","html"].map(O=>{const he=Qe.includes(O),xe=o.size>0;return c.jsx("button",{type:"button",disabled:xe,onClick:()=>{xe||(he?Qe.length>1&&Ci(Qe.filter(at=>at!==O)):Ci([...Qe,O]))},className:`px-1.5 py-0.5 text-[10px] font-semibold rounded transition-all ${xe?"bg-gray-200 text-gray-400 cursor-not-allowed opacity-50":he?"bg-orange-600 text-white shadow-sm":"bg-white/60 text-slate-600 hover:bg-white/80 border border-slate-200"}`,title:O==="markdown"?"Markdown":O==="markdown_mermaid"?"Markdown + Mermaid":O==="mdx"?"MDX (Markdown + JSX)":O==="openapi"?"OpenAPI (YAML)":"HTML",children:O==="markdown"?"MD":O==="markdown_mermaid"?"MD+M":O==="mdx"?"MDX":O==="openapi"?"OAPI":"HTML"},O)})})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-[10px] font-bold text-slate-700 mb-1.5 flex items-center gap-1",children:[c.jsx(Th,{className:"w-2.5 h-2.5 text-orange-500"}),me("sections")]}),c.jsx("div",{className:"flex flex-wrap gap-1",children:["README","ARCHITECTURE","API","COMPONENTS","TESTING_CI","CHANGELOG"].map(O=>{const he=An.includes(O),xe=o.size>0||m;return c.jsx("button",{type:"button",disabled:xe,onClick:()=>{xe||(he?An.length>1&&_y(An.filter(at=>at!==O)):_y([...An,O]))},className:`px-1.5 py-0.5 text-[10px] font-semibold rounded transition-all ${xe?"bg-gray-200 text-gray-400 cursor-not-allowed opacity-50":he?"bg-orange-600 text-white shadow-sm":"bg-white/60 text-slate-600 hover:bg-white/80 border border-slate-200"}`,title:O==="README"?"README":O==="ARCHITECTURE"?"Architecture":O==="API"?"API Reference":O==="COMPONENTS"?"Components":O==="TESTING_CI"?"Testing & CI/CD":"Changelog",children:O==="README"?"README":O==="ARCHITECTURE"?"ARCH":O==="API"?"API":O==="COMPONENTS"?"COMP":O==="TESTING_CI"?"TEST":"CHG"},O)})})]})]}),(Qe.length===0||An.length===0)&&c.jsx("p",{className:"text-[9px] text-red-500 mt-1.5 text-center",children:me("selectAtLeastOne")})]})]}),c.jsxs("div",{className:"bg-white/90 backdrop-blur-sm rounded-xl p-3 border border-white/50 shadow-lg shadow-orange-500/10",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsxs("label",{className:"block text-xs font-bold text-slate-700 flex items-center gap-1.5",children:[c.jsx(Qs,{className:"w-3 h-3 text-orange-500"}),me("token")]}),c.jsx("button",{type:"button",onClick:()=>{if(D&&re){R(Te);const O=F.trim()!==Ee;X(O)}ye(!D)},className:"text-[10px] text-orange-600 hover:text-orange-700 font-bold px-2 py-1 rounded hover:bg-orange-50 transition-all duration-300 border border-orange-200 hover:border-orange-300",children:me(D?"hide":j?"change":"add")})]}),D&&c.jsxs("div",{className:"space-y-2",children:[c.jsx("input",{type:"password",value:j,onChange:O=>{R(O.target.value),G(!1);const he=O.target.value.trim()!==Te||F.trim()!==Ee;X(he)},placeholder:"ghp_xxxxxxxxxxxxxxxxxxxx",className:"w-full px-4 py-2 text-sm border-2 border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all"}),Fe&&c.jsxs("div",{className:"flex items-center gap-2 text-xs text-green-600 font-medium",children:[c.jsx(ys,{className:"w-4 h-4"}),"Token saved successfully!"]}),c.jsxs("p",{className:"text-xs text-gray-500",children:["Required for private repos or to avoid rate limits."," ",c.jsx("a",{href:"https://github.com/settings/tokens",target:"_blank",rel:"noopener noreferrer",className:"text-orange-600 hover:text-orange-700 underline",children:"Create a token"})]})]}),!D&&j&&c.jsxs("p",{className:"text-xs text-gray-500 flex items-center gap-1",children:[c.jsx(ys,{className:"w-3.5 h-3.5 text-green-500"}),"Token configured (hidden)"]}),!D&&!j&&c.jsx("p",{className:"text-xs text-gray-500",children:"No token set. Public repos work without a token."})]}),c.jsxs("div",{className:"bg-white/90 backdrop-blur-sm rounded-xl p-3 border border-white/50 shadow-lg shadow-red-500/10",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsxs("label",{className:"block text-xs font-bold text-slate-700 flex items-center gap-1.5",children:[c.jsx(Nt,{className:"w-3 h-3 text-red-500"}),me("openaiKey")]}),c.jsx("button",{type:"button",onClick:()=>{if(J&&re){W(Ee);const O=j.trim()!==Te;X(O)}$(!J)},className:"text-[10px] text-red-600 hover:text-red-700 font-bold px-2 py-1 rounded hover:bg-red-50 transition-all duration-300 border border-red-200 hover:border-red-300",children:me(J?"hide":F?"change":"add")})]}),J&&c.jsxs("div",{className:"space-y-2",children:[c.jsx("input",{type:"password",value:F,onChange:O=>{W(O.target.value),U(!1);const he=O.target.value.trim()!==Ee||j.trim()!==Te;X(he)},placeholder:"sk-xxxxxxxxxxxxxxxxxxxx",className:"w-full px-4 py-2 text-sm border-2 border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent transition-all"}),M&&c.jsxs("div",{className:"flex items-center gap-2 text-xs text-green-600 font-medium",children:[c.jsx(ys,{className:"w-4 h-4"}),"API key saved successfully!"]}),c.jsxs("p",{className:"text-xs text-gray-500",children:["Required for AI-powered documentation generation."," ",c.jsx("a",{href:"https://platform.openai.com/api-keys",target:"_blank",rel:"noopener noreferrer",className:"text-red-600 hover:text-red-700 underline",children:"Get your API key"})]})]}),!J&&F&&c.jsxs("p",{className:"text-xs text-gray-500 flex items-center gap-1",children:[c.jsx(ys,{className:"w-3.5 h-3.5 text-green-500"}),"API key configured (hidden)"]}),!J&&!F&&c.jsx("p",{className:"text-xs text-gray-500",children:"No API key set. Required for AI features."})]}),re&&(D||J)&&c.jsx("div",{className:"mt-3",children:c.jsxs("button",{onClick:()=>{try{j.trim()!==Te&&(fC(j.trim()),ze(j.trim()),G(!0),setTimeout(()=>G(!1),3e3)),F.trim()!==Ee&&(YE(F.trim()),E(F.trim()),U(!0),setTimeout(()=>U(!1),3e3)),X(!1),_("")}catch{_("Failed to save changes. Please try again.")}},className:"w-full bg-gradient-to-r from-orange-600 to-red-600 text-white py-2.5 px-4 rounded-lg font-semibold text-sm hover:from-orange-700 hover:to-red-700 transition-all duration-300 shadow-lg shadow-orange-500/30 hover:shadow-xl hover:shadow-orange-500/40 flex items-center justify-center gap-2",children:[c.jsx(ys,{className:"w-4 h-4"}),me("saveChanges")]})})]})})})})})]}),c.jsxs("div",{className:"flex-1 overflow-y-auto overflow-x-hidden p-8 min-h-0 scrollbar-thin scrollbar-thumb-slate-300 scrollbar-track-transparent hover:scrollbar-thumb-slate-400",children:[w&&c.jsx("div",{className:"max-w-5xl mx-auto mb-6 p-5 bg-gradient-to-r from-red-50 to-pink-50 border-l-4 border-red-500 rounded-2xl text-red-700 shadow-xl shadow-red-500/20",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:c.jsx(So,{className:"w-5 h-5 text-red-600"})}),c.jsx("span",{className:"font-bold",children:w})]})}),!r&&!m&&c.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center max-w-3xl mx-auto",children:[c.jsxs("div",{className:"relative mb-8",children:[c.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-orange-400 to-red-400 rounded-3xl blur-2xl opacity-20 animate-pulse"}),c.jsx("div",{className:"relative p-8 bg-gradient-to-br from-orange-100 via-red-100 to-pink-100 rounded-3xl shadow-2xl",children:c.jsx(zr,{className:"w-20 h-20 text-orange-600 mx-auto"})})]}),c.jsx("h3",{className:"text-3xl font-extrabold bg-gradient-to-r from-orange-600 to-red-600 bg-clip-text text-transparent mb-4",children:"Ready to Generate Documentation"}),c.jsx("p",{className:"text-slate-600 text-lg font-medium max-w-xl",children:"Enter a GitHub repository URL to generate comprehensive documentation from its structure and code."})]}),m&&c.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[c.jsxs("div",{className:"relative mb-8",children:[c.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-orange-400 to-red-400 rounded-full blur-3xl opacity-30 animate-pulse"}),c.jsx("div",{className:"relative animate-spin w-20 h-20 border-4 border-orange-200 border-t-orange-600 rounded-full"}),c.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:c.jsx(Nt,{className:"w-8 h-8 text-orange-600 animate-pulse"})})]}),c.jsx("p",{className:"text-slate-700 font-bold text-xl mb-2 bg-gradient-to-r from-orange-600 to-red-600 bg-clip-text text-transparent",children:me("generating")}),b&&c.jsxs("div",{className:"mt-6 text-center max-w-md bg-white/80 backdrop-blur-sm rounded-2xl p-6 shadow-xl border border-white/50",children:[c.jsxs("p",{className:"text-sm text-slate-600 mb-3 font-medium",children:["Processing ",c.jsx("span",{className:"font-bold text-orange-600 text-lg",children:b.current})," of"," ",c.jsx("span",{className:"font-bold text-slate-700",children:b.total})]}),b.repo&&c.jsx("p",{className:"text-xs text-slate-500 mb-4 font-mono bg-slate-50 px-3 py-2 rounded-lg",children:b.repo}),c.jsx("div",{className:"w-full bg-slate-200 rounded-full h-4 overflow-hidden shadow-inner",children:c.jsx("div",{className:"bg-gradient-to-r from-orange-500 via-red-500 to-pink-500 h-full rounded-full transition-all duration-500 shadow-lg",style:{width:`${b.current/b.total*100}%`}})})]})]}),r&&c.jsxs("div",{className:"h-full flex flex-col max-w-6xl mx-auto min-h-0",children:[y==="multi"&&a.size>0&&g.length>0&&c.jsx("div",{className:"bg-white/90 backdrop-blur-xl border border-white/50 rounded-2xl mb-6 flex-shrink-0 shadow-2xl shadow-black/5 overflow-hidden",children:c.jsx("div",{className:"flex items-center gap-2 overflow-x-auto px-4 py-3 scrollbar-thin",children:g.map(O=>{const he=a.has(O.fullName),xe=At===O.fullName;return c.jsxs("button",{onClick:()=>{We(O.fullName),jl(O.fullName,u,h)},className:`px-5 py-3 text-sm font-bold border-b-2 transition-all duration-300 whitespace-nowrap flex items-center gap-2 rounded-t-xl ${xe?"border-orange-500 text-orange-600 bg-gradient-to-b from-orange-50 to-white shadow-lg":"border-transparent text-slate-600 hover:text-slate-900 hover:border-slate-300 hover:bg-slate-50"}`,children:[c.jsx(_r,{className:`w-4 h-4 flex-shrink-0 ${xe?"text-orange-600":"text-slate-500"}`}),c.jsx("span",{className:"truncate max-w-[200px]",children:O.name}),he&&c.jsx("span",{className:"px-2 py-0.5 bg-gradient-to-r from-green-100 to-emerald-100 text-green-700 rounded-full text-xs flex-shrink-0 font-bold border border-green-200",children:""})]},O.id)})})}),o.size>0&&c.jsx("div",{className:"bg-white/90 backdrop-blur-xl border border-white/50 rounded-xl mb-4 flex-shrink-0 shadow-lg shadow-black/5 p-2.5",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsxs("div",{className:"flex items-center gap-1.5 flex-1 min-w-0",children:[c.jsx(zr,{className:"w-3.5 h-3.5 text-orange-500 flex-shrink-0"}),c.jsx("span",{className:"text-[10px] font-bold text-slate-600 flex-shrink-0",children:me("format")}),c.jsx("div",{className:"flex gap-1 flex-wrap min-w-0",children:Qe.map(O=>c.jsx("button",{onClick:()=>{var xe;d(O);const he=At!=="combined"?At:(xe=g[0])==null?void 0:xe.fullName;he&&jl(he,O,h)},className:`px-2 py-1 text-[10px] font-semibold rounded-md transition-all whitespace-nowrap ${u===O?"bg-orange-600 text-white shadow-sm":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,title:O==="markdown"?"Markdown":O==="markdown_mermaid"?"Markdown + Mermaid":O==="mdx"?"MDX":O==="openapi"?"OpenAPI":"HTML",children:O==="markdown"?"MD":O==="markdown_mermaid"?"MD+M":O==="mdx"?"MDX":O==="openapi"?"OAPI":"HTML"},O))})]}),c.jsx("div",{className:"w-px h-6 bg-slate-300"}),c.jsxs("div",{className:"flex items-center gap-1.5 flex-1 min-w-0",children:[c.jsx(Th,{className:"w-3.5 h-3.5 text-orange-500 flex-shrink-0"}),c.jsx("span",{className:"text-[10px] font-bold text-slate-600 flex-shrink-0",children:me("section")}),c.jsx("div",{className:"flex gap-1 flex-wrap min-w-0",children:An.map(O=>c.jsx("button",{onClick:()=>{var xe;f(O);const he=At!=="combined"?At:(xe=g[0])==null?void 0:xe.fullName;he&&jl(he,u,O)},className:`px-2 py-1 text-[10px] font-semibold rounded-md transition-all whitespace-nowrap ${h===O?"bg-orange-600 text-white shadow-sm":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,title:O==="README"?"README":O==="ARCHITECTURE"?"Architecture":O==="API"?"API Reference":O==="COMPONENTS"?"Components":O==="TESTING_CI"?"Testing & CI/CD":"Changelog",children:O==="README"?"README":O==="ARCHITECTURE"?"ARCH":O==="API"?"API":O==="COMPONENTS"?"COMP":O==="TESTING_CI"?"TEST":"CHG"},O))})]})]})}),c.jsx("div",{className:"flex-1 min-h-0 overflow-hidden",children:c.jsx("div",{className:"h-full bg-white/90 backdrop-blur-xl rounded-3xl border border-white/50 shadow-2xl shadow-black/10 p-10 overflow-y-auto overflow-x-auto scrollbar-thin scrollbar-thumb-slate-300 scrollbar-track-transparent hover:scrollbar-thumb-slate-400",children:u==="html"?c.jsx("div",{className:"prose prose-slate max-w-none",dangerouslySetInnerHTML:{__html:r}}):u==="openapi"?c.jsx("pre",{className:"whitespace-pre-wrap text-sm font-mono bg-slate-900 text-slate-100 p-6 rounded-lg overflow-x-auto",children:c.jsx("code",{children:r})}):c.jsx("div",{className:"whitespace-pre-wrap text-sm prose prose-slate max-w-none prose-headings:font-bold prose-headings:text-slate-900 prose-p:text-slate-700 prose-a:text-orange-600 prose-code:bg-slate-100 prose-code:px-1.5 prose-code:py-0.5 prose-code:rounded prose-pre:bg-slate-900 prose-pre:overflow-x-auto prose-pre:max-w-full",children:r})})})]})]})]}),c.jsx("aside",{className:"w-80 bg-white/70 backdrop-blur-xl border-l border-white/30 shadow-2xl shadow-black/5 overflow-y-auto flex-shrink-0",children:c.jsxs("div",{className:"p-6",children:[c.jsxs("div",{className:"space-y-4 mb-8",children:[c.jsxs("button",{onClick:()=>{if(Qd().length===0){_(me(y==="single"?"pleaseProvideUrl":"selectAtLeastOneRepo"));return}if(Qe.length===0){_(me("selectAtLeastOneFormat"));return}if(An.length===0){_(me("selectAtLeastOneSection"));return}fe(!0)},disabled:m||(y==="single"?!e.trim():g.length===0)||Qe.length===0||An.length===0,className:"w-full flex items-center justify-center gap-3 px-5 py-4 bg-gradient-to-r from-red-600 via-orange-600 to-red-600 text-white rounded-2xl hover:from-red-700 hover:via-orange-700 hover:to-red-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed font-bold shadow-2xl shadow-orange-500/40 hover:shadow-2xl hover:shadow-orange-500/50 hover:scale-[1.03] disabled:hover:scale-100 transform",children:[c.jsx(Nt,{className:"w-5 h-5"}),c.jsx("span",{children:me("runWorkflow")})]}),r&&c.jsxs(c.Fragment,{children:[c.jsxs("button",{onClick:sN,className:"w-full flex items-center justify-center gap-3 px-5 py-4 bg-gradient-to-r from-slate-700 to-slate-900 text-white rounded-2xl hover:from-slate-800 hover:to-black transition-all duration-300 font-bold shadow-xl shadow-slate-500/30 hover:shadow-2xl hover:shadow-slate-500/40 hover:scale-[1.03] transform",children:[c.jsx(bo,{className:"w-5 h-5"}),c.jsx("span",{children:me("export")})]}),y==="multi"&&g.length>0&&c.jsxs("button",{onClick:()=>Ne(!0),className:"w-full flex items-center justify-center gap-3 px-5 py-4 bg-gradient-to-r from-green-500 via-emerald-600 to-teal-600 text-white rounded-2xl hover:from-green-600 hover:via-emerald-700 hover:to-teal-700 transition-all duration-300 font-bold shadow-2xl shadow-green-500/40 hover:shadow-2xl hover:shadow-green-500/50 hover:scale-[1.03] transform",children:[c.jsx(Yo,{className:"w-5 h-5"}),c.jsx("span",{children:me("commitToRepos")})]})]})]}),c.jsxs("div",{className:"bg-gradient-to-br from-white/90 to-orange-50/50 backdrop-blur-sm rounded-2xl border border-white/50 p-6 shadow-xl shadow-orange-500/10",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[c.jsx("div",{className:"p-2.5 bg-gradient-to-br from-orange-100 to-red-100 rounded-xl shadow-md",children:c.jsx(gu,{className:"w-5 h-5 text-orange-600"})}),c.jsx("h3",{className:"text-base font-extrabold bg-gradient-to-r from-orange-600 to-red-600 bg-clip-text text-transparent",children:me("statistics")})]}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"flex items-center justify-between text-xs",children:[c.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[c.jsx(zr,{className:"w-3.5 h-3.5"}),c.jsx("span",{children:"Length"})]}),c.jsx("span",{className:"font-bold text-gray-900",children:r?`${r.length.toLocaleString()}`:"0"})]}),Bt&&c.jsxs("div",{className:"space-y-2 pt-2 border-t border-gray-200",children:[c.jsx("div",{className:"flex items-center justify-between text-xs",children:c.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[c.jsx(qA,{className:"w-3.5 h-3.5"}),c.jsx("span",{children:"Model"})]})}),c.jsxs("select",{value:A,onChange:O=>x(O.target.value),className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 bg-white",children:[c.jsx("option",{value:"gpt-4o-mini",children:"GPT-4o Mini "}),c.jsx("option",{value:"gpt-4o",children:"GPT-4o "}),c.jsx("option",{value:"gpt-4-turbo",children:"GPT-4 Turbo "}),c.jsx("option",{value:"gpt-4",children:"GPT-4 - Standard"}),c.jsx("option",{value:"gpt-3.5-turbo",children:"GPT-3.5 Turbo "})]})]}),c.jsxs("div",{className:"flex items-center justify-between text-xs",children:[c.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[c.jsx(gu,{className:"w-3.5 h-3.5"}),c.jsx("span",{children:"Est. Tokens"})]}),c.jsx("span",{className:"font-bold text-gray-900",children:Oi>1e3?`${(Oi/1e3).toFixed(1)}K`:Oi.toString()})]}),r&&c.jsxs("div",{className:"flex items-center justify-between text-xs",children:[c.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[c.jsx(ZA,{className:"w-3.5 h-3.5"}),c.jsx("span",{children:"Est. Cost"})]}),c.jsxs("span",{className:"font-bold text-green-600",children:["$",Oy<.01?"<0.01":Oy.toFixed(4)]})]}),r&&c.jsxs("div",{className:"flex items-center justify-between text-xs",children:[c.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[c.jsx(Rb,{className:"w-3.5 h-3.5"}),c.jsx("span",{children:"Words"})]}),c.jsx("span",{className:"font-bold text-gray-900",children:Rl.toLocaleString()})]}),r&&c.jsxs("div",{className:"flex items-center justify-between text-xs",children:[c.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[c.jsx(Z0,{className:"w-3.5 h-3.5"}),c.jsx("span",{children:"Lines"})]}),c.jsx("span",{className:"font-bold text-gray-900",children:Xd.toLocaleString()})]}),r&&c.jsxs("div",{className:"flex items-center justify-between text-xs",children:[c.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[c.jsx(Qs,{className:"w-3.5 h-3.5"}),c.jsx("span",{children:"Characters"})]}),c.jsx("span",{className:"font-bold text-gray-900",children:Sy.toLocaleString()})]}),r&&c.jsxs("div",{className:"flex items-center justify-between text-xs",children:[c.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[c.jsx(zr,{className:"w-3.5 h-3.5"}),c.jsx("span",{children:"File Size"})]}),c.jsxs("span",{className:"font-bold text-gray-900",children:[iN," KB"]})]}),r&&ky>0&&c.jsxs("div",{className:"flex items-center justify-between text-xs",children:[c.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[c.jsx(HA,{className:"w-3.5 h-3.5"}),c.jsx("span",{children:"Reading Time"})]}),c.jsxs("span",{className:"font-bold text-gray-900",children:["~",ky," min"]})]}),r&&c.jsxs("div",{className:"flex items-center justify-between text-xs",children:[c.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[c.jsx(iC,{className:"w-3.5 h-3.5"}),c.jsx("span",{children:"Avg Words/Line"})]}),c.jsx("span",{className:"font-bold text-gray-900",children:aN})]}),r&&Ey>0&&c.jsxs("div",{className:"flex items-center justify-between text-xs",children:[c.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[c.jsx(Th,{className:"w-3.5 h-3.5"}),c.jsx("span",{children:"Sections"})]}),c.jsx("span",{className:"font-bold text-gray-900",children:Ey})]}),r&&Ay>0&&c.jsxs("div",{className:"flex items-center justify-between text-xs",children:[c.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[c.jsx(Z0,{className:"w-3.5 h-3.5"}),c.jsx("span",{children:"Headers"})]}),c.jsx("span",{className:"font-bold text-gray-900",children:Ay})]}),r&&Ny>0&&c.jsxs("div",{className:"flex items-center justify-between text-xs",children:[c.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[c.jsx(Qs,{className:"w-3.5 h-3.5"}),c.jsx("span",{children:"Code Blocks"})]}),c.jsx("span",{className:"font-bold text-gray-900",children:Ny})]}),r&&Ty>0&&c.jsxs("div",{className:"flex items-center justify-between text-xs",children:[c.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[c.jsx(QA,{className:"w-3.5 h-3.5"}),c.jsx("span",{children:"Links"})]}),c.jsx("span",{className:"font-bold text-gray-900",children:Ty})]}),r&&c.jsxs("div",{className:"pt-2 border-t border-gray-200 space-y-1",children:[c.jsxs("div",{className:"flex items-center justify-between text-xs",children:[c.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[c.jsx(H0,{className:"w-3.5 h-3.5"}),c.jsx("span",{children:"Input Tokens"})]}),c.jsx("span",{className:"font-bold text-gray-900",children:jy.toLocaleString()})]}),c.jsxs("div",{className:"flex items-center justify-between text-xs",children:[c.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[c.jsx(H0,{className:"w-3.5 h-3.5"}),c.jsx("span",{children:"Output Tokens"})]}),c.jsx("span",{className:"font-bold text-gray-900",children:Ry.toLocaleString()})]})]}),y==="multi"&&g.length>0&&c.jsxs("div",{className:"flex items-center justify-between text-xs",children:[c.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[c.jsx(ws,{className:"w-3.5 h-3.5"}),c.jsx("span",{children:"Repositories"})]}),c.jsx("span",{className:"font-bold text-gray-900",children:g.length})]}),c.jsxs("div",{className:"flex items-center justify-between text-xs pt-2 border-t border-gray-200",children:[c.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[c.jsx(Qs,{className:"w-3.5 h-3.5"}),c.jsx("span",{children:"Source"})]}),c.jsx("span",{className:"font-bold text-gray-900",children:"GitHub"})]})]})]})]})})]}),c.jsx("div",{className:"mt-auto",children:c.jsx(Xp,{onNavigate:O=>{window.dispatchEvent(new CustomEvent("navigate",{detail:O}))}})}),ve&&c.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl border border-gray-200 max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[c.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 flex-shrink-0",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-2 bg-gradient-to-br from-red-500 to-orange-600 rounded-xl shadow-lg",children:c.jsx(Nt,{className:"w-6 h-6 text-white"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Agent Workflow"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Automated documentation generation pipeline"})]})]}),c.jsx("button",{onClick:()=>fe(!1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors","aria-label":me("close"),children:c.jsx(So,{className:"w-5 h-5 text-gray-600"})})]}),c.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:c.jsx(_F,{selectedRepos:Qd(),selectedOutputFormats:Qe,selectedSectionTypes:An,selectedLanguage:Ii,onReposChange:O=>{y==="single"?O.length>0&&n(O[0].htmlUrl):S(O)},onComplete:O=>{if(O.generatedDocs){const he=new Map;O.generatedDocs.forEach((at,Ve)=>{he.set(Ve,at)}),i(he),O.generatedDocsFull&&l(O.generatedDocsFull);const xe=Qd();xe.length>0&&(We(xe[0].fullName),jl(xe[0].fullName,u,h)),y==="single"&&xe.length>0&&S(xe)}fe(!1),q(!1)}})})]})}),N&&c.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:c.jsx(gC,{selectedRepos:g,onSelectionChange:S,onClose:()=>T(!1)})}),C&&c.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl border border-gray-200 p-6 max-w-md w-full",children:[c.jsxs("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:[me("commit")," ",me("documentation")]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:me("commitMessage")}),c.jsx("input",{type:"text",value:Pe,onChange:O=>He(O.target.value),placeholder:me("addDocumentation"),className:"w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:me("branch")}),c.jsx("input",{type:"text",value:tt,onChange:O=>gt(O.target.value),placeholder:"main",className:"w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all"})]}),c.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-3 text-sm text-gray-600",children:["This will commit ",c.jsx("code",{className:"bg-white px-1.5 py-0.5 rounded font-mono text-xs",children:"DOCUMENTATION.md"})," to"," ",g.length," repository",g.length!==1?"ies":"","."]})]}),c.jsxs("div",{className:"mt-6 flex gap-3 justify-end",children:[c.jsx("button",{onClick:()=>{Ne(!1),He("")},className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors font-medium",children:me("cancel")}),c.jsx("button",{onClick:rN,disabled:!Pe.trim()||m,className:"px-4 py-2 bg-gradient-to-r from-green-600 to-emerald-600 text-white rounded-lg hover:from-green-700 hover:to-emerald-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed font-medium shadow-md",children:me(m?"committing":"commit")})]})]})}),oe&&c.jsx("button",{onClick:nN,className:"fixed bottom-8 right-8 z-50 p-4 bg-gradient-to-r from-orange-600 to-red-600 text-white rounded-full shadow-2xl shadow-orange-500/50 hover:shadow-orange-500/70 transition-all duration-300 hover:scale-110 active:scale-95 group","aria-label":me("scrollToTop"),children:c.jsx(FA,{className:"w-6 h-6 group-hover:-translate-y-1 transition-transform duration-300"})})]})}function xF({pageType:t,onBack:e}){const[n,r]=V.useState(()=>localStorage.getItem("selectedLanguage")||"en");V.useEffect(()=>{const o=()=>{const u=localStorage.getItem("selectedLanguage");u&&r(u)};window.addEventListener("storage",o);const l=setInterval(o,100);return()=>{window.removeEventListener("storage",o),clearInterval(l)}},[]);const s=xa(n),i=(()=>{switch(t){case"github-integration":return{title:s("githubIntegration"),icon:c.jsx(_r,{className:"w-8 h-8"}),description:s("seamlesslyConnectWithGitHub"),content:c.jsxs("div",{className:"space-y-6",children:[c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:s("overview")}),c.jsxs("p",{className:"text-gray-700 leading-relaxed",children:[s("gitScribeIntegratesDirectly")," ",s("accessYourRepositories")," ",s("generateComprehensiveDocumentation"),".",s("whetherPublicOrPrivate"),", ",s("ourIntegrationMakesItEasy")," ",s("documentYourCodebase"),"."]})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:s("features")}),c.jsxs("ul",{className:"space-y-3",children:[c.jsxs("li",{className:"flex items-start gap-3",children:[c.jsx("div",{className:"p-1.5 bg-orange-100 rounded-lg mt-0.5",children:c.jsx(_r,{className:"w-5 h-5 text-orange-600"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-gray-900",children:s("repositoryAccess")}),c.jsxs("p",{className:"text-gray-600",children:[s("connectToAnyRepository")," ",s("usingPersonalAccessToken")]})]})]}),c.jsxs("li",{className:"flex items-start gap-3",children:[c.jsx("div",{className:"p-1.5 bg-blue-100 rounded-lg mt-0.5",children:c.jsx(ws,{className:"w-5 h-5 text-blue-600"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-gray-900",children:s("fileAnalysis")}),c.jsxs("p",{className:"text-gray-600",children:[s("automaticallyAnalyzeRepository")," ",s("repositoryStructure"),", ",s("codeFiles"),", ",s("configuration")]})]})]}),c.jsxs("li",{className:"flex items-start gap-3",children:[c.jsx("div",{className:"p-1.5 bg-blue-100 rounded-lg mt-0.5",children:c.jsx(Qs,{className:"w-5 h-5 text-blue-600"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-gray-900",children:s("codeUnderstanding")}),c.jsxs("p",{className:"text-gray-600",children:[s("aiPoweredAnalysisOfCodebase")," ",s("generateAccurateDocumentation")]})]})]})]})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:s("gettingStarted")}),c.jsxs("div",{className:"bg-gray-50 rounded-lg p-6 space-y-4",children:[c.jsxs("div",{children:[c.jsxs("h3",{className:"font-semibold text-gray-900 mb-2",children:["1. ",s("createGitHubToken")]}),c.jsxs("p",{className:"text-gray-600 mb-2",children:[s("goToGitHubSettings"),"  ",s("developerSettings"),"  ",s("personalAccessTokens"),"  ",s("tokensClassic")]}),c.jsxs("p",{className:"text-sm text-gray-500 mb-2",children:[s("requiredScopes"),": ",c.jsx("code",{className:"bg-gray-200 px-2 py-1 rounded",children:"repo"})," (",s("forPrivateRepos"),")"]}),c.jsx("p",{className:"text-sm text-gray-500",children:s("forPublicRepos")})]}),c.jsxs("div",{children:[c.jsxs("h3",{className:"font-semibold text-gray-900 mb-2",children:["2. ",s("addTokenToGitScribe")]}),c.jsxs("p",{className:"text-gray-600",children:[s("enterYourToken")," ",s("githubTokenField")," ",s("documentationEditorSettings"),". ",s("clickSaveChanges")," ",s("persistIt"),"."]})]}),c.jsxs("div",{children:[c.jsxs("h3",{className:"font-semibold text-gray-900 mb-2",children:["3. ",s("startGenerating")]}),c.jsxs("p",{className:"text-gray-600 mb-2",children:[s("enterRepositoryUrl")," (",s("egOwnerRepo"),", ",c.jsx("code",{className:"bg-gray-200 px-2 py-1 rounded",children:s("ownerRepoPlaceholder")}),") ",s("selectMultipleRepositories")]}),c.jsxs("p",{className:"text-gray-600",children:[s("chooseOutputFormats")," ",s("thenClickRunWorkflow")," ",s("startAiAgentWorkflow")]})]})]})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:s("supportedFormats")}),c.jsxs("p",{className:"text-gray-700 mb-3",children:[s("youCanUseAnyOfTheseFormats")," ",s("toSpecifyRepository"),":"]}),c.jsxs("ul",{className:"list-disc list-inside space-y-2 text-gray-700 ml-4",children:[c.jsx("li",{children:c.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded",children:"https://github.com/owner/repo"})}),c.jsx("li",{children:c.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded",children:"github.com/owner/repo"})}),c.jsx("li",{children:c.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded",children:"owner/repo"})})]})]})]})};case"multi-repo-support":return{title:"Multi-Repository Support",icon:c.jsx(ws,{className:"w-8 h-8"}),description:"Generate documentation for multiple repositories simultaneously",content:c.jsxs("div",{className:"space-y-6",children:[c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Overview"}),c.jsx("p",{className:"text-gray-700 leading-relaxed",children:"GitScribe's multi-repository support allows you to process multiple GitHub repositories at once, saving time and effort when documenting multiple projects."})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Key Features"}),c.jsxs("ul",{className:"space-y-3",children:[c.jsxs("li",{className:"flex items-start gap-3",children:[c.jsx("div",{className:"p-1.5 bg-red-100 rounded-lg mt-0.5",children:c.jsx(ws,{className:"w-5 h-5 text-red-600"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-gray-900",children:"Batch Processing"}),c.jsx("p",{className:"text-gray-600",children:"Select and process multiple repositories in a single operation"})]})]}),c.jsxs("li",{className:"flex items-start gap-3",children:[c.jsx("div",{className:"p-1.5 bg-red-100 rounded-lg mt-0.5",children:c.jsx(Nt,{className:"w-5 h-5 text-red-600"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-gray-900",children:"Individual Documentation"}),c.jsx("p",{className:"text-gray-600",children:"Each repository gets its own dedicated documentation file"})]})]}),c.jsxs("li",{className:"flex items-start gap-3",children:[c.jsx("div",{className:"p-1.5 bg-red-100 rounded-lg mt-0.5",children:c.jsx(Yo,{className:"w-5 h-5 text-red-600"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-gray-900",children:"Batch Commit"}),c.jsx("p",{className:"text-gray-600",children:"Commit documentation to all selected repositories with one click"})]})]})]})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"How to Use"}),c.jsxs("div",{className:"bg-gray-50 rounded-lg p-6 space-y-4",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"1. Select Multiple Repositories"}),c.jsx("p",{className:"text-gray-600",children:'Click "Select repositories" button to browse and select from your GitHub repositories. You can search and filter by visibility.'})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"2. Choose Output Formats & Sections"}),c.jsx("p",{className:"text-gray-600",children:"Select one or more output formats (Markdown, MDX, OpenAPI, HTML) and documentation section types (README, Architecture, API, etc.)"})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"3. Run Workflow"}),c.jsx("p",{className:"text-gray-600",children:'Click "Run Workflow" to start the AI agent workflow. The system will process each repository through discovery, analysis, planning, and writing stages.'})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"4. Review & Commit"}),c.jsx("p",{className:"text-gray-600",children:'Review documentation in separate tabs for each repository. Switch between formats and sections. When ready, click "Commit to Repos" to commit all at once.'})]})]})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Benefits"}),c.jsxs("ul",{className:"list-disc list-inside space-y-2 text-gray-700 ml-4",children:[c.jsx("li",{children:"Save time by processing multiple repositories simultaneously"}),c.jsx("li",{children:"Maintain consistent documentation format across projects"}),c.jsx("li",{children:"Easy management with tabbed interface for each repository"}),c.jsx("li",{children:"Batch commit functionality for efficient workflow"})]})]})]})};case"ai-powered-generation":return{title:s("aiPoweredGenerationTitle"),icon:c.jsx(Nt,{className:"w-8 h-8"}),description:s("aiPoweredGenerationDescription"),content:c.jsxs("div",{className:"space-y-6",children:[c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Overview"}),c.jsx("p",{className:"text-gray-700 leading-relaxed",children:"GitScribe uses OpenAI's advanced language models to analyze your codebase and generate comprehensive, well-structured documentation. Our AI understands code context, relationships, and best practices to create documentation that's both accurate and readable."})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:s("aiModels")}),c.jsxs("p",{className:"text-gray-700 mb-4",children:[s("gitScribeSupportsMultipleModels"),". ",s("chooseBasedOnNeeds")," ",s("speedCostQuality"),":"]}),c.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[c.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-red-50 rounded-lg p-4 border border-orange-200",children:[c.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:s("gpt4oMiniRecommended")}),c.jsx("p",{className:"text-sm text-gray-600 mb-2",children:s("fastAndCostEffective")}),c.jsx("p",{className:"text-xs text-gray-500",children:s("bestBalanceSpeedQuality")})]}),c.jsxs("div",{className:"bg-gradient-to-br from-red-50 to-pink-50 rounded-lg p-4 border border-red-200",children:[c.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:s("gpt4o")}),c.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:[s("mostAdvancedModel")," ",s("complexCodebases")]}),c.jsx("p",{className:"text-xs text-gray-500",children:s("highestQualityHigherCost")})]}),c.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 rounded-lg p-4 border border-green-200",children:[c.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:s("gpt4Turbo")}),c.jsx("p",{className:"text-sm text-gray-600 mb-2",children:s("balancedPerformanceAccuracy")}),c.jsx("p",{className:"text-xs text-gray-500",children:s("goodForLargeRepos")})]}),c.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-red-50 rounded-lg p-4 border border-orange-200",children:[c.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:s("gpt35Turbo")}),c.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:[s("fastAndEconomical")," ",s("simpleProjects")]}),c.jsx("p",{className:"text-xs text-gray-500",children:s("lowestCostOption")})]})]}),c.jsxs("p",{className:"text-gray-600 mt-4 text-sm",children:[s("youCanChangeModel")," ",s("settingsPanel"),". ",s("realtimeCostEstimation")," ",s("statisticsSidebar"),"."]})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:s("aiAssistant")}),c.jsxs("p",{className:"text-gray-700 mb-4",children:[s("aiAssistantFeature")," ",s("interactivelyEditImprove"),":"]}),c.jsxs("ul",{className:"space-y-2 text-gray-700 ml-4",children:[c.jsxs("li",{className:"flex items-start gap-2",children:[c.jsx("span",{className:"text-orange-600 mt-1",children:""}),c.jsx("span",{children:s("rewriteSectionsForClarity")})]}),c.jsxs("li",{className:"flex items-start gap-2",children:[c.jsx("span",{className:"text-orange-600 mt-1",children:""}),c.jsx("span",{children:s("fixGrammarSpellingErrors")})]}),c.jsxs("li",{className:"flex items-start gap-2",children:[c.jsx("span",{className:"text-orange-600 mt-1",children:""}),c.jsx("span",{children:s("addRemoveContentBasedOnNeeds")})]}),c.jsxs("li",{className:"flex items-start gap-2",children:[c.jsx("span",{className:"text-orange-600 mt-1",children:""}),c.jsx("span",{children:s("restructureDocumentation")})]}),c.jsxs("li",{className:"flex items-start gap-2",children:[c.jsx("span",{className:"text-orange-600 mt-1",children:""}),c.jsx("span",{children:s("formatTextImproveReadability")})]})]})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:s("costEstimation")}),c.jsxs("p",{className:"text-gray-700 mb-3",children:[s("gitScribeProvidesRealtime")," ",s("basedOn"),":"]}),c.jsxs("ul",{className:"list-disc list-inside space-y-2 text-gray-700 ml-4",children:[c.jsx("li",{children:s("selectedAiModelPricing")}),c.jsx("li",{children:s("estimatedTokenUsage")}),c.jsx("li",{children:s("documentationLengthComplexity")})]}),c.jsxs("p",{className:"text-gray-600 mt-4 text-sm",children:[s("costsDisplayedInStatistics")," ",s("statisticsSidebar")," ",s("duringGeneration"),"."]})]})]})};case"export-commit":return{title:s("exportCommitTitle"),icon:c.jsx(bo,{className:"w-8 h-8"}),description:s("exportCommitDescription"),content:c.jsxs("div",{className:"space-y-6",children:[c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Export Documentation"}),c.jsx("p",{className:"text-gray-700 leading-relaxed mb-4",children:"Download your generated documentation in multiple formats for use in documentation sites, wikis, or version control systems."}),c.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[c.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Export Formats"}),c.jsxs("ul",{className:"space-y-2 text-gray-700",children:[c.jsxs("li",{className:"flex items-start gap-2",children:[c.jsx("span",{className:"text-orange-600 mt-1",children:""}),c.jsxs("span",{children:[c.jsx("strong",{children:"Markdown"})," - Standard .md format for GitHub, GitLab, and documentation sites"]})]}),c.jsxs("li",{className:"flex items-start gap-2",children:[c.jsx("span",{className:"text-orange-600 mt-1",children:""}),c.jsxs("span",{children:[c.jsx("strong",{children:"Markdown + Mermaid"})," - Markdown with AI-generated diagrams"]})]}),c.jsxs("li",{className:"flex items-start gap-2",children:[c.jsx("span",{className:"text-orange-600 mt-1",children:""}),c.jsxs("span",{children:[c.jsx("strong",{children:"MDX"})," - Markdown with JSX components for interactive docs"]})]}),c.jsxs("li",{className:"flex items-start gap-2",children:[c.jsx("span",{className:"text-orange-600 mt-1",children:""}),c.jsxs("span",{children:[c.jsx("strong",{children:"OpenAPI"})," - YAML format for API documentation"]})]}),c.jsxs("li",{className:"flex items-start gap-2",children:[c.jsx("span",{className:"text-orange-600 mt-1",children:""}),c.jsxs("span",{children:[c.jsx("strong",{children:"HTML"})," - Fully styled HTML pages ready for deployment"]})]})]}),c.jsx("p",{className:"text-gray-600 mt-4 text-sm",children:"Each format is generated with section-specific content tailored to the selected section types."})]})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Commit to Repository"}),c.jsx("p",{className:"text-gray-700 leading-relaxed mb-4",children:"Automatically commit generated documentation directly to your GitHub repositories. Perfect for keeping documentation in sync with your codebase."}),c.jsxs("div",{className:"bg-gray-50 rounded-lg p-6 space-y-4",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"How It Works"}),c.jsxs("ol",{className:"list-decimal list-inside space-y-2 text-gray-700 ml-2",children:[c.jsx("li",{children:"Run the workflow to generate documentation for your repository(ies)"}),c.jsx("li",{children:"Review the generated documentation in the viewer"}),c.jsx("li",{children:'Click "Commit to Repos" button (appears after workflow completes)'}),c.jsx("li",{children:'Enter a commit message (e.g., "docs: Add comprehensive documentation")'}),c.jsx("li",{children:"Specify the target branch (default: main)"}),c.jsx("li",{children:"Documentation is committed with the selected format and section types"})]}),c.jsxs("p",{className:"text-gray-600 mt-3 text-sm",children:[c.jsx("strong",{children:"Note:"})," The workflow stops after generation, allowing you to review before committing. This ensures you have control over what gets committed to your repositories."]})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Multi-Repository Support"}),c.jsx("p",{className:"text-gray-700 mb-2",children:"When working with multiple repositories, each repository receives its own dedicated documentation files based on your selected formats and sections. The commit operation processes all selected repositories in batch."}),c.jsx("p",{className:"text-gray-600 text-sm",children:"Each repository's documentation is stored separately and committed to the correct repository."})]})]})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Auto-Update Feature"}),c.jsx("p",{className:"text-gray-700 leading-relaxed mb-4",children:"Enable auto-update to automatically regenerate and commit documentation when your repository receives new commits or merges to the main branch."}),c.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-6",children:[c.jsxs("h3",{className:"font-semibold text-gray-900 mb-2 flex items-center gap-2",children:[c.jsx("span",{className:"text-green-600",children:""}),"Automatic Updates"]}),c.jsxs("ul",{className:"space-y-2 text-gray-700",children:[c.jsx("li",{children:" Monitors repositories every 5 minutes"}),c.jsx("li",{children:" Detects pushes and merges to main branch"}),c.jsx("li",{children:" Automatically regenerates documentation"}),c.jsx("li",{children:" Commits updated documentation with timestamp"})]})]})]})]})};case"documentation-page":return{title:s("documentationTitle"),icon:c.jsx(Rb,{className:"w-8 h-8"}),description:"Complete guide to using GitScribe",content:c.jsxs("div",{className:"space-y-6",children:[c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Getting Started"}),c.jsx("p",{className:"text-gray-700 leading-relaxed mb-4",children:"Welcome to GitScribe! An AI-powered documentation generation tool that automatically creates comprehensive documentation for your GitHub repositories using advanced AI agent workflows."}),c.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-6",children:[c.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Quick Start"}),c.jsxs("ol",{className:"list-decimal list-inside space-y-2 text-gray-700 ml-2",children:[c.jsx("li",{children:"Add your OpenAI API key in the settings"}),c.jsx("li",{children:"(Optional) Add a GitHub Personal Access Token for private repos"}),c.jsx("li",{children:"Enter a GitHub repository URL or select multiple repositories"}),c.jsx("li",{children:"Choose output formats (Markdown, MDX, OpenAPI, HTML) and section types"}),c.jsx("li",{children:'Click "Run Workflow" to start the AI agent workflow'}),c.jsx("li",{children:"Review generated documentation, edit with AI Assistant, and commit"})]})]})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Core Features"}),c.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[c.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[c.jsxs("h3",{className:"font-semibold text-gray-900 mb-2 flex items-center gap-2",children:[c.jsx(_r,{className:"w-5 h-5 text-orange-600"}),"GitHub Integration"]}),c.jsx("p",{className:"text-sm text-gray-600",children:"Direct integration with GitHub API for repository access and commits"})]}),c.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[c.jsxs("h3",{className:"font-semibold text-gray-900 mb-2 flex items-center gap-2",children:[c.jsx(ws,{className:"w-5 h-5 text-orange-600"}),"Multi-Repo Support"]}),c.jsx("p",{className:"text-sm text-gray-600",children:"Process multiple repositories simultaneously with batch operations"})]}),c.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[c.jsxs("h3",{className:"font-semibold text-gray-900 mb-2 flex items-center gap-2",children:[c.jsx(Nt,{className:"w-5 h-5 text-orange-600"}),"AI Agent Workflows"]}),c.jsx("p",{className:"text-sm text-gray-600",children:"Intelligent agent system for automated documentation generation"})]}),c.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[c.jsxs("h3",{className:"font-semibold text-gray-900 mb-2 flex items-center gap-2",children:[c.jsx(Yo,{className:"w-5 h-5 text-orange-600"}),"Export & Commit"]}),c.jsx("p",{className:"text-sm text-gray-600",children:"Multiple output formats and direct GitHub commits"})]})]})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Output Formats"}),c.jsx("p",{className:"text-gray-700 mb-4",children:"GitScribe supports multiple documentation formats to suit different needs:"}),c.jsxs("div",{className:"grid md:grid-cols-2 gap-3",children:[c.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[c.jsx("h4",{className:"font-semibold text-gray-900",children:"Markdown"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Standard markdown format for GitHub, GitLab, and documentation sites"})]}),c.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[c.jsx("h4",{className:"font-semibold text-gray-900",children:"Markdown + Mermaid"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Markdown with AI-generated Mermaid diagrams for architecture and flows"})]}),c.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[c.jsx("h4",{className:"font-semibold text-gray-900",children:"MDX"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Markdown with JSX components for interactive documentation"})]}),c.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[c.jsx("h4",{className:"font-semibold text-gray-900",children:"OpenAPI"}),c.jsx("p",{className:"text-sm text-gray-600",children:"YAML format for API documentation with endpoint specifications"})]}),c.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[c.jsx("h4",{className:"font-semibold text-gray-900",children:"HTML"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Fully styled HTML pages ready for deployment"})]})]})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Documentation Sections"}),c.jsx("p",{className:"text-gray-700 mb-4",children:"Generate different types of documentation sections:"}),c.jsxs("ul",{className:"space-y-2 text-gray-700",children:[c.jsxs("li",{className:"flex items-start gap-2",children:[c.jsx("span",{className:"text-orange-600 mt-1",children:""}),c.jsxs("span",{children:[c.jsx("strong",{children:"README"})," - Project overview, installation, usage, and features"]})]}),c.jsxs("li",{className:"flex items-start gap-2",children:[c.jsx("span",{className:"text-orange-600 mt-1",children:""}),c.jsxs("span",{children:[c.jsx("strong",{children:"Architecture"})," - System design, component structure, and data flow"]})]}),c.jsxs("li",{className:"flex items-start gap-2",children:[c.jsx("span",{className:"text-orange-600 mt-1",children:""}),c.jsxs("span",{children:[c.jsx("strong",{children:"API Reference"})," - Endpoint documentation, request/response schemas"]})]}),c.jsxs("li",{className:"flex items-start gap-2",children:[c.jsx("span",{className:"text-orange-600 mt-1",children:""}),c.jsxs("span",{children:[c.jsx("strong",{children:"Components"})," - Component documentation with props and usage examples"]})]}),c.jsxs("li",{className:"flex items-start gap-2",children:[c.jsx("span",{className:"text-orange-600 mt-1",children:""}),c.jsxs("span",{children:[c.jsx("strong",{children:"Testing & CI/CD"})," - Test setup, CI/CD pipeline, and deployment"]})]}),c.jsxs("li",{className:"flex items-start gap-2",children:[c.jsx("span",{className:"text-orange-600 mt-1",children:""}),c.jsxs("span",{children:[c.jsx("strong",{children:"Changelog"})," - Version history and release notes"]})]})]})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"AI Agent Workflow"}),c.jsx("p",{className:"text-gray-700 mb-4",children:"GitScribe uses an intelligent agent system that processes repositories through multiple stages:"}),c.jsx("div",{className:"bg-gradient-to-br from-orange-50 to-red-50 rounded-lg p-6 border border-orange-200",children:c.jsxs("ol",{className:"space-y-3",children:[c.jsxs("li",{className:"flex items-start gap-3",children:[c.jsx("span",{className:"font-bold text-orange-600",children:"1. RepoDiscovery"}),c.jsx("span",{className:"text-gray-700",children:"- Validates and discovers repositories"})]}),c.jsxs("li",{className:"flex items-start gap-3",children:[c.jsx("span",{className:"font-bold text-orange-600",children:"2. RepoAnalysis"}),c.jsx("span",{className:"text-gray-700",children:"- Analyzes structure, tech stack, and complexity"})]}),c.jsxs("li",{className:"flex items-start gap-3",children:[c.jsx("span",{className:"font-bold text-orange-600",children:"3. DocsPlanner"}),c.jsx("span",{className:"text-gray-700",children:"- Creates structured documentation plan"})]}),c.jsxs("li",{className:"flex items-start gap-3",children:[c.jsx("span",{className:"font-bold text-orange-600",children:"4. DocsWriter"}),c.jsx("span",{className:"text-gray-700",children:"- Generates documentation in selected formats"})]}),c.jsxs("li",{className:"flex items-start gap-3",children:[c.jsx("span",{className:"font-bold text-orange-600",children:"5. GitOps"}),c.jsx("span",{className:"text-gray-700",children:"- Commits documentation to repositories"})]})]})})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Learn More"}),c.jsx("p",{className:"text-gray-700",children:"Explore the other pages in this documentation section for detailed information about each feature and how to use them effectively."})]})]})};case"api-reference":return{title:s("apiReferenceTitle"),icon:c.jsx(Qs,{className:"w-8 h-8"}),description:"Complete API documentation for developers",content:c.jsxs("div",{className:"space-y-6",children:[c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Agent Workflow System"}),c.jsx("p",{className:"text-gray-700 mb-4",children:"GitScribe uses a LangGraph-style agent system for automated documentation generation:"}),c.jsx("div",{className:"bg-gray-900 text-gray-100 rounded-lg p-6 overflow-x-auto mb-4",children:c.jsx("pre",{className:"text-sm",children:`// Agent Workflow Steps
1. RepoDiscovery - Validates and discovers repositories
2. RepoAnalysis - Analyzes structure, tech stack, complexity
3. DocsPlanner - Creates structured documentation plan
4. DocsWriter - Generates documentation in selected formats
5. GitOps - Commits documentation to repositories`})}),c.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[c.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Agent State"}),c.jsx("p",{className:"text-gray-700 text-sm mb-2",children:"The workflow maintains shared state between agents, including:"}),c.jsxs("ul",{className:"list-disc list-inside space-y-1 text-gray-700 text-sm ml-2",children:[c.jsx("li",{children:"Discovered repositories"}),c.jsx("li",{children:"Repository analyses"}),c.jsx("li",{children:"Documentation plans"}),c.jsx("li",{children:"Generated documentation (by format and section)"}),c.jsx("li",{children:"Commit results"})]})]})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"GitHub Service"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"fetchUserRepos"}),c.jsx("div",{className:"bg-gray-900 text-gray-100 rounded-lg p-4 overflow-x-auto",children:c.jsx("pre",{className:"text-sm",children:`fetchUserRepos(options?: {
  visibility?: 'all' | 'public' | 'private';
  perPage?: number;
  page?: number;
}): Promise<SimpleRepo[]>`})})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"createOrUpdateFile"}),c.jsx("div",{className:"bg-gray-900 text-gray-100 rounded-lg p-4 overflow-x-auto",children:c.jsx("pre",{className:"text-sm",children:`createOrUpdateFile(
  owner: string,
  repo: string,
  path: string,
  content: string,
  message: string,
  branch?: string
): Promise<CommitResponse>`})})]})]})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"LangChain Service"}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"callLangChain"}),c.jsx("div",{className:"bg-gray-900 text-gray-100 rounded-lg p-4 overflow-x-auto",children:c.jsx("pre",{className:"text-sm",children:`callLangChain(
  prompt: string,
  systemPrompt?: string,
  model?: string,
  temperature?: number
): Promise<string>`})})]})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Type Definitions"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[c.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"SimpleRepo"}),c.jsx("div",{className:"bg-gray-900 text-gray-100 rounded-lg p-4 overflow-x-auto",children:c.jsx("pre",{className:"text-sm",children:`type SimpleRepo = {
  id: number;
  name: string;
  fullName: string;
  owner: string;
  private: boolean;
  htmlUrl: string;
  description?: string;
  defaultBranch: string;
}`})})]}),c.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[c.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"DocOutputFormat"}),c.jsx("div",{className:"bg-gray-900 text-gray-100 rounded-lg p-4 overflow-x-auto",children:c.jsx("pre",{className:"text-sm",children:`type DocOutputFormat = 
  | 'markdown'
  | 'markdown_mermaid'
  | 'mdx'
  | 'openapi'
  | 'html';`})})]}),c.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[c.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"DocSectionType"}),c.jsx("div",{className:"bg-gray-900 text-gray-100 rounded-lg p-4 overflow-x-auto",children:c.jsx("pre",{className:"text-sm",children:`type DocSectionType = 
  | 'README'
  | 'ARCHITECTURE'
  | 'API'
  | 'COMPONENTS'
  | 'TESTING_CI'
  | 'CHANGELOG';`})})]})]})]})]})};case"examples":return{title:s("examplesTitle"),icon:c.jsx(YA,{className:"w-8 h-8"}),description:"Example use cases and workflows",content:c.jsxs("div",{className:"space-y-6",children:[c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Example 1: Single Repository"}),c.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[c.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Scenario"}),c.jsx("p",{className:"text-gray-700 mb-4",children:"You want to generate comprehensive documentation for a single React project with multiple formats."}),c.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Steps"}),c.jsxs("ol",{className:"list-decimal list-inside space-y-2 text-gray-700 ml-2",children:[c.jsxs("li",{children:["Enter GitHub repository URL: ",c.jsx("code",{className:"bg-gray-200 px-2 py-1 rounded",children:"facebook/react"})]}),c.jsx("li",{children:"Select output formats (e.g., Markdown, MDX, HTML)"}),c.jsx("li",{children:"Select section types (e.g., README, Architecture, API)"}),c.jsx("li",{children:'Click "Run Workflow" to start the AI agent workflow'}),c.jsx("li",{children:"Watch the workflow progress through discovery, analysis, planning, and writing"}),c.jsx("li",{children:"Review generated documentation, switch between formats and sections"}),c.jsx("li",{children:'Click "Commit to Repos" when ready to commit'})]})]})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Example 2: Multiple Repositories"}),c.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[c.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Scenario"}),c.jsx("p",{className:"text-gray-700 mb-4",children:"You manage multiple microservices and want to document them all at once with consistent formatting."}),c.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Steps"}),c.jsxs("ol",{className:"list-decimal list-inside space-y-2 text-gray-700 ml-2",children:[c.jsx("li",{children:'Click "Select repositories" and choose multiple repos from your GitHub account'}),c.jsx("li",{children:"Select output formats (e.g., Markdown + OpenAPI for API docs)"}),c.jsx("li",{children:"Select section types (e.g., README, API, Architecture)"}),c.jsx("li",{children:'Click "Run Workflow" to process all repositories'}),c.jsx("li",{children:"Monitor workflow progress for each repository"}),c.jsx("li",{children:"Review each repository's documentation in separate tabs"}),c.jsx("li",{children:"Switch between formats and sections for each repo"}),c.jsx("li",{children:'Commit all repositories at once with "Commit to Repos"'})]})]})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Example 3: Auto-Update Workflow"}),c.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[c.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Scenario"}),c.jsx("p",{className:"text-gray-700 mb-4",children:"You want documentation to automatically update when code changes."}),c.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Steps"}),c.jsxs("ol",{className:"list-decimal list-inside space-y-2 text-gray-700 ml-2",children:[c.jsx("li",{children:"Select repositories in multi-repo mode"}),c.jsx("li",{children:"Enable auto-update for each repository (bell icon)"}),c.jsx("li",{children:"Toggle global auto-update switch"}),c.jsx("li",{children:"Documentation will auto-update on every push/merge to main"})]})]})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Example 4: Using AI Assistant"}),c.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[c.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Scenario"}),c.jsx("p",{className:"text-gray-700 mb-4",children:"You want to improve the generated documentation with AI help."}),c.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Example Prompts"}),c.jsxs("ul",{className:"space-y-2 text-gray-700",children:[c.jsxs("li",{className:"flex items-start gap-2",children:[c.jsx("span",{className:"text-orange-600 mt-1",children:""}),c.jsx("span",{children:'"Add a section explaining the installation process"'})]}),c.jsxs("li",{className:"flex items-start gap-2",children:[c.jsx("span",{className:"text-orange-600 mt-1",children:""}),c.jsx("span",{children:'"Make the API documentation section more detailed"'})]}),c.jsxs("li",{className:"flex items-start gap-2",children:[c.jsx("span",{className:"text-orange-600 mt-1",children:""}),c.jsx("span",{children:'"Fix all grammar errors"'})]}),c.jsxs("li",{className:"flex items-start gap-2",children:[c.jsx("span",{className:"text-orange-600 mt-1",children:""}),c.jsx("span",{children:'"Restructure the documentation for better flow"'})]})]})]})]})]})};case"support":return{title:s("supportTitle"),icon:c.jsx(JA,{className:"w-8 h-8"}),description:"Get help and support for GitScribe",content:c.jsxs("div",{className:"space-y-6",children:[c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Need Help?"}),c.jsx("p",{className:"text-gray-700 leading-relaxed mb-4",children:"We're here to help! If you're experiencing issues or have questions about GitScribe, here are the best ways to get support."})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Contact Options"}),c.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[c.jsxs("div",{className:"border border-gray-200 rounded-lg p-6",children:[c.jsxs("h3",{className:"font-semibold text-gray-900 mb-2 flex items-center gap-2",children:[c.jsx(Ob,{className:"w-5 h-5 text-orange-600"}),"Email Support"]}),c.jsx("p",{className:"text-gray-600 mb-3",children:"Get direct help via email"}),c.jsx("a",{href:"mailto:support@GitScribe.com",className:"text-orange-600 hover:text-orange-700 font-medium",children:"support@GitScribe.com"})]}),c.jsxs("div",{className:"border border-gray-200 rounded-lg p-6",children:[c.jsxs("h3",{className:"font-semibold text-gray-900 mb-2 flex items-center gap-2",children:[c.jsx(_r,{className:"w-5 h-5 text-orange-600"}),"GitHub Issues"]}),c.jsx("p",{className:"text-gray-600 mb-3",children:"Report bugs or request features"}),c.jsx("a",{href:"https://github.com",target:"_blank",rel:"noopener noreferrer",className:"text-orange-600 hover:text-orange-700 font-medium",children:"Open an issue"})]})]})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Common Issues"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[c.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"OpenAI API Key Error"}),c.jsx("p",{className:"text-gray-700 text-sm mb-2",children:'Add your OpenAI API key in the Settings panel. Click the Settings icon, enter your key, and click "Save Changes".'}),c.jsx("p",{className:"text-gray-600 text-xs"})]}),c.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[c.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"GitHub Rate Limiting"}),c.jsx("p",{className:"text-gray-700 text-sm mb-2",children:"Add a GitHub Personal Access Token in the Settings panel to increase rate limits and access private repositories."}),c.jsxs("p",{className:"text-gray-600 text-xs",children:["Required scope: ",c.jsx("code",{className:"bg-gray-200 px-2 py-1 rounded",children:"repo"})," (for private repos and commits)"]})]}),c.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[c.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Workflow Not Starting"}),c.jsx("p",{className:"text-gray-700 text-sm",children:'Ensure you have selected at least one output format and one section type. The "Run Workflow" button requires both to be enabled.'})]}),c.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[c.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Documentation Not Committing"}),c.jsxs("p",{className:"text-gray-700 text-sm",children:["Make sure your GitHub token has the ",c.jsx("code",{className:"bg-gray-200 px-2 py-1 rounded",children:"repo"})," scope and you have write access to the repository."]})]})]})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Documentation"}),c.jsx("p",{className:"text-gray-700",children:"Check out our comprehensive documentation for detailed guides and API references."})]})]})};case"privacy-policy":return{title:s("privacyPolicyTitle"),icon:c.jsx(aC,{className:"w-8 h-8"}),description:"How we protect and handle your data",content:c.jsxs("div",{className:"space-y-6",children:[c.jsxs("section",{children:[c.jsxs("p",{className:"text-sm text-gray-500 mb-6",children:["Last updated: ",new Date().toLocaleDateString()]}),c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Introduction"}),c.jsx("p",{className:"text-gray-700 leading-relaxed",children:'GitScribe ("we", "our", or "us") is committed to protecting your privacy. This Privacy Policy explains how we collect, use, and safeguard your information when you use our service.'})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Information We Collect"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Personal Information"}),c.jsx("p",{className:"text-gray-700",children:"We may collect personal information such as email addresses when you create an account or contact us for support."})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"GitHub Tokens"}),c.jsx("p",{className:"text-gray-700",children:"GitHub Personal Access Tokens are stored locally in your browser's localStorage. We do not transmit or store these tokens on our servers."})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Usage Data"}),c.jsx("p",{className:"text-gray-700",children:"We may collect information about how you use our service, including repository URLs and documentation generation preferences."})]})]})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"How We Use Your Information"}),c.jsxs("ul",{className:"list-disc list-inside space-y-2 text-gray-700 ml-4",children:[c.jsx("li",{children:"To provide and improve our documentation generation service"}),c.jsx("li",{children:"To process your requests and generate documentation"}),c.jsx("li",{children:"To communicate with you about your account or support requests"}),c.jsx("li",{children:"To analyze usage patterns and improve our service"})]})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Data Security"}),c.jsx("p",{className:"text-gray-700 leading-relaxed",children:"We implement appropriate security measures to protect your information. GitHub tokens are stored locally in your browser and never transmitted to our servers. All API communications are encrypted using HTTPS."})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Third-Party Services"}),c.jsx("p",{className:"text-gray-700 leading-relaxed mb-3",children:"We use the following third-party services:"}),c.jsxs("ul",{className:"list-disc list-inside space-y-2 text-gray-700 ml-4",children:[c.jsxs("li",{children:[c.jsx("strong",{children:"OpenAI:"})," For AI-powered documentation generation using GPT models"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"GitHub:"})," For repository access, file operations, and commits via GitHub API"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"LocalStorage:"})," For storing user preferences, tokens, and project history locally in your browser"]})]}),c.jsx("p",{className:"text-gray-600 mt-4 text-sm",children:"All data is stored locally in your browser. GitHub tokens and API keys are never transmitted to our servers."})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Your Rights"}),c.jsx("p",{className:"text-gray-700 leading-relaxed",children:"You have the right to access, update, or delete your personal information. You can manage your account settings or contact us at support@GitScribe.com."})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Contact Us"}),c.jsxs("p",{className:"text-gray-700",children:["If you have questions about this Privacy Policy, please contact us at"," ",c.jsx("a",{href:"mailto:privacy@GitScribe.com",className:"text-orange-600 hover:text-orange-700",children:"privacy@GitScribe.com"})]})]})]})};case"terms-of-service":return{title:s("termsOfServiceTitle"),icon:c.jsx(zr,{className:"w-8 h-8"}),description:"Terms and conditions for using GitScribe",content:c.jsxs("div",{className:"space-y-6",children:[c.jsxs("section",{children:[c.jsxs("p",{className:"text-sm text-gray-500 mb-6",children:["Last updated: ",new Date().toLocaleDateString()]}),c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Agreement to Terms"}),c.jsx("p",{className:"text-gray-700 leading-relaxed",children:'By accessing or using GitScribe ("the Service"), you agree to be bound by these Terms of Service. If you disagree with any part of these terms, you may not access the Service.'})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Use of Service"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Eligibility"}),c.jsx("p",{className:"text-gray-700",children:"You must be at least 18 years old or have parental consent to use this Service."})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Account Responsibility"}),c.jsx("p",{className:"text-gray-700",children:"You are responsible for maintaining the security of your account and any API keys or tokens you use with the Service."})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Acceptable Use"}),c.jsx("p",{className:"text-gray-700 mb-2",children:"You agree not to:"}),c.jsxs("ul",{className:"list-disc list-inside space-y-1 text-gray-700 ml-4",children:[c.jsx("li",{children:"Use the Service for any illegal purpose"}),c.jsx("li",{children:"Violate any laws or regulations"}),c.jsx("li",{children:"Infringe on intellectual property rights"}),c.jsx("li",{children:"Transmit malicious code or viruses"}),c.jsx("li",{children:"Attempt to gain unauthorized access to the Service"})]})]})]})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"API Usage and Costs"}),c.jsx("p",{className:"text-gray-700 leading-relaxed",children:"GitScribe uses OpenAI's API for AI-powered features. You are responsible for:"}),c.jsxs("ul",{className:"list-disc list-inside space-y-2 text-gray-700 ml-4 mt-3",children:[c.jsx("li",{children:"Providing your own OpenAI API key"}),c.jsx("li",{children:"All costs associated with API usage"}),c.jsx("li",{children:"Managing your API key security"})]})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Intellectual Property"}),c.jsx("p",{className:"text-gray-700 leading-relaxed",children:"The Service and its original content, features, and functionality are owned by GitScribe and are protected by international copyright, trademark, and other intellectual property laws."})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Limitation of Liability"}),c.jsx("p",{className:"text-gray-700 leading-relaxed",children:'GitScribe is provided "as is" without warranties of any kind. We are not liable for any damages arising from your use of the Service, including but not limited to data loss, documentation errors, or API costs.'})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Changes to Terms"}),c.jsx("p",{className:"text-gray-700 leading-relaxed",children:"We reserve the right to modify these terms at any time. Continued use of the Service after changes constitutes acceptance of the new terms."})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Contact"}),c.jsxs("p",{className:"text-gray-700",children:["For questions about these Terms, contact us at"," ",c.jsx("a",{href:"mailto:legal@GitScribe.com",className:"text-orange-600 hover:text-orange-700",children:"legal@GitScribe.com"})]})]})]})};case"cookie-policy":return{title:s("cookiePolicyTitle"),icon:c.jsx(WA,{className:"w-8 h-8"}),description:"How we use cookies and similar technologies",content:c.jsxs("div",{className:"space-y-6",children:[c.jsxs("section",{children:[c.jsxs("p",{className:"text-sm text-gray-500 mb-6",children:["Last updated: ",new Date().toLocaleDateString()]}),c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"What Are Cookies"}),c.jsx("p",{className:"text-gray-700 leading-relaxed",children:"Cookies are small text files stored on your device when you visit a website. They help websites remember your preferences and improve your browsing experience."})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"How We Use Cookies"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Essential Cookies"}),c.jsx("p",{className:"text-gray-700",children:"These cookies are necessary for the Service to function. They include authentication tokens and session information."})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Preference Cookies"}),c.jsx("p",{className:"text-gray-700",children:"We use localStorage to store your preferences, such as GitHub tokens and UI settings. This data is stored locally in your browser and never transmitted to our servers."})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Analytics Cookies"}),c.jsx("p",{className:"text-gray-700",children:"We may use analytics cookies to understand how users interact with our Service and improve our features."})]})]})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"LocalStorage Usage"}),c.jsx("p",{className:"text-gray-700 leading-relaxed mb-3",children:"GitScribe uses browser localStorage (not cookies) to store:"}),c.jsxs("ul",{className:"list-disc list-inside space-y-2 text-gray-700 ml-4",children:[c.jsx("li",{children:"GitHub Personal Access Tokens (encrypted locally)"}),c.jsx("li",{children:"User preferences and settings"}),c.jsx("li",{children:"Auto-follow repository configurations"})]}),c.jsx("p",{className:"text-gray-700 mt-4",children:"This data remains on your device and is never shared with third parties."})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Managing Cookies"}),c.jsx("p",{className:"text-gray-700 leading-relaxed",children:"You can control cookies through your browser settings. However, disabling essential cookies may affect the functionality of the Service."}),c.jsx("p",{className:"text-gray-700 mt-4",children:"To clear localStorage data, you can use your browser's developer tools or clear browsing data."})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Third-Party Cookies"}),c.jsx("p",{className:"text-gray-700 leading-relaxed",children:"We may use third-party services that set their own cookies. These services include:"}),c.jsx("ul",{className:"list-disc list-inside space-y-2 text-gray-700 ml-4 mt-3",children:c.jsx("li",{children:"Analytics providers (if applicable)"})})]}),c.jsxs("section",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Contact"}),c.jsxs("p",{className:"text-gray-700",children:["For questions about our Cookie Policy, contact us at"," ",c.jsx("a",{href:"mailto:privacy@GitScribe.com",className:"text-orange-600 hover:text-orange-700",children:"privacy@GitScribe.com"})]})]})]})};default:return{title:"Page Not Found",icon:c.jsx(zr,{className:"w-8 h-8"}),description:"The requested page could not be found",content:c.jsx("div",{children:c.jsx("p",{className:"text-gray-700",children:"The page you're looking for doesn't exist."})})}}})();return c.jsxs("div",{className:"min-h-screen bg-white flex flex-col",children:[c.jsx("header",{className:"bg-white border-b border-gray-100 sticky top-0 z-50",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:c.jsx("div",{className:"flex items-center justify-between",children:c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:c.jsx(jb,{className:"w-5 h-5 text-gray-600"})}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-2 bg-gradient-to-r from-orange-500 to-red-500 rounded-lg",children:i.icon}),c.jsxs("div",{children:[c.jsx("h1",{className:"text-xl font-bold text-gray-900",children:i.title}),c.jsx("p",{className:"text-sm text-gray-500",children:i.description})]})]})]})})})}),c.jsx("main",{className:"flex-1 max-w-4xl mx-auto px-4 py-12 w-full",children:c.jsx("div",{className:"prose prose-slate max-w-none",children:i.content})}),c.jsx(Xp,{onNavigate:o=>{window.dispatchEvent(new CustomEvent("navigate",{detail:o}))}})]})}function bF(){const[t,e]=V.useState("landing");return V.useEffect(()=>{const r=s=>{e(s.detail)};return window.addEventListener("navigate",r),()=>{window.removeEventListener("navigate",r)}},[]),["github-integration","multi-repo-support","ai-powered-generation","export-commit","documentation-page","api-reference","examples","support","privacy-policy","terms-of-service","cookie-policy"].includes(t)?c.jsx(xF,{pageType:t,onBack:()=>e("landing")}):t==="documentation"?c.jsx(wF,{onBack:()=>e("landing")}):c.jsx(lC,{onGenerate:()=>e("documentation")})}Ib(document.getElementById("root")).render(c.jsx(V.StrictMode,{children:c.jsx(bF,{})}));
